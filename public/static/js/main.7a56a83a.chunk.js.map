{"version":3,"sources":["dispatcher.js","conf.jsx","actions/MyActions.js","init-fcm.js","Dict.jsx","stores/ModelStore.js","containers/layouts/PanelRightPage.jsx","containers/actuals/options.jsx","containers/actuals/form.jsx","containers/actuals/list.jsx","containers/metas/show.jsx","components/metas/show.jsx","containers/metas/list.jsx","containers/metas/index.jsx","components/metas/index.jsx","containers/metas/form.jsx","components/metas/create.jsx","components/metas/update.jsx","containers/interactions/menu.jsx","containers/shares/menu.jsx","containers/comments/form.jsx","containers/comments/list.jsx","containers/posts/show.jsx","janus.js","components/users/loggedIn.js","components/rooms/session.js","components/posts/show.jsx","containers/posts/list.jsx","containers/posts/index.jsx","components/posts/index.jsx","containers/channels/options.jsx","containers/posts/form.jsx","components/posts/uploader.js","components/posts/create.jsx","components/posts/update.jsx","containers/notifications/list.jsx","containers/notifications/index.jsx","components/notifications/index.jsx","containers/channels/show.jsx","components/channels/show.jsx","containers/channels/list.jsx","containers/channels/index.jsx","components/channels/index.jsx","containers/channels/form.jsx","components/channels/uploader.js","components/channels/create.jsx","components/channels/update.jsx","containers/users/options.jsx","containers/assignments/form.jsx","containers/assignments/list.jsx","containers/access_controls/form.jsx","containers/access_controls/list.jsx","containers/roles/show.jsx","components/roles/show.jsx","containers/roles/list.jsx","containers/roles/index.jsx","components/roles/index.jsx","containers/roles/form.jsx","components/roles/create.jsx","components/roles/update.jsx","containers/settings/show.jsx","components/settings/show.jsx","containers/settings/list.jsx","containers/settings/index.jsx","components/settings/index.jsx","containers/settings/form.jsx","components/settings/create.jsx","components/settings/update.jsx","containers/channels/compactlist.jsx","containers/profiles/experties.jsx","containers/profiles/simpleList.jsx","containers/profiles/followers.jsx","containers/profiles/followees.jsx","containers/profiles/show.jsx","components/profiles/show.jsx","containers/profiles/list.jsx","containers/profiles/index.jsx","components/profiles/index.jsx","containers/profiles/form.jsx","components/profiles/create.jsx","components/profiles/update.jsx","containers/friendships/index.jsx","components/friendships/index.jsx","containers/privacy/index.jsx","components/privacy/index.jsx","containers/bookmarks/list.jsx","containers/bookmarks/index.jsx","components/bookmarks/index.jsx","containers/users/Login.jsx","components/users/Login.jsx","components/users/LoginJwt.jsx","containers/users/SignUp.jsx","components/users/SignUp.jsx","containers/users/Verification.jsx","components/users/Verification.jsx","containers/rooms/show.jsx","components/rooms/show.jsx","containers/rooms/list.jsx","containers/rooms/index.jsx","components/rooms/index.jsx","containers/rooms/form.jsx","components/rooms/create.jsx","components/rooms/update.jsx","containers/notification_settings/form.jsx","routes.js","components/notification_settings/update.jsx","containers/layouts/NotFoundPage.jsx","components/App.jsx","serviceWorker.js","index.js","js/fa.js"],"names":["Dispatcher","conf","server","getList","model","page","params","token","queryString","Object","keys","map","key","join","axios","get","headers","then","response","dispatcher","dispatch","type","list","data","catch","error","console","log","fileUpload","id","file","url","formData","FormData","append","config","put","instance","getInstance","removeInstance","setInstance","post","updateInstance","initializedFirebaseApp","firebase","apiKey","authDomain","databaseURL","projectId","storageBucket","messagingSenderId","appId","measurementId","messaging","isSupported","usePublicVapidKey","dict","modelStore","klass","this","i","len","length","push","emit","action","listModel","showIntance","deleteIntance","setIntance","postFile","EventEmitter","register","handleActions","bind","PanelRightPage","logout","check_ability","state","window","localStorage","getItem","ability","profileId","setState","removeItem","location","replace","ModelStore","on","removeListener","MyActions","user","getIntance","getKlass","the_ability","roles","the_roles","profile_id","a","link","icon","result","ab","title","value","ignoreCache","view","panelClose","className","role_id","profile","options","role","current","selected","Fragment","dashboard","reloadCurrent","posts","channels","notifications","bookmarks","user_settings","privacy_settings","notification_settings","data-open-in","name","onChange","e","changeRole","target","change_role","onClick","settings","login","tavan","logged_in","Component","ActualOptions","props","content","fid","ActualForm","meta","meta_schema","items","label","placeholder","onInput","onChangeValue","smartSelect","smartSelectParams","pageBackLinkText","back","submit","fill","form","ActualList","actuals","body","td","j","crypto","lib","WordArray","random","defaultValue","editable","metaId","color","removeActual","uuid","ios","aurora","md","MetaShow","simple-list","JSON","stringify","handleChangeValue","Layout","fields","$f7route","newState","assign","concat","meta_id","href","position","slot","metas","backLink","fab","MetaList","mediaList","after","subtitle","text","MetaIndex","loadData","Framework7","toast","show","receiving","closeTimeout","React","MetaForm","handleChange","inputStyle","direction","metaSchema","MetaCreate","obj","$f7router","navigate","meta_form","editing","DocumentUpdate","InteractionMenu","social_acts","interaction","sourceType","sourceId","bookmark","like","likes","follow","follows","cancel","tooltip","actionsOpen","ShareMenu","opened","sheetOpened","onSheetClosed","sheetClose","close","channel","selectedChannel","strong","tag","sheetOpen","class","CommentForm","comment_form","replyTo","comments","cm","in_reply_to","substring","deleteable","removeReply","comment","inputId","rnd","maxlength","resizable","clearButton","commentContent","CommentList","editLink","deleteCommentConfirm","replyToComment","fullname","reply_to","date","Date","ODate","created_at","time","locale","fromNow","ago","src","avatar","width","height","inset","noGap","loadMore","more","PostShow","draft","rated","rating","aria-hidden","contentState","convertFromRaw","editorState","EditorState","createWithContent","stateToHTML","tabletWidth","deletable","deletePostConfirm","share","toolbar","readOnly","submitComment","RTCRtpTransceiver","Janus","sessions","isExtensionEnabled","navigator","mediaDevices","getDisplayMedia","userAgent","match","chromever","parseInt","maxver","extension","isInstalled","defaultExtension","extensionId","document","querySelector","getScreen","callback","pending","setTimeout","Error","cache","postMessage","init","addEventListener","event","origin","clearTimeout","gatewayCallbacks","success","noop","destroyed","initDone","isWebrtcSupported","websockets","ws","wsHandlers","wsKeepaliveTimeoutId","servers","serversIndex","isArray","debug","indexOf","iceServers","urls","iceTransportPolicy","bundlePolicy","ipv6Support","ipv6","withCredentials","undefined","maxev","max_poll_events","apisecret","destroyOnUnload","keepAlivePeriod","isNaN","longPollTimeout","getMaxBitrates","simulcastMaxBitrates","maxBitrates","high","medium","low","connected","sessionId","pluginHandles","that","retries","transactions","eventHandler","longpoll","getTime","encodeURIComponent","httpAPICall","verb","handleEvent","timeout","textStatus","errorThrown","warn","json","skipTimeout","sender","pluginHandle","candidate","webrtcStuff","pc","remoteSdp","completed","addIceCandidate","endOfCandidates","candidates","webrtcState","hangup","detached","ondetached","detach","mediaState","slowLink","transaction","reportSuccess","code","reason","plugindata","jsep","onmessage","vdebug","keepAlive","request","randomString","send","createSession","callbacks","onopen","onerror","onclose","eventName","newWebSocket","parse","sendMessage","handleId","message","sdp","e2ee","sendTrickleCandidate","createDataChannel","dclabel","dcprotocol","incoming","pendingData","onDataChannelStateChange","protocol","dcState","dataChannel","readyState","ondataopen","dcoptions","ordered","ondata","sendData","dataChanDefaultLabel","sendDtmf","dtmfSender","audioSender","getSenders","find","track","kind","dtmf","ontonechange","tone","tones","duration","gap","insertDTMF","destroyHandle","noRequest","cleanupWebrtc","streamsDone","media","stream","getAudioTracks","getVideoTracks","addTracks","myStream","update","streamExternal","isAudioSendEnabled","addAudio","replaceAudio","addTrack","unifiedPlan","audioTransceiver","transceivers","getTransceivers","t","receiver","replaceTrack","isVideoSendEnabled","addVideo","replaceVideo","videoTransceiver","pc_config","webRTCAdapter","browserDetails","browser","version","pc_constraints","optional","rtcConstraints","RTCRtpSender","prototype","createEncodedAudioStreams","createEncodedVideoStreams","senderTransforms","receiverTransforms","RTCPeerConnection","getStats","volume","bitrate","trickle","oniceconnectionstatechange","iceState","iceConnectionState","onicecandidate","iceDone","mySdp","localDescription","sdpSent","sendSDP","sdpMid","sdpMLineIndex","ontrack","streams","remoteStream","onremotestream","onended","receiverStreams","readableStream","pipeThrough","pipeTo","writableStream","trackMutedTimeoutId","ev","removeTrack","onmute","onunmute","simulcast2","getTracks","forEach","addTransceiver","sendEncodings","rid","active","maxBitrate","scaleResolutionDownBy","senderStreams","isDataEnabled","ondatachannel","onlocalstream","setRemoteDescription","customizeSdp","simulcast","mediaConstraints","audioSend","audioRecv","isAudioRecvEnabled","setDirection","removeAudio","videoSend","videoRecv","isVideoRecvEnabled","removeVideo","offerToReceiveAudio","offerToReceiveVideo","mandatory","OfferToReceiveAudio","OfferToReceiveVideo","sendVideo","parameters","getParameters","setParameters","encodings","priority","createAnswer","answer","setLocalDescription","iceRestart","s","createOffer","offer","lines","split","video","ssrc","ssrc_fid","cname","msid","mslabel","insertAt","mline","splice","Math","floor","endsWith","mungeSdpForSimulcasting","prepareWebrtc","webrtcError","audio","keepAudio","keepVideo","addData","consentDialog","at","stop","ra","asnd","vt","rv","vsnd","tracks","mst","isGetUserMediaAvailable","constraints","audioSupport","videoSupport","callbackUserMedia","getScreenMedia","gsmCallback","useAudio","getUserMedia","audioStream","screenshareFrameRate","frameRate","screenshareHeight","screenshareWidth","captureDesktopAudio","googLeakyBucket","maxWidth","screen","maxHeight","minFrameRate","maxFrameRate","chromeMediaSource","googTemporalLayeredScreencast","chromeMediaSourceId","mozMediaSource","mediaSource","err","lastTime","currentTime","polly","setInterval","clearInterval","enumerateDevices","devices","audioExist","some","device","videoExist","isScreenSendEnabled","needAudioDevice","failIfNoAudio","isAudioSendRequired","needVideoDevice","failIfNoVideo","isVideoSendRequired","haveAudioDevice","haveVideoDevice","gumConstraints","prepareWebrtcPeer","getVolume","remote","timer","stats","res","remoteSource","audioLevel","isMuted","enabled","mute","getBitrate","inStats","mediaType","toLowerCase","bytesReceived","googCodecName","bsnow","tsnow","timestamp","bsbefore","tsbefore","timePassed","bitRate","round","hangupRequest","oncleanup","getServer","isConnected","reconnect","getSessionId","destroy","unload","notifyDestroyed","cleanupHandles","sendBeacon","unbindWebSocket","removeEventListener","onUnbindMessage","onUnbindError","session_id","destroySession","attach","plugin","opaqueId","handleToken","session","started","getId","getPlugin","getRemoteVolume","getLocalVolume","isAudioMuted","muteAudio","unmuteAudio","isVideoMuted","muteVideo","unmuteVideo","handleRemoteJsep","sendRequest","createHandle","useDefaultDependencies","deps","f","fetch","p","Promise","socketCls","WebSocket","proto","arr","Array","adapter","fetchOptions","method","credentials","fetching","reject","resolve","timerId","race","ok","parsed","useOldDependencies","jq","jQuery","payload","contentType","xhrFields","ajax","extend","dataType","async","xhr","status","trace","d","usedDependencies","dependencies","listDevices","attachMediaStream","element","srcObject","URL","createObjectURL","reattachMediaStream","to","from","platform","oldOBF","safariVp8","getCapabilities","codecs","codec","mimeType","testpc","tempPc","charSet","randomPoz","loggedIn","setItem","sessionCreate","self","janus","sfutest","registerUsername","alert","msg","myid","mypvtid","addParticipant","userUUID","display","newRemoteFeed","leaving","feeds","filter","item","rfid","remoteFeed","unPublishedFeed","shift","removeParticipant","unpublished","lowFeeds","isOwner","requestAccepted","videoTracks","participants","$$","streamAttacher","hide","reload","room","roomId","ptype","pin","publishData","findFeedByRfid","findFeedById","participant","exisitingParticipant","participantId","findParticpantById","findParticpantByUuid","simulcastStarted","subscribe","feed","private_id","toUpperCase","videoCodec","rfdisplay","rfindex","feedToRole","getElementById","videoQuality","audioTracks","requests","messageFlag","publisedCamera","unPublishCamera","publishCamera","publishMicrophone","feedId","participantIndex","index","findIndex","Number","isInteger","textroom","unPublishData","deleteComment","deletePost","pageAfterIn","channelId","shortners","janusServer","myusername","mystream","activeFeeds","bitrateTimer","publishedMicrophone","muted","prevProps","val","interaction_type","interactionable_id","interactionable_type","source_type","source_id","post_id","channel_id","$f7","sheet","reply_id","dialog","confirm","are_you_sure","focus","PostList","ratings_count","comments_count","PostIndex","infinite","infiniteDistance","infinitePreloader","showPreloader","onInfinite","panelOpen","f7","inner","disableButtonText","search","query","style","marginTop","Post","allowInfinite","q","el","ChannelOptions","PostForm","searchbar","searchbarPlaceholder","new_post","localization","translations","fa","inline","image","uploadCallback","uploadImageCallBack","previewImage","onEditorStateChange","XMLHttpRequest","open","setRequestHeader","responseText","PostCreate","createEmpty","convertToRaw","getCurrentContent","blocks","block","trim","incomplete_data","prev","prevstate","post_form","PostUpdate","NotificationList","colorClass","notification","seen","target_type","target_id","notification_text","NotificationIndex","Notification","ChannelShow","admins","recent_posts","ChannelList","ChannelIndex","Channel","ChannelForm","details","ChannelCreate","channel_form","ChannelUpdate","UserOptions","users","email","AssignmentForm","assignment_form","user_id","UserList","removeRole","AccessControlForm","access_control_form","abilityTitle","abilityValue","true","false","addAbility","AbilityList","removeAbility","access_control_list","RoleShow","assignedUsers","ability_title","ability_value","RoleList","RoleIndex","RoleForm","defaultRole","isDefaultRole","radio","checked","NonDefault","Default","disabled","RoleCreate","default_role","role_form","SettingShow","setting","removeSetting","setting_id","SettingList","SettingIndex","SettingForm","SettingCreate","setting_form","ChannelCompactList","ExpertiesList","experties","expert","removeExperties","mediaBgColor","SimpleList","profiles","Followers","followers","followees","ProfileShow","useMemo","primary","tabActive","m","addTag","backLinkForce","tabbar","bottom","tabLink","tabLinkActive","ProfileList","ProfileIndex","ProfileForm","profile_info","firstname","surename","new_experties","submitExperties","withIcon","buttonText","choose_image","onDrop","buttonClassName","imgExtension","maxFileSize","submitFields","handleChangeValueFields","ProfileCreate","pictures","picture","profile_form","FriendshipIndex","friendship","Friendship","PrivacyIndex","profilePrivacy","findSetting","setting_schemas","schema","op","privacySettings","completed_successfully","privacy","BookmarkList","BookmarkIndex","LoginForm","sign_up","autofocus","enter_your_email","animate","you_can_sign_up","cas","password","username","Login","last","SignUpForm","enter_your_name","enter_your_surename","validate","if_registered","you_can_login","submitting","SignUp","verification","verification_code","enter_verification_code","verificationCode","Verification","RoomIndex","videos","spec","controls","autoPlay","playsInline","onPageBeforeRemove","beforeRemove","speakRequest","paddingTop","highVidoes","removeRequest","acceptRequest","lowVideos","off","unmute","attachMedia","room_id","requesterId","publish","bitrate_cap","videocodec","user_uuid","user_fullname","is_owner","participantIsSpeaker","accept","RoomList","rooms","RoomForm","defaultRoom","isPrivateRoom","write_appropriate_description","NonPrivate","privateRoom","Private","RoomCreate","default_room","room_form","notification_setting","notification_type","mail_notification","push_notification","sms","add_comment_to_followed_posts","changeSetting","add_comment_to_posts","remove_comments_from_posts","add_likes_to_posts","remove_likes_from_posts","add_bookmarks_to_posts","remove_bookmarks_from_posts","add_follows_to_posts","remove_follows_from_posts","add_shares_to_posts","remove_shares_from_posts","able_to_post","add_likes_to_channels","remove_likes_from_channels","add_bookmarks_to_channels","remove_bookmarks_from_channels","add_follows_to_channels","remove_follows_from_channels","able_to_channel","add_post_to_channels","path","component","LoginJwt","RoomUpdate","RoomShow","MetaUpdate","RoleUpdate","ProfileUpdate","SettingUpdate","loadBlockList","removeBlocked","app","autocomplete","create","openIn","openerEl","multiple","valueProperty","textProperty","searchbarDisableText","popupCloseLinkText","notFoundText","not_found","limit","source","render","results","change","blockList","prevState","onPageAfterIn","work_form","requestPermission","getToken","serviceWorker","firebaseMessaging","titleRightText","cssClass","f7params","theme","panel","rightBreakpoint","auroraPageLoadDelay","removeElements","routes","right","reveal","themeDark","pushState","main","Boolean","hostname","use","Framework7React","ReactDOM","createElement","App","ready","registration","unregister","module","exports"],"mappings":"qWAEe,M,OAAIA,Y,iBCFNC,EAAO,CACpB,OAAW,MAEX,YAAgB,sCCAVC,EAAQD,EAAKC,OAKZ,SAASC,EAAQC,GAAkC,IAA3BC,EAA0B,uDAArB,EAAGC,EAAkB,uDAAX,GAAIC,EAAO,uCACnDC,EAAcC,OAAOC,KAAKJ,GAAQK,KAAI,SAAAC,GAAG,OAAIA,EAAM,IAAMN,EAAOM,MAAMC,KAAK,KAC/EC,IAAMC,IAAIb,EAAS,IAAKE,EAAO,SAASC,EAAK,IAAIG,EAAa,CAAEQ,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KAC1IU,MAAK,SAAUC,GACdC,EAAWC,SAAS,CAClBC,KAAM,qBACNC,KAAMJ,EAASK,UAGlBC,OAAM,SAAUC,GACfC,QAAQC,IAAIF,MAIT,SAASG,EAAWxB,EAAOyB,EAAKC,EAAMvB,GAC3C,IAAMwB,EAAM7B,EAAS,IAAKE,EAAO,IAAIyB,EAC/BG,EAAW,IAAIC,SACrBD,EAASE,OAAO,kBAAkBJ,GAClCE,EAASE,OAAO,cAAcL,GAC9B,IAAMM,EAAS,CACXnB,QAAS,CACL,eAAgB,sBAChB,cAAiB,UAAYT,IAGrC6B,cAAIL,EAAKC,EAASG,GAAQlB,MAAK,SAAUC,GACvCC,EAAWC,SAAS,CAClBC,KAAM,oBACNgB,SAAUnB,EAASK,UAGtBC,OAAM,SAAUC,GACfC,QAAQC,IAAIF,MAIT,SAASa,EAAYlC,EAAOyB,EAAItB,GAAgB,IAATF,EAAQ,uDAAH,EACjDS,IAAMC,IAAIb,EAAS,IAAKE,EAAO,IAAIyB,EAAG,SAASxB,EAAM,CAAEW,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KACjIU,MAAK,SAAUC,GACdC,EAAWC,SAAS,CAClBC,KAAM,uBACNgB,SAAUnB,EAASK,UAGtBC,OAAM,SAAUC,GACfC,QAAQC,IAAIF,MAIT,SAASc,EAAenC,GAA2B,IAApBE,EAAmB,uDAAZ,GAAIC,EAAQ,uCACnDC,EAAcC,OAAOC,KAAKJ,GAAQK,KAAI,SAAAC,GAAG,OAAIA,EAAM,IAAMN,EAAOM,MAAMC,KAAK,KAC/EC,IAAMC,IAAIb,EAAS,IAAKE,EAAO,WAAWI,EAAa,CAAEQ,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KACnIU,MAAK,SAAUC,GACdC,EAAWC,SAAS,CAClBC,KAAM,0BACNgB,SAAUnB,EAASK,UAGtBC,OAAM,SAAUC,GACfC,QAAQC,IAAIF,MAIT,SAASe,EAAYpC,EAAOmB,EAAMhB,GACvCO,IAAM2B,KAAKvC,EAAS,IAAKE,EAAO,IAAKmB,EAAM,CAAEP,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KACvHU,MAAK,SAAUC,GACdC,EAAWC,SAAS,CAClBC,KAAM,uBACNgB,SAAUnB,EAASK,UAGtBC,OAAM,SAAUC,GACfC,QAAQC,IAAIF,MAIT,SAASiB,EAAetC,EAAOmB,EAAMhB,GAC1CO,IAAMsB,IAAIlC,EAAS,IAAKE,EAAO,IAAImB,EAAKM,GAAIN,EAAM,CAAEP,QAAS,CAAC,eAAgB,mBAAoB,cAAiB,UAAYT,KAC9HU,MAAK,SAAUC,GACdC,EAAWC,SAAS,CAClBC,KAAM,uBACNgB,SAAUnB,EAASK,UAGtBC,OAAM,SAAUC,GACfC,QAAQC,IAAIF,M,YC3FVkB,G,OAAyBC,gBAAuB,CAClDC,OAAQ,0CACRC,WAAY,8BACZC,YAAa,qCACbC,UAAW,cACXC,cAAe,0BACfC,kBAAmB,eACnBC,MAAO,4CACPC,cAAe,kBAIfC,EAAY,KACZT,YAAmBU,gBACrBD,EAAYV,EAAuBU,aACzBE,kBAER,2F,aCnBSC,GAAI,GACf,KAAS,2BACT,KAAS,iGACT,MAAU,2BACV,SAAc,2DACd,SAAa,+CACb,sBAAyB,6EACzB,OAAW,uEACX,MAAS,qBACT,QAAY,4BACZ,QAAY,wCACZ,KAAS,uCACT,kBAAqB,sIACrB,WAAc,+CACd,MAAS,iCACT,SAAY,iCACZ,QAAW,qBACX,OAAU,sBACV,oBAAuB,mFACvB,QAAW,oDACX,SAAY,2BACZ,aAAgB,0DAChB,iBAAoB,sEACpB,eAAkB,wFAClB,QAAW,4BACX,MAAS,kCACT,oBAAsB,uEACtB,OAAU,kCACV,OAAW,uCACX,KAAQ,iCACR,KAAQ,uCACR,OAAU,qBACV,YAAe,iLACf,QAAW,kEACX,IAAQ,wCACR,OAAU,8CACV,kBAAqB,0DACrB,SAAY,yCACZ,aAAgB,sGAChB,SAAY,iCACZ,KAAQ,qBACR,QAAW,uCACX,KAAQ,gEACR,IAAO,sBACP,UAAa,8EACb,UAAa,8EACb,SAAY,qDACZ,IAAM,2BACN,KAAO,iCACP,KAAQ,2BACR,kBAAqB,6EACrB,SAAY,sEACZ,WAAa,wCACb,IAAM,iCACN,WAAa,8CACb,QAAW,4EACX,UAAa,0DACb,eAAkB,8CAClB,gBAAmB,kFACnB,eAAkB,uEAClB,QAAW,oDACX,YAAe,sGACf,YAAe,4EACf,cAAkB,iEAClB,cAAiB,qDACjB,KAAQ,iCACR,UAAY,kCACZ,KAAS,qBACT,OAAU,oDACV,KAAQ,8CACR,OAAU,iCACV,YAAe,oDACf,MAAS,4BAxEM,qBAyER,kCAzEQ,cA0Ef,aAAc,2DA1EC,cA2Ef,MAAM,sBA3ES,cA4Ef,KAAK,sBA5EU,cA6Ef,cAAc,iEA7EC,cA8Ef,YAAY,2DA9EG,cA+Ef,cAAc,qDA/EC,cAgFf,UAAU,+CAhFK,cAiFf,cAAc,iEAjFC,cAkFf,aAAc,+CAlFC,cAmFf,MAAO,yCAnFQ,cAoFf,SAAU,sBApFK,cAqFf,mBAAoB,2DArFL,cAsFf,YAAY,8EAtFG,cAuFf,OAAQ,4BAvFO,cAwFf,YAAa,2DAxFE,cAyFf,oBAAqB,iEAzFN,cA0Ff,cAAe,qDA1FA,cA2Ff,iBAAkB,2DA3FH,cA4Ff,uBAAwB,yEA5FT,cA6Ff,QAAS,4BA7FM,cA8Ff,WAAY,mCA9FG,cA+Ff,QAAS,kCA/FM,cAgGf,gBAAgB,kEAhGD,cAiGf,aAAa,uEAjGE,cAkGf,WAAW,8CAlGI,cAmGf,YAAY,4EAnGG,cAoGf,kBAAmB,wGApGJ,cAqGf,kBAAmB,qDArGJ,cAsGf,WAAW,+CAtGI,cAuGf,UAAY,wCAvGG,cAwGf,QAAS,mCAxGM,cAyGf,QAAS,kCAzGM,cA0Gf,mBAAoB,oHA1GL,cA2Gf,sBAAuB,+GA3GR,cA4Gf,mCAAoC,qHA5GrB,cA6Gf,WAAY,mCA7GG,cA8Gf,YAAa,sBA9GE,cA+Gf,gBAAiB,iIA/GF,cAgHf,gBAAgB,sDAhHD,cAiHf,oBAAqB,8GAjHN,cAkHf,kBAAkB,kEAlHH,cAmHf,iBAAkB,8EAnHH,cAoHf,QAAS,mCApHM,cAqHf,WAAY,4BArHG,cAsHf,OAAO,kCAtHQ,cAuHf,SAAS,kCAvHM,cAwHf,QAAQ,wCAxHO,cAyHf,cAAc,gGAzHC,cA0Hf,WAAY,+CA1HG,cA2Hf,QAAS,4BA3HM,cA4Hf,UAAU,mCA5HK,cA6Hf,UAAW,sBA7HI,cA8Hf,OAAQ,6BA9HO,cA+Hf,OAAQ,sBA/HO,cAgIf,UAAW,yCAhII,cAiIf,aAAa,6DAjIE,cAkIf,QAAS,mCAlIM,cAmIf,OAAQ,4BAnIO,cAoIf,QAAS,4BApIM,cAqIf,sBAAsB,gGArIP,cAsIf,sBAAsB,0FAtIP,cAuIf,kBAAkB,wEAvIH,cAwIf,eAAgB,qDAxID,cAyIf,YAAa,yCAzIE,cA0If,QAAQ,qDA1IO,cA2If,OAAQ,4BA3IO,cA4If,OAAS,uEA5IM,cA6If,eAAgB,2DA7ID,cA8If,SAAU,4BA9IK,cA+If,OAAQ,sCA/IO,cAgJf,SAAU,8CAhJK,cAiJf,SAAU,wCAjJK,cAkJf,UAAY,kCAlJG,cAmJf,OAAQ,gBAnJO,cAoJf,OAAO,8CApJQ,cAqJf,SAAU,wCArJK,cAsJf,eAAgB,kEAtJD,cAuJf,eAAe,wEAvJA,cAwJf,YAAa,4FAxJE,cAyJf,gBAAiB,iEAzJF,cA0Jf,gBAAkB,iEA1JH,cA2Jf,kBAAkB,wGA3JH,cA4Jf,sBAAsB,yJA5JP,cA6Jf,kBAAkB,uEA7JH,cA8Jf,QAAQ,sGA9JO,cA+Jf,YAAa,6EA/JE,cAgKf,YAAY,6EAhKG,cAiKf,eAAgB,2DAjKD,cAkKf,oBAAsB,+CAlKP,cAmKf,0BAA4B,8GAnKb,cAoKf,UAAW,8CApKI,cAqKf,qBAAsB,mJArKP,cAsKf,WAAa,+CAtKE,cAuKf,YAAa,qDAvKE,cAwKf,mBAAoB,2DAxKL,cAyKf,kBAAoB,6EAzKL,cA0Kf,UAAW,4BA1KI,cA2Kf,yBAA0B,iGA3KX,cA4Kf,MAAO,0FA5KQ,cA6Kf,cAAe,sDA7KA,cA8Kf,wBAAyB,+FA9KV,cA+Kf,uBAAuB,2FA/KR,cAgLf,gCAAgC,gKAhLjB,cAiLf,6BAA6B,yEAjLd,cAkLf,qBAAqB,iGAlLN,cAmLf,0BAA0B,oHAnLX,cAoLf,yBAAyB,iGApLV,cAqLf,8BAA8B,+EArLf,cAsLf,uBAAuB,8EAtLR,cAuLf,4BAA4B,oFAvLb,cAwLf,sBAAsB,2DAxLP,cAyLf,2BAA2B,8EAzLZ,cA0Lf,wBAAwB,6GA1LT,cA2Lf,6BAA6B,gIA3Ld,cA4Lf,4BAA4B,oFA5Lb,cA6Lf,iCAAiC,8EA7LlB,cA8Lf,0BAA0B,0FA9LX,cA+Lf,+BAA+B,6GA/LhB,cAgMf,uBAAuB,uGAhMR,cAiMf,oBAAoB,uEAjML,cAkMf,oBAAoB,kCAlML,cAmMf,oBAAoB,gBAnML,cAoMf,MAAM,kCApMS,cAqMf,aAAe,kCArMA,cAsMf,UAAW,kCAtMI,cAuMf,UAAW,2DAvMI,cAwMf,UAAW,8CAxMI,cAyMf,YAAa,wCAzME,cA0Mf,gBAAgB,6EA1MD,cA2Mf,cAAe,qDA3MA,cA4Mf,YAAY,wEA5MG,cA6Mf,QAAS,yCA7MM,G,OCkGXC,EAAa,I,YA7FjB,aAAe,IAAD,8BACZ,+CACKnC,KAAO,GACZ,EAAKe,SAAW,KAChB,EAAKqB,MAAO,KAJA,E,uEAOJpC,GACRqC,KAAKrC,KAAO,GACZqC,KAAKD,MAAQpC,EAAKoC,MAClB,IAAK,IAAIE,EAAI,EAAGC,EAAMvC,EAAKC,KAAKuC,OAAQF,EAAIC,IAAOD,EACjDD,KAAKrC,KAAKyC,KAAKzC,EAAKC,KAAKqC,IACrBA,IAAMC,EAAM,GACdF,KAAKK,KAAK,YAGS,GAApB1C,EAAKC,KAAKuC,QACXH,KAAKK,KAAK,c,kCAKF3B,GACVsB,KAAKD,MAAQrB,EAASqB,MACtBC,KAAKtB,SAAWA,EAASd,KACzBoC,KAAKK,KAAK,kB,iCAGD3B,GACTsB,KAAKD,MAAQrB,EAASqB,MACtBC,KAAKtB,SAAWA,EAASd,KACzBoC,KAAKK,KAAK,kB,oCAIE3B,GACZsB,KAAKD,MAAQrB,EAASqB,MACtBC,KAAKtB,SAAWA,EAASd,KACzBoC,KAAKK,KAAK,sB,+BAGH3B,GACPX,QAAQC,IAAIU,GACZsB,KAAKD,MAAQrB,EAASqB,MACtBC,KAAKtB,SAAWA,EAASd,KACzBoC,KAAKK,KAAK,iB,mCAIV,OAAOL,KAAKtB,W,gCAIZ,OAAOsB,KAAKrC,O,sCAIZ,MAAO,CAACqC,KAAKrC,KAAMqC,KAAKD,S,iCAIxB,OAAOC,KAAKD,Q,oCAGAO,GACZ,OAAOA,EAAO5C,MACZ,IAAK,qBACHsC,KAAKO,UAAUD,EAAO3C,MACtB,MAEF,IAAK,uBACHqC,KAAKQ,YAAYF,EAAO5B,UACxB,MAEF,IAAK,0BACHsB,KAAKS,cAAcH,EAAO5B,UAC1B,MAEF,IAAK,uBACHsB,KAAKU,WAAWJ,EAAO5B,UACvB,MAEF,IAAK,oBACHsB,KAAKW,SAASL,EAAO5B,e,UApFJkC,eA+FzBpD,EAAWqD,SAASf,EAAWgB,cAAcC,KAAKjB,IAEnCA,QC9FMkB,G,kBACnB,aAAe,IAAD,8BACZ,+CACKC,OAAS,EAAKA,OAAOF,KAAZ,gBACd,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKG,cAAgB,EAAKA,cAAcH,KAAnB,gBAGrB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCC,QAAS,KACTC,UAAW,MAVD,E,sEAeZxB,KAAKyB,SAAS,CAAE7E,MAAO,OACvBwE,OAAOC,aAAaK,WAAW,SAC/BN,OAAOO,SAASC,QAAQ,O,2CAIxBC,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI3CqB,KAAKmB,MAAMvE,OAASoD,KAAKmB,MAAMvE,MAAMuD,OAAS,IAChD6B,EAAsB,QAAS,OAAQhC,KAAKmB,MAAMvE,S,oCAKpD,IAAIqF,EAAOJ,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBF,GAAkB,aAAVlC,GACVC,KAAKyB,SAAS,CACZF,QAASU,EAAKG,YACdC,MAAOJ,EAAKK,UACZd,UAAWS,EAAKM,e,oCAMRC,EAAGC,EAAMC,GACrB,IAAIC,EAAS,GAab,OAZI3C,KAAKmB,MAAMI,SACbvB,KAAKmB,MAAMI,QAAQvE,KAAI,SAAC4F,GAClBA,EAAGC,QAAUL,GAAKI,EAAGE,OACvBH,EAAOvC,KACL,kBAAC,IAAD,CAAUqC,KAAM,IAAMA,EAAO,IAAKM,aAAa,EAAM9F,IAAK,QAAUwF,EAAMO,KAAK,aAAaC,YAAU,GACpG,uBAAGC,UAAW,iBAAmBR,IACjC,8BAAO7C,EAAK4C,SAMfE,I,iCAGEQ,GAETnB,EAAsB,oBADX,CAACmB,QAASA,GAC4BnD,KAAKmB,MAAMvE,S,gCAI5D,GAAIoD,KAAKmB,MAAMK,UACb,OACE,kBAAC,IAAD,CAAUiB,KAAM,aAAezC,KAAKmB,MAAMK,UAAWwB,KAAK,aAAaC,YAAU,GAC/E,uBAAGC,UAAU,gCACb,8BAAOrD,EAAKuD,Y,8BAOlB,IAAIC,EAAU,GAYd,OAXIrD,KAAKmB,MAAMkB,OACbrC,KAAKmB,MAAMkB,MAAMrF,KAAI,SAACsG,GACjBA,EAAKC,QACNF,EAAQjD,KAAK,4BAAQ0C,MAAOQ,EAAKpF,GAAIjB,IAAK,OAASqG,EAAKpF,GAAIsF,UAAQ,GAAGF,EAAKT,QAE5EQ,EAAQjD,KAAK,4BAAQ0C,MAAOQ,EAAKpF,GAAIjB,IAAK,OAASqG,EAAKpF,IAAMoF,EAAKT,WAMlEQ,I,gCAGCzG,GAAQ,IAAD,OACf,OAAIA,EAEA,kBAAC,IAAM6G,SAAP,KACE,kBAAC,IAAD,SAAa,uBAAGP,UAAU,6BAAgCrD,EAAK6D,WAC/D,kBAAC,IAAD,CAAMR,UAAU,SACd,kBAAC,IAAD,CAAUT,KAAK,UAAUM,aAAa,EAAOY,eAAe,EAAOX,KAAK,aAAaC,YAAU,GAC7F,uBAAGC,UAAU,yBACb,8BAAOrD,EAAK+D,QAGd,kBAAC,IAAD,CAAUnB,KAAK,aAAaM,aAAa,EAAOY,eAAe,EAAQX,KAAK,aAAaC,YAAU,GACjG,uBAAGC,UAAU,2BACb,8BAAOrD,EAAKgE,WAGd,kBAAC,IAAD,CAAUpB,KAAK,kBAAkBM,aAAa,EAAOY,eAAe,EAAOX,KAAK,aAAaC,YAAU,GACrG,uBAAGC,UAAU,iCACb,8BAAOrD,EAAKiE,gBAGd,kBAAC,IAAD,CAAUrB,KAAK,cAAcM,aAAa,EAAOY,eAAe,EAAOX,KAAK,aAAaC,YAAU,GACjG,uBAAGC,UAAU,2BACb,8BAAOrD,EAAKkE,YAGb/D,KAAKkB,cAAc,aAAc,QAAS,UAM7C,kBAAC,IAAD,KAAY,uBAAGgC,UAAU,uBAA0BrD,EAAKmE,eACxD,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAUvB,KAAK,qBAAqBM,aAAa,EAAMC,KAAK,aAAaC,YAAU,GACjF,uBAAGC,UAAU,8BACb,8BAAOrD,EAAKoE,mBAEd,kBAAC,IAAD,CAAUxB,KAAK,0BAA0BM,aAAa,EAAMC,KAAK,aAAaC,YAAU,GACtF,uBAAGC,UAAU,sBACb,8BAAOrD,EAAKqE,wBAEblE,KAAKoD,UAEN,wBAAIF,UAAU,IACZ,uBAAGA,UAAU,uDAAuDiB,eAAa,WAC/E,4BAAQC,KAAK,YAAYC,SAAU,SAACC,GAAQ,EAAKC,WAAWD,EAAEE,OAAO1B,SAClE9C,KAAKqC,SAER,yBAAKa,UAAU,gBACb,yBAAKA,UAAU,cACb,yBAAKA,UAAU,cAAcrD,EAAK4E,iBAM1C,kBAAC,IAAD,CAAUzB,KAAK,aAAaC,YAAU,EAACyB,QAAS1E,KAAKiB,QACnD,uBAAGiC,UAAU,4BACb,8BAAOrD,EAAKoB,UAKhB,kBAAC,IAAD,SAAa,uBAAGiC,UAAU,sBAAyBrD,EAAK8E,UACxD,kBAAC,IAAD,CAAMzB,UAAU,SACblD,KAAKkB,cAAc,cAAe,QAAS,YAMhD,kBAAC,IAAMuC,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAKmE,eAClB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAUvB,KAAK,UAAUI,MAAOhD,EAAK+E,MAAO5B,KAAK,aAAaC,YAAU,Q,+BAOxE,IACArG,EAAUoD,KAAKmB,MAAfvE,MACR,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQiG,MAAOhD,EAAKgF,QACnB7E,KAAK8E,UAAUlI,Q,GA1LoBmI,cCU7BC,EAfO,SAACC,GACrB,IAAI5B,EAAU,CAAC,4BAAQP,MAAM,MAC7B,GAAGmC,EAAMC,QACP,IAAK,IAAIjF,EAAI,EAAGA,EAAIgF,EAAMC,QAAQ/E,OAAQF,IACxCoD,EAAQjD,KACN,4BAAQ0C,MAAOmC,EAAMC,QAAQjF,GAAGiF,QAAQ,GAAGC,KACxCF,EAAMC,QAAQjF,GAAGiF,QAAQ,GAAGpC,QAMrC,OAAOO,GCqDQ+B,EA9DE,SAACH,GAChB,GAAIA,EAAMI,MAAQJ,EAAMI,KAAKC,YAAa,CAItC,IAFA,IAAIA,EAAcL,EAAMI,KAAKC,YACzBC,EAAQ,GAH0B,WAI7BtF,GACP,OAAQqF,EAAYrF,GAAGvC,MACrB,IAAK,SACL6H,EAAMnF,KACJ,kBAAC,IAAD,CACEoF,MAAOF,EAAYrF,GAAGuF,MACtB9H,KAAK,OACL+H,YAAY,MACZC,QAAS,SAACpB,GAAD,OAAOW,EAAMU,cAAcL,EAAYrF,GAAGkF,IAAKb,EAAEE,OAAO1B,MAAOmC,EAAMI,KAAKnH,QAEvF,MACA,IAAK,OACDqH,EAAMnF,KACJ,kBAAC,IAAD,CACEoF,MAAOF,EAAYrF,GAAGmE,KACtB1G,KAAK,WACL+H,YAAY,MACZC,QAAS,SAACpB,GAAD,OAAOW,EAAMU,cAAcL,EAAYrF,GAAGkF,IAAKb,EAAEE,OAAO1B,MAAOmC,EAAMI,KAAKnH,QAG3F,MACA,IAAK,QACGoH,EAAYrF,GAAGiF,SACjBK,EAAMnF,KACJ,kBAAC,IAAD,CACEyC,MAAOyC,EAAYrF,GAAGiF,QAAQrC,MAC9B+C,aAAW,EACXC,kBAAmB,CAACC,iBAAkBjG,EAAKkG,OAE3C,4BAAQ3B,KAAK,UACXC,SAAU,SAACC,GAAD,OAAOW,EAAMU,cAAcL,EAAYrF,GAAGkF,IAAKb,EAAEE,OAAO1B,MAAOmC,EAAMI,KAAKnH,MAEpF,kBAAC,EAAD,CAAegH,QAASI,EAAYrF,GAAGiF,eAhC9CjF,EAAI,EAAGA,EAAIqF,EAAYnF,OAAQF,IAAM,EAArCA,GAuCH,IAAI+F,EAAS,KAIb,OAHIf,EAAMe,SACRA,EAAS,kBAAC,IAAD,KAAY,kBAAC,IAAD,MAAa,kBAAC,IAAD,CAAQ9C,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,UAG5F,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAanG,EAAKqG,KAAlB,IAAyBjB,EAAMI,KAAKG,OACpC,kBAAC,IAAD,CAAMU,MAAI,GACPX,EACAS,IAMP,OAAO,+B,gBCzBNG,EAnCI,SAAClB,GAClB,IAAIK,EAAaL,EAAMI,KAAKC,YAC5B,GAAGL,EAAMI,MAAQJ,EAAMmB,QAAQ,CAI7B,IAHF,IAAIC,EAAO,CAAC,kBAAC,IAAD,KAAapB,EAAMI,KAAKG,QAC9Bc,EAAK,GACLF,EAAWnB,EAAMmB,QAHQ,WAIpBnG,GACJiF,EAAUkB,EAAQnG,GAAGiF,QACrBoB,EAAK,GACR,IAAK,IAAIC,EAAG,EAAGA,EAAIrB,EAAQ/E,OAAQoG,IAE/BD,EAAGlG,KAAK,kBAAC,IAAD,CAAWnD,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IAAKnB,MAAON,EAAQqB,GAAGf,MAAO9H,KAAK,OAAOkJ,aAAc1B,EAAQqB,GAAGzD,SAErHmC,EAAM4B,UAAY3B,EAAQqB,IAAMA,GAAKjB,EAAYnF,OAAS,GAAK8E,EAAMI,KAAKnH,IAAMgH,EAAQqB,GAAGO,QAC7FR,EAAGlG,KAAK,kBAAC,IAAD,CAAQ2G,MAAM,OAAOrC,QAAS,kBAAMO,EAAM+B,aAAaZ,EAAQnG,GAAGgH,QAC1E,kBAAC,IAAD,CAAMC,IAAI,WAAWC,OAAO,WAAWC,GAAG,qBAI9Cf,EAAKjG,KAAK,kBAAC,IAAD,KAAM,kBAAC,IAAD,CAAMnD,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAAML,MAbtDrG,EAAI,EAAGA,EAAImG,EAAQjG,OAAQF,IAAK,CAAC,IACrCiF,EADoC,EAAhCjF,GAmBX,OACE,kBAAC,IAAMwD,SAAP,KACG4C,GAKL,OAAO,+B,kBCVMgB,EAnBE,SAACpC,GAChB,OAAIA,EAAMI,KAEN,kBAAC,IAAM5B,SAAP,KACE,kBAAC,IAAD,KACA,kBAAC,IAAD,KAAa5D,EAAKgD,MAAlB,KAA2BoC,EAAMI,KAAKxC,OACtC,kBAAC,IAAD,CAAMyE,eAAA,GACJ,kBAAC,IAAD,CAAUpE,UAAU,IACpB,kBAAC,IAAD,CAAYhF,GAAG,cAAcN,KAAM2J,KAAKC,UAAUvC,EAAMI,KAAKC,kBAG/D,kBAAC,EAAD,CAAYD,KAAMJ,EAAMI,KAAMwB,UAAU,EAAMT,QAASnB,EAAMI,KAAKe,QAASY,aAAc/B,EAAM+B,eAC/F,kBAAC,EAAD,CAAY3B,KAAMJ,EAAMI,KAAMW,OAAQf,EAAMe,OAAQL,cAAeV,EAAMwC,qBAItE,MCHUC,E,YACnB,aAAe,IAAD,8BACZ,+CACK/I,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKiF,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKiG,aAAe,EAAKA,aAAajG,KAAlB,gBAGpB,EAAKI,MAAQ,CACXkE,KAAM,KACNyB,OAAQ,KACRlK,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCqG,OAAQ,IAZE,E,kFAiBZ9F,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,mBAAoB9B,KAAKrB,e,6CAIvCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,mBAAoB/B,KAAKrB,e,0CAInDqD,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,U,oCAI/B,IAAI0I,EAAOxD,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBkD,GAAkB,SAAVtF,GACVC,KAAKyB,SAAS,CACZ4D,KAAMA,EACNyB,OAAQzB,EAAKnH,O,wCAKDjB,EAAK6F,GACrB,IAAI6E,EAAS3H,KAAKmB,MAAMwG,OACxB,GAAIA,EAAOxH,OAAS,EAClB,IAAK,IAAIF,EAAI,EAAGA,EAAI0H,EAAOxH,OAAQF,IACjC,GAAI0H,EAAO1H,GAAGkF,KAAOwC,EAAO1H,GAAGkF,MAAQlI,EAAK,CAC1C,IAAI4K,EAAW/K,OAAOgL,OAAO,GAAI9H,KAAKmB,OACtC0G,EAASF,OAAO1H,GAAK,CAAEkF,IAAKlI,EAAK6F,MAAOA,GACxC9C,KAAKyB,SAASoG,QAEd7H,KAAKyB,SAAS,CAAEkG,OAAQ3H,KAAKmB,MAAMwG,OAAOI,OAAO,CAAE5C,IAAKlI,EAAK6F,MAAOA,WAIxE9C,KAAKyB,SAAS,CAAEkG,OAAQ3H,KAAKmB,MAAMwG,OAAOI,OAAO,CAAE5C,IAAKlI,EAAK6F,MAAOA,Q,mCAI3DmE,GACXjF,EAAyB,UAAW,CAACiF,KAAMA,M,+BAK3CjF,EAAsB,UADX,CAACgG,QAAShI,KAAKmB,MAAM2F,OAAQ5B,QAASlF,KAAKmB,MAAMwG,QACrB3H,KAAKmB,MAAMvE,S,4BAIlD,GAAIoD,KAAKmB,MAAMkE,KACb,OACE,kBAAC,IAAD,CAAK4C,KAAM,UAAYjI,KAAKmB,MAAMkE,KAAKnH,GAAK,QAASsG,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,QACjH,kBAAC,IAAD,CAAMG,IAAI,UAAUC,OAAO,UAAUC,GAAG,kBACxC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,sB,+BAMxC,IACA/B,EAASrF,KAAKmB,MAAdkE,KACR,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQxC,MAAOhD,EAAKuI,MAAOC,SAAUxI,EAAKkG,OAC1C,kBAAC,IAAD,MACC/F,KAAKsI,MACN,kBAAC,EAAD,CAAUjD,KAAMA,EAAM2B,aAAchH,KAAKgH,aAAcS,kBAAmBzH,KAAKyH,kBAAmBzB,OAAQhG,KAAKgG,c,GAxFnFjB,aCKnBwD,EArBA,SAACtD,GAEhB,OAAIA,EAAMmD,MAEN,kBAAC,IAAD,CAAMI,WAAS,GACZvD,EAAMmD,MAAMpL,KAAI,SAACqI,GAAD,OACf,kBAAC,IAAD,CACEpI,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IACjClE,KAAM,UAAY4C,EAAKnH,GACvB6E,aAAa,EACbF,MAAOwC,EAAKxC,MACZ4F,MAAM,GACNC,SAAS,GACTC,KAAK,SAKH,8BCHCC,EAdG,SAAC3D,GACjB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAKuI,MAAOC,SAAUxI,EAAKkG,OAE1C,kBAAC,IAAD,KAAalG,EAAKlC,MAClB,kBAAC,IAAD,CAAKsK,KAAK,aAAazD,OAAO,aAAc0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,cACpF,kBAAC,IAAD,CAAMG,IAAI,SAASC,OAAO,SAASC,GAAG,iBACtC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,oBAE5C,kBAAC,EAAD,CAAUgB,MAAOnD,EAAMmD,UCNRV,E,YACnB,aAAe,IAAD,8BACZ,+CACKlL,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKI,MAAQ,CACXiH,MAAO,MAJG,E,kFAQZvG,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,WAAY/B,KAAKxD,W,0CAI3CwD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QACpElG,EAAkB,QAAShC,KAAKmB,MAAMzE,Q,gCAItC,IAAI0L,EAAQvG,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnBiG,GAAoB,SAAVrI,GACZC,KAAKyB,SAAS,CACZ2G,MAAOA,M,+BAKH,IACDA,EAASpI,KAAKmB,MAAdiH,MACP,OAAO,kBAAC,EAAD,CAAWA,MAAOA,Q,GAtCOe,IAAMpE,WCwC3BqE,EA1CE,SAACnE,GAChB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAMiB,MAAI,GACR,kBAAC,IAAD,CACEV,MAAO3F,EAAKgD,MACZnF,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAMI,KAAKxC,MACzB6C,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAExG,MAAOyB,EAAEE,OAAO1B,WAGzC,kBAAC,IAAD,CACE0C,MAAO3F,EAAK2F,MACZ9H,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAMI,KAAKG,MACzBE,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAE7D,MAAOlB,EAAEE,OAAO1B,WAGzC,kBAAC,IAAD,CACE0C,MAAM,SACN9H,KAAK,OACL4L,WAAY,CAACC,UAAW,OACxB3C,aAAcW,KAAKC,UAAUvC,EAAMI,KAAKC,aACxCG,YAAY,OACZC,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEG,WAAYlF,EAAEE,OAAO1B,YAMhD,kBAAC,IAAD,KACE,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAQI,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,WCvB7CyD,E,YACnB,aAAe,IAAD,8BACZ,+CACKzD,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBAEzB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnC+D,KAAM,GACNmE,WAAY,KACZ3G,MAAO,KACP2C,MAAO,MAXG,E,kFAiBZ3D,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAK/CmD,EAAsB,QADX,CAACa,MAAO7C,KAAKmB,MAAM0B,MAAO2C,MAAOxF,KAAKmB,MAAMqE,MAAQF,YAAatF,KAAKmB,MAAMqI,YAClDxJ,KAAKmB,MAAMvE,S,wCAIhC8M,GAChB1J,KAAKyB,SAASiI,K,oCAKd1J,KAAK2J,UAAUC,SAAS,a,+BAKhB,IACDvE,EAAQrF,KAAKmB,MAAbkE,KACP,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQxC,MAAOhD,EAAKgK,UAAWxB,SAAUxI,EAAKkG,OAC9C,kBAAC,IAAD,KAAalG,EAAKgK,WAClB,kBAAC,EAAD,CAAUxE,KAAMA,EAAMW,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,yB,GAhD7C1C,aCCnBgF,E,YACnB,aAAe,IAAD,8BACZ,+CACK/D,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBAGzB,EAAKI,MAAQ,CACXkE,KAAO,GACPxC,MAAO,KACP2G,WAAY,KACZtL,GAAI,KACJsH,MAAO,MAbG,E,kFAkBZ3D,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAO/CmD,EAAyB,QADd,CAAC9D,GAAG8B,KAAKmB,MAAMjD,GAAI2E,MAAO7C,KAAKmB,MAAM0B,MAAO2C,MAAOxF,KAAKmB,MAAMqE,MAAOF,YAAatF,KAAKmB,MAAMqI,e,0CAIxGxJ,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QAChElI,KAAK4H,SAASjL,OAAd,QACFqF,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,U,oCAMjC,IAAI0I,EAAOxD,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACvBpE,QAAQC,IAAIqH,GACRA,GAAkB,SAAVtF,GACVC,KAAKyB,SAAS,CACZoB,MAAOwC,EAAKxC,MACZ3E,GAAImH,EAAKnH,GACTmH,KAAMA,EACNmE,WAAYnE,EAAKmE,WACjBhE,MAAOH,EAAKG,U,wCAKAkE,GAChB3L,QAAQC,IAAI0L,GACZ1J,KAAKyB,SAASiI,K,oCAMd1J,KAAK2J,UAAUC,SAAS,a,+BAIhB,IACGvE,EAAQrF,KAAKmB,MAAbkE,KACX,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQxC,MAAOhD,EAAKgK,UAAWxB,SAAUxI,EAAKkG,OAC9C,kBAAC,IAAD,KAAalG,EAAKgK,WAClB,kBAAC,EAAD,CAAUxE,KAAMA,EAAMW,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,yB,GAhFzC1C,a,2BCO7BiF,GAxBS,SAAC/E,GACvB,OAAIA,EAAMxI,MAEN,kBAAC,IAAMgH,SAAP,KAEA,kBAAC,IAAD,CAASvF,GAAI,sBAAsB+G,EAAMxI,MAAMyB,IAC7C,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAe2B,EAAKoK,aACpB,kBAAC,IAAD,CAAevF,QAAS,kBAAMO,EAAMiF,YAAY,WAAYjF,EAAMxI,MAAMyB,GAAI+G,EAAMlF,MAAOkF,EAAMkF,WAAYlF,EAAMmF,YAAW,uBAAGlH,UAAU,2BAA8BrD,EAAKwK,SAA5K,KAAwLpF,EAAMxI,MAAMsH,UAApM,KACA,kBAAC,IAAD,CAAeW,QAAS,kBAAMO,EAAMiF,YAAY,OAAQjF,EAAMxI,MAAMyB,GAAI+G,EAAMlF,MAAOkF,EAAMkF,WAAYlF,EAAMmF,YAAW,uBAAGlH,UAAU,wBAA2BrD,EAAKyK,KAArK,KAA6KrF,EAAMxI,MAAM8N,MAAzL,KACA,kBAAC,IAAD,CAAe7F,QAAS,kBAAMO,EAAMiF,YAAY,SAAUjF,EAAMxI,MAAMyB,GAAI+G,EAAMlF,MAAOkF,EAAMkF,WAAYlF,EAAMmF,YAAW,uBAAGlH,UAAU,uBAA0BrD,EAAK2K,OAAtK,KAAgLvF,EAAMxI,MAAMgO,QAA5L,MAEF,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAe1D,MAAM,OAAOlH,EAAK6K,UAIrC,kBAAC,IAAD,CAAQC,QAAS9K,EAAKoK,YAAa/G,UAAU,MAAO+E,MAAM,EAAO2C,YAAa,uBAAuB3F,EAAMxI,MAAMyB,IAAI,uBAAGgF,UAAU,qBAI7H,MC8BI2H,GAnDG,SAAC5F,GACjB,GAAIA,EAAMxI,MAAO,CACf,GAAIwI,EAAMpB,SAER,IADA,IAAIR,EAAU,GACLpD,EAAI,EAAGA,EAAIgF,EAAMpB,SAAS1D,OAAQF,IACzCoD,EAAQjD,KACN,4BAAQ0C,MAAOmC,EAAMpB,SAAS5D,GAAG/B,IAC9B+G,EAAMpB,SAAS5D,GAAG4C,QAK3B,OACE,kBAAC,IAAMY,SAAP,KACE,kBAAC,IAAD,CAAOP,UAAU,aAAa4H,OAAQ7F,EAAM8F,YAAaC,cAAe,WAAQ/F,EAAMoE,aAAa,CAAE0B,aAAa,MAChH,kBAAC,IAAD,KACE,yBAAK7H,UAAU,SACf,yBAAKA,UAAU,SACb,kBAAC,IAAD,CAAM+H,YAAU,GAAEpL,EAAKqL,SAI3B,kBAAC,IAAD,KAEE,kBAAC,IAAD,KACE,kBAAC,IAAD,CACE1F,MAAO3F,EAAKsL,QACZzN,KAAK,SACL2G,SAAU,SAACC,GACTW,EAAMoE,aAAa,CAAE+B,gBAAiB9G,EAAEE,OAAO1B,UAIhDO,IAGL,kBAAC,IAAD,CAAOgI,QAAM,GACX,kBAAC,IAAD,CAAKC,IAAI,KACP,kBAAC,IAAD,CAAQpI,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,YAMlE,kBAAC,IAAD,CAAQ9C,UAAU,MAAM+E,MAAM,EAAOsD,UAAU,eAAc,uBAAGC,MAAM,uBAI1E,OAAQ,MCbGC,GAlCK,SAACxG,GASnB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAapF,EAAK6L,aAAlB,IAVJ,WACE,GAAGzG,EAAM0G,QAAQ,CACf,IAAIzG,EAAU,GAEd,OADAD,EAAM2G,SAAS5O,KAAI,SAAC6O,GAAYA,EAAG3N,KAAO+G,EAAM0G,UAASzG,EAAU2G,EAAG3G,YAC/D,kBAAC,IAAD,CAAMyD,KAAM9I,EAAKiM,YAAc,KAAM5G,EAAQ6G,UAAU,EAAE,IAAKC,YAAU,EAACtH,QAAUO,EAAMgH,eAM/DN,IAClC,kBAAC,IAAD,KACG,kBAAC,IAAD,CACEnG,MAAO3F,EAAKqM,QACZC,QAAS,WAAWlH,EAAMmH,IAC1B1O,KAAK,WACL+H,YAAY,MACZ4G,UAAU,MACVC,WAAS,EACTC,aAAa,EACb7G,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEmD,eAAgBlI,EAAEE,OAAO1B,YAIpD,kBAAC,IAAD,KACE,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAMI,UAAU,eAChB,kBAAC,IAAD,CAAQA,UAAU,UAAU+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,W,oBCgDvDyG,I,YA5EK,SAACxH,GACjB,IAAIM,EAAQ,GACZ,SAASmH,EAASR,GACd,IAAIvJ,EAAS,GAab,OAZIuJ,EAAQrF,UACRlE,EAAOvC,KACH,kBAAC,IAAD,CAAMsE,QAAS,kBAAMO,EAAM0H,qBAAqBT,EAAQhO,MACpD,uBAAGgF,UAAU,0BAIzBP,EAAOvC,KACH,kBAAC,IAAD,CAAMsE,QAAS,kBAAMO,EAAM2H,eAAeV,EAAQhO,MAC9C,uBAAGgF,UAAU,0BAGbP,EAGZ,SAASE,EAAMqJ,GACX,IAAIvJ,EAAS,CAAC,8BAAOuJ,EAAQ9I,QAAQyJ,SAAvB,OAId,OAHGX,EAAQY,UACPnK,EAAOvC,KAAK,0BAAM8C,UAAU,sBAAsBrD,EAAKiM,YAA3C,IAAyDI,EAAQY,WAE1EnK,EAEX,GAAIsC,EAAM2G,SAAU,CAEhB,IAAK,IAAI3L,EAAI,EAAGA,EAAIgF,EAAM2G,SAASzL,OAAQF,IAAK,CAC5C,IAAI8M,EAAO,IAAIC,KAAK,IAAI5L,OAAO6L,MAAMhI,EAAM2G,SAAS3L,GAAGiN,aACnDC,EACA,kBAAC,IAAM1J,SAAP,KACKiJ,EAASzH,EAAM2G,SAAS3L,IACzB,kBAAC,KAAD,CAAQmN,OAAO,KAAKC,SAAO,EAACC,KAAG,GAAEP,GAChClN,EAAKyN,KAEd/H,EAAMnF,KACF,kBAAC,IAAD,CACInD,IAAK,UAAYgI,EAAM2G,SAAS3L,GAAG/B,GACnCgF,UAAU,QACVhF,GAAI,MAAM+G,EAAM2G,SAAS3L,GAAG/B,GAC5ByK,KAAMwE,EACNtK,MAAOA,EAAMoC,EAAM2G,SAAS3L,IAC5ByI,SAAUzD,EAAM2G,SAAS3L,GAAGiF,SAE5B,yBAAKiD,KAAK,QAAQoF,IAAKtI,EAAM2G,SAAS3L,GAAGmD,QAAQoK,OAAQC,MAAM,KAAKC,OAAO,SAQvF,OACI,kBAAC,IAAMjK,SAAP,KACI,kBAAC,IAAD,KAAa5D,EAAK+L,UAClB,kBAAC,IAAD,CAAMpD,WAAS,EAACmF,OAAK,GAChBpI,GAEL,kBAAC,IAAD,CAAKqI,OAAK,GACN,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAK1K,UAAU,UACX,uBAAGA,UAAU,aAAawB,QAAS,kBAAMO,EAAM4I,aAC1ChO,EAAKiO,OAGd,kBAAC,IAAD,OAEJ,kBAAC,IAAD,OAKR,OAAQ,kBAAC,IAAD,Q,oBCiDDC,GArHE,SAAC9I,GAChB,GAAIA,EAAMnG,MAAQmG,EAAMnG,KAAKkP,MAAO,CAAC,IAAD,EAwCzBC,EAAT,SAAehO,GACb,OAAIgF,EAAMnG,KAAKoP,QAAUjO,EACf,uBAAGuL,MAAM,aAAa2C,cAAY,SAElC,uBAAG3C,MAAM,eAAe2C,cAAY,UA3C1CC,EAAeC,0BAAepJ,EAAMnG,KAAKkP,OACzCM,EAAcC,eAAYC,kBAAkBJ,GAqBvCK,YAAYL,EADT,IAqDd,OACE,kBAAC,IAAM3K,SAAP,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKgK,MAAM,KAAKiB,YAAY,OAlBpC,WACE,GAAIzJ,EAAM0J,UACR,OACE,kBAAC,IAAD,CAAKlB,MAAM,KAAKiB,YAAY,KAAKxL,UAAU,QACzC,kBAAC,IAAD,CAAQ+C,MAAI,EAACc,MAAM,MAAMrC,QAAS,kBAAMO,EAAM2J,sBAAqB,uBAAGpD,MAAM,gBAAgB2C,cAAY,WAevGnC,GACD,kBAAC,IAAD,CAAKyB,MAAM,KAAKiB,YAAY,KAAKxL,UAAU,QACzC,kBAAC,IAAD,CAAQyH,QAAS9K,EAAKgP,MAAO5I,MAAI,GAAC,kBAAC,IAAD,GAAWxJ,MAAOwI,EAAMnG,KAAMkH,OAAQf,EAAMe,OAAQnC,SAAUoB,EAAMpB,SAAU9D,MAAM,OAAOgL,YAAa9F,EAAM8F,YAAa1B,aAAcpE,EAAMoE,cAA/I,sBAAmK,WAAnK,4BAA0LpE,EAAMiF,aAAhM,MAEpC,kBAAC,IAAD,CAAKuD,MAAM,KAAKiB,YAAY,MAC1B,kBAAC,IAAD,CAAS/D,QAAS9K,EAAKoK,YAAahE,MAAI,GAAC,kBAAC,GAAD,CAAiBxJ,MAAOwI,EAAMnG,KAAMiB,MAAM,OAAOmK,YAAajF,EAAMiF,kBAInH,kBAAC,IAAD,KAAarK,EAAKgD,OAClB,kBAAC,IAAD,CAAMyE,eAAA,GACJ,kBAAC,IAAD,KAAWrC,EAAMnG,KAAK+D,QAExB,kBAAC,IAAD,CAAOwI,QAAM,GApEjB,WACE,GAAIpG,EAAMnG,KAAKoG,QAAQ/E,OAAS,EAC9B,OACE,kBAAC,IAAMsD,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAKqF,SAClB,kBAAC,UAAD,CAAQoJ,YAAaA,EACnBQ,QAAS,CAAEzL,QAAS,IACpB0L,UAAU,KA+DjB7J,IA7CC,kBAAC,IAAD,CAAOmG,QAAM,GACX,uBAAG3G,QAAS,kBAAMO,EAAMiJ,OAAO,KAAKD,EAAM,IAC1C,uBAAGvJ,QAAS,kBAAMO,EAAMiJ,OAAO,KAAKD,EAAM,IAC1C,uBAAGvJ,QAAS,kBAAMO,EAAMiJ,OAAO,KAAKD,EAAM,IAC1C,uBAAGvJ,QAAS,kBAAMO,EAAMiJ,OAAO,KAAKD,EAAM,IAC1C,uBAAGvJ,QAAS,kBAAMO,EAAMiJ,OAAO,KAAKD,EAAM,IAC1C,0BAAM/K,UAAU,cAAhB,IAA+B+B,EAAMnG,KAAKmP,MAA1C,MA4CF,kBAAC,GAAD,CACExR,MAAOwI,EAAMnG,KAAMkH,OAAQf,EAAM+J,cACjC3F,aAAcpE,EAAMoE,aAAcsC,QAAS1G,EAAM0G,QACjDC,SAAU3G,EAAM2G,SAAUK,YAAahH,EAAMgH,YAC7CG,IAAKnH,EAAMmH,MAEb,kBAAC,GAAD,CACER,SAAU3G,EAAM2G,SAAUe,qBAAsB1H,EAAM0H,qBACtDC,eAAgB3H,EAAM2H,kBAK5B,OAAQ,M,SClGNqC,GAAoB7N,OAAO6N,kBACjCC,GAAMC,SAAW,GAEjBD,GAAME,mBAAqB,WAC1B,GAAGC,UAAUC,cAAgBD,UAAUC,aAAaC,gBAEnD,OAAO,EAER,GAAGnO,OAAOiO,UAAUG,UAAUC,MAAM,UAAW,CAC9C,IAAIC,EAAYC,SAASvO,OAAOiO,UAAUG,UAAUC,MAAM,iBAAiB,GAAI,IAC3EG,EAAS,GAGb,OAFGxO,OAAOiO,UAAUG,UAAUC,MAAM,WACnCG,EAAS,IACPF,GAAa,IAAMA,GAAaE,GAI5BV,GAAMW,UAAUC,cAGvB,OAAO,GAIT,IAAIC,GAAmB,CAEtBC,YAAa,mCACbF,YAAa,WAAa,OAAgE,OAAzDG,SAASC,cAAc,+BACxDC,UAAW,SAAUC,GACpB,IAAIC,EAAUjP,OAAOkP,YAAW,WAC/B,IAAIxS,EAAQ,IAAIyS,MAAM,2BAEtB,OADAzS,EAAMsG,KAAO,2IACNgM,EAAStS,KACd,KACHkC,KAAKwQ,MAAMH,GAAWD,EACtBhP,OAAOqP,YAAY,CAAE/S,KAAM,iBAAkBQ,GAAImS,GAAW,MAE7DK,KAAM,WACL,IAAIF,EAAQ,GACZxQ,KAAKwQ,MAAQA,EAEbpP,OAAOuP,iBAAiB,WAAW,SAAUC,GAC5C,GAAGA,EAAMC,QAAUzP,OAAOO,SAASkP,OAEnC,GAAsB,kBAAnBD,EAAMhT,KAAKF,MAA4B8S,EAAMI,EAAMhT,KAAKM,IAAK,CAC/D,IAAIkS,EAAWI,EAAMI,EAAMhT,KAAKM,IAGhC,UAFOsS,EAAMI,EAAMhT,KAAKM,IAEI,KAAxB0S,EAAMhT,KAAKwM,SAAiB,CAE/B,IAAItM,EAAQ,IAAIyS,MAAM,2BACtBzS,EAAMsG,KAAO,yDACbgM,EAAStS,QAETsS,EAAS,KAAMQ,EAAMhT,KAAKwM,cAEE,yBAAnBwG,EAAMhT,KAAKF,OACrBK,QAAQC,IAAI,YAAa4S,EAAMhT,KAAKM,IACpCkD,OAAO0P,aAAaF,EAAMhT,KAAKM,UAqVnC,SAASgR,GAAM6B,GAKd,IAJAA,EAAmBA,GAAoB,IACtBC,QAA8C,mBAA5BD,EAAiBC,QAAyBD,EAAiBC,QAAU9B,GAAM+B,KAC9GF,EAAiBjT,MAA0C,mBAA1BiT,EAAiBjT,MAAuBiT,EAAiBjT,MAAQoR,GAAM+B,KACxGF,EAAiBG,UAAkD,mBAA9BH,EAAiBG,UAA2BH,EAAiBG,UAAYhC,GAAM+B,MAChH/B,GAAMiC,SAET,OADAJ,EAAiBjT,MAAM,2BAChB,GAER,IAAIoR,GAAMkC,oBAET,OADAL,EAAiBjT,MAAM,wCAChB,GAGR,GADAoR,GAAMlR,IAAI,wBAA0BkR,GAAMiC,WACtCJ,EAAiBxU,OAEpB,OADAwU,EAAiBjT,MAAM,sBAChB,GAER,IAAIuT,GAAa,EACbC,EAAK,KACLC,EAAa,GACbC,EAAuB,KACvBC,EAAU,KACVC,EAAe,EACfnV,EAASwU,EAAiBxU,OAC3B2S,GAAMyC,QAAQpV,IAChB2S,GAAMlR,IAAI,8BAAgCzB,EAAO4D,OAAS,oCAC1D5D,EAAS,KACTkV,EAAUV,EAAiBxU,OAC3B2S,GAAM0C,MAAMH,IAEgB,IAAzBlV,EAAOsV,QAAQ,OACjBR,GAAa,EACbnC,GAAMlR,IAAI,sCAAwCzB,KAElD8U,GAAa,EACbnC,GAAMlR,IAAI,oCAAsCzB,IAGlD,IAAIuV,EAAaf,EAAiBe,YAAc,CAAC,CAACC,KAAM,iCACpDC,EAAqBjB,EAAiBiB,mBACtCC,EAAelB,EAAiBkB,aAEhCC,GAAyC,IAA1BnB,EAAiBoB,KAEhCC,GAAkB,OACkBC,IAArCtB,EAAiBqB,iBAAsE,OAArCrB,EAAiBqB,kBACrEA,GAAuD,IAArCrB,EAAiBqB,iBAEpC,IAAIE,EAAQ,QAC4BD,IAArCtB,EAAiBwB,iBAAsE,OAArCxB,EAAiBwB,kBACrED,EAAQvB,EAAiBwB,iBACvBD,EAAQ,IACVA,EAAQ,GAET,IAAI1V,EAAQ,UACkByV,IAA3BtB,EAAiBnU,OAAkD,OAA3BmU,EAAiBnU,QAC3DA,EAAQmU,EAAiBnU,OAE1B,IAAI4V,EAAY,UACkBH,IAA/BtB,EAAiByB,WAA0D,OAA/BzB,EAAiByB,YAC/DA,EAAYzB,EAAiByB,WAE9BxS,KAAKyS,iBAAkB,OACiBJ,IAArCtB,EAAiB0B,iBAAsE,OAArC1B,EAAiB0B,kBACrEzS,KAAKyS,iBAAwD,IAArC1B,EAAiB0B,iBAE1C,IAAIC,EAAkB,UACkBL,IAArCtB,EAAiB2B,iBAAsE,OAArC3B,EAAiB2B,kBACrEA,EAAkB3B,EAAiB2B,iBACjCC,MAAMD,KACRA,EAAkB,MACnB,IAAIE,EAAkB,IAOtB,SAASC,EAAeC,GACvB,IAAIC,EAAc,CACjBC,KAAM,IACNC,OAAQ,IACRC,IAAK,KAYN,YAT6Bb,IAAzBS,GAA+D,OAAzBA,IACrCA,EAAqBE,OACxBD,EAAYC,KAAOF,EAAqBE,MACrCF,EAAqBG,SACxBF,EAAYE,OAASH,EAAqBG,QACvCH,EAAqBI,MACxBH,EAAYG,IAAMJ,EAAqBI,MAGlCH,OAtBgCV,IAArCtB,EAAiB6B,iBAAsE,OAArC7B,EAAiB6B,kBACrEA,EAAkB7B,EAAiB6B,iBACjCD,MAAMC,KACRA,EAAkB,KAsBnB,IAAIO,GAAY,EACZC,EAAY,KACZC,EAAgB,GAChBC,EAAOtT,KACPuT,EAAU,EACVC,EAAe,GAiBnB,SAASC,IACR,GAAgB,MAAbL,EAGH,GADAlE,GAAM0C,MAAM,gBACRuB,EAAJ,CAIA,IAAIO,EAAWnX,EAAS,IAAM6W,EAAY,SAAU,IAAIpG,MAAO2G,UAC5DrB,IACFoB,EAAWA,EAAW,UAAYpB,GAChC1V,IACF8W,EAAWA,EAAW,UAAYE,mBAAmBhX,IACnD4V,IACFkB,EAAWA,EAAW,cAAgBE,mBAAmBpB,IAC1DtD,GAAM2E,YAAYH,EAAU,CAC3BI,KAAM,MACN1B,gBAAiBA,EACjBpB,QAAS+C,EACTC,QAASpB,EACT9U,MAAO,SAASmW,EAAYC,GAG3B,GAFAhF,GAAMpR,MAAMmW,EAAa,IAAKC,KAC9BX,EACa,EAIZ,OAFAJ,GAAY,OACZpC,EAAiBjT,MAAM,+CAGxB2V,YAxBDvE,GAAMiF,KAAK,yCA8Bb,SAASJ,EAAYK,EAAMC,GAI1B,GAHAd,EAAU,EACNlC,QAA4BgB,IAAde,GAAyC,OAAdA,IAAsC,IAAhBiB,GAClEZ,IACGpC,IAAcnC,GAAMyC,QAAQyC,GAOhC,GAAqB,cAAlBA,EAAI,MAIA,GAAqB,QAAlBA,EAAI,MAYP,GAAqB,YAAlBA,EAAI,MAYP,GAAqB,YAAlBA,EAAI,MAAyB,CAGtC,KADIE,EAASF,EAAI,QAGhB,YADAlF,GAAMiF,KAAK,qBAIZ,KADII,EAAelB,EAAciB,IAGhC,YADApF,GAAM0C,MAAM,+CAGb,IAAI4C,EAAYJ,EAAI,UACpBlF,GAAM0C,MAAM,uCAAyCwB,GACrDlE,GAAM0C,MAAM4C,GACZ,IAAIhW,EAAS+V,EAAaE,YACvBjW,EAAOkW,IAAMlW,EAAOmW,WAEtBzF,GAAM0C,MAAM,2BAA4B4C,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BpW,EAAOkW,GAAGG,gBAAgBL,GAH1BhW,EAAOkW,GAAGG,gBAAgB3F,GAAM4F,mBAOjC5F,GAAM0C,MAAM,6FACRpT,EAAOuW,aACVvW,EAAOuW,WAAa,IACrBvW,EAAOuW,WAAW3U,KAAKoU,GACvBtF,GAAM0C,MAAMpT,EAAOuW,iBAEd,IAAqB,aAAlBX,EAAI,MAKb,OAHAlF,GAAM0C,MAAM,mCAAqCwB,GACjDlE,GAAM0C,MAAMwC,IACRE,EAASF,EAAI,SAKbG,EAAelB,EAAciB,SAKjCC,EAAaS,aAAY,QAHxB9F,GAAM0C,MAAM,oDALZ1C,GAAMiF,KAAK,qBAUN,GAAqB,WAAlBC,EAAI,MAAwB,CAKrC,GAHAlF,GAAM0C,MAAM,iCAAmCwB,GAC/ClE,GAAM0C,MAAMwC,KACRE,EAASF,EAAI,QAGhB,YADAlF,GAAMiF,KAAK,qBAIZ,KADII,EAAelB,EAAciB,IAGhC,YADApF,GAAM0C,MAAM,+CAGb2C,EAAaS,aAAY,EAAOZ,EAAI,QACpCG,EAAaU,cACP,GAAqB,aAAlBb,EAAI,MAA0B,CAKvC,GAHAlF,GAAM0C,MAAM,mCAAqCwB,GACjDlE,GAAM0C,MAAMwC,KACRE,EAASF,EAAI,QAGhB,YADAlF,GAAMiF,KAAK,qBAIZ,KADII,EAAelB,EAAciB,IAGhC,OAEDC,EAAaW,UAAW,EACxBX,EAAaY,aACbZ,EAAaa,cACP,GAAqB,UAAlBhB,EAAI,MAAuB,CAKpC,GAHAlF,GAAM0C,MAAM,gCAAkCwB,GAC9ClE,GAAM0C,MAAMwC,KACRE,EAASF,EAAI,QAGhB,YADAlF,GAAMiF,KAAK,qBAIZ,KADII,EAAelB,EAAciB,IAGhC,YADApF,GAAM0C,MAAM,+CAGb2C,EAAac,WAAWjB,EAAI,KAAUA,EAAI,gBACpC,GAAqB,aAAlBA,EAAI,MAA0B,CAKvC,GAJAlF,GAAM0C,MAAM,mCAAqCwB,GACjDlE,GAAM0C,MAAMwC,KAERE,EAASF,EAAI,QAGhB,YADAlF,GAAMiF,KAAK,qBAIZ,KADII,EAAelB,EAAciB,IAGhC,YADApF,GAAM0C,MAAM,+CAGb2C,EAAae,SAASlB,EAAI,OAAYA,EAAI,UACpC,IAAqB,UAAlBA,EAAI,MAAuB,CAIpC,IAAImB,EAECC,EADL,GAHAtG,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,QACjExG,GAAM0C,MAAMwC,GACRmB,EAAcnB,EAAI,aAEjBoB,EAAgBhC,EAAa+B,KAEhCC,EAAcpB,UAERZ,EAAa+B,GAErB,OACM,GAAqB,UAAlBnB,EAAI,MAAuB,CAGpC,IAAIE,EACJ,GAHApF,GAAM0C,MAAM,iCAAmCwB,GAC/ClE,GAAM0C,MAAMwC,KACRE,EAASF,EAAI,QAGhB,YADAlF,GAAMiF,KAAK,qBAGZ,IAAIwB,EAAavB,EAAI,WACrB,IAAIuB,EAEH,YADAzG,GAAMiF,KAAK,yBAGZjF,GAAM0C,MAAM,6BAA+B0C,EAAS,KAAOqB,EAAU,OAAa,KAClF,IAEIpB,EAFA3W,EAAO+X,EAAU,KAGrB,GAFAzG,GAAM0C,MAAMhU,KACR2W,EAAelB,EAAciB,IAGhC,YADApF,GAAMiF,KAAK,+CAGZ,IAAIyB,EAAOxB,EAAI,KACZwB,IACF1G,GAAM0C,MAAM,2BACZ1C,GAAM0C,MAAMgE,IAEb,IAAIxF,EAAWmE,EAAasB,UACzBzF,GACFlB,GAAM0C,MAAM,4BAEZxB,EAASxS,EAAMgY,IAGf1G,GAAM0C,MAAM,yCAEP,IAAqB,YAAlBwC,EAAI,MAMb,OALAlF,GAAMpR,MAAM,sBAAwBsV,GACpClE,GAAM0C,MAAMwC,QACR/C,GACHC,EAAGpG,MAAM,KAAM,oBAIhBgE,GAAMiF,KAAK,2BAA6BC,EAAI,MAAY,gBAAkBhB,GAC1ElE,GAAM0C,MAAMwC,UApLZlF,GAAM0C,MAAM,4BAA8BwB,GAC1ClE,GAAM0C,MAAMwC,IACRmB,EAAcnB,EAAI,gBAEjBoB,EAAgBhC,EAAa+B,KAEhCC,EAAcpB,UACRZ,EAAa+B,SAnBrBrG,GAAM0C,MAAM,yBAA2BwB,GACvClE,GAAM0C,MAAMwC,IACRmB,EAAcnB,EAAI,gBAEjBoB,EAAgBhC,EAAa+B,KAEhCC,EAAcpB,UACRZ,EAAa+B,SAXrBrG,GAAM4G,OAAO,8BAAgC1C,QAP7C,IAAI,IAAInT,EAAE,EAAGA,EAAEmU,EAAKjU,OAAQF,IAC3B8T,EAAYK,EAAKnU,IAAI,GA+MxB,SAAS8V,IACR,GAAIxZ,GAAW8U,GAAe8B,EAA9B,CAEA3B,EAAuBlB,WAAWyF,EAAWrD,GAC7C,IAAIsD,EAAU,CAAE,MAAS,YAAa,WAAc5C,EAAW,YAAelE,GAAM+G,aAAa,KAC9FrZ,IACFoZ,EAAO,MAAYpZ,GACjB4V,IACFwD,EAAO,UAAgBxD,GACxBlB,EAAG4E,KAAK3O,KAAKC,UAAUwO,KAIxB,SAASG,EAAcC,GACtB,IAAIb,EAAcrG,GAAM+G,aAAa,IACjCD,EAAU,CAAE,MAAS,SAAU,YAAeT,GAgClD,GA/BGa,EAAS,YAEXjD,GAAY,EACZ6C,EAAO,MAAY,QACnBA,EAAO,WAAiB5C,EAErB9B,IACFA,EAAG+E,OAAS,KACZ/E,EAAGgF,QAAU,KACbhF,EAAGiF,QAAU,KACV/E,IACFV,aAAaU,GACbA,EAAuB,QAIvB5U,IACFoZ,EAAO,MAAYpZ,GACjB4V,IACFwD,EAAO,UAAgBxD,IACpBjW,GAAU2S,GAAMyC,QAAQF,KAGC,KAD5BlV,EAASkV,EAAQC,IACPG,QAAQ,OACjBR,GAAa,EACbnC,GAAMlR,IAAI,YAAc0T,EAAa,GAAK,yCAA2CnV,EAAS,OAE9F8U,GAAa,EACbnC,GAAMlR,IAAI,YAAc0T,EAAa,GAAK,uCAAyCnV,EAAS,OAG3F8U,EA2DF,IAAI,IAAImF,KA1DRlF,EAAKpC,GAAMuH,aAAala,EAAQ,kBAChCgV,EAAa,CACZ,MAAS,WAER,GADArC,GAAMpR,MAAM,sDAAwDvB,GAChE2S,GAAMyC,QAAQF,KAAa2E,EAAS,UAEvC,QADA1E,IACqBD,EAAQtR,YAE5BiW,EAAUtY,MAAM,+EAIjBvB,EAAS,UACT+T,YAAW,WACV6F,EAAcC,KACZ,MAGJA,EAAUtY,MAAM,yEAGjB,KAAQ,WAEP0V,EAAa+B,GAAe,SAASnB,GAEpC,GADAlF,GAAM0C,MAAMwC,GACU,YAAlBA,EAAI,MAGP,OAFAlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,aACjEU,EAAUtY,MAAMsW,EAAI,MAAUsB,QAG/BlE,EAAuBlB,WAAWyF,EAAWrD,GAC7CS,GAAY,EACZC,EAAYgB,EAAI,WAAiBA,EAAI,WAAiBA,EAAKxW,KAAL,GACnDwY,EAAS,UACXlH,GAAMlR,IAAI,oBAAsBoV,GAEhClE,GAAMlR,IAAI,oBAAsBoV,GAEjClE,GAAMC,SAASiE,GAAaE,EAC5B8C,EAAUpF,WAEXM,EAAG4E,KAAK3O,KAAKC,UAAUwO,KAGxB,QAAW,SAASpF,GACnBmD,EAAYxM,KAAKmP,MAAM9F,EAAMhT,QAG9B,MAAS,WACHrB,GAAW4W,IAGhBA,GAAY,EAEZpC,EAAiBjT,MAAM,kDAKxBwT,EAAGX,iBAAiB6F,EAAWjF,EAAWiF,SAK5CtH,GAAM2E,YAAYtX,EAAQ,CACzBuX,KAAM,OACN1B,gBAAiBA,EACjB/L,KAAM2P,EACNhF,QAAS,SAASoD,GAEjB,GADAlF,GAAM0C,MAAMwC,GACS,YAAlBA,EAAI,MAGN,OAFAlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,aACjEU,EAAUtY,MAAMsW,EAAI,MAAUsB,QAG/BvC,GAAY,EACZC,EAAYgB,EAAI,WAAiBA,EAAI,WAAiBA,EAAKxW,KAAL,GACnDwY,EAAS,UACXlH,GAAMlR,IAAI,oBAAsBoV,GAEhClE,GAAMlR,IAAI,oBAAsBoV,GAEjClE,GAAMC,SAASiE,GAAaE,EAC5BG,IACA2C,EAAUpF,WAEXlT,MAAO,SAASmW,EAAYC,GAE3B,GADAhF,GAAMpR,MAAMmW,EAAa,IAAKC,GAC3BhF,GAAMyC,QAAQF,KAAa2E,EAAS,UAEtC,QADA1E,IACoBD,EAAQtR,YAE3BiW,EAAUtY,MAAM,+EAIjBvB,EAAS,UACT+T,YAAW,WAAa6F,EAAcC,KAAe,MAGnC,KAAhBlC,EACFkC,EAAUtY,MAAMmW,EAAa,yBAE7BmC,EAAUtY,MAAMmW,EAAa,KAAOC,MA6UxC,SAASyC,EAAYC,EAAUR,GAI9B,IAHAA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,MAC/EkC,EAGH,OAFAjE,GAAMiF,KAAK,8CACXiC,EAAUtY,MAAM,yCAGjB,IAAIyW,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IAAI+Y,EAAUT,EAAUS,QACpBjB,EAAOQ,EAAUR,KACjBL,EAAcrG,GAAM+G,aAAa,IACjCD,EAAU,CAAE,MAAS,UAAW,KAAQa,EAAS,YAAetB,GAepE,GAdGhB,EAAa3X,QACfoZ,EAAO,MAAYzB,EAAa3X,OAC9B4V,IACFwD,EAAO,UAAgBxD,GACrBoD,IACFI,EAAQJ,KAAO,CACdlY,KAAMkY,EAAKlY,KACXoZ,IAAKlB,EAAKkB,KAERlB,EAAKmB,OACPf,EAAQJ,KAAKmB,MAAO,IAEtB7H,GAAM0C,MAAM,qCAAuCgF,EAAW,MAC9D1H,GAAM0C,MAAMoE,GACT3E,EAkCF,OAjCA2E,EAAO,WAAiB5C,EACxB4C,EAAO,UAAgBY,EACvBpD,EAAa+B,GAAe,SAASnB,GAGpC,GAFAlF,GAAM0C,MAAM,iBACZ1C,GAAM0C,MAAMwC,GACS,YAAlBA,EAAI,MAAyB,CAE/B,IAAIuB,EAAavB,EAAI,WACrB,IAAIuB,EAGH,OAFAzG,GAAMiF,KAAK,qDACXiC,EAAUpF,UAGX9B,GAAMlR,IAAI,uCAAyC2X,EAAU,OAAa,KAC1E,IAAI/X,EAAO+X,EAAU,KAGrB,OAFAzG,GAAM0C,MAAMhU,QACZwY,EAAUpF,QAAQpT,GAES,QAAlBwW,EAAI,MAYdgC,EAAUpF,UAVNoD,EAAI,OACNlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,QACjEU,EAAUtY,MAAMsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,UAEzDxG,GAAMpR,MAAM,iBACZsY,EAAUtY,MAAM,wBAOnBwT,EAAG4E,KAAK3O,KAAKC,UAAUwO,IAGxB9G,GAAM2E,YAAYtX,EAAS,IAAM6W,EAAY,IAAMwD,EAAU,CAC5D9C,KAAM,OACN1B,gBAAiBA,EACjB/L,KAAM2P,EACNhF,QAAS,SAASoD,GAGjB,GAFAlF,GAAM0C,MAAM,iBACZ1C,GAAM0C,MAAMwC,GACS,YAAlBA,EAAI,MAAyB,CAE/B,IAAIuB,EAAavB,EAAI,WACrB,IAAIuB,EAGH,OAFAzG,GAAMiF,KAAK,qDACXiC,EAAUpF,UAGX9B,GAAMlR,IAAI,uCAAyC2X,EAAU,OAAa,KAC1E,IAAI/X,EAAO+X,EAAU,KAGrB,OAFAzG,GAAM0C,MAAMhU,QACZwY,EAAUpF,QAAQpT,GAES,QAAlBwW,EAAI,MAYdgC,EAAUpF,UAVNoD,EAAI,OACNlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,QACjEU,EAAUtY,MAAMsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,UAEzDxG,GAAMpR,MAAM,iBACZsY,EAAUtY,MAAM,mBAOnBA,MAAO,SAASmW,EAAYC,GAC3BhF,GAAMpR,MAAMmW,EAAa,IAAKC,GAC9BkC,EAAUtY,MAAMmW,EAAa,KAAOC,MAMvC,SAAS8C,EAAqBJ,EAAUpC,GACvC,GAAIrB,EAAJ,CAIA,IAAIoB,EAAelB,EAAcuD,GACjC,GAAIrC,GAAiBA,EAAaE,YAAlC,CAIA,IAAIuB,EAAU,CAAE,MAAS,UAAW,UAAaxB,EAAW,YAAetF,GAAM+G,aAAa,KAO9F,GANG1B,EAAa3X,QACfoZ,EAAO,MAAYzB,EAAa3X,OAC9B4V,IACFwD,EAAO,UAAgBxD,GACxBtD,GAAM4G,OAAO,qCAAuCc,EAAW,MAC/D1H,GAAM4G,OAAOE,GACV3E,EAIF,OAHA2E,EAAO,WAAiB5C,EACxB4C,EAAO,UAAgBY,OACvBtF,EAAG4E,KAAK3O,KAAKC,UAAUwO,IAGxB9G,GAAM2E,YAAYtX,EAAS,IAAM6W,EAAY,IAAMwD,EAAU,CAC5D9C,KAAM,OACN1B,gBAAiBA,EACjB/L,KAAM2P,EACNhF,QAAS,SAASoD,GACjBlF,GAAM4G,OAAO,mBACb5G,GAAM4G,OAAO1B,GACQ,QAAlBA,EAAI,OACNlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,SAInE5X,MAAO,SAASmW,EAAYC,GAC3BhF,GAAMpR,MAAMmW,EAAa,IAAKC,WA7B/BhF,GAAMiF,KAAK,uBALXjF,GAAMiF,KAAK,yCAwCb,SAAS8C,EAAkBL,EAAUM,EAASC,EAAYC,EAAUC,GACnE,IAAI9C,EAAelB,EAAcuD,GACjC,GAAIrC,GAAiBA,EAAaE,YAAlC,CAIA,IAAIjW,EAAS+V,EAAaE,YAMtB6C,EAA2B,SAAS1G,GACvC1B,GAAMlR,IAAI,yCAA0C4S,GACpD,IAAIpL,EAAQoL,EAAMpM,OAAOgB,MACrB+R,EAAW3G,EAAMpM,OAAO+S,SACxBC,EAAUhZ,EAAOiZ,YAAYjS,GAAShH,EAAOiZ,YAAYjS,GAAOkS,WAAa,OAEjF,GADAxI,GAAMlR,IAAI,oBAAsBwH,EAAQ,mBAAqBgS,GAC9C,SAAZA,EAAoB,CAEtB,GAAGhZ,EAAOiZ,YAAYjS,GAAO6K,SAAW7R,EAAOiZ,YAAYjS,GAAO6K,QAAQlQ,OAAS,EAAG,CACrF+O,GAAMlR,IAAI,gCAAkCwH,EAAQ,KAAMhH,EAAOiZ,YAAYjS,GAAO6K,QAAQlQ,QADP,2BAErF,IAAI,IAAJ,EAAQ,EAAQ3B,EAAOiZ,YAAYjS,GAAO6K,QAA1C,+CAAmD,CAAC,IAA5CzS,EAA2C,QAClDsR,GAAMlR,IAAI,iCAAmCwH,EAAQ,KACrD0J,GAAM0C,MAAMhU,GACZY,EAAOiZ,YAAYjS,GAAO0Q,KAAKtY,IALqD,kFAOrFY,EAAOiZ,YAAYjS,GAAO6K,QAAU,GAGrCkE,EAAaoD,WAAWnS,EAAO+R,KAOjC,GAAIH,EAQH5Y,EAAOiZ,YAAYP,GAAWE,MARjB,CAEb,IAAIQ,EAAY,CAAEC,SAAS,GACxBV,IACFS,EAAUL,SAAWJ,GACtB3Y,EAAOiZ,YAAYP,GAAW1Y,EAAOkW,GAAGuC,kBAAkBC,EAASU,GAKpEpZ,EAAOiZ,YAAYP,GAASrB,UAxCD,SAASjF,GACnC1B,GAAMlR,IAAI,oCAAqC4S,GAC/C,IAAIpL,EAAQoL,EAAMpM,OAAOgB,MACzB+O,EAAauD,OAAOlH,EAAMhT,KAAM4H,IAsCjChH,EAAOiZ,YAAYP,GAASb,OAASiB,EACrC9Y,EAAOiZ,YAAYP,GAASX,QAAUe,EACtC9Y,EAAOiZ,YAAYP,GAASZ,QAjBH,SAASxY,GACjCoR,GAAMpR,MAAM,6BAA8BA,IAiB3CU,EAAOiZ,YAAYP,GAAS7G,QAAU,GACnCgH,GACF7Y,EAAOiZ,YAAYP,GAAS7G,QAAQjQ,KAAKiX,QAlDzCnI,GAAMiF,KAAK,kBAsDb,SAAS4D,EAASnB,EAAUR,IAC3BA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnF,IAAIsD,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IAAIU,EAAS+V,EAAaE,YACtB7W,EAAOwY,EAAUzN,MAAQyN,EAAUxY,KACvC,IAAIA,EAGH,OAFAsR,GAAMiF,KAAK,qBACXiC,EAAUtY,MAAM,gBAGjB,IAAI0H,EAAQ4Q,EAAU5Q,MAAQ4Q,EAAU5Q,MAAQ0J,GAAM8I,qBACtD,OAAIxZ,EAAOiZ,YAAYjS,GAMqB,SAAzChH,EAAOiZ,YAAYjS,GAAOkS,YAC5BlZ,EAAOiZ,YAAYjS,GAAO6K,QAAQjQ,KAAKxC,QACvCwY,EAAUpF,YAGX9B,GAAMlR,IAAI,iCAAmCwH,EAAQ,KACrD0J,GAAM0C,MAAMhU,GACZY,EAAOiZ,YAAYjS,GAAO0Q,KAAKtY,QAC/BwY,EAAUpF,YAZTiG,EAAkBL,EAAUpR,EAAO4Q,EAAUmB,UAAU,EAAO3Z,EAAMwY,EAAUmB,eAC9EnB,EAAUpF,WAeZ,SAASiH,EAASrB,EAAUR,IAC3BA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnF,IAAIsD,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IAAIU,EAAS+V,EAAaE,YAC1B,IAAIjW,EAAO0Z,WAAY,CAEtB,GAAG1Z,EAAOkW,GAAI,CACb,IACIyD,EADU3Z,EAAOkW,GAAG0D,aACEC,MAAK,SAAS/D,GACvC,OAAOA,EAAOgE,OAA+B,UAAtBhE,EAAOgE,MAAMC,QAErC,IAAIJ,EAGH,OAFAjJ,GAAMiF,KAAK,oDACXiC,EAAUtY,MAAM,+CAGjBU,EAAO0Z,WAAaC,EAAYK,KAC7Bha,EAAO0Z,aACThJ,GAAMlR,IAAI,uBACVQ,EAAO0Z,WAAWO,aAAe,SAASC,GAAQxJ,GAAM0C,MAAM,mBAAqB8G,EAAKA,QAG1F,IAAIla,EAAO0Z,WAGV,OAFAhJ,GAAMiF,KAAK,mCACXiC,EAAUtY,MAAM,8BAIlB,IAAI0a,EAAOpC,EAAUoC,KACrB,IAAIA,EAGH,OAFAtJ,GAAMiF,KAAK,gCACXiC,EAAUtY,MAAM,2BAGjB,IAAI6a,EAAQH,EAAKG,MACjB,IAAIA,EAGH,OAFAzJ,GAAMiF,KAAK,4BACXiC,EAAUtY,MAAM,uBAGjB,IAAI8a,EAAqC,kBAAlBJ,EAAKI,SAAyBJ,EAAKI,SAAW,IACjEC,EAA2B,kBAAbL,EAAKK,IAAoBL,EAAKK,IAAM,GACtD3J,GAAM0C,MAAM,uBAAyB+G,EAAQ,cAAgBC,EAAW,WAAaC,EAAM,OAC3Fra,EAAO0Z,WAAWY,WAAWH,EAAOC,EAAUC,GAC9CzC,EAAUpF,UAIX,SAAS+H,EAAcnC,EAAUR,IAChCA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnF,IAAI+H,GAAqC,IAAxB5C,EAAU4C,UAC3B9J,GAAMlR,IAAI,qBAAuB4Y,EAAW,kBAAoBoC,EAAY,KAC5EC,EAAcrC,GACd,IAAIrC,EAAelB,EAAcuD,GACjC,IAAIrC,GAAgBA,EAAaW,SAIhC,cAFO7B,EAAcuD,QACrBR,EAAUpF,UAGX,GAAGgI,EAIF,cAFO3F,EAAcuD,QACrBR,EAAUpF,UAGX,IAAImC,EAGH,OAFAjE,GAAMiF,KAAK,8CACXiC,EAAUtY,MAAM,yCAGjB,IAAIkY,EAAU,CAAE,MAAS,SAAU,YAAe9G,GAAM+G,aAAa,KAKrE,GAJG1B,EAAa3X,QACfoZ,EAAO,MAAYzB,EAAa3X,OAC9B4V,IACFwD,EAAO,UAAgBxD,GACrBnB,EAMF,OALA2E,EAAO,WAAiB5C,EACxB4C,EAAO,UAAgBY,EACvBtF,EAAG4E,KAAK3O,KAAKC,UAAUwO,WAChB3C,EAAcuD,QACrBR,EAAUpF,UAGX9B,GAAM2E,YAAYtX,EAAS,IAAM6W,EAAY,IAAMwD,EAAU,CAC5D9C,KAAM,OACN1B,gBAAiBA,EACjB/L,KAAM2P,EACNhF,QAAS,SAASoD,GACjBlF,GAAMlR,IAAI,qBACVkR,GAAM0C,MAAMwC,GACS,YAAlBA,EAAI,OACNlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,eAE3DrC,EAAcuD,GACrBR,EAAUpF,WAEXlT,MAAO,SAASmW,EAAYC,GAC3BhF,GAAMpR,MAAMmW,EAAa,IAAKC,UAEvBb,EAAcuD,GACrBR,EAAUpF,aAMb,SAASkI,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAWgD,GACtD,IAAI7E,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IAAIU,EAAS+V,EAAaE,YAC1BvF,GAAM0C,MAAM,eAAgBwH,GACzBA,IACFlK,GAAM0C,MAAM,qBAAsBwH,EAAOC,kBACzCnK,GAAM0C,MAAM,qBAAsBwH,EAAOE,mBAG1C,IAAIC,GAAY,EAChB,GAAI/a,EAAOgb,UAAaL,EAAMM,SAAUjb,EAAOkb,eAGxC,CAEN,KAAMP,EAAMM,QAAUE,EAAmBR,IAAYA,EAAMM,SAAWN,EAAMS,UAAYT,EAAMU,gBAC5FT,EAAOC,kBAAoBD,EAAOC,iBAAiBlZ,OAEpD,GADA3B,EAAOgb,SAASM,SAASV,EAAOC,iBAAiB,IAC9CnK,GAAM6K,YAAa,CAErB7K,GAAMlR,KAAKmb,EAAMU,aAAe,YAAc,UAAY,gBAAiBT,EAAOC,iBAAiB,IACnG,IAAIW,EAAmB,KAEvB,IADIC,EAAezb,EAAOkW,GAAGwF,oBACVD,EAAa9Z,OAAS,EAAG,CAAC,IAAD,uBAC3C,IAAI,IAAJ,EAAQ,EAAK8Z,EAAb,+CAA2B,CAC1B,IADOE,EAAmB,SACpB7F,QAAU6F,EAAE7F,OAAOgE,OAAiC,UAAxB6B,EAAE7F,OAAOgE,MAAMC,MAC9C4B,EAAEC,UAAYD,EAAEC,SAAS9B,OAAmC,UAA1B6B,EAAEC,SAAS9B,MAAMC,KAAmB,CACxEyB,EAAmBG,EACnB,QALyC,mFASzCH,GAAoBA,EAAiB1F,OACvC0F,EAAiB1F,OAAO+F,aAAajB,EAAOC,iBAAiB,IAE7D7a,EAAOkW,GAAGoF,SAASV,EAAOC,iBAAiB,GAAID,QAGhDlK,GAAMlR,KAAKmb,EAAMU,aAAe,YAAc,UAAY,gBAAiBT,EAAOC,iBAAiB,IACnG7a,EAAOkW,GAAGoF,SAASV,EAAOC,iBAAiB,GAAID,GAGjD,KAAMD,EAAMM,QAAUa,EAAmBnB,IAAYA,EAAMM,SAAWN,EAAMoB,UAAYpB,EAAMqB,gBAC5FpB,EAAOE,kBAAoBF,EAAOE,iBAAiBnZ,OAEpD,GADA3B,EAAOgb,SAASM,SAASV,EAAOE,iBAAiB,IAC9CpK,GAAM6K,YAAa,CAErB7K,GAAMlR,KAAKmb,EAAMqB,aAAe,YAAc,UAAY,gBAAiBpB,EAAOE,iBAAiB,IACnG,IACIW,EADAQ,EAAmB,KAEvB,IADIR,EAAezb,EAAOkW,GAAGwF,oBACVD,EAAa9Z,OAAS,EAAG,CAAC,IAAD,uBAC3C,IAAI,IAAJ,EAAQ,EAAK8Z,EAAb,+CAA2B,CAAC,IAApBE,EACP,IADOA,EAAmB,SACpB7F,QAAU6F,EAAE7F,OAAOgE,OAAiC,UAAxB6B,EAAE7F,OAAOgE,MAAMC,MAC9C4B,EAAEC,UAAYD,EAAEC,SAAS9B,OAAmC,UAA1B6B,EAAEC,SAAS9B,MAAMC,KAAmB,CACxEkC,EAAmBN,EACnB,QALyC,mFASzCM,GAAoBA,EAAiBnG,OACvCmG,EAAiBnG,OAAO+F,aAAajB,EAAOE,iBAAiB,IAE7D9a,EAAOkW,GAAGoF,SAASV,EAAOE,iBAAiB,GAAIF,QAGhDlK,GAAMlR,KAAKmb,EAAMqB,aAAe,YAAc,UAAY,gBAAiBpB,EAAOE,iBAAiB,IACnG9a,EAAOkW,GAAGoF,SAASV,EAAOE,iBAAiB,GAAIF,QAvDjD5a,EAAOgb,SAAWJ,EAClBG,GAAY,EA2Db,IAAI/a,EAAOkW,GAAI,CACd,IAAIgG,EAAY,CAAC,WAAc5I,EAAY,mBAAsBE,EAAoB,aAAgBC,GACnD,WAA/C/C,GAAMyL,cAAcC,eAAeC,UAErCH,EAAS,aAAoBxL,GAAMyL,cAAcC,eAAeE,QAAU,GAAM,SAAW,gBAE5F,IAAIC,EAAiB,CACpB,SAAY,CAAC,CAAC,sBAAwB,KAMvC,GAJG7I,GACF6I,EAAeC,SAAS5a,KAAK,CAAC,UAAW,IAGvCgW,EAAU6E,gBAAsD,kBAA7B7E,EAAU6E,eAE/C,IAAI,IAAIhb,KADRiP,GAAM0C,MAAM,4CAA6CwE,EAAU6E,gBACtD7E,EAAU6E,eACtBF,EAAeC,SAAS5a,KAAKgW,EAAU6E,eAAehb,IAGN,SAA/CiP,GAAMyL,cAAcC,eAAeC,UAErCH,EAAUzI,aAAe,cAGvBiJ,aAAaC,UAAUC,2BACxBF,aAAaC,UAAUE,4BACtBjF,EAAUkF,kBAAoBlF,EAAUmF,sBAC1C/c,EAAO8c,iBAAmBlF,EAAUkF,iBACpC9c,EAAO+c,mBAAqBnF,EAAUmF,mBACtCb,EAAS,oCAAyC,EAClDA,EAAS,oCAAyC,EAClDA,EAAS,0BAA+B,GAEzCxL,GAAMlR,IAAI,2BACVkR,GAAM0C,MAAMmJ,GACZvc,EAAOkW,GAAK,IAAI8G,kBAAkBd,EAAWK,GAC7C7L,GAAM0C,MAAMpT,EAAOkW,IAChBlW,EAAOkW,GAAG+G,WACZjd,EAAOkd,OAAS,GAChBld,EAAOmd,QAAQ7Y,MAAQ,eAExBoM,GAAMlR,IAAI,yDAA2DQ,EAAOod,QAAU,KACtFpd,EAAOkW,GAAGmH,2BAA6B,SAASvX,GAC5C9F,EAAOkW,IACTH,EAAauH,SAAStd,EAAOkW,GAAGqH,qBAElCvd,EAAOkW,GAAGsH,eAAiB,SAASpL,GACnC,IAAKA,EAAM4D,WACuC,SAA/CtF,GAAMyL,cAAcC,eAAeC,SAAsBjK,EAAM4D,UAAUA,UAAU3C,QAAQ,mBAAqB,EAClH3C,GAAMlR,IAAI,sBACVQ,EAAOyd,SAAU,GACK,IAAnBzd,EAAOod,QAET5E,EAAqBJ,EAAU,CAAC,WAAa,IAiqClD,SAAiBA,EAAUR,IAC1BA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnF,IAAIsD,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAEjC,YADAvF,GAAMiF,KAAK,wCAGZ,IAAI3V,EAAS+V,EAAaE,YAE1B,GADAvF,GAAMlR,IAAI,gCACNQ,EAAO0d,MAEV,YADAhN,GAAMiF,KAAK,0DAGZ3V,EAAO0d,MAAQ,CACd,KAAQ1d,EAAOkW,GAAGyH,iBAAiBze,KACnC,IAAOc,EAAOkW,GAAGyH,iBAAiBrF,MAEb,IAAnBtY,EAAOod,UACTpd,EAAO0d,MAAP,SAA0B,GAC3BhN,GAAM0C,MAAMwE,GACZ5X,EAAO4d,SAAU,EACjBhG,EAAUpF,QAAQxS,EAAO0d,OArrCrBG,CAAQzF,EAAUR,OAEb,CAGN,IAAI5B,EAAY,CACf,UAAa5D,EAAM4D,UAAUA,UAC7B,OAAU5D,EAAM4D,UAAU8H,OAC1B,cAAiB1L,EAAM4D,UAAU+H,gBAEZ,IAAnB/d,EAAOod,SAET5E,EAAqBJ,EAAUpC,KAIlChW,EAAOkW,GAAG8H,QAAU,SAAS5L,GAG5B,GAFA1B,GAAMlR,IAAI,yBACVkR,GAAM0C,MAAMhB,GACRA,EAAM6L,UAEVje,EAAOke,aAAe9L,EAAM6L,QAAQ,GACpClI,EAAaoI,eAAene,EAAOke,eAChC9L,EAAM0H,MAAMsE,SAAf,CAEA,GAAGpe,EAAO+c,mBAAoB,CAC7B,IAAIsB,EAAkB,KACE,UAArBjM,EAAM0H,MAAMC,MAAoB/Z,EAAO+c,mBAAP,MAClCsB,EAAkBjM,EAAMwJ,SAASgB,4BACH,UAArBxK,EAAM0H,MAAMC,MAAoB/Z,EAAO+c,mBAAP,QACzCsB,EAAkBjM,EAAMwJ,SAASiB,6BAE/BwB,GACFA,EAAgBC,eACdC,YAAYve,EAAO+c,mBAAmB3K,EAAM0H,MAAMC,OAClDyE,OAAOH,EAAgBI,gBAG3B,IAAIC,EAAsB,KAC1BhO,GAAMlR,IAAI,oCAAqC4S,EAAM0H,OACrD1H,EAAM0H,MAAMsE,QAAU,SAASO,GAC9BjO,GAAMlR,IAAI,wBAAyBmf,GAChC3e,EAAOke,eACT5L,aAAaoM,GACb1e,EAAOke,aAAaU,YAAYD,EAAG3Y,QACnC+P,EAAaoI,eAAene,EAAOke,gBAGrC9L,EAAM0H,MAAM+E,OAAS,SAASF,GAC7BjO,GAAMlR,IAAI,sBAAuBmf,GAC9B3e,EAAOke,cAAuC,MAAvBQ,IACzBA,EAAsB5M,YAAW,WAChCpB,GAAMlR,IAAI,yBACVQ,EAAOke,aAAaU,YAAYD,EAAG3Y,QACnC+P,EAAaoI,eAAene,EAAOke,cACnCQ,EAAsB,OAGpB,QAGLtM,EAAM0H,MAAMgF,SAAW,SAASH,GAE/B,GADAjO,GAAMlR,IAAI,8BAA+Bmf,GACf,MAAvBD,EACFpM,aAAaoM,GACbA,EAAsB,UAEtB,IACC1e,EAAOke,aAAa5C,SAASqD,EAAG3Y,QAChC+P,EAAaoI,eAAene,EAAOke,cAClC,MAAMpY,GACP4K,GAAMpR,MAAMwG,OAMjB,GAAGiV,GAAaH,EAAQ,CACvBlK,GAAMlR,IAAI,uBACV,IAAIuf,GAAuC,IAAzBnH,EAAUmH,WAC5BnE,EAAOoE,YAAYC,SAAQ,SAASnF,GAEnC,GADApJ,GAAMlR,IAAI,sBAAuBsa,GAC7BiF,EAiBH,GAAkB,UAAfjF,EAAMC,KACR/Z,EAAOkW,GAAGoF,SAASxB,EAAOc,OACpB,CACNlK,GAAMlR,IAAI,mCAAoCsa,GAC9C,IAAIvF,EAAcF,EAAeuD,EAAUtD,sBAC3CtU,EAAOkW,GAAGgJ,eAAepF,EAAO,CAC/B/O,UAAW,WACXkT,QAAS,CAACrD,GACVuE,cAAe,CACd,CAAEC,IAAK,IAAKC,QAAQ,EAAMC,WAAY/K,EAAYC,MAClD,CAAE4K,IAAK,IAAKC,QAAQ,EAAMC,WAAY/K,EAAYE,OAAQ8K,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAY/K,EAAYG,IAAK6K,sBAAuB,UA5BlE,CACf,IAAIzJ,EAAS9V,EAAOkW,GAAGoF,SAASxB,EAAOc,GAEvC,GAAG9E,GAAU9V,EAAO8c,iBAAkB,CACrC,IAAI0C,EAAgB,KACK,UAAtB1J,EAAOgE,MAAMC,MAAoB/Z,EAAO8c,iBAAP,MACnC0C,EAAgB1J,EAAO8G,4BACQ,UAAtB9G,EAAOgE,MAAMC,MAAoB/Z,EAAO8c,iBAAP,QAC1C0C,EAAgB1J,EAAO+G,6BAErB2C,GACFA,EAAclB,eACZC,YAAYve,EAAO8c,iBAAiBhH,EAAOgE,MAAMC,OACjDyE,OAAOgB,EAAcf,sBA2nD7B,SAAuB9D,GAEtB,GADAjK,GAAM0C,MAAM,iBAAkBuH,GACoB,SAA/CjK,GAAMyL,cAAcC,eAAeC,QAErC,OADA3L,GAAMiF,KAAK,2CACJ,EAER,YAAa9B,IAAV8G,GAAiC,OAAVA,IAEH,IAAfA,EAAMvb,MA5mDXqgB,CAAc9E,KAAW3a,EAAOiZ,YAAYvI,GAAM8I,wBACpD9I,GAAMlR,IAAI,iCACViZ,EAAkBL,EAAU1H,GAAM8I,qBAAsB,MAAM,GAC9DxZ,EAAOkW,GAAGwJ,cAAgB,SAAStN,GAClC1B,GAAMlR,IAAI,iCAAkC4S,GAC5CqG,EAAkBL,EAAUhG,EAAMzF,QAAQ3F,MAAOoL,EAAMzF,QAAQoM,SAAU3G,EAAMzF,WAI9E3M,EAAOgb,UACTjF,EAAa4J,cAAc3f,EAAOgb,UAG/B5D,EAGHpX,EAAOkW,GAAG0J,qBAAqBxI,GAC7BtY,MAAK,WAIL,GAHA4R,GAAMlR,IAAI,gCACVQ,EAAOmW,UAAYiB,EAAKkB,IAErBtY,EAAOuW,YAAcvW,EAAOuW,WAAW5U,OAAS,EAAG,CACrD,IAAI,IAAIF,EAAI,EAAGA,EAAGzB,EAAOuW,WAAW5U,OAAQF,IAAK,CAChD,IAAIuU,EAAYhW,EAAOuW,WAAW9U,GAClCiP,GAAM0C,MAAM,2BAA4B4C,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BpW,EAAOkW,GAAGG,gBAAgBL,GAH1BhW,EAAOkW,GAAGG,gBAAgB3F,GAAM4F,iBAMlCtW,EAAOuW,WAAa,IAsxBzB,SAAsB6B,EAAUuC,EAAO/C,IACtCA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnFmF,EAAUiI,aAAiD,mBAA1BjI,EAAUiI,aAA8BjI,EAAUiI,aAAenP,GAAM+B,KACxG,IAAIsD,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IAAIU,EAAS+V,EAAaE,YACtB6J,GAAqC,IAAxBlI,EAAUkI,UACvBA,EAGHpP,GAAMlR,IAAI,4BAA8BQ,EAAOyd,QAAU,eAAiBqC,EAAY,KAFtFpP,GAAMlR,IAAI,4BAA8BQ,EAAOyd,QAAU,KAI1D,IAAIsC,EAAmB,KACvB,GAAGrP,GAAM6K,YAAa,CAErBwE,EAAmB,GACnB,IAAIvE,EAAmB,KAAMS,EAAmB,KAC5CR,EAAezb,EAAOkW,GAAGwF,kBAC7B,GAAGD,GAAgBA,EAAa9Z,OAAS,EAAG,CAAC,IAAD,uBAC3C,IAAI,IAAJ,EAAQ,EAAK8Z,EAAb,+CAA2B,CAAC,IAApBE,EAAmB,QACtBA,EAAE7F,QAAU6F,EAAE7F,OAAOgE,OAAiC,UAAxB6B,EAAE7F,OAAOgE,MAAMC,MAC9C4B,EAAEC,UAAYD,EAAEC,SAAS9B,OAAmC,UAA1B6B,EAAEC,SAAS9B,MAAMC,KACjDyB,IACHA,EAAmBG,IAGjBA,EAAE7F,QAAU6F,EAAE7F,OAAOgE,OAAiC,UAAxB6B,EAAE7F,OAAOgE,MAAMC,MAC9C4B,EAAEC,UAAYD,EAAEC,SAAS9B,OAAmC,UAA1B6B,EAAEC,SAAS9B,MAAMC,QACjDkC,IACHA,EAAmBN,KAXqB,mFAiB5C,IAAIqE,EAAY7E,EAAmBR,GAC/BsF,EAAYC,EAAmBvF,GACnC,GAAIqF,GAAcC,GAgBjB,GAAGD,GAAaC,GACf,GAAGzE,EACF,IACKA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,GACnD,MAAM1V,GACP4K,GAAMpR,MAAMwG,SAGR,GAAGka,IAAcC,EACvB,IACIzE,IACEA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,IAEpD,MAAM1V,GACP4K,GAAMpR,MAAMwG,QAEP,IAAIka,GAAaC,EACvB,GAAGzE,EACF,IACKA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,GACnD,MAAM1V,GACP4K,GAAMpR,MAAMwG,QAIb0V,EAAmBxb,EAAOkW,GAAGgJ,eAAe,QAAS,CAAEnU,UAAW,aAClE2F,GAAMlR,IAAI,qCAAsCgc,QAvDlD,GAAGb,EAAMyF,aAAe5E,EACvB,IACKA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,GACnD,MAAM1V,GACP4K,GAAMpR,MAAMwG,GAmDf,IAAIua,EAAYvE,EAAmBnB,GAC/B2F,EAAYC,EAAmB5F,GACnC,GAAI0F,GAAcC,GAgBjB,GAAGD,GAAaC,GACf,GAAGrE,EACF,IACKA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,GACnD,MAAMnW,GACP4K,GAAMpR,MAAMwG,SAGR,GAAGua,IAAcC,GACvB,GAAGrE,EACF,IACKA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,GACnD,MAAMnW,GACP4K,GAAMpR,MAAMwG,SAGR,IAAIua,GAAaC,EACvB,GAAGrE,EACF,IACKA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,GACnD,MAAMnW,GACP4K,GAAMpR,MAAMwG,QAIbmW,EAAmBjc,EAAOkW,GAAGgJ,eAAe,QAAS,CAAEnU,UAAW,aAClE2F,GAAMlR,IAAI,qCAAsCyc,QAvDlD,GAAGtB,EAAM6F,aAAevE,EACvB,IACKA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,GACnD,MAAMnW,GACP4K,GAAMpR,MAAMwG,SAoDdia,EADiD,YAA/CrP,GAAMyL,cAAcC,eAAeC,SAAwE,SAA/C3L,GAAMyL,cAAcC,eAAeC,QAC9E,CAClBoE,oBAAqBP,EAAmBvF,GACxC+F,oBAAqBH,EAAmB5F,IAGtB,CAClBgG,UAAW,CACVC,oBAAqBV,EAAmBvF,GACxCkG,oBAAqBN,EAAmB5F,KAK5CjK,GAAM0C,MAAM2M,GAEZ,IAAIe,EAAYhF,EAAmBnB,GACnC,GAAGmG,GAAahB,GAA4D,YAA/CpP,GAAMyL,cAAcC,eAAeC,QAAuB,CAEtF3L,GAAMlR,IAAI,2CACV,IAAIsW,EAAS9V,EAAOkW,GAAG0D,aAAa,GACpClJ,GAAMlR,IAAIsW,GACV,IAAIiL,EAAajL,EAAOkL,gBACxBtQ,GAAMlR,IAAIuhB,GAEV,IAAIxM,EAAcF,EAAeuD,EAAUtD,sBAC3CwB,EAAOmL,cAAc,CAACC,UAAW,CAChC,CAAE9B,IAAK,OAAQC,QAAQ,EAAM8B,SAAU,OAAQ7B,WAAY/K,EAAYC,MACvE,CAAE4K,IAAK,SAAUC,QAAQ,EAAM8B,SAAU,SAAU7B,WAAY/K,EAAYE,QAC3E,CAAE2K,IAAK,MAAOC,QAAQ,EAAM8B,SAAU,MAAO7B,WAAY/K,EAAYG,QAGvE1U,EAAOkW,GAAGkL,aAAarB,GACrBjhB,MAAK,SAASuiB,GACd3Q,GAAM0C,MAAMiO,GAGZ,IAAIjK,EAAO,CACV,KAAQiK,EAAOniB,KACf,IAAOmiB,EAAO/I,KAEfV,EAAUiI,aAAazI,GACvBiK,EAAO/I,IAAMlB,EAAKkB,IAClB5H,GAAMlR,IAAI,6BACPshB,GAAahB,IAEmC,WAA/CpP,GAAMyL,cAAcC,eAAeC,QAIrC3L,GAAMiF,KAAK,qFAC6C,YAA/CjF,GAAMyL,cAAcC,eAAeC,SAC5C3L,GAAMiF,KAAK,iEAGb3V,EAAO0d,MAAQ2D,EAAO/I,IACtBtY,EAAOkW,GAAGoL,oBAAoBD,GAC5BhiB,MAAMuY,EAAUtY,OAClBU,EAAO+f,iBAAmBA,EACtB/f,EAAOyd,SAAYzd,EAAOod,UAM3Bpd,EAAO8c,kBAAoB9c,EAAO+c,sBACpCsE,EAAM,MAAW,GAElBzJ,EAAUpF,QAAQ6O,IAPjB3Q,GAAMlR,IAAI,mCAQToY,EAAUtY,OAjgCX8hB,CAAahJ,EAAUuC,EAAO/C,KAC5BA,EAAUtY,OAokBhB,SAAqB8Y,EAAUuC,EAAO/C,IACrCA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnFmF,EAAUiI,aAAiD,mBAA1BjI,EAAUiI,aAA8BjI,EAAUiI,aAAenP,GAAM+B,KACxG,IAAIsD,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IAAIU,EAAS+V,EAAaE,YACtB6J,GAAqC,IAAxBlI,EAAUkI,UACvBA,EAGHpP,GAAMlR,IAAI,2BAA6BQ,EAAOyd,QAAU,eAAiBqC,EAAY,KAFrFpP,GAAMlR,IAAI,2BAA6BQ,EAAOyd,QAAU,KAKzD,IAAIsC,EAAmB,GACvB,GAAGrP,GAAM6K,YAAa,CAErB,IAAIC,EAAmB,KAAMS,EAAmB,KAC5CR,EAAezb,EAAOkW,GAAGwF,kBAC7B,GAAGD,GAAgBA,EAAa9Z,OAAS,EAAG,CAAC,IAAD,uBAC3C,IAAI,IAAJ,EAAQ,EAAK8Z,EAAb,+CAA2B,CAAC,IAApBE,EAAmB,QACtBA,EAAE7F,QAAU6F,EAAE7F,OAAOgE,OAAiC,UAAxB6B,EAAE7F,OAAOgE,MAAMC,MAC9C4B,EAAEC,UAAYD,EAAEC,SAAS9B,OAAmC,UAA1B6B,EAAEC,SAAS9B,MAAMC,KACjDyB,IACHA,EAAmBG,IAIjBA,EAAE7F,QAAU6F,EAAE7F,OAAOgE,OAAiC,UAAxB6B,EAAE7F,OAAOgE,MAAMC,MAC9C4B,EAAEC,UAAYD,EAAEC,SAAS9B,OAAmC,UAA1B6B,EAAEC,SAAS9B,MAAMC,QACjDkC,IACHA,EAAmBN,KAZqB,mFAmB5C,IAAIqE,EAAY7E,EAAmBR,GAC/BsF,EAAYC,EAAmBvF,GAC/BqF,GAAcC,EAYdD,GAAaC,EACZzE,IACEA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,IAE5CwE,IAAcC,EACpBzE,IACEA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,KAE3CwE,GAAaC,IACpBzE,GACEA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,KAGpDA,EAAmBxb,EAAOkW,GAAGgJ,eAAe,QAAS,CAAEnU,UAAW,aAClE2F,GAAMlR,IAAI,qCAAsCgc,KAvC/Cb,EAAMyF,aAAe5E,IACnBA,EAAiB2E,aACpB3E,EAAiB2E,aAAa,YAE9B3E,EAAiBzQ,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cgc,IAsCtD,IAAI6E,EAAYvE,EAAmBnB,GAC/B2F,EAAYC,EAAmB5F,GAC/B0F,GAAcC,EAYdD,GAAaC,EACZrE,IACEA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,IAE5CoE,IAAcC,EACpBrE,IACEA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,KAE3CoE,GAAaC,IACpBrE,GACEA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,KAGpDA,EAAmBjc,EAAOkW,GAAGgJ,eAAe,QAAS,CAAEnU,UAAW,aAClE2F,GAAMlR,IAAI,qCAAsCyc,KAvC/CtB,EAAM6F,aAAevE,IACnBA,EAAiBkE,aACpBlE,EAAiBkE,aAAa,YAE9BlE,EAAiBlR,UAAY,WAE9B2F,GAAMlR,IAAI,yCAA0Cyc,SAsCtD8D,EAAgB,oBAA0BG,EAAmBvF,GAC7DoF,EAAgB,oBAA0BQ,EAAmB5F,IAEnB,IAAzB/C,EAAU2J,aAE3BxB,EAAgB,YAAiB,GAElCrP,GAAM0C,MAAM2M,GAEZ,IAAIe,EAAYhF,EAAmBnB,GACnC,GAAGmG,GAAahB,GAA4D,YAA/CpP,GAAMyL,cAAcC,eAAeC,QAAuB,CAEtF3L,GAAMlR,IAAI,2CACV,IAAIsW,EAAS9V,EAAOkW,GAAG0D,aAAaC,MAAK,SAAS2H,GAAI,MAAwB,UAAjBA,EAAE1H,MAAMC,QACrE,GAAGjE,EAAQ,CACV,IAAIiL,EAAajL,EAAOkL,gBACpBD,IACHA,EAAa,IAEd,IAAIxM,EAAcF,EAAeuD,EAAUtD,sBAC3CyM,EAAWG,UAAY,CACtB,CAAE9B,IAAK,IAAKC,QAAQ,EAAMC,WAAY/K,EAAYC,MAClD,CAAE4K,IAAK,IAAKC,QAAQ,EAAMC,WAAY/K,EAAYE,OAAQ8K,sBAAuB,GACjF,CAAEH,IAAK,IAAKC,QAAQ,EAAMC,WAAY/K,EAAYG,IAAK6K,sBAAuB,IAE/EzJ,EAAOmL,cAAcF,IAGvB/gB,EAAOkW,GAAGuL,YAAY1B,GACpBjhB,MAAK,SAAS4iB,GACdhR,GAAM0C,MAAMsO,GAGZ,IAAItK,EAAO,CACV,KAAQsK,EAAMxiB,KACd,IAAOwiB,EAAMpJ,KAEdV,EAAUiI,aAAazI,GACvBsK,EAAMpJ,IAAMlB,EAAKkB,IACjB5H,GAAMlR,IAAI,6BACPshB,GAAahB,IAEmC,WAA/CpP,GAAMyL,cAAcC,eAAeC,SACW,WAA/C3L,GAAMyL,cAAcC,eAAeC,SACpC3L,GAAMlR,IAAI,kDACVkiB,EAAMpJ,IAwiBX,SAAiCA,GAQhC,IALA,IAAIqJ,EAAQrJ,EAAIsJ,MAAM,QAClBC,GAAQ,EACRC,EAAO,EAAG,GAAKC,EAAW,EAAG,GAC7BC,EAAQ,KAAMC,EAAO,KAAMC,EAAU,KAAMlb,EAAQ,KACnDmb,GAAY,EACR1gB,EAAE,EAAGA,EAAEkgB,EAAMhgB,OAAQF,IAAK,CAEjC,GADI2gB,EAAQT,EAAMlgB,GAAGwP,MAAM,cAG1B,GAAc,UADDmR,EAAM,GACI,CAEtB,KAAGN,EAAK,GAAK,GAEN,CAENK,EAAW1gB,EACX,MAJAogB,GAAQ,OAQT,GAAGC,EAAK,IAAM,EAAG,CAEhBK,EAAW1gB,EACX,YAKH,GAAIogB,EAAJ,CAEA,IAAIlb,EAAMgb,EAAMlgB,GAAGwP,MAAM,gCACzB,GAAGtK,EACFmb,EAAK,GAAKnb,EAAI,GACdob,EAAS,GAAKpb,EAAI,GAClBgb,EAAMU,OAAO5gB,EAAG,GAAIA,QAHrB,CAMA,GAAGqgB,EAAK,GAAI,CAiBX,IAhBI7Q,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,kBAEhDE,EAAQ/Q,EAAM,KAEfA,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,iBAE5CG,EAAOhR,EAAM,KAEdA,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,oBAE5CI,EAAUjR,EAAM,KAEjBA,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,kBAE5C9a,EAAQiK,EAAM,IAEkC,IAA9C0Q,EAAMlgB,GAAG4R,QAAQ,UAAY0O,EAAS,IAAW,CACnDJ,EAAMU,OAAO5gB,EAAG,GAAIA,IACpB,SAED,GAA6C,IAA1CkgB,EAAMlgB,GAAG4R,QAAQ,UAAYyO,EAAK,IAAW,CAC/CH,EAAMU,OAAO5gB,EAAG,GAAIA,IACpB,UAGoB,GAAnBkgB,EAAMlgB,GAAGE,SACXggB,EAAMU,OAAO5gB,EAAG,GAAIA,OAItB,GAAGqgB,EAAK,GAAK,EAAG,CAEfK,GAAY,EACZN,GAAQ,EACR,IAAQpgB,EAAE,EAAGA,EAAEkgB,EAAMhgB,OAAQF,IAAK,CACjC,IAAI2gB,EACJ,GADIA,EAAQT,EAAMlgB,GAAGwP,MAAM,cAG1B,GAAc,UADDmR,EAAM,GACI,CAEtB,KAAGN,EAAK,GAAK,GAEN,CAENK,EAAW1gB,EACX,MAJAogB,GAAQ,OAQT,GAAGC,EAAK,IAAM,EAAG,CAEhBK,EAAW1gB,EACX,YAKH,GAAIogB,EAAJ,CAEA,GAAGC,EAAK,GAAK,EAAG,CACf,IAAIxd,EAAQqd,EAAMlgB,GAAGwP,MAAM,gBAC3B,GAAG3M,EAAO,CACTwd,EAAK,GAAKxd,EAAM,GAChBqd,EAAMU,OAAO5gB,EAAG,GAAIA,IACpB,cAEK,CACN,IAAIwP,EAgBJ,IAhBIA,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,kBAEhDE,EAAQ/Q,EAAM,KAEfA,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,iBAE5CG,EAAOhR,EAAM,KAEdA,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,oBAE5CI,EAAUjR,EAAM,KAEjBA,EAAQ0Q,EAAMlgB,GAAGwP,MAAM,UAAY6Q,EAAK,GAAK,kBAE5C9a,EAAQiK,EAAM,IAEkC,IAA9C0Q,EAAMlgB,GAAG4R,QAAQ,UAAY0O,EAAS,IAAW,CACnDJ,EAAMU,OAAO5gB,EAAG,GAAIA,IACpB,SAED,GAA6C,IAA1CkgB,EAAMlgB,GAAG4R,QAAQ,UAAYyO,EAAK,IAAW,CAC/CH,EAAMU,OAAO5gB,EAAG,GAAIA,IACpB,UAGqB,IAApBkgB,EAAMlgB,GAAGE,SACXggB,EAAMU,OAAO5gB,EAAG,GAAIA,OAKvB,GAAGqgB,EAAK,GAAK,EAGZ,OADApR,GAAMiF,KAAK,0DACJ2C,EAEL6J,EAAW,IAEbA,EAAWR,EAAMhgB,QAIlBmgB,EAAK,GAAKQ,KAAKC,MAAoB,WAAdD,KAAKna,UAC1B2Z,EAAK,GAAKQ,KAAKC,MAAoB,WAAdD,KAAKna,UAC1B4Z,EAAS,GAAKO,KAAKC,MAAoB,WAAdD,KAAKna,UAC9B4Z,EAAS,GAAKO,KAAKC,MAAoB,WAAdD,KAAKna,UAE9B,IAAQ1G,EAAE,EAAGA,EAAEqgB,EAAKngB,OAAQF,IACxBugB,IACFL,EAAMU,OAAOF,EAAU,EAAG,UAAYL,EAAKrgB,GAAK,UAAYugB,GAC5DG,KAEEF,IACFN,EAAMU,OAAOF,EAAU,EAAG,UAAYL,EAAKrgB,GAAK,SAAWwgB,GAC3DE,KAEED,IACFP,EAAMU,OAAOF,EAAU,EAAG,UAAYL,EAAKrgB,GAAK,YAAcygB,GAC9DC,KAEEnb,IACF2a,EAAMU,OAAOF,EAAU,EAAG,UAAYL,EAAKrgB,GAAK,UAAYuF,GAC5Dmb,KAGEH,IACFL,EAAMU,OAAOF,EAAU,EAAG,UAAYJ,EAAStgB,GAAK,UAAYugB,GAChEG,KAEEF,IACFN,EAAMU,OAAOF,EAAU,EAAG,UAAYJ,EAAStgB,GAAK,SAAWwgB,GAC/DE,KAEED,IACFP,EAAMU,OAAOF,EAAU,EAAG,UAAYJ,EAAStgB,GAAK,YAAcygB,GAClEC,KAEEnb,IACF2a,EAAMU,OAAOF,EAAU,EAAG,UAAYJ,EAAStgB,GAAK,UAAYuF,GAChEmb,KAGFR,EAAMU,OAAOF,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEJ,EAAMU,OAAOF,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEJ,EAAMU,OAAOF,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMC,EAAS,IACzEJ,EAAMU,OAAOF,EAAU,EAAG,oBAAsBL,EAAK,GAAK,IAAMA,EAAK,GAAK,IAAMA,EAAK,KACrFxJ,EAAMqJ,EAAMjjB,KAAK,SACT8jB,SAAS,UAChBlK,GAAO,QACR,OAAOA,EA7uBSmK,CAAwBf,EAAMpJ,MACc,YAA/C5H,GAAMyL,cAAcC,eAAeC,SAC5C3L,GAAMiF,KAAK,iEAGb3V,EAAO0d,MAAQgE,EAAMpJ,IACrBtY,EAAOkW,GAAGoL,oBAAoBI,GAC5BriB,MAAMuY,EAAUtY,OAClBU,EAAO+f,iBAAmBA,EACtB/f,EAAOyd,SAAYzd,EAAOod,UAM3Bpd,EAAO8c,kBAAoB9c,EAAO+c,sBACpC2E,EAAK,MAAW,GAEjB9J,EAAUpF,QAAQkP,IAPjBhR,GAAMlR,IAAI,mCAQToY,EAAUtY,OAtyBbmiB,CAAYrJ,EAAUuC,EAAO/C,GA2B/B,SAAS8K,EAActK,EAAUsJ,EAAO9J,IACvCA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQqjB,EAC7E,IAAIvL,EAAOQ,EAAUR,KACrB,GAAGsK,GAAStK,EAGX,OAFA1G,GAAMpR,MAAM,yCACZsY,EAAUtY,MAAM,oCAEV,IAAIoiB,KAAWtK,IAASA,EAAKlY,OAASkY,EAAKkB,KAGjD,OAFA5H,GAAMpR,MAAM,kDACZsY,EAAUtY,MAAM,6CAIjBsY,EAAU+C,MAAoC,kBAApB/C,EAAU+C,OAAsB/C,EAAU+C,MAAS/C,EAAU+C,MAAQ,CAAEiI,OAAO,EAAMf,OAAO,GACrH,IAAIlH,EAAQ/C,EAAU+C,MAClB5E,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IA+iDyB8d,EA/iDrBpd,EAAS+V,EAAaE,YAG1B,GAFAjW,EAAOod,SA8iDkBA,EA9iDSxF,EAAUwF,QA+iD5C1M,GAAM0C,MAAM,oBAAqBgK,IACb,IAAZA,GA9iDJpd,EAAOkW,GAKJ,CAKN,GAJAxF,GAAMlR,IAAI,mCACVmb,EAAMM,QAAS,EAGZrD,EAAUgD,OAEThD,EAAUgD,SAAW5a,EAAOgb,UAC9BtK,GAAMlR,IAAI,oDAEL,CAEN,GAAGmb,EAAMS,UAKR,GAJAT,EAAMkI,WAAY,EAClBlI,EAAMU,cAAe,EACrBV,EAAMyF,aAAc,EACpBzF,EAAMqF,WAAY,EACfhgB,EAAOgb,UAAYhb,EAAOgb,SAASH,kBAAoB7a,EAAOgb,SAASH,iBAAiBlZ,OAG1F,OAFA+O,GAAMpR,MAAM,qDACZsY,EAAUtY,MAAM,qDAGRqb,EAAMyF,aACfzF,EAAMkI,WAAY,EAClBlI,EAAMU,cAAe,EACrBV,EAAMS,UAAW,EACjBT,EAAMqF,WAAY,GACTrF,EAAMU,eACfV,EAAMkI,WAAY,EAClBlI,EAAMS,UAAW,EACjBT,EAAMyF,aAAc,EACpBzF,EAAMqF,WAAY,GAoCnB,GAlCIhgB,EAAOgb,UAaNhb,EAAOgb,SAASH,kBAAgE,IAA5C7a,EAAOgb,SAASH,iBAAiBlZ,QAcrEwZ,EAAmBR,IACnBA,EAAMyF,aAAgBzF,EAAMU,eAC9BV,EAAMkI,WAAY,IA3BjBlI,EAAMU,eACRV,EAAMkI,WAAY,EAClBlI,EAAMU,cAAe,EACrBV,EAAMS,UAAW,EACjBT,EAAMqF,WAAY,GAEhB7E,EAAmBR,KACrBA,EAAMkI,WAAY,EAClBlI,EAAMS,UAAW,IAwBhBT,EAAMoB,UAKR,GAJApB,EAAMmI,WAAY,EAClBnI,EAAMqB,cAAe,EACrBrB,EAAM6F,aAAc,EACpB7F,EAAM0F,WAAY,EACfrgB,EAAOgb,UAAYhb,EAAOgb,SAASF,kBAAoB9a,EAAOgb,SAASF,iBAAiBnZ,OAG1F,OAFA+O,GAAMpR,MAAM,qDACZsY,EAAUtY,MAAM,qDAGRqb,EAAM6F,aACf7F,EAAMmI,WAAY,EAClBnI,EAAMqB,cAAe,EACrBrB,EAAMoB,UAAW,EACjBpB,EAAM0F,WAAY,GACT1F,EAAMqB,eACfrB,EAAMmI,WAAY,EAClBnI,EAAMoB,UAAW,EACjBpB,EAAM6F,aAAc,EACpB7F,EAAM0F,WAAY,GAEfrgB,EAAOgb,UAaNhb,EAAOgb,SAASF,kBAAgE,IAA5C9a,EAAOgb,SAASF,iBAAiBnZ,QAcrEma,EAAmBnB,IAAWA,EAAM6F,aAAgB7F,EAAMqB,eAC5DrB,EAAMmI,WAAY,IA1BjBnI,EAAMqB,eACRrB,EAAMmI,WAAY,EAClBnI,EAAMqB,cAAe,EACrBrB,EAAMoB,UAAW,EACjBpB,EAAM0F,WAAY,GAEhBvE,EAAmBnB,KACrBA,EAAMmI,WAAY,EAClBnI,EAAMoB,UAAW,IAuBhBpB,EAAMoI,UACRpI,EAAMvb,MAAO,GAIf,GAAI+b,EAAmBR,IAAUA,EAAMkI,WACpC/G,EAAmBnB,IAAUA,EAAMmI,UAGrC,OAFA/M,EAAaiN,eAAc,QAC3BtI,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAW5X,EAAOgb,eApItDL,EAAMM,QAAS,EACfN,EAAMkI,WAAY,EAClBlI,EAAMmI,WAAY,EAuInB,GAAGnI,EAAMM,SAAWjb,EAAOkb,eAAgB,CAC1C,GAAGP,EAAMyF,aAAezF,EAAMU,aAAc,CAC3C,GAAGrb,EAAOgb,UAAYhb,EAAOgb,SAASH,kBAAoB7a,EAAOgb,SAASH,iBAAiBlZ,OAAQ,CAClG,IAAIshB,EAAKjjB,EAAOgb,SAASH,iBAAiB,GAC1CnK,GAAMlR,IAAI,wBAAyByjB,GACnCjjB,EAAOgb,SAAS4D,YAAYqE,GAC5B,IACCA,EAAGC,OACF,MAAMpd,KAET,GAAG9F,EAAOkW,GAAG0D,cAAgB5Z,EAAOkW,GAAG0D,aAAajY,OAAQ,CAC3D,IAAIwhB,GAAK,EAKT,GAJGxI,EAAMU,cAAgB3K,GAAM6K,cAE9B4H,GAAK,GAEHA,EAAI,CAAC,IAAD,uBACN,IAAI,IAAJ,EAAQ,EAAQnjB,EAAOkW,GAAG0D,aAA1B,+CAAwC,CAAC,IAAjCwJ,EAAgC,QACpCA,GAAQA,EAAKtJ,OAA6B,UAApBsJ,EAAKtJ,MAAMC,OACnCrJ,GAAMlR,IAAI,yBAA0B4jB,GACpCpjB,EAAOkW,GAAG0I,YAAYwE,KAJlB,qFAUT,GAAGzI,EAAM6F,aAAe7F,EAAMqB,aAAc,CAC3C,GAAGhc,EAAOgb,UAAYhb,EAAOgb,SAASF,kBAAoB9a,EAAOgb,SAASF,iBAAiBnZ,OAAQ,CAClG,IAAI0hB,EAAKrjB,EAAOgb,SAASF,iBAAiB,GAC1CpK,GAAMlR,IAAI,wBAAyB6jB,GACnCrjB,EAAOgb,SAAS4D,YAAYyE,GAC5B,IACCA,EAAGH,OACF,MAAMpd,KAET,GAAG9F,EAAOkW,GAAG0D,cAAgB5Z,EAAOkW,GAAG0D,aAAajY,OAAQ,CAC3D,IAAI2hB,GAAK,EAKT,GAJG3I,EAAMqB,cAAgBtL,GAAM6K,cAE9B+H,GAAK,GAEHA,EAAI,CAAC,IAAD,uBACN,IAAI,IAAJ,EAAQ,EAAQtjB,EAAOkW,GAAG0D,aAA1B,+CAAwC,CAAC,IAAjC2J,EAAgC,QACpCA,GAAQA,EAAKzJ,OAA6B,UAApByJ,EAAKzJ,MAAMC,OACnCrJ,GAAMlR,IAAI,yBAA0B+jB,GACpCvjB,EAAOkW,GAAG0I,YAAY2E,KAJlB,sFAYV,GAAG3L,EAAUgD,OAAQ,CACpB,IAAIA,EAAShD,EAAUgD,OAIvB,GAHAlK,GAAMlR,IAAI,2CACVkR,GAAM0C,MAAMwH,GAETD,EAAMM,QACLjb,EAAOgb,UAAYhb,EAAOgb,WAAapD,EAAUgD,SAAW5a,EAAOkb,eAAgB,CAErF,IAEC,IAAIsI,EAASxjB,EAAOgb,SAASgE,YAF1B,uBAGH,IAAI,IAAJ,EAAQ,EAAOwE,EAAf,+CAAuB,CAAC,IAAhBC,EAAe,QACtB/S,GAAMlR,IAAIikB,GACPA,GACFA,EAAIP,QANH,mFAQF,MAAMpd,IAGR9F,EAAOgb,SAAW,KAOpB,OAHAhb,EAAOkb,gBAAiB,EACxBnF,EAAaiN,eAAc,QAC3BtI,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAWgD,GAG/C,GAAGO,EAAmBR,IAAUmB,EAAmBnB,GAAQ,CAC1D,IAAIjK,GAAMgT,0BAET,YADA9L,EAAUtY,MAAM,8BAGjB,IAAIqkB,EAAc,CAAEhD,UAAW,GAAInE,SAAU,IAC7CzG,EAAaiN,eAAc,GAC3B,IAAIY,EAAezI,EAAmBR,GACnCiJ,GAAgBjJ,GAAgC,kBAAhBA,EAAMiI,QACxCgB,EAAejJ,EAAMiI,OACtB,IAAIiB,EAAe/H,EAAmBnB,GACtC,GAAGkJ,GAAgBlJ,EAAO,CACzB,IAAImF,GAAqC,IAAxBlI,EAAUkI,UACvBf,GAAuC,IAAzBnH,EAAUmH,WAG5B,IAFIe,IAAaf,GAAgB3H,GAASuD,EAAMkH,QAC/ClH,EAAMkH,MAAQ,SACZlH,EAAMkH,OAAwB,UAAflH,EAAMkH,OAAoC,UAAflH,EAAMkH,MAClD,GAA0B,kBAAhBlH,EAAMkH,MACfgC,EAAelJ,EAAMkH,UACf,CACN,IAAI5S,EAAQ,EACRC,EAAS,EACM,WAAhByL,EAAMkH,OAER3S,EAAS,IACG,IACZD,EAAQ,KACiB,gBAAhB0L,EAAMkH,OAEf3S,EAAS,IACG,IACZD,EAAQ,KACiB,UAAhB0L,EAAMkH,OAAqC,eAAhBlH,EAAMkH,OAA0C,UAAhBlH,EAAMkH,OAE1E3S,EAAS,IACG,IACZD,EAAQ,MACiB,WAAhB0L,EAAMkH,OAEf3S,EAAS,KACG,KACZD,EAAQ,MACiB,UAAhB0L,EAAMkH,OAEf3S,EAAS,KACG,KACZD,EAAQ,MACiB,WAAhB0L,EAAMkH,OAEf3S,EAAS,IACG,IACZD,EAAQ,KACiB,gBAAhB0L,EAAMkH,OAEf3S,EAAS,IACG,IACZD,EAAQ,MAERyB,GAAMlR,IAAI,uCACV0P,EAAS,IACG,IACZD,EAAQ,KAETyB,GAAMlR,IAAI,2BAA4Bmb,EAAMkH,OAC5CgC,EAAe,CACd,OAAU,CAAC,MAAS3U,GACpB,MAAS,CAAC,MAASD,IAEpByB,GAAMlR,IAAI,2BAA4BqkB,QAEjC,GAAmB,WAAhBlJ,EAAMkH,OAAsC,WAAhBlH,EAAMkH,MAAoB,KAoCtDiC,EAAT,SAA4BxkB,EAAOsb,GAClC7E,EAAaiN,eAAc,GACxB1jB,EACFsY,EAAUtY,MAAMA,GAEhBob,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAWgD,IAGvCmJ,EAAT,SAAwBJ,EAAaK,EAAaC,GACjDvT,GAAMlR,IAAI,4CACVkR,GAAM0C,MAAMuQ,GACZ9S,UAAUC,aAAaoT,aAAaP,GAClC7kB,MAAK,SAAS8b,GACXqJ,EACFpT,UAAUC,aAAaoT,aAAa,CAAEtB,OAAO,EAAMf,OAAO,IACzD/iB,MAAK,SAAUqlB,GACfvJ,EAAOU,SAAS6I,EAAYtJ,iBAAiB,IAC7CmJ,EAAY,KAAMpJ,MAGnBoJ,EAAY,KAAMpJ,MAGnBvb,OAAM,SAASC,GAASyW,EAAaiN,eAAc,GAAQgB,EAAY1kB,OA1D1E,GAAGuR,UAAUC,cAAgBD,UAAUC,aAAaC,gBA+BnD,OA3BA4S,EAAY9B,MAAQ,GACjBlH,EAAMyJ,uBACRT,EAAY9B,MAAMwC,UAAY1J,EAAMyJ,sBAElCzJ,EAAM2J,oBACRX,EAAY9B,MAAM3S,OAASyL,EAAM2J,mBAE/B3J,EAAM4J,mBACRZ,EAAY9B,MAAM5S,MAAQ0L,EAAM4J,kBAEjCZ,EAAYf,MAAQjI,EAAM6J,yBAC1B3T,UAAUC,aAAaC,gBAAgB4S,GACrC7kB,MAAK,SAAS8b,GACd7E,EAAaiN,eAAc,GACxB7H,EAAmBR,KAAWA,EAAMkI,UACtChS,UAAUC,aAAaoT,aAAa,CAAEtB,OAAO,EAAMf,OAAO,IACzD/iB,MAAK,SAAUqlB,GACfvJ,EAAOU,SAAS6I,EAAYtJ,iBAAiB,IAC7CH,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAWgD,MAG/CF,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAWgD,MAE7C,SAAUtb,GACZyW,EAAaiN,eAAc,GAC3BpL,EAAUtY,MAAMA,MA+BnB,GAAkD,WAA/CoR,GAAMyL,cAAcC,eAAeC,QAAsB,CAC3D,IAAInL,EAAYR,GAAMyL,cAAcC,eAAeE,QAC/ClL,EAAS,GACVxO,OAAOiO,UAAUG,UAAUC,MAAM,WACnCG,EAAS,IACPF,GAAa,IAAMA,GAAaE,GAElCuS,EAAc,CACb9B,MAAO,CACNlB,UAAW,CACV8D,iBAAiB,EACjBC,SAAU9hB,OAAO+hB,OAAO1V,MACxB2V,UAAWhiB,OAAO+hB,OAAOzV,OACzB2V,aAAclK,EAAMyJ,qBACpBU,aAAcnK,EAAMyJ,qBACpBW,kBAAmB,WAGrBnC,MAAOzH,EAAmBR,KAAWA,EAAMkI,WAE5CkB,EAAeJ,EAAaG,IAG5BpT,GAAMW,UAAUM,WAAU,SAAUrS,EAAOsM,GAC1C,GAAItM,EAEH,OADAyW,EAAaiN,eAAc,GACpBpL,EAAUtY,MAAMA,IAExBqkB,EAAc,CACbf,OAAO,EACPf,MAAO,CACNlB,UAAW,CACVoE,kBAAmB,UACnBL,SAAU9hB,OAAO+hB,OAAO1V,MACxB2V,UAAWhiB,OAAO+hB,OAAOzV,OACzB2V,aAAclK,EAAMyJ,qBACpBU,aAAcnK,EAAMyJ,sBAErB5H,SAAU,CACT,CAACiI,iBAAiB,GAClB,CAACO,+BAA+B,OAIvBnD,MAAMlB,UAAUsE,oBAAsBrZ,EAClDmY,EAAeJ,EAAaG,EAC3B3I,EAAmBR,KAAWA,EAAMkI,mBAGjC,GAAkD,YAA/CnS,GAAMyL,cAAcC,eAAeC,QAAuB,CACnE,KAAG3L,GAAMyL,cAAcC,eAAeE,SAAW,IA2B1C,CACN,IAAIhd,EAAQ,IAAIyS,MAAM,2BAItB,OAHAzS,EAAMsG,KAAO,+GACbmQ,EAAaiN,eAAc,QAC3BpL,EAAUtY,MAAMA,GA7BhBqkB,EAAc,CACb9B,MAAO,CACNqD,eAAgBvK,EAAMkH,MACtBsD,YAAaxK,EAAMkH,OAEpBe,MAAOzH,EAAmBR,KAAWA,EAAMkI,WAE5CkB,EAAeJ,GAAa,SAAUyB,EAAKxK,GAG1C,GAFAkJ,EAAkBsB,EAAKxK,IAElBwK,EACJ,IAAIC,EAAWzK,EAAO0K,YAClBC,EAAQ3iB,OAAO4iB,aAAY,WAC1B5K,GACHhY,OAAO6iB,cAAcF,GACnB3K,EAAO0K,aAAeD,IACxBziB,OAAO6iB,cAAcF,GAClB3K,EAAOwD,SACTxD,EAAOwD,WAGTiH,EAAWzK,EAAO0K,cAChB,QAWP,QAIE3K,GAAyB,WAAhBA,EAAMkH,OAElBhR,UAAUC,aAAa4U,mBAAmB5mB,MAAK,SAAS6mB,GACvD,IAAIC,EAAaD,EAAQE,MAAK,SAASC,GACtC,MAAuB,eAAhBA,EAAO/L,QAEfgM,EAmlCJ,SAA6BpL,GAE5B,GADAjK,GAAM0C,MAAM,uBAAwBuH,IAC/BA,EACJ,OAAO,EACR,GAA2B,kBAAhBA,EAAMkH,OAAuD,kBAA1BlH,EAAMkH,MAAMlB,UACzD,OAAO,EACR,IAAIgD,EAAchJ,EAAMkH,MAAMlB,UAC9B,GAAIgD,EAAYoB,kBACf,MAAyC,YAAlCpB,EAAYoB,mBAAqE,WAAlCpB,EAAYoB,kBAC9D,GAAIpB,EAAYuB,eACpB,MAAsC,WAA/BvB,EAAYuB,gBAA8D,WAA/BvB,EAAYuB,eAC1D,GAAIvB,EAAYwB,YACpB,MAAmC,WAA5BxB,EAAYwB,aAAwD,WAA5BxB,EAAYwB,YAC5D,OAAO,EAhmCSa,CAAoBrL,IAAUgL,EAAQE,MAAK,SAASC,GAChE,MAAuB,eAAhBA,EAAO/L,QAIXiG,EAAY7E,EAAmBR,GAC/B0F,EAAYvE,EAAmBnB,GAC/BsL,EAqhCR,SAA6BtL,GAE5B,OADAjK,GAAM0C,MAAM,uBAAwBuH,KAChCA,KAEe,IAAhBA,EAAMiI,QAAuC,IAApBjI,EAAMqF,iBAEPnM,IAAxB8G,EAAMuL,eAAuD,OAAxBvL,EAAMuL,gBAEd,IAAxBvL,EAAMuL,gBA7hCWC,CAAoBxL,GACtCyL,EAqjCR,SAA6BzL,GAE5B,OADAjK,GAAM0C,MAAM,uBAAwBuH,KAChCA,KAEe,IAAhBA,EAAMkH,QAAuC,IAApBlH,EAAM0F,iBAEPxM,IAAxB8G,EAAM0L,eAAuD,OAAxB1L,EAAM0L,gBAEd,IAAxB1L,EAAM0L,gBA7jCWC,CAAoB3L,GAC1C,GAAGqF,GAAaK,GAAa4F,GAAmBG,EAAiB,CAEhE,IAAIG,IAAkBvG,GAAY4F,EAC9BY,IAAkBnG,GAAY0F,EAClC,IAAIQ,IAAoBC,EAIvB,OAFAzQ,EAAaiN,eAAc,GAC3BpL,EAAUtY,MAAM,4BACT,EACD,IAAIinB,GAAmBN,EAG7B,OAFAlQ,EAAaiN,eAAc,GAC3BpL,EAAUtY,MAAM,2DACT,EACD,IAAIknB,GAAmBJ,EAG7B,OAFArQ,EAAaiN,eAAc,GAC3BpL,EAAUtY,MAAM,2DACT,EAIT,IAAImnB,EAAiB,CACpB7D,SAAQgD,GAAejL,EAAMkI,YAAae,EAC1C/B,SAAQkE,GAAepL,EAAMmI,YAAae,GAE3CnT,GAAM0C,MAAM,2BAA4BqT,GACnCA,EAAe7D,OAAU6D,EAAe5E,MAI5ChR,UAAUC,aAAaoT,aAAauC,GAClC3nB,MAAK,SAAS8b,GACd7E,EAAaiN,eAAc,GAC3BtI,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAWgD,MAC5Cvb,OAAM,SAASC,GACjByW,EAAaiN,eAAc,GAC3BpL,EAAUtY,MAAM,CAAC2X,KAAM3X,EAAM2X,KAAMrR,KAAMtG,EAAMsG,KAAMyS,QAAS/Y,EAAM+Y,cATtEtC,EAAaiN,eAAc,GAC3BtI,EAAYtC,EAAUhB,EAAMuD,EAAO/C,EAAWgD,OAY/Cvb,OAAM,SAASC,GACfyW,EAAaiN,eAAc,GAC3BpL,EAAUtY,MAAM,yBAA0BA,WAK5Cob,EAAYtC,EAAUhB,EAAMuD,EAAO/C,GAIrC,SAAS8O,EAAkBtO,EAAUR,IACpCA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQqjB,EAC7E,IAAIvL,EAAOQ,EAAUR,KACjBrB,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAGjC,OAFAvF,GAAMiF,KAAK,uBACXiC,EAAUtY,MAAM,kBAGjB,IAAIU,EAAS+V,EAAaE,YAC1B,GAAGmB,EAAM,CACR,IAAIpX,EAAOkW,GAGV,OAFAxF,GAAMiF,KAAK,kGACXiC,EAAUtY,MAAM,sFAGjBU,EAAOkW,GAAG0J,qBAAqBxI,GAC7BtY,MAAK,WAIL,GAHA4R,GAAMlR,IAAI,gCACVQ,EAAOmW,UAAYiB,EAAKkB,IAErBtY,EAAOuW,YAAcvW,EAAOuW,WAAW5U,OAAS,EAAG,CACrD,IAAI,IAAIF,EAAI,EAAGA,EAAGzB,EAAOuW,WAAW5U,OAAQF,IAAK,CAChD,IAAIuU,EAAYhW,EAAOuW,WAAW9U,GAClCiP,GAAM0C,MAAM,2BAA4B4C,GACpCA,IAAqC,IAAxBA,EAAUI,UAK1BpW,EAAOkW,GAAGG,gBAAgBL,GAH1BhW,EAAOkW,GAAGG,gBAAgB3F,GAAM4F,iBAMlCtW,EAAOuW,WAAa,GAGrBqB,EAAUpF,YACRoF,EAAUtY,YAEdsY,EAAUtY,MAAM,gBA6dlB,SAASqnB,EAAUvO,EAAUwO,GAC5B,IAAI7Q,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAEjC,OADAvF,GAAMiF,KAAK,kBACJ,EAER,IAAIiF,EAASgM,EAAS,SAAW,QAC7B5mB,EAAS+V,EAAaE,YAK1B,OAJIjW,EAAOkd,OAAOtC,KACjB5a,EAAOkd,OAAOtC,GAAU,CAAEtW,MAAO,KAG/BtE,EAAOkW,GAAG+G,UAA4D,WAA/CvM,GAAMyL,cAAcC,eAAeC,SACZ,WAA/C3L,GAAMyL,cAAcC,eAAeC,SA4BpC3L,GAAMiF,KAAK,eAAiBiF,EAAS,kCAC9B,GA5BJgM,IAAW5mB,EAAOke,cACpBxN,GAAMiF,KAAK,6BACJ,GACGiR,GAAW5mB,EAAOgb,SAIzBhb,EAAOkd,OAAOtC,GAAQiM,MAgBnB7mB,EAAOkd,OAAOtC,GAAQtW,OAf5BoM,GAAMlR,IAAI,YAAcob,EAAS,mBACjC5a,EAAOkd,OAAOtC,GAAQiM,MAAQrB,aAAY,WACzCxlB,EAAOkW,GAAG+G,WACRne,MAAK,SAASgoB,GACdA,EAAM7H,SAAQ,SAAU8H,GACnBA,GAAoB,UAAbA,EAAIhN,OAEX6M,IAAWG,EAAIC,eAAmBJ,GAAuB,iBAAbG,EAAI7nB,OAEpDc,EAAOkd,OAAOtC,GAAQtW,MAASyiB,EAAIE,WAAaF,EAAIE,WAAa,YAGlE,KACI,IAjBPvW,GAAMiF,KAAK,4BACJ,GA2BV,SAASuR,EAAQ9O,EAAUyJ,GAC1B,IAAI9L,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAEjC,OADAvF,GAAMiF,KAAK,mBACJ,EAER,IAAI3V,EAAS+V,EAAaE,YAC1B,OAAIjW,EAAOkW,GAIPlW,EAAOgb,SAIR6G,EAEE7hB,EAAOgb,SAASF,kBAAgE,IAA5C9a,EAAOgb,SAASF,iBAAiBnZ,QAIjE3B,EAAOgb,SAASF,iBAAiB,GAAGqM,SAH3CzW,GAAMiF,KAAK,mBACJ,GAKJ3V,EAAOgb,SAASH,kBAAgE,IAA5C7a,EAAOgb,SAASH,iBAAiBlZ,QAIjE3B,EAAOgb,SAASH,iBAAiB,GAAGsM,SAH3CzW,GAAMiF,KAAK,mBACJ,IAdRjF,GAAMiF,KAAK,8BACJ,IALPjF,GAAMiF,KAAK,2BACJ,GAuBT,SAASyR,EAAKhP,EAAUyJ,EAAOuF,GAC9B,IAAIrR,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAEjC,OADAvF,GAAMiF,KAAK,mBACJ,EAER,IAAI3V,EAAS+V,EAAaE,YAC1B,OAAIjW,EAAOkW,GAIPlW,EAAOgb,SAIR6G,EAEE7hB,EAAOgb,SAASF,kBAAgE,IAA5C9a,EAAOgb,SAASF,iBAAiBnZ,QAIzE3B,EAAOgb,SAASF,iBAAiB,GAAGqM,SAAWC,GACxC,IAJN1W,GAAMiF,KAAK,mBACJ,GAMJ3V,EAAOgb,SAASH,kBAAgE,IAA5C7a,EAAOgb,SAASH,iBAAiBlZ,QAIzE3B,EAAOgb,SAASH,iBAAiB,GAAGsM,SAAWC,GACxC,IAJN1W,GAAMiF,KAAK,mBACJ,IAfRjF,GAAMiF,KAAK,8BACJ,IALPjF,GAAMiF,KAAK,2BACJ,GAyBT,SAAS0R,EAAWjP,GACnB,IAAIrC,EAAelB,EAAcuD,GACjC,IAAIrC,IAAiBA,EAAaE,YAEjC,OADAvF,GAAMiF,KAAK,kBACJ,iBAER,IAAI3V,EAAS+V,EAAaE,YAC1B,OAAIjW,EAAOkW,GAGRlW,EAAOkW,GAAG+G,SACRjd,EAAOmd,QAAQ0J,MA8CZ7mB,EAAOmd,QAAQ7Y,OA7CrBoM,GAAMlR,IAAI,yCACVQ,EAAOmd,QAAQ0J,MAAQrB,aAAY,WAClCxlB,EAAOkW,GAAG+G,WACRne,MAAK,SAASgoB,GACdA,EAAM7H,SAAQ,SAAU8H,GACvB,GAAIA,EAAJ,CAEA,IAAIO,GAAU,EAYd,IAVsB,UAAlBP,EAAIQ,WAAyBR,EAAIrnB,GAAG8nB,cAAcnU,QAAQ,UAAY,IAC3D,gBAAb0T,EAAI7nB,MAA0B6nB,EAAIrnB,GAAG2T,QAAQ,QAAU,EAExDiU,GAAU,EACW,QAAZP,EAAI7nB,OAAkB6nB,EAAIU,eACX,QAAtBV,EAAIW,eAAiD,KAAtBX,EAAIW,gBAErCJ,GAAU,GAGRA,EAGF,GAFAtnB,EAAOmd,QAAQwK,MAAQZ,EAAIU,cAC3BznB,EAAOmd,QAAQyK,MAAQb,EAAIc,UACI,OAA5B7nB,EAAOmd,QAAQ2K,UAAiD,OAA5B9nB,EAAOmd,QAAQ4K,SAErD/nB,EAAOmd,QAAQ2K,SAAW9nB,EAAOmd,QAAQwK,MACzC3nB,EAAOmd,QAAQ4K,SAAW/nB,EAAOmd,QAAQyK,UACnC,CAEN,IAAII,EAAahoB,EAAOmd,QAAQyK,MAAQ5nB,EAAOmd,QAAQ4K,SACL,WAA/CrX,GAAMyL,cAAcC,eAAeC,UACrC2L,GAAwB,KACzB,IAAIC,EAAU3F,KAAK4F,MAAyD,GAAlDloB,EAAOmd,QAAQwK,MAAQ3nB,EAAOmd,QAAQ2K,UAAgBE,GAC9B,WAA/CtX,GAAMyL,cAAcC,eAAeC,UACrC4L,EAAU9W,SAAS8W,EAAQ,MAC5BjoB,EAAOmd,QAAQ7Y,MAAQ2jB,EAAU,aAEjCjoB,EAAOmd,QAAQ2K,SAAW9nB,EAAOmd,QAAQwK,MACzC3nB,EAAOmd,QAAQ4K,SAAW/nB,EAAOmd,QAAQyK,gBAK5C,KACI,gBAIRlX,GAAMiF,KAAK,oDACJ,kCApDA,yBAwDT,SAASgN,EAAYrjB,GACpBoR,GAAMpR,MAAM,gBAAiBA,GAG9B,SAASmb,EAAcrC,EAAU+P,GAChCzX,GAAMlR,IAAI,yBACV,IAAIuW,EAAelB,EAAcuD,GACjC,GAAIrC,EAAJ,CAIA,IAAI/V,EAAS+V,EAAaE,YAC1B,GAAGjW,EAAQ,CACV,IAAqB,IAAlBmoB,EAAwB,CAE1B,IAAI3Q,EAAU,CAAE,MAAS,SAAU,YAAe9G,GAAM+G,aAAa,KAClE1B,EAAa3X,QACfoZ,EAAO,MAAYzB,EAAa3X,OAC9B4V,IACFwD,EAAO,UAAgBxD,GACxBtD,GAAM0C,MAAM,kCAAoCgF,EAAW,MAC3D1H,GAAM0C,MAAMoE,GACT3E,GACF2E,EAAO,WAAiB5C,EACxB4C,EAAO,UAAgBY,EACvBtF,EAAG4E,KAAK3O,KAAKC,UAAUwO,KAEvB9G,GAAM2E,YAAYtX,EAAS,IAAM6W,EAAY,IAAMwD,EAAU,CAC5D9C,KAAM,OACN1B,gBAAiBA,EACjB/L,KAAM2P,IAKTxX,EAAOke,aAAe,KACnBle,EAAOkd,SACNld,EAAOkd,OAAP,OAA0Bld,EAAOkd,OAAP,MAAuB2J,OACnDpB,cAAczlB,EAAOkd,OAAP,MAAuB2J,OACnC7mB,EAAOkd,OAAP,QAA2Bld,EAAOkd,OAAP,OAAwB2J,OACrDpB,cAAczlB,EAAOkd,OAAP,OAAwB2J,QAExC7mB,EAAOkd,OAAS,GACbld,EAAOmd,QAAQ0J,OACjBpB,cAAczlB,EAAOmd,QAAQ0J,OAC9B7mB,EAAOmd,QAAQ0J,MAAQ,KACvB7mB,EAAOmd,QAAQwK,MAAQ,KACvB3nB,EAAOmd,QAAQ2K,SAAW,KAC1B9nB,EAAOmd,QAAQyK,MAAQ,KACvB5nB,EAAOmd,QAAQ4K,SAAW,KAC1B/nB,EAAOmd,QAAQ7Y,MAAQ,KACvB,IAEC,IAAItE,EAAOkb,gBAAkBlb,EAAOgb,SAAU,CAC7CtK,GAAMlR,IAAI,gCACV,IAAIgkB,EAASxjB,EAAOgb,SAASgE,YAFgB,uBAG7C,IAAI,IAAJ,EAAQ,EAAOwE,EAAf,+CAAuB,CAAC,IAAhBC,EAAe,QACtB/S,GAAMlR,IAAIikB,GACPA,GACFA,EAAIP,QANuC,oFAS7C,MAAMpd,IAGR9F,EAAOkb,gBAAiB,EACxBlb,EAAOgb,SAAW,KAElB,IACChb,EAAOkW,GAAGxJ,QACT,MAAM5G,IAGR9F,EAAOkW,GAAK,KACZlW,EAAOuW,WAAa,KACpBvW,EAAO0d,MAAQ,KACf1d,EAAOmW,UAAY,KACnBnW,EAAOyd,SAAU,EACjBzd,EAAOiZ,YAAc,GACrBjZ,EAAO0Z,WAAa,KACpB1Z,EAAO8c,iBAAmB,KAC1B9c,EAAO+c,mBAAqB,KAE7BhH,EAAaqS,aA6Md,SAASjN,EAAmBR,GAE3B,OADAjK,GAAM0C,MAAM,sBAAuBuH,IAC/BA,IAEe,IAAhBA,EAAMiI,aAEc/O,IAApB8G,EAAMqF,WAA+C,OAApBrF,EAAMqF,YAEd,IAApBrF,EAAMqF,WAcf,SAASE,EAAmBvF,GAE3B,OADAjK,GAAM0C,MAAM,sBAAuBuH,IAC/BA,IAEe,IAAhBA,EAAMiI,aAEc/O,IAApB8G,EAAMsF,WAA+C,OAApBtF,EAAMsF,YAEd,IAApBtF,EAAMsF,WAGf,SAASnE,EAAmBnB,GAE3B,OADAjK,GAAM0C,MAAM,sBAAuBuH,IAC/BA,IAEe,IAAhBA,EAAMkH,aAEchO,IAApB8G,EAAM0F,WAA+C,OAApB1F,EAAM0F,YAEd,IAApB1F,EAAM0F,WAcf,SAASE,EAAmB5F,GAE3B,OADAjK,GAAM0C,MAAM,sBAAuBuH,IAC/BA,IAEe,IAAhBA,EAAMkH,aAEchO,IAApB8G,EAAM2F,WAA+C,OAApB3F,EAAM2F,YAEd,IAApB3F,EAAM2F,WAl6Ff3I,EAAcpF,GAGd/Q,KAAK6mB,UAAY,WAAa,OAAOtqB,GACrCyD,KAAK8mB,YAAc,WAAa,OAAO3T,GACvCnT,KAAK+mB,UAAY,SAAS3Q,IACzBA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnFmF,EAAS,WAAgB,EACzBD,EAAcC,IAEfpW,KAAKgnB,aAAe,WAAa,OAAO5T,GACxCpT,KAAKinB,QAAU,SAAS7Q,IAyZxB,SAAwBA,IACvBA,EAAYA,GAAa,IAEfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnF,IAAIiW,GAA+B,IAArB9Q,EAAU8Q,OACpBC,GAAkB,OACW9U,IAA9B+D,EAAU+Q,iBAA+D,OAA9B/Q,EAAU+Q,kBACvDA,GAAiD,IAA9B/Q,EAAU+Q,iBAC9B,IAAIC,GAA+C,IAA7BhR,EAAUgR,eAEhC,GADAlY,GAAMlR,IAAI,sBAAwBoV,EAAY,YAAc8T,EAAS,MACjE9T,EAKH,OAJAlE,GAAMiF,KAAK,yBACXiC,EAAUpF,eACPmW,GACFpW,EAAiBG,aAGnB,GAAGkW,EACF,IAAI,IAAIxQ,KAAYvD,EACnB0F,EAAcnC,EAAU,CAAEoC,WAAW,IAEvC,IAAI7F,EAIH,OAHAjE,GAAMiF,KAAK,yCACXf,EAAY,UACZgD,EAAUpF,UAIX,IAAIgF,EAAU,CAAE,MAAS,UAAW,YAAe9G,GAAM+G,aAAa,KACnErZ,IACFoZ,EAAO,MAAYpZ,GACjB4V,IACFwD,EAAO,UAAgBxD,GACxB,GAAG0U,EAgBF,OAbG7V,GACFC,EAAGiF,QAAU,KACbjF,EAAGpG,QACHoG,EAAK,MAELjC,UAAUgY,WAAW9qB,EAAS,IAAM6W,EAAW7L,KAAKC,UAAUwO,IAE/D9G,GAAMlR,IAAI,sBACVoV,EAAY,KACZD,GAAY,EACZiD,EAAUpF,eACPmW,GACFpW,EAAiBG,aAGnB,GAAGG,EAAY,CACd2E,EAAO,WAAiB5C,EAExB,IAAIkU,EAAkB,WACrB,IAAI,IAAI9Q,KAAajF,EACpBD,EAAGiW,oBAAoB/Q,EAAWjF,EAAWiF,IAE9ClF,EAAGiW,oBAAoB,UAAWC,GAClClW,EAAGiW,oBAAoB,QAASE,GAC7BjW,GACFV,aAAaU,GAEdF,EAAGpG,SAGAsc,EAAkB,SAAS5W,GAC9B,IAAIhT,EAAO2J,KAAKmP,MAAM9F,EAAMhT,MACzBA,EAAK8pB,YAAc1R,EAAQ0R,YAAc9pB,EAAK2X,aAAeS,EAAQT,cACvE+R,IACAlR,EAAUpF,UACPmW,GACFpW,EAAiBG,cAGhBuW,EAAgB,SAAS7W,GAC5B0W,IACAlR,EAAUtY,MAAM,qDACbqpB,GACFpW,EAAiBG,aAOnB,OAJAI,EAAGX,iBAAiB,UAAW6W,GAC/BlW,EAAGX,iBAAiB,QAAS8W,QAE7BnW,EAAG4E,KAAK3O,KAAKC,UAAUwO,IAGxB9G,GAAM2E,YAAYtX,EAAS,IAAM6W,EAAW,CAC3CU,KAAM,OACN1B,gBAAiBA,EACjB/L,KAAM2P,EACNhF,QAAS,SAASoD,GACjBlF,GAAMlR,IAAI,sBACVkR,GAAM0C,MAAMwC,GACZhB,EAAY,KACZD,GAAY,EACS,YAAlBiB,EAAI,OACNlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,QAElEU,EAAUpF,UACPmW,GACFpW,EAAiBG,aAEnBpT,MAAO,SAASmW,EAAYC,GAC3BhF,GAAMpR,MAAMmW,EAAa,IAAKC,GAE9Bd,EAAY,KACZD,GAAY,EACZiD,EAAUpF,UACPmW,GACFpW,EAAiBG,eAzgBgByW,CAAevR,IACpDpW,KAAK4nB,OAAS,SAASxR,IA8gBvB,SAAsBA,GAgBrB,IAfAA,EAAYA,GAAa,IACfpF,QAAuC,mBAArBoF,EAAUpF,QAAyBoF,EAAUpF,QAAU9B,GAAM+B,KACzFmF,EAAUtY,MAAmC,mBAAnBsY,EAAUtY,MAAuBsY,EAAUtY,MAAQoR,GAAM+B,KACnFmF,EAAUoL,cAAmD,mBAA3BpL,EAAUoL,cAA+BpL,EAAUoL,cAAgBtS,GAAM+B,KAC3GmF,EAAU0F,SAAyC,mBAAtB1F,EAAU0F,SAA0B1F,EAAU0F,SAAW5M,GAAM+B,KAC5FmF,EAAUf,WAA6C,mBAAxBe,EAAUf,WAA4Be,EAAUf,WAAanG,GAAM+B,KAClGmF,EAAUpB,YAA+C,mBAAzBoB,EAAUpB,YAA6BoB,EAAUpB,YAAc9F,GAAM+B,KACrGmF,EAAUd,SAAyC,mBAAtBc,EAAUd,SAA0Bc,EAAUd,SAAWpG,GAAM+B,KAC5FmF,EAAUP,UAA2C,mBAAvBO,EAAUP,UAA2BO,EAAUP,UAAY3G,GAAM+B,KAC/FmF,EAAU+H,cAAmD,mBAA3B/H,EAAU+H,cAA+B/H,EAAU+H,cAAgBjP,GAAM+B,KAC3GmF,EAAUuG,eAAqD,mBAA5BvG,EAAUuG,eAAgCvG,EAAUuG,eAAiBzN,GAAM+B,KAC9GmF,EAAU0B,OAAqC,mBAApB1B,EAAU0B,OAAwB1B,EAAU0B,OAAS5I,GAAM+B,KACtFmF,EAAUuB,WAA6C,mBAAxBvB,EAAUuB,WAA4BvB,EAAUuB,WAAazI,GAAM+B,KAClGmF,EAAUwQ,UAA2C,mBAAvBxQ,EAAUwQ,UAA2BxQ,EAAUwQ,UAAY1X,GAAM+B,KAC/FmF,EAAUjB,WAA6C,mBAAxBiB,EAAUjB,WAA4BiB,EAAUjB,WAAajG,GAAM+B,MAC9FkC,EAGH,OAFAjE,GAAMiF,KAAK,8CACXiC,EAAUtY,MAAM,yCAGjB,IAAI+pB,EAASzR,EAAUyR,OACvB,IAAIA,EAGH,OAFA3Y,GAAMpR,MAAM,uBACZsY,EAAUtY,MAAM,kBAGjB,IAAIgqB,EAAW1R,EAAU0R,SACrBC,EAAc3R,EAAUxZ,MAAQwZ,EAAUxZ,MAAQA,EAClD2Y,EAAcrG,GAAM+G,aAAa,IACjCD,EAAU,CAAE,MAAS,SAAU,OAAU6R,EAAQ,UAAaC,EAAU,YAAevS,GACxFwS,IACF/R,EAAO,MAAY+R,GACjBvV,IACFwD,EAAO,UAAgBxD,GACxB,GAAGnB,EAgFF,OA/EAmC,EAAa+B,GAAe,SAASnB,GAEpC,GADAlF,GAAM0C,MAAMwC,GACS,YAAlBA,EAAI,MAGN,OAFAlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,aACjEU,EAAUtY,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,QAGtE,IAAIkB,EAAWxC,EAAKxW,KAAL,GACfsR,GAAMlR,IAAI,mBAAqB4Y,GAC/B,IAAIrC,EACH,CACCyT,QAAU1U,EACVuU,OAASA,EACT3pB,GAAK0Y,EACLha,MAAQmrB,EACR7S,UAAW,EACXT,YAAc,CACbwT,SAAU,EACVzO,SAAW,KACXE,gBAAiB,EACjBgD,aAAe,KACfR,MAAQ,KACRqC,iBAAmB,KACnB7J,GAAK,KACL+C,YAAc,GACdS,WAAa,KACb0D,SAAU,EACVK,SAAU,EACVP,OAAS,CACR5Y,MAAQ,KACRuiB,MAAQ,MAET1J,QAAU,CACT7Y,MAAQ,KACRqjB,MAAQ,KACRG,SAAW,KACXF,MAAQ,KACRG,SAAW,KACXlB,MAAQ,OAGV6C,MAAQ,WAAa,OAAOtR,GAC5BuR,UAAY,WAAa,OAAON,GAChC1C,UAAY,WAAa,OAAOA,EAAUvO,GAAU,IACpDwR,gBAAkB,WAAa,OAAOjD,EAAUvO,GAAU,IAC1DyR,eAAiB,WAAa,OAAOlD,EAAUvO,GAAU,IACzD0R,aAAe,WAAa,OAAO5C,EAAQ9O,GAAU,IACrD2R,UAAY,WAAa,OAAO3C,EAAKhP,GAAU,GAAO,IACtD4R,YAAc,WAAa,OAAO5C,EAAKhP,GAAU,GAAO,IACxD6R,aAAe,WAAa,OAAO/C,EAAQ9O,GAAU,IACrD8R,UAAY,WAAa,OAAO9C,EAAKhP,GAAU,GAAM,IACrD+R,YAAc,WAAa,OAAO/C,EAAKhP,GAAU,GAAM,IACvDiP,WAAa,WAAa,OAAOA,EAAWjP,IAC5CV,KAAO,SAASE,GAAaO,EAAYC,EAAUR,IACnDxY,KAAO,SAASwY,GAAa2B,EAASnB,EAAUR,IAChDoC,KAAO,SAASpC,GAAa6B,EAASrB,EAAUR,IAChDoL,cAAgBpL,EAAUoL,cAC1B1F,SAAW1F,EAAU0F,SACrBzG,WAAae,EAAUf,WACvBL,YAAcoB,EAAUpB,YACxBM,SAAWc,EAAUd,SACrBO,UAAYO,EAAUP,UACtBoK,YAAc,SAAS7J,GAAa8K,EAActK,GAAU,EAAMR,IAClEwJ,aAAe,SAASxJ,GAAa8K,EAActK,GAAU,EAAOR,IACpEwS,iBAAmB,SAASxS,GAAa8O,EAAkBtO,EAAUR,IACrE+H,cAAgB/H,EAAU+H,cAC1BxB,eAAiBvG,EAAUuG,eAC3B7E,OAAS1B,EAAU0B,OACnBH,WAAavB,EAAUuB,WACvBiP,UAAYxQ,EAAUwQ,UACtBzR,WAAaiB,EAAUjB,WACvBF,OAAS,SAAS4T,GAAe5P,EAAcrC,GAA0B,IAAhBiS,IACzDzT,OAAS,SAASgB,GAAa2C,EAAcnC,EAAUR,KAEzD/C,EAAcuD,GAAYrC,EAC1B6B,EAAUpF,QAAQuD,IAEnByB,EAAO,WAAiB5C,OACxB9B,EAAG4E,KAAK3O,KAAKC,UAAUwO,IAGxB9G,GAAM2E,YAAYtX,EAAS,IAAM6W,EAAW,CAC3CU,KAAM,OACN1B,gBAAiBA,EACjB/L,KAAM2P,EACNhF,QAAS,SAASoD,GAEjB,GADAlF,GAAM0C,MAAMwC,GACS,YAAlBA,EAAI,MAGN,OAFAlF,GAAMpR,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,aACjEU,EAAUtY,MAAM,UAAYsW,EAAI,MAAUqB,KAAO,IAAMrB,EAAI,MAAUsB,QAGtE,IAAIkB,EAAWxC,EAAKxW,KAAL,GACfsR,GAAMlR,IAAI,mBAAqB4Y,GAC/B,IAAIrC,EACH,CACCyT,QAAU1U,EACVuU,OAASA,EACT3pB,GAAK0Y,EACLha,MAAQmrB,EACR7S,UAAW,EACXT,YAAc,CACbwT,SAAU,EACVzO,SAAW,KACXE,gBAAiB,EACjBgD,aAAe,KACfR,MAAQ,KACRqC,iBAAmB,KACnB7J,GAAK,KACL+C,YAAc,GACdS,WAAa,KACb0D,SAAU,EACVK,SAAU,EACVP,OAAS,CACR5Y,MAAQ,KACRuiB,MAAQ,MAET1J,QAAU,CACT7Y,MAAQ,KACRqjB,MAAQ,KACRG,SAAW,KACXF,MAAQ,KACRG,SAAW,KACXlB,MAAQ,OAGV6C,MAAQ,WAAa,OAAOtR,GAC5BuR,UAAY,WAAa,OAAON,GAChC1C,UAAY,WAAa,OAAOA,EAAUvO,GAAU,IACpDwR,gBAAkB,WAAa,OAAOjD,EAAUvO,GAAU,IAC1DyR,eAAiB,WAAa,OAAOlD,EAAUvO,GAAU,IACzD0R,aAAe,WAAa,OAAO5C,EAAQ9O,GAAU,IACrD2R,UAAY,WAAa,OAAO3C,EAAKhP,GAAU,GAAO,IACtD4R,YAAc,WAAa,OAAO5C,EAAKhP,GAAU,GAAO,IACxD6R,aAAe,WAAa,OAAO/C,EAAQ9O,GAAU,IACrD8R,UAAY,WAAa,OAAO9C,EAAKhP,GAAU,GAAM,IACrD+R,YAAc,WAAa,OAAO/C,EAAKhP,GAAU,GAAM,IACvDiP,WAAa,WAAa,OAAOA,EAAWjP,IAC5CV,KAAO,SAASE,GAAaO,EAAYC,EAAUR,IACnDxY,KAAO,SAASwY,GAAa2B,EAASnB,EAAUR,IAChDoC,KAAO,SAASpC,GAAa6B,EAASrB,EAAUR,IAChDoL,cAAgBpL,EAAUoL,cAC1B1F,SAAW1F,EAAU0F,SACrBzG,WAAae,EAAUf,WACvBL,YAAcoB,EAAUpB,YACxBM,SAAWc,EAAUd,SACrBO,UAAYO,EAAUP,UACtBoK,YAAc,SAAS7J,GAAa8K,EAActK,GAAU,EAAMR,IAClEwJ,aAAe,SAASxJ,GAAa8K,EAActK,GAAU,EAAOR,IACpEwS,iBAAmB,SAASxS,GAAa8O,EAAkBtO,EAAUR,IACrE+H,cAAgB/H,EAAU+H,cAC1BxB,eAAiBvG,EAAUuG,eAC3B7E,OAAS1B,EAAU0B,OACnBH,WAAavB,EAAUuB,WACvBiP,UAAYxQ,EAAUwQ,UACtBzR,WAAaiB,EAAUjB,WACvBF,OAAS,SAAS4T,GAAe5P,EAAcrC,GAA0B,IAAhBiS,IACzDzT,OAAS,SAASgB,GAAa2C,EAAcnC,EAAUR,KAEzD/C,EAAcuD,GAAYrC,EAC1B6B,EAAUpF,QAAQuD,IAEnBzW,MAAO,SAASmW,EAAYC,GAC3BhF,GAAMpR,MAAMmW,EAAa,IAAKC,GACX,KAAhBA,EACFkC,EAAUtY,MAAMmW,EAAa,yBAE7BmC,EAAUtY,MAAMmW,EAAa,KAAOC,MAztBJ4U,CAAa1S,IArclDlH,GAAM6Z,uBAAyB,SAAUC,GACxC,IAAIC,EAAKD,GAAQA,EAAKE,OAAUA,MAC5BC,EAAKH,GAAQA,EAAKI,SAAYA,QAC9BC,EAAaL,GAAQA,EAAKM,WAAcA,UAE5C,MAAO,CACN7S,aAAc,SAASla,EAAQgtB,GAAS,OAAO,IAAIF,EAAU9sB,EAAQgtB,IACrE1Z,UAAYmZ,GAAQA,EAAKnZ,WAAcE,GACvC4B,QAAS,SAAS6X,GAAO,OAAOC,MAAM9X,QAAQ6X,IAC9C7O,cAAgBqO,GAAQA,EAAKU,SAAYA,KACzC7V,YAAa,SAASzV,EAAKiF,GAC1B,IAAIsmB,EAAe,CAClBC,OAAQvmB,EAAQyQ,KAChBzW,QAAS,CACR,OAAU,qCAEXmT,MAAO,YAEY,SAAjBnN,EAAQyQ,OACV6V,EAAatsB,QAAQ,gBAAkB,yBAETgV,IAA5BhP,EAAQ+O,kBACVuX,EAAaE,aAA0C,IAA5BxmB,EAAQ+O,gBAA2B,UAAa/O,EAAQ+O,gBAAkB/O,EAAQ+O,gBAAkB,QAE7H/O,EAAQgD,OACVsjB,EAAatjB,KAAOkB,KAAKC,UAAUnE,EAAQgD,OAG5C,IAAIyjB,EAAWb,EAAE7qB,EAAKurB,GAAc9rB,OAAM,SAASC,GAClD,OAAOqrB,EAAEY,OAAO,CAAClT,QAAS,gDAAiD/Y,MAAOA,OAQnF,GAAGuF,EAAQ2Q,QAAS,CACnB,IAAIA,EAAU,IAAImV,GAAE,SAASa,EAASD,GACrC,IAAIE,EAAU3Z,YAAW,WAExB,OADAQ,aAAamZ,GACNF,EAAO,CAAClT,QAAS,oBAAqB7C,QAAS3Q,EAAQ2Q,YAC5D3Q,EAAQ2Q,YAEZ8V,EAAWX,EAAEe,KAAK,CAACJ,EAAU9V,IAsB9B,OAnBA8V,EAASxsB,MAAK,SAASC,GACtB,OAAGA,EAAS4sB,UACD9mB,EAAQ2N,iBAAoB9B,GAAM+B,KACpC1T,EAAS6W,OAAO9W,MAAK,SAAS8sB,GACpC/mB,EAAQ2N,QAAQoZ,MACdvsB,OAAM,SAASC,GACjB,OAAOqrB,EAAEY,OAAO,CAAClT,QAAS,gCAAiC/Y,MAAOA,EAAOP,SAAUA,YAJrF,EASO4rB,EAAEY,OAAO,CAAClT,QAAS,kBAAmBtZ,SAAUA,OAEtDM,OAAM,SAASC,UACPuF,EAAQvF,eAAkBoR,GAAM+B,MACzC5N,EAAQvF,MAAMA,EAAM+Y,SAAW,uBAAwB/Y,MAIlDgsB,KAKV5a,GAAMmb,mBAAqB,SAAUrB,GACpC,IAAIsB,EAAMtB,GAAQA,EAAKuB,QAAWA,KAC9BlB,EAAaL,GAAQA,EAAKM,WAAcA,UAC5C,MAAO,CACN7S,aAAc,SAASla,EAAQgtB,GAAS,OAAO,IAAIF,EAAU9sB,EAAQgtB,IACrE5X,QAAS,SAAS6X,GAAO,OAAOc,EAAG3Y,QAAQ6X,IAC3C3Z,UAAYmZ,GAAQA,EAAKnZ,WAAcE,GACvC4K,cAAgBqO,GAAQA,EAAKU,SAAYA,KACzC7V,YAAa,SAASzV,EAAKiF,GAC1B,IAAImnB,OAA2BnY,IAAjBhP,EAAQgD,KAAqB,CAC1CokB,YAAa,mBACb7sB,KAAM2J,KAAKC,UAAUnE,EAAQgD,OAC1B,GACAwjB,OAA0CxX,IAA5BhP,EAAQ+O,gBAAgC,CAACsY,UAAW,CAACtY,gBAAiB/O,EAAQ+O,kBAAoB,GAEpH,OAAOkY,EAAGK,KAAKL,EAAGM,OAAOJ,EAASX,EAAa,CAC9CzrB,IAAKA,EACLV,KAAM2F,EAAQyQ,KACdtD,OAAO,EACPqa,SAAU,OACVC,MAAOznB,EAAQynB,MACf9W,QAAS3Q,EAAQ2Q,QACjBhD,QAAS,SAASrO,UACPU,EAAQ2N,iBAAoB9B,GAAM+B,MAC3C5N,EAAQ2N,QAAQrO,IAGlB7E,MAAO,SAASitB,EAAKC,EAAQpH,UAClBvgB,EAAQvF,eAAkBoR,GAAM+B,MACzC5N,EAAQvF,MAAMktB,EAAQpH,UAQ5B1U,GAAM+B,KAAO,aAEb/B,GAAM8I,qBAAuB,mBAI7B9I,GAAM4F,gBAAkB,KAGxB5F,GAAMwB,KAAO,SAASrN,GAGrB,IAFAA,EAAUA,GAAW,IACb+M,SAAuC,mBAApB/M,EAAQ+M,SAA0B/M,EAAQ+M,SAAWlB,GAAM+B,KACnF/B,GAAMiC,SAER9N,EAAQ+M,eACF,CAWN,GAVqB,oBAAXrS,SAAgD,oBAAfA,QAAQC,MAClDD,QAAU,CAAEC,IAAK,eAGlBkR,GAAM+b,MAAQ/b,GAAM+B,KACpB/B,GAAM0C,MAAQ1C,GAAM+B,KACpB/B,GAAM4G,OAAS5G,GAAM+B,KACrB/B,GAAMlR,IAAMkR,GAAM+B,KAClB/B,GAAMiF,KAAOjF,GAAM+B,KACnB/B,GAAMpR,MAAQoR,GAAM+B,MACC,IAAlB5N,EAAQuO,OAAoC,QAAlBvO,EAAQuO,MAEpC1C,GAAM+b,MAAQltB,QAAQktB,MAAMlqB,KAAKhD,SACjCmR,GAAM0C,MAAQ7T,QAAQ6T,MAAM7Q,KAAKhD,SACjCmR,GAAM4G,OAAS/X,QAAQ6T,MAAM7Q,KAAKhD,SAClCmR,GAAMlR,IAAMD,QAAQC,IAAI+C,KAAKhD,SAC7BmR,GAAMiF,KAAOpW,QAAQoW,KAAKpT,KAAKhD,SAC/BmR,GAAMpR,MAAQC,QAAQD,MAAMiD,KAAKhD,cAC3B,GAAG0rB,MAAM9X,QAAQtO,EAAQuO,OAAQ,CAAC,IAAD,uBACvC,IAAI,IAAJ,EAAQ,EAAKvO,EAAQuO,MAArB,+CAA4B,CAAC,IAArBsZ,EAAoB,QAC3B,OAAOA,GACN,IAAK,QACJhc,GAAM+b,MAAQltB,QAAQktB,MAAMlqB,KAAKhD,SACjC,MACD,IAAK,QACJmR,GAAM0C,MAAQ7T,QAAQ6T,MAAM7Q,KAAKhD,SACjC,MACD,IAAK,SACJmR,GAAM4G,OAAS/X,QAAQ6T,MAAM7Q,KAAKhD,SAClC,MACD,IAAK,MACJmR,GAAMlR,IAAMD,QAAQC,IAAI+C,KAAKhD,SAC7B,MACD,IAAK,OACJmR,GAAMiF,KAAOpW,QAAQoW,KAAKpT,KAAKhD,SAC/B,MACD,IAAK,QACJmR,GAAMpR,MAAQC,QAAQD,MAAMiD,KAAKhD,SACjC,MACD,QACCA,QAAQD,MAAM,6BAA+BotB,EAAI,sEAtBb,mFA2BxChc,GAAMlR,IAAI,wBAEV,IAAImtB,EAAmB9nB,EAAQ+nB,cAAgBlc,GAAM6Z,yBACrD7Z,GAAMyC,QAAUwZ,EAAiBxZ,QACjCzC,GAAMyL,cAAgBwQ,EAAiBxQ,cACvCzL,GAAM2E,YAAcsX,EAAiBtX,YACrC3E,GAAMuH,aAAe0U,EAAiB1U,aACtCvH,GAAMW,UAAYsb,EAAiBtb,UACnCX,GAAMW,UAAUa,OAGhBxB,GAAMmc,YAAc,SAASjb,EAAU5R,GACtC4R,EAA+B,mBAAZA,EAA0BA,EAAWlB,GAAM+B,KAChD,MAAVzS,IAAgBA,EAAS,CAAE4iB,OAAO,EAAMf,OAAO,IAChDnR,GAAMgT,0BACR7S,UAAUC,aAAaoT,aAAalkB,GACnClB,MAAK,SAAS8b,GACd/J,UAAUC,aAAa4U,mBAAmB5mB,MAAK,SAAS6mB,GACvDjV,GAAM0C,MAAMuS,GACZ/T,EAAS+T,GAET,IACC,IAAInC,EAAS5I,EAAOoE,YADjB,uBAEH,IAAI,IAAJ,EAAQ,EAAOwE,EAAf,+CAAuB,CAAC,IAAhBC,EAAe,QACnBA,GACFA,EAAIP,QAJH,mFAMF,MAAMpd,WAGTzG,OAAM,SAAS+lB,GACf1U,GAAMpR,MAAM8lB,GACZxT,EAAS,QAGVlB,GAAMiF,KAAK,sCACX/D,EAAS,MAIXlB,GAAMoc,kBAAoB,SAASC,EAASnS,GAC3C,IACCmS,EAAQC,UAAYpS,EACnB,MAAO9U,GACR,IACCinB,EAAQhe,IAAMke,IAAIC,gBAAgBtS,GACjC,MAAO9U,GACR4K,GAAMpR,MAAM,qCACZC,QAAQC,IAAI,wCAIfkR,GAAMyc,oBAAsB,SAASC,EAAIC,GACxC,IACCD,EAAGJ,UAAYK,EAAKL,UACnB,MAAOlnB,GACR,IACCsnB,EAAGre,IAAMse,EAAKte,IACb,MAAOjJ,GACR4K,GAAMpR,MAAM,0CAOf,IACI0Y,EADM,CAAC,OAAQ,SAAU,QAAQ3E,QAAQxC,UAAUyc,WAAa,EAC9C,WAAa,eAC/BC,EAAS3qB,OAAO,KAAOoV,GAe3B,GAdApV,OAAOuP,iBAAiB6F,GAAW,SAAS5F,GAE3C,IAAI,IAAIoP,KADR9Q,GAAMlR,IAAI,kBACGkR,GAAMC,SACfD,GAAMC,SAAS6Q,IAAM9Q,GAAMC,SAAS6Q,GAAGvN,kBACzCvD,GAAMlR,IAAI,sBAAwBgiB,GAClC9Q,GAAMC,SAAS6Q,GAAGiH,QAAQ,CAACC,QAAQ,EAAMC,iBAAiB,KAGzD4E,GAA2B,mBAAVA,GACnBA,OAIF7c,GAAM8c,WAAY,EACgC,WAA/C9c,GAAMyL,cAAcC,eAAeC,SACpC3L,GAAMyL,cAAcC,eAAeE,SAAW,IAE/C,GAAGI,cAAgBA,aAAa+Q,iBAAmB/Q,aAAa+Q,gBAAgB,UAC9E/Q,aAAa+Q,gBAAgB,SAASC,QAAUhR,aAAa+Q,gBAAgB,SAASC,OAAO/rB,OAAQ,CAAC,IAAD,uBACtG,IAAI,IAAJ,EAAQ,EAAS+a,aAAa+Q,gBAAgB,SAASC,OAAvD,+CAA+D,CAAC,IAAxDC,EAAuD,QAC9D,GAAGA,GAASA,EAAMC,UAA6C,cAAjCD,EAAMC,SAASpG,cAA+B,CAC3E9W,GAAM8c,WAAY,EAClB,QAJoG,kFAOnG9c,GAAM8c,UACR9c,GAAMlR,IAAI,uCAEVkR,GAAMiF,KAAK,kLAGN,CAGN,IAAIkY,EAAS,IAAI7Q,kBAAkB,IACnC6Q,EAAOpM,YAAY,CAACf,qBAAqB,IAAO5hB,MAAK,SAAS4iB,GAC7DhR,GAAM8c,WAA0C,IAA9B9L,EAAMpJ,IAAIjF,QAAQ,OACjC3C,GAAM8c,UACR9c,GAAMlR,IAAI,uCAEVkR,GAAMiF,KAAK,8KAGZkY,EAAOnhB,QACPmhB,EAAS,QAOZ,GADAnd,GAAM6K,aAAc,EAC8B,YAA/C7K,GAAMyL,cAAcC,eAAeC,SACpC3L,GAAMyL,cAAcC,eAAeE,SAAW,GAE/C5L,GAAM6K,aAAc,OACd,GAAkD,WAA/C7K,GAAMyL,cAAcC,eAAeC,SAC3C3L,GAAMyL,cAAcC,eAAeE,QAAU,GAE9C5L,GAAM6K,aAAc,OACd,GAAI3Y,OAAO6N,mBAAuB,qBAAsBA,GAAkBkM,UAI1E,CAEN,IAAImR,EAAS,IAAI9Q,kBACjB,IACC8Q,EAAO5O,eAAe,SACtBxO,GAAM6K,aAAc,EACnB,MAAOzV,IACTgoB,EAAOphB,aARPgE,GAAM6K,aAAc,EAUrB7K,GAAMiC,UAAW,EACjB9N,EAAQ+M,aAKVlB,GAAMkC,kBAAoB,WACzB,QAAShQ,OAAOoa,mBAGjBtM,GAAMgT,wBAA0B,WAC/B,OAAO7S,UAAUC,cAAgBD,UAAUC,aAAaoT,cAIzDxT,GAAM+G,aAAe,SAAS/V,GAG7B,IAFA,IAAIqsB,EAAU,iEACVtW,EAAe,GACVhW,EAAI,EAAGA,EAAIC,EAAKD,IAAK,CAC7B,IAAIusB,EAAY1L,KAAKC,MAAMD,KAAKna,SAAW4lB,EAAQpsB,QACnD8V,GAAgBsW,EAAQxgB,UAAUygB,EAAUA,EAAU,GAEvD,OAAOvW,GAgjGO/G,UCv9GR,SAASud,KAEZ,GADYrrB,OAAOC,aAAaC,QAAQ,SAEtC,OAAO,EAEPF,OAAOC,aAAaqrB,QAAQ,MAAOtrB,OAAOO,SAASsG,MACnDjI,KAAK2J,UAAUC,SAAS,WCNvB,SAAS+iB,KACd,IAAIC,EAAO5sB,KACXkP,GAAMwB,KAAK,CACTkB,MAAO,MACPxB,SAAU,WACR,IAAIyc,EAAQ,IAAI3d,GAAM,CACpB3S,OAAQqwB,EAAKzrB,MAAM5E,OACnByU,QAAS,WACP6b,EAAMjF,OAAO,CACXC,OAAQ,yBACRC,SAAU8E,EAAKzrB,MAAM2mB,SACrB9W,QAAS,SAAUuD,GACjBqY,EAAKnrB,SAAS,CAAEorB,MAAOA,IACvBD,EAAKnrB,SAAS,CAAEqrB,QAASvY,IACzBrF,GAAMlR,IACJ,qBACE4uB,EAAKzrB,MAAM2rB,QAAQ3E,YACnB,QACAyE,EAAKzrB,MAAM2rB,QAAQ5E,QACnB,KAEJhZ,GAAMlR,IAAI,oCACV4uB,EAAKG,oBAGPjvB,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,iCAAkCA,GAC9CsD,OAAO4rB,MAAM,6BAA+BlvB,IAE9C0jB,cAAe,SAAU1f,GACvBoN,GAAM0C,MACJ,6BAA+B9P,EAAK,KAAO,OAAS,SAGxDga,SAAU,SAAU3a,GAClB+N,GAAMlR,IAAI,wBAA0BmD,IAEtCkU,WAAY,SAAUpC,EAAQnR,GAC5BoN,GAAMlR,IACJ,UACG8D,EAAK,UAAY,WAClB,kBACAmR,IAGN+B,YAAa,SAAUlT,GACrBoN,GAAMlR,IACJ,4CACG8D,EAAK,KAAO,QACb,SAGN+T,UAAW,SAAUoX,EAAKrX,GACxB1G,GAAMlR,IAAI,qCAAsCivB,GAChD,IAAIrc,EAAQqc,EAAG,UAEf,GADA/d,GAAM0C,MAAM,UAAYhB,GACpBA,EACF,GAAc,WAAVA,GAaF,GAZA7S,QAAQC,IAAI,UACZ4uB,EAAKnrB,SAAS,CACZyrB,KAAMD,EAAG,GACTE,QAASF,EAAG,aAIdL,EAAKQ,eACHH,EAAG,GACHL,EAAKzrB,MAAM0L,SAAW,OAAM+f,EAAKzrB,MAAMksB,UAGrCJ,EAAG,WAAgB,CACrB,IAAItvB,EAAOsvB,EAAG,WAKd,IAAK,IAAIhE,KAJTlrB,QAAQC,IACN,4CACAL,GAEYA,EAAM,CAClB,IAAIO,EAAKP,EAAKsrB,GAAL,GACLqE,EAAU3vB,EAAKsrB,GAAL,QACV7H,EAAQzjB,EAAKsrB,GAAL,YACR5I,EAAQ1iB,EAAKsrB,GAAL,YACZ/Z,GAAM0C,MACJ,SACE1T,EACA,KACAovB,EACA,YACAlM,EACA,YACAf,EACA,KAEJuM,EAAKQ,eAAezvB,EAAKsrB,GAAL,GAAetrB,EAAKsrB,GAAL,SACnC2D,EAAKW,cAAcrvB,EAAIovB,EAASlM,EAAOf,UAGtC,GAAc,cAAVzP,EAET1B,GAAMiF,KAAK,qCACN,GAAc,UAAVvD,EAET,GAAIqc,EAAG,WAAgB,CACjBtvB,EAAOsvB,EAAG,WAKd,IAAK,IAAIhE,KAJT/Z,GAAMlR,IACJ,4CACAL,GAEYA,EAAM,CACdO,EAAKP,EAAKsrB,GAAL,GACLqE,EAAU3vB,EAAKsrB,GAAL,QACV7H,EAAQzjB,EAAKsrB,GAAL,YACR5I,EAAQ1iB,EAAKsrB,GAAL,YACZ/Z,GAAMlR,IACJ,SACEE,EACA,KACAovB,EACA,YACAlM,EACA,YACAf,EACA,KAGJuM,EAAKQ,eAAezvB,EAAKsrB,GAAL,GAAetrB,EAAKsrB,GAAL,SACnC2D,EAAKW,cAAcrvB,EAAIovB,EAASlM,EAAOf,SAGpC,GAAI4M,EAAG,QAAa,CACzB,IAAIO,EAAUP,EAAG,QACjBlvB,QAAQC,IAAI,sBAAwBwvB,GACpCZ,EAAKnrB,SACH,CACEgsB,MAAOb,EAAKzrB,MAAMssB,MAAMC,QACtB,SAACC,GAAD,OAAUA,EAAKC,MAAQJ,OAG3B,kBAAMzvB,QAAQC,IAAI,cAAe4uB,EAAKzrB,MAAMssB,UAM5B,OADdI,GAHAC,EAAkBlB,EAAKzrB,MAAMssB,MAAMC,QACrC,SAACC,GAAD,OAAUA,EAAKC,OAASJ,MAEOO,UAE/BF,EAAWzY,SAEbwX,EAAKoB,kBAAkBR,QAClB,GAAIP,EAAG,YAAiB,CAC7B,IAAIgB,EAAchB,EAAG,YAErB,GADAlvB,QAAQC,IAAI,mBAAqBiwB,GACb,OAAhBA,EAEF,YADArB,EAAKzrB,MAAM2rB,QAAQ7X,SAGrB2X,EAAKnrB,SAAS,CACZgsB,MAAOb,EAAKzrB,MAAMssB,MAAMC,QACtB,SAACC,GAAD,OAAUA,EAAKC,MAAQK,OAG3B,IAUIJ,EAVAC,EAAkBlB,EAAKzrB,MAAMssB,MAAMC,QACrC,SAACC,GAAD,OAAUA,EAAKC,OAASK,KAG1BrB,EAAKnrB,SAAS,CACZysB,SAAUtB,EAAKzrB,MAAM+sB,SAASR,QAC5B,SAACC,GAAD,OAAUA,EAAKC,MAAQK,OAKT,OADdJ,EAAaC,EAAgBC,UAE/BF,EAAWzY,SAEbwX,EAAKoB,kBAAkBC,QACdhB,EAAG,OACHA,EAAG,YACHA,EAAG,SACZL,EAAKQ,eACHH,EAAG,QAAY/uB,GACf+uB,EAAG,QAAYK,SAKnB1X,IACF1G,GAAMlR,IAAI,0BAA2B4X,GACrCgX,EAAKzrB,MAAM2rB,QAAQlE,iBAAiB,CAAEhT,KAAMA,MAIhDuI,cAAe,SAAU/E,GACvBrb,QAAQC,IAAI,8BAA+Bob,GAC3Crb,QAAQC,IAAI4uB,EAAKzrB,MAAM2rB,QAAQ5uB,IAIN,IAHT0uB,EAAKzrB,MAAMssB,MAAMC,QAC/B,SAACC,GAAD,OAAUA,EAAKzvB,KAAO0uB,EAAKzrB,MAAM2rB,QAAQ5uB,MAE7BiC,SACZysB,EAAKzrB,MAAM2rB,QAAQc,KAAOhB,EAAKzrB,MAAM+rB,KAErCN,EAAKnrB,SAAS,CACZgsB,MAAOb,EAAKzrB,MAAMssB,MAAM1lB,OAAO6kB,EAAKzrB,MAAM2rB,WAExCF,EAAKzrB,MAAMgtB,SACbvB,EAAKwB,gBAAgBxB,EAAKzrB,MAAMksB,WAIpC,IAAIgB,EAAcjV,EAAOE,iBAEpB+U,GAAsC,IAAvBA,EAAYluB,QAG9BpC,QAAQC,IAAI4uB,EAAKzrB,MAAMmtB,cACvB1B,EAAK2B,GAAG,UAAY3B,EAAKzrB,MAAM2rB,QAAQ5uB,IAAI8K,OAC3C4jB,EAAK4B,eAAe5B,EAAKzrB,MAAM2rB,UAJ/BF,EAAK2B,GAAG,UAAY3B,EAAKzrB,MAAM2rB,QAAQ5uB,IAAIuwB,QAY/C9R,eAAgB,SAAUvD,GACxBlK,GAAMlR,IAAI,+BAAgCob,IAG5CtB,OAAQ,SAAUla,GAChBsR,GAAM0C,MAAM,oCAAqChU,IAGnDgpB,UAAW,WACT1X,GAAMlR,IACJ,mEAKRF,MAAO,SAAUA,GACfoR,GAAMpR,MAAMA,GACZsD,OAAO4rB,MAAMlvB,GAAO,WAClBsD,OAAOO,SAAS+sB,aAGpBxd,UAAW,WACT9P,OAAOO,SAAS+sB,eAOnB,SAAS3B,KACd,IACIlsB,EAAW,CACbmV,QAAS,OACT2Y,KAHS3uB,KAGEmB,MAAMytB,OACjBC,MAAO,YACPvB,QALSttB,KAKKmB,MAAM0L,SAAW,QALtB7M,KAKkCmB,MAAMksB,SACjDyB,IANS9uB,KAMCmB,MAAM2tB,KANP9uB,KAQNmB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QAAShW,IACnCyP,WACE,WACEtQ,KAAK+uB,eACLhuB,KAAKf,MACP,KAIG,SAASgvB,GAAepB,GAC7B,IAAIH,EAAQztB,KAAKmB,MAAMssB,MAAMC,QAAO,SAACC,GAAD,OAAUA,EAAKC,OAASA,KAC5D,GAAIH,GAASA,EAAM,GACjB,OAAOA,EAAM,GAIV,SAASwB,GAAa/wB,GAC3B,IAAIuvB,EAAQztB,KAAKmB,MAAMssB,MAAMC,QAAO,SAACC,GAAD,OAAUA,EAAKzvB,KAAOA,KAC1D,GAAIuvB,GAASA,EAAM,GACjB,OAAOA,EAAM,GAWV,SAASL,GAAelvB,EAAIirB,GACjC,IACI+F,EAAc/F,EAAE/I,MAAM,QACtBpgB,KAAKmvB,qBAAqBD,EAAY,KAF/BlvB,KAGJyB,SAAS,CACZ6sB,aAJOtuB,KAIYmB,MAAMmtB,aAAavmB,OAAO,CAC3C7J,GAAIA,EACJovB,QAAS4B,EAAY,GACrBjoB,KAAMioB,EAAY,GAClB5rB,KAAM,eAIZvF,QAAQC,IAAI,qBAAsBkxB,EAAY,IAGzC,SAASC,GAAqBC,GAKnC,OAAyB,IAJdpvB,KACUmB,MAAMmtB,aAAaZ,QACtC,SAACC,GAAD,OAAUA,EAAK1mB,OAASmoB,KAEZjvB,OAOT,SAASkvB,GAAmBnxB,GACjC,IAAIowB,EAAetuB,KAAKmB,MAAMmtB,aAAaZ,QAAO,SAACC,GAAD,OAAUA,EAAKzvB,KAAOA,KACxE,GAAIowB,GAAgBA,EAAa,GAC/B,OAAOA,EAAa,GAIjB,SAASgB,GAAqBpxB,GACnC,IAAIowB,EAAetuB,KAAKmB,MAAMmtB,aAAaZ,QAAO,SAACC,GAAD,OAAUA,EAAK1mB,OAAS/I,KAC1E,GAAIowB,GAAgBA,EAAa,GAC/B,OAAOA,EAAa,GAIjB,SAASN,GAAkB9vB,GACrB8B,KACNyB,SAAS,CACZ6sB,aAFStuB,KAEUmB,MAAMmtB,aAAaZ,QAAO,SAACC,GAAD,OAAUA,EAAKzvB,KAAOA,OAIhE,SAASqvB,GAAcrvB,EAAIuvB,EAAOH,EAASlM,EAAOf,GACvD,IAAIuM,EAAO5sB,KAEP6tB,EAAa,KACjBjB,EAAKzrB,MAAM0rB,MAAMjF,OAAO,CACtBC,OAAQ,yBACRC,SAAU9nB,KAAKmB,MAAM2mB,SACrB9W,QAAS,SAAUuD,IACjBsZ,EAAatZ,GACFgb,kBAAmB,EAC9BrgB,GAAMlR,IACJ,qBACE6vB,EAAW1F,YACX,QACA0F,EAAW3F,QACX,KAEJhZ,GAAMlR,IAAI,6BAEV,IAAIwxB,EAAY,CACdxZ,QAAS,OACT2Y,KAAM/B,EAAKzrB,MAAMytB,OACjBC,MAAO,aACPC,IAAKlC,EAAKzrB,MAAM2tB,IAChBW,KAAMvxB,EACNwxB,WAAY9C,EAAKzrB,MAAMgsB,SAQwB,WAA/Cje,GAAMyL,cAAcC,eAAeC,SACxB,QAAVwF,IAA8B,QAAVA,GAAoBnR,GAAM8c,aAE3C3L,IAAOA,EAAQA,EAAMsP,eACzB5xB,QAAQC,IACN,sBACEqiB,EACA,oDAEJmP,EAAS,aAAkB,GAE7B3B,EAAW+B,WAAavP,EACxBwN,EAAW3X,KAAK,CAAEW,QAAS2Y,KAE7B1xB,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,iCAAkCA,GAC9CsD,OAAO4rB,MAAM,6BAA+BlvB,IAE9C+X,UAAW,SAAUoX,EAAKrX,GACxB1G,GAAM0C,MAAM,sCAAuCqb,GACnD,IAAIrc,EAAQqc,EAAG,UACf/d,GAAMlR,IAAI,UAAY4S,GAClBqc,EAAG,MACL7rB,OAAO4rB,MAAMC,EAAG,OACPrc,GACK,aAAVA,IACFid,EAAWD,KAAOX,EAAG,GACrBY,EAAWgC,UAAY5C,EAAG,QAC1BL,EAAKnrB,SAAS,CAAEgsB,MAAOb,EAAKzrB,MAAMssB,MAAM1lB,OAAO8lB,KAC/CjB,EAAKnrB,SAAS,CAAEysB,SAAUtB,EAAKzrB,MAAM+sB,SAASnmB,OAAO8lB,KAChDxN,GAAUe,GACbwL,EAAK2B,GAAG,UAAYV,EAAW3vB,IAAIuwB,OAKrCvf,GAAMlR,IACJ,iCACE6vB,EAAWD,KACX,KACAC,EAAWgC,UACX,aACA5C,EAAG,OAOPrX,IACF1G,GAAMlR,IAAI,0BAA2B4X,GACrCiY,EAAWjO,aAAa,CACtBhK,KAAMA,EAGNuD,MAAO,CAAEqF,WAAW,EAAOK,WAAW,EAAOjhB,MAAM,GACnDoT,QAAS,SAAU4E,GACjB1G,GAAMlR,IAAI,WAAY4X,GACtB,IAAIvP,EAAO,CAAE2P,QAAS,QAAS2Y,KAAM/B,EAAKzrB,MAAMytB,QAChDf,EAAW3X,KAAK,CAAEW,QAASxQ,EAAMuP,KAAMA,KAEzC9X,MAAO,SAAUA,GACfoR,GAAMlR,IAAI,gBAAiBF,GAC3BsD,OAAO4rB,MAAM,mBAAqBlvB,EAAM+Y,cAKhDiF,SAAU,SAAU3a,GAClB+N,GAAMlR,IACJ,kDACE6vB,EAAWiC,QACX,gBACA3uB,IAGN6T,YAAa,SAAUlT,GACrBoN,GAAMlR,IACJ,gDACE6vB,EAAWiC,QACX,SACChuB,EAAK,KAAO,QACb,QAEO,SAAPA,GACF8qB,EAAKoB,kBAAkBH,EAAWD,OAGtCzP,cAAe,SAAU/E,GACvBrb,QAAQC,IAAI,cAAeob,IAE7BuD,eAAgB,SAAUvD,GAExB,IAAIiV,EAAcjV,EAAOE,iBAMzBvb,QAAQC,IACN,gBACA4uB,EAAKmD,WAAWlC,EAAW3vB,IAC3B2vB,EAAW3vB,IAERmwB,GAAsC,IAAvBA,EAAYluB,QAK9BysB,EAAK2B,GAAG,UAA2BV,EAAW3vB,IAAI8K,OAIlDkG,GAAMoc,kBACJrb,SAAS+f,eAAeC,SAAqBpC,EAAW3vB,IACxDkb,IAVFwT,EAAK2B,GAAG,UAAYV,EAAW3vB,IAAIuwB,OAarC,IAAIyB,EAAc9W,EAAOC,iBACpB6W,GAAsC,IAAvBA,EAAY/vB,QAI9B+O,GAAMoc,kBACJrb,SAAS+f,eAAe,SAAWnC,EAAW3vB,IAC9Ckb,IAINtB,OAAQ,SAAUla,GAEhBG,QAAQC,IAAIJ,GACZ,IAAIiZ,EAAUtP,KAAKmP,MAAM9Y,GAKA,IAJTgvB,EAAKzrB,MAAMgvB,SAASzC,QAClC,SAACC,GAAD,OAAUA,EAAK1mB,OAAS4P,EAAO,QAGnB1W,QAAuC,OAAvB0W,EAAO,SACnC+V,EAAKnrB,SAAS,CACZ0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASpoB,OAAO,CACnCulB,QAASzW,EAAO,QAChB5P,KAAM4P,EAAO,SAKQ,kBAAvBA,EAAO,SACT+V,EAAKnrB,SAAS,CACZ0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASzC,QAC5B,SAACC,GAAD,OAAUA,EAAK1mB,MAAQ4P,EAAO,UAKZ,eAApBA,EAAO,OACP9Y,QAAQC,IAAI4uB,EAAKzrB,OACnByrB,EAAKnrB,SAAS,CAAC2uB,aAAa,KAGH,kBAAvBvZ,EAAO,UACT+V,EAAKnrB,SAAS,CACZ0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASzC,QAC5B,SAACC,GAAD,OAAUA,EAAK1mB,MAAQ4P,EAAO,UAGlC+V,EAAKwB,gBAAgBvX,EAAO,MACxBA,EAAO,OAAa+V,EAAKzrB,MAAMksB,WACjCtvB,QAAQC,IAAI,+BAAW4uB,EAAKzrB,MAAMkvB,gBAC9BzD,EAAKzrB,MAAMkvB,gBACbzD,EAAK0D,kBACL1D,EAAK2D,cAAc,KAEnB3D,EAAK4D,uBAKb5J,UAAW,WACT1X,GAAMlR,IAAI,gDAAkDE,EAAK,YAKhE,SAAS6xB,GAAWU,GACzB,IAAIhB,EAAOzvB,KAAKivB,aAAawB,GAC7B,GAAIhB,GAAQA,EAAK7B,KAAM,IAAIsB,EAAclvB,KAAKqvB,mBAAmBI,EAAK7B,MACtE,GAAIsB,EACF,OAAOA,EAAY5rB,KA6BhB,SAASotB,GAAiBxyB,GAC/B,IAAIyyB,EAAQ3wB,KAAKmB,MAAMmtB,aAAasC,WAAU,SAACjD,GAAD,OAAUA,EAAK1mB,OAAS/I,KAEtE,GADAH,QAAQC,IAAI2yB,GACRE,OAAOC,UAAUH,GACnB,OAAOA,EAaJ,SAASnC,GAAeiB,GAC7B1xB,QAAQC,IAAIyxB,EAAKvxB,IACbuxB,EAAKvxB,IAAMuxB,EAAKhb,aAAegb,EAAKhb,YAAYiI,cAClDpM,WACE,WACEpB,GAAMoc,kBACJrb,SAAS+f,eAAe,WAAaP,EAAKvxB,IAC1CuxB,EAAKhb,YAAYiI,eAEnB3b,KAAKf,MACP,MAKC,SAAS+X,KACd,IAAIlB,EAAU,CACZka,SAAU,UACVxb,YAAarG,GAAM+G,aAAa,IAChC0Y,KAAM3uB,KAAKmB,MAAMytB,OACjBjmB,KAAM,cAER3I,KAAKmB,MAAM2rB,QAAQlvB,KAAK,CACtB+K,KAAMpB,KAAKC,UAAUqP,GACrB/Y,MAAO,SAAU4X,GACf3X,QAAQC,IAAI0X,IAEd1E,QAAS,WACPjT,QAAQC,IAAI,WAqCX,SAAS+wB,KACd,IAAInC,EAAO5sB,KACX4sB,EAAKzrB,MAAM2rB,QAAQ7M,YAAY,CAC7B9G,MAAO,CACLsF,WAAW,EACXK,WAAW,EACXlhB,MAAM,EACNihB,WAAW,EACXL,WAAW,GAGbxN,QAAS,SAAU4E,GAEjB,GADA1G,GAAM0C,MAAM,+BAAgCgE,GACxCA,EAAM,CAORgX,EAAKzrB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QANZ,CACZb,QAAS,UACToL,OAAO,EACPf,OAAO,EACPziB,MAAM,GAEoCgY,KAAMA,MAGtD9X,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,sBAAuBA,MAKlC,SAASkzB,KACd,IAAIpE,EAAO5sB,KACX4sB,EAAKzrB,MAAM2rB,QAAQ7M,YAAY,CAC7B9G,MAAO,CACLsF,WAAW,EACXK,WAAW,EACXlhB,MAAM,EACNihB,WAAW,EAEXL,WAAW,GAGbxN,QAAS,SAAU4E,GAEjB,GADA1G,GAAM0C,MAAM,+BAAgCgE,GACxCA,EAAM,CAORgX,EAAKzrB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QANV,CACdb,QAAS,YACToL,OAAO,EACPf,OAAO,EACPziB,MAAM,GAEsCgY,KAAMA,MAGxD9X,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,sBAAuBA,M,ICtrBpB4J,G,YACnB,aAAe,IAAD,8BACZ,+CACK/I,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKmJ,YAAc,EAAKA,YAAYnJ,KAAjB,gBACnB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0rB,SAAWA,GAAS1rB,KAAT,gBAChB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKiF,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKiO,cAAgB,EAAKA,cAAcjO,KAAnB,gBACrB,EAAKkwB,cAAgB,EAAKA,cAAclwB,KAAnB,gBACrB,EAAK4L,qBAAuB,EAAKA,qBAAqB5L,KAA1B,gBAC5B,EAAK6L,eAAiB,EAAKA,eAAe7L,KAApB,gBACtB,EAAKkL,YAAc,EAAKA,YAAYlL,KAAjB,gBAEnB,EAAK8M,SAAW,EAAKA,SAAS9M,KAAd,gBAChB,EAAKmN,OAAS,EAAKA,OAAOnN,KAAZ,gBACd,EAAKmwB,WAAa,EAAKA,WAAWnwB,KAAhB,gBAClB,EAAK6N,kBAAoB,EAAKA,kBAAkB7N,KAAvB,gBAEzB,EAAK4rB,cAAgBA,GAAc5rB,KAAd,gBACrB,EAAKowB,YAAc,EAAKA,YAAYpwB,KAAjB,gBACnB,EAAKgsB,iBAAmBA,GAAiBhsB,KAAjB,gBACxB,EAAKwsB,cAAgBA,GAAcxsB,KAAd,gBACrB,EAAKytB,eAAiBA,GAAeztB,KAAf,gBACtB,EAAKgX,SAAWA,GAAShX,KAAT,gBAChB,EAAKguB,YAAcA,GAAYhuB,KAAZ,gBACnB,EAAKqsB,eAAiBA,GAAersB,KAAf,gBACtB,EAAKitB,kBAAoBA,GAAkBjtB,KAAlB,gBACzB,EAAKiwB,cAAgBA,GAAcjwB,KAAd,gBACrB,EAAKouB,qBAAuBA,GAAqBpuB,KAArB,gBAC5B,EAAKuuB,qBAAuBA,GAAqBvuB,KAArB,gBAC5B,EAAK2vB,iBAAmBA,GAAiB3vB,KAAjB,gBACxB,EAAKsuB,mBAAqBA,GAAmBtuB,KAAnB,gBAC1B,EAAKiuB,eAAiBA,GAAejuB,KAAf,gBACtB,EAAKkuB,aAAeA,GAAaluB,KAAb,gBACpB,EAAKgvB,WAAaA,GAAWhvB,KAAX,gBAIlB,EAAKI,MAAQ,CACXrC,KAAM,KACNZ,GAAI,KACJxB,KAAM,EACNmH,SAAU,KACVuH,gBAAiB,KACjBgmB,UAAW,KACXrmB,aAAa,EACbyB,eAAgB,GAChBZ,SAAU,KACVhP,MAAOwE,OAAOC,aAAaC,QAAQ,SACnC8K,IAAK5F,IAAOC,IAAIC,UAAUC,OAAO,IACjCgF,QAAS,KACTgD,WAAW,EACXyhB,aAAa,EAEbiB,UAAW,KACX90B,OAAQD,EAAKg1B,YACbzE,MAAO,KACPC,QAAS,KACThF,SAAU,iBAAmB5Y,GAAM+G,aAAa,IAChD2Y,OAAQ,KACR2C,WAAYnwB,OAAOC,aAAaC,QAAQ,SACxC4rB,KAAM,KACNsE,SAAU,KACVrE,QAAS,iBAAmBje,GAAM+G,aAAa,IAC/C6Y,IAAK,KACLrB,MAAO,GACPgE,YAAa,GACbC,aAAc,GACdrE,SAAUjsB,OAAOC,aAAaC,QAAQ,SACtCuL,SAAU,KACVshB,SAAS,EACTpc,KAAM,GACNse,gBAAgB,EAChBsB,qBAAqB,EACrBC,OAAO,EACPzB,SAAU,GACVjC,SAAU,GACVI,aAAc,GACdK,KAAM,MAhFI,E,kFAsFZ9sB,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,WAAY9B,KAAKxD,SAC/BqF,EAAWC,GAAG,mBAAoB9B,KAAKrB,e,6CAKvCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,WAAY/B,KAAKxD,SAC3CqF,EAAWE,eAAe,mBAAoB/B,KAAKrB,e,0CAInDqB,KAAKysB,WACLzqB,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,OAAgCqD,KAAKmB,MAAMvE,OAC1EoF,EAAkB,cAAehC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,yCAGhDi1B,GACb7xB,KAAKmB,MAAMivB,aACbpuB,EAAkB,kBAAkBhC,KAAK4H,SAASjL,OAAd,OAAgCqD,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,oCAIzF,IAAD,OACRkC,EAAO+C,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBrD,GAAkB,SAAViB,GACVC,KAAKyB,SAAS,CACZ3C,KAAMA,EACNZ,GAAIY,EAAKZ,GACT0N,SAAU9M,EAAK8M,SACf+C,UAAW7P,EAAK6P,YACf,kBAAM,EAAKwiB,iBAEJ,eAATpxB,GACDC,KAAK2J,UAAUC,SAAS,a,gCAK1B,IAAIjM,EAAOkE,EAAWrF,UAClBuD,EAAQ8B,EAAWM,WACnBxE,GAAkB,YAAVoC,GACVC,KAAKyB,SAAS,CACZoC,SAAUlG,IAGVA,GAAkB,YAAVoC,GACVC,KAAKyB,SAAS,CACZmK,SAAUjO,IAGVA,GAASA,EAAK,IAAgB,YAAVoC,GACtBC,KAAKyB,SAAS,CACZ2vB,UAAWzzB,EAAK,GAAGO,O,oCAMvB,IAAIY,EAAO+C,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBrD,GAAkB,SAAViB,GACVC,KAAKyB,SAAS,CACZ3C,KAAMA,EACN8M,SAAU9M,EAAK8M,SACflP,KAAM,IAGVsD,KAAKuuB,GAAG,YAAYvuB,KAAKmB,MAAMiL,KAAK0lB,IAAI,M,iCAG9B,IAAD,OACT9xB,KAAKyB,SAAS,CAAE/E,KAAMsD,KAAKmB,MAAMzE,KAAO,IAAK,WAC3CsF,EAAsB,QAAS,EAAK4F,SAASjL,OAAd,OAAgC,EAAKwE,MAAMvE,MAAO,EAAKuE,MAAMzE,W,4BAK9F,GAAIsD,KAAKmB,MAAMrC,MAAQkB,KAAKmB,MAAMrC,KAAK+H,SACrC,OACE,kBAAC,IAAD,CAAKoB,KAAM,UAAYjI,KAAKmB,MAAMrC,KAAKZ,GAAK,QAASsG,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,QACjH,kBAAC,IAAD,CAAMG,IAAI,UAAUC,OAAO,UAAUC,GAAG,kBACxC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,sB,wCAMhCsC,GAChB1J,KAAKyB,SAASiI,K,kCAIJqoB,EAAkBC,EAAoBC,GAA6D,IAAvCC,EAAsC,uDAAxB,KAAMC,EAAkB,uDAAN,KAClGv0B,EAAO,CAAEm0B,iBAAkBA,EAAkBC,mBAAoBA,EAAoBC,qBAAsBA,EAAsBC,YAAaA,EAAaC,UAAWA,GAC1KnwB,EAAsB,eAAgBpE,EAAMoC,KAAKmB,MAAMvE,S,6BAGlDkG,GACL/E,QAAQC,IAAI,UAAW8E,GAEvBd,EAAsB,UADX,CAAEowB,QAASpyB,KAAKmB,MAAMjD,GAAI4E,MAAOA,GACL9C,KAAKmB,MAAMvE,S,+BAKlDoF,EAAsB,SADX,CAAEowB,QAASpyB,KAAKmB,MAAMjD,GAAIm0B,WAAYryB,KAAKmB,MAAMiK,iBACtBpL,KAAKmB,MAAMvE,OACpCoD,KACRsyB,IAAIC,MAAMrnB,MAAM,iB,sCAMrBlJ,EAAsB,WADX,CAACowB,QAASpyB,KAAKmB,MAAMjD,GAAIgH,QAASlF,KAAKmB,MAAMqL,eAAgBgmB,SAAUxyB,KAAKmB,MAAMwK,SACrD3L,KAAKmB,MAAMvE,OACnDoD,KAAK+X,a,2CAIc7Z,GACnB,IAAM0uB,EAAO5sB,KACD4sB,EAAK0F,IACbG,OAAOC,QAAQ7yB,EAAK8yB,aAAc9yB,EAAKmtB,OAAO,kBAAMJ,EAAKqE,cAAc/yB,Q,oCAG/DA,GAEZ8D,EAAyB,WADd,CAAE9D,GAAIA,GAC0B8B,KAAKmB,MAAMvE,MAAOoD,KAAKmB,MAAMzE,Q,qCAG3DwB,GACb8B,KAAKyB,SAAS,CAAEkK,QAASzN,IACzB8B,KAAKuuB,GAAG,YAAYvuB,KAAKmB,MAAMiL,KAAKwmB,U,oCAIpC5yB,KAAKyB,SAAS,CAAEkK,QAAS,S,mCAKzB3J,EAAyB,QADd,CAAE9D,GAAI8B,KAAKmB,MAAMjD,IACY8B,KAAKmB,MAAMvE,MAAOoD,KAAKmB,MAAMzE,Q,0CAIrE,IAAMkwB,EAAO5sB,KACD4sB,EAAK0F,IACbG,OAAOC,QAAQ7yB,EAAK8yB,aAAc9yB,EAAKmtB,OAAO,kBAAMJ,EAAKsE,kB,oCAI7D5gB,WAAW,WACTtQ,KAAK2sB,iBAEL5rB,KAAKf,MAAO,Q,+BAIN,IAAD,EAC4EA,KAAKmB,MAAhFrC,EADD,EACCA,KAAmB+E,GADpB,EACOkH,YADP,EACoBlH,UAAU+H,EAD9B,EAC8BA,SAAkBQ,GADhD,EACwC8B,OADxC,EACgD9B,KAAKT,EADrD,EACqDA,QAASgD,EAD9D,EAC8DA,UACrE,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQ9L,MAAOhD,EAAK+D,MAAOyE,SAAUxI,EAAKkG,OAC1C,kBAAC,IAAD,MACC/F,KAAKsI,MACN,kBAAC,GAAD,CACAxJ,KAAMA,EAAM8M,SAAUA,EAAUsC,OAAQlO,KAAKkO,OAAQ9B,IAAKA,EAC1DvI,SAAUA,EAAUmL,cAAehP,KAAKgP,cAAerD,QAASA,EAChEslB,cAAejxB,KAAKixB,cAAejrB,OAAQhG,KAAKgG,OAChD2G,qBAAsB3M,KAAK2M,qBAAsBC,eAAgB5M,KAAK4M,eACtEX,YAAajM,KAAKiM,YAAa0C,UAAWA,EAC1CzE,YAAalK,KAAKkK,YAAab,aAAcrJ,KAAKyH,kBAClDoG,SAAU7N,KAAK6N,SAAUqjB,WAAYlxB,KAAKkxB,WAC1CtiB,kBAAmB5O,KAAK4O,yB,GAxQI7J,aCkBrB8tB,GA3CE,SAAC5tB,GAChB,OAAIA,EAAMrB,OAASqB,EAAMrB,MAAMzD,OAAS,EAEpC,kBAAC,IAAMsD,SAAP,KACE,kBAAC,IAAD,CAAKmK,OAAK,GACP3I,EAAMrB,MAAM5G,KAAI,SAAC8B,GAAD,OACf,kBAAC,IAAD,CAAK2O,MAAM,MAAMiB,YAAY,KAAKzR,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KACjE,kBAAC,IAAD,CAAMzD,UAAU,sBACd,kBAAC,IAAD,CAAYA,UAAU,aACtB,yBAAKA,UAAU,wBAAuB,kBAAC,IAAD,CAAMyH,QAAS7L,EAAKsE,QAAQyJ,SAAU5E,KAAM,aAAenJ,EAAKsE,QAAQlF,IAAI,yBAAKqP,IAAKzO,EAAKsE,QAAQoK,OAAQE,OAAO,SACtJ,yBAAKxK,UAAU,uBACb,yBAAKA,UAAU,0BACb,kBAAC,IAAD,CAAMA,UAAU,aAAa+E,KAAM,aAAenJ,EAAKsE,QAAQlF,IAAKY,EAAKsE,QAAQyJ,SAASd,UAAU,EAAG,MAEzG,kBAAC,IAAD,CAAMpB,QAAS7L,EAAK+D,MAAOK,UAAU,aAAa+E,KAAM,UAAYnJ,EAAKZ,IAAKY,EAAK+D,MAAMkJ,UAAU,EAAG,IAAM,QAEhH,kBAAC,IAAD,CAAa7I,UAAU,yBACpBpE,EAAKoG,QAAQ6G,UAAU,EAAG,KAAO,OAEpC,kBAAC,IAAD,KACE,yBAAK7I,UAAU,SACf,0BAAMA,UAAU,QAAO,uBAAGA,UAAU,sBAApC,IAA8DpE,EAAKiF,UAAnE,KACA,0BAAMb,UAAU,QAAO,uBAAGA,UAAU,mBAApC,IAA2DpE,EAAKyL,MAAhE,KACA,0BAAMrH,UAAU,QAAO,uBAAGA,UAAU,kBAApC,IAA0DpE,EAAK2L,QAA/D,KACA,0BAAMvH,UAAU,QAAO,uBAAGA,UAAU,kBAApC,IAA0DpE,EAAKg0B,cAA/D,KACA,0BAAM5vB,UAAU,QAAO,uBAAGA,UAAU,qBAApC,IAA6DpE,EAAKi0B,eAAlE,MAGF,kBAAC,IAAD,CAAM7vB,UAAU,mBAAmB+E,KAAM,UAAYnJ,EAAKZ,IACnD2B,EAAKmD,KACN,uBAAGE,UAAU,sCAUvB,8BCQG8vB,GAjDG,SAAC/tB,GAiBjB,OACE,kBAAC,IAAD,CAEAguB,UAAU,EACVC,iBAAkB,GAClBC,kBAAmBluB,EAAMmuB,cACzBC,WAAYpuB,EAAM4I,UAChB,kBAAC,IAAD,CAAQhL,MAAOhD,EAAK+D,OAClB,kBAAC,IAAD,CAAM0vB,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,UAEX,kBAAC,IAAD,CAAWC,OAAO,GAChB,kBAAC,IAAD,CACEC,kBAAmB5zB,EAAK6K,OACxBjF,YAAa5F,EAAK6zB,OAClBrvB,SAAU,SAACC,GACTW,EAAMyuB,OAAO,CAAEC,MAAOrvB,EAAEE,OAAO1B,aAhC3C,SAAaN,GACX,IAAIG,EAAS,GAab,OAZIsC,EAAM1D,SACR0D,EAAM1D,QAAQvE,KAAI,SAAC4F,GACbA,EAAGC,QAAUL,GAAKI,EAAGE,OACvBH,EAAOvC,KACL,kBAAC,IAAD,CAAK6H,KAAK,aAAazD,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,cACrF,kBAAC,IAAD,CAAMG,IAAI,SAASC,OAAO,SAASC,GAAG,iBACtC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,wBAM3CzE,EAwBJ2F,CAAI,YACL,yBAAKsrB,MAAO,CAACC,UAAW,WAAxB,KACA,kBAAC,IAAD,MACI,kBAAC,IAAD,KACE,kBAAC,GAAD,CAAUjwB,MAAOqB,EAAMrB,MAAOsG,YAAajF,EAAMiF,YAAa2D,SAAU5I,EAAM4I,cCxCrEimB,G,YACnB,aAAe,IAAD,8BACZ,+CACKt3B,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK0rB,SAAWA,GAAS1rB,KAAT,gBAChB,EAAKmJ,YAAc,EAAKA,YAAYnJ,KAAjB,gBACnB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK2yB,OAAS,EAAKA,OAAO3yB,KAAZ,gBACd,EAAK8M,SAAW,EAAKA,SAAS9M,KAAd,gBAChB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBAGnB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCsC,MAAO,GACP+vB,MAAO,KACPj3B,KAAM,EACN6E,QAAS,KACTC,UAAW,KACXuyB,eAAe,EACfX,eAAe,GAnBL,E,kFAuBZvxB,EAAWC,GAAG,WAAY9B,KAAKxD,SAC/BqF,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,WAAY/B,KAAKxD,SAC3CqF,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI/CqB,KAAKysB,WACLzsB,KAAK6I,a,iCAIL7G,EAAkB,QAAShC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,OAC3DoF,EAAsB,QAAS,OAAQhC,KAAKmB,MAAMvE,S,6BAG7C8M,GAAM,IAAD,OACV1J,KAAKyB,SAAS,CAAEmC,MAAO,GAAIlH,KAAM,IACjCsD,KAAKyB,SAASiI,GAAK,WACjB1H,EAAkB,eAAgB,EAAKb,MAAMzE,KAAM,CAAEs3B,EAAG,EAAK7yB,MAAMwyB,OAAS,EAAKxyB,MAAMvE,Y,oCAMzF,IAAIkC,EAAO+C,EAAWK,aAClBpD,GACFkB,KAAKyB,SAAS,CAAEmC,MAAO5D,KAAKmB,MAAMyC,MAAM5G,KAAI,SAAAi3B,GAAE,OAAKA,EAAG/1B,KAAOY,EAAKZ,GAAKpB,OAAOgL,OAAO,GAAImsB,EAAIn1B,GAAQm1B,S,iCAK7F,IAAD,OAELj0B,KAAKmB,MAAMwyB,OAAS3zB,KAAKmB,MAAMwyB,MAAMxzB,OAAS,EAChDH,KAAKyB,SAAS,CAAE/E,KAAMsD,KAAKmB,MAAMzE,KAAO,IAAK,WAC3CsF,EAAkB,eAAgB,EAAKb,MAAMzE,KAAM,CAACs3B,EAAG,EAAK7yB,MAAMwyB,OAAS,EAAKxyB,MAAMvE,WAGxFoD,KAAKyB,SAAS,CAAE/E,KAAMsD,KAAKmB,MAAMzE,KAAO,IAAK,WAC3CsF,EAAkB,QAAS,EAAKb,MAAMzE,KAAM,GAAI,EAAKyE,MAAMvE,UAE7DoD,KAAKyB,SAAS,CAAE2xB,eAAe,O,gCAKjC,IAAIxvB,EAAQ/B,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnByB,EAAMzD,OAAS,GAAe,eAAVJ,GACtBC,KAAKyB,SAAS,CACZmC,MAAOA,IAGPA,EAAMzD,OAAS,GAAe,SAAVJ,GACtBC,KAAKyB,SAAS,CACZmC,MAAO5D,KAAKmB,MAAMyC,MAAMmE,OAAOnE,KAGnC5D,KAAKyB,SAAS,CAAE2xB,eAAe,M,oCAK/B,IAAInxB,EAAOJ,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBF,GAAkB,aAAVlC,GACVC,KAAKyB,SAAS,CACZF,QAASU,EAAKG,YACdZ,UAAWS,EAAKM,e,kCAKVwvB,EAAkBC,EAAoBC,GAA6D,IAAvCC,EAAsC,uDAAxB,KAAMC,EAAkB,uDAAN,KAClGv0B,EAAO,CAAEm0B,iBAAkBA,EAAkBC,mBAAoBA,EAAoBC,qBAAsBA,EAAsBC,YAAaA,EAAaC,UAAWA,GAC1KnwB,EAAsB,eAAgBpE,EAAMoC,KAAKmB,MAAMvE,S,+BAG/C,IAAD,EACmCoD,KAAKmB,MAAvCyC,EADD,EACCA,MAAQrC,EADT,EACSA,QAAS6xB,EADlB,EACkBA,cACzB,OACE,kBAAC,GAAD,CACElpB,YAAalK,KAAKkK,YAAa2D,SAAU7N,KAAK6N,SAC9CjK,MAAOA,EAAO8vB,OAAQ1zB,KAAK0zB,OAAQnyB,QAASA,EAC5C6xB,cAAeA,Q,GAlHWjqB,IAAMpE,WCUzBmvB,GAhBQ,SAACjvB,GACtB,IAAI5B,EAAU,CAAC,4BAAQP,MAAM,MAC7B,GAAGmC,EAAMC,QAEP,IAAK,IAAIjF,EAAI,EAAGA,EAAIgF,EAAMC,QAAQ/E,OAAQF,IACxCoD,EAAQjD,KACN,4BAAQ0C,MAAOmC,EAAMC,QAAQjF,GAAG/B,IAC7B+G,EAAMC,QAAQjF,GAAG4C,QAM1B,OAAOQ,G,oBC4DM8wB,GAjEE,SAAClvB,GAChB,GAAIA,EAAMnG,KAAM,CACd,IAAI+E,EAAW,KAiBf,OAhBIoB,EAAMpB,WACRA,EACE,kBAAC,IAAD,CACEhB,MAAOhD,EAAKsL,QACZvF,aAAW,EACXC,kBAAmB,CAAEC,iBAAkBjG,EAAKkG,KAAMquB,WAAW,EAAMC,qBAAsBx0B,EAAK6zB,SAE9F,4BAAQtvB,KAAK,UACXwC,aAAc3B,EAAMmsB,UACpB/sB,SAAU,SAACC,GACTW,EAAMoE,aAAa,CAAE+nB,UAAW9sB,EAAEE,OAAO1B,UAE3C,kBAAC,GAAD,CAAgBoC,QAASD,EAAMpB,cAKrC,kBAAC,IAAMJ,SAAP,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAa5D,EAAKy0B,UAClB,kBAAC,IAAD,CAAMpuB,MAAI,GACPrC,EACD,kBAAC,IAAD,CACE2B,MAAO3F,EAAKgD,MAAQ,IACpBnF,KAAK,OACL+H,YAAY,MACZ4G,UAAU,KACVvJ,MAAOmC,EAAMpC,MACb6C,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAExG,MAAOyB,EAAEE,OAAO1B,WAGzC,kBAAC,UAAD,CACEwL,YAAarJ,EAAMqJ,YACnB7I,YAAa5F,EAAKqF,QAClBqvB,aAAc,CACZnnB,OAAQ,KACRonB,aAAcC,MAEhB3lB,QAAS,CACPzL,QAAS,CAAC,SAAU,OAAQ,OAAQ,QAAS,YAC7CqxB,OAAQ,CAAErxB,QAAS,CAAC,OAAQ,SAAU,cACtCsxB,MAAO,CACLC,eAAgB3vB,EAAM4vB,oBACtBC,cAAc,IAGlBC,oBAAqB9vB,EAAM8vB,uBAG/B,kBAAC,IAAD,KACE,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAQ7xB,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,WAOlE,OAAQ,MCxEL,SAAS6uB,GAAoB12B,GAClC,OAAO,IAAIirB,SACT,SAACY,EAASD,GACR,IAAMgB,EAAM,IAAIiK,eAChBjK,EAAIkK,KAAK,OAAQ,oCACjBlK,EAAImK,iBAAiB,gBAAiB,6BACtC,IAAMt3B,EAAO,IAAIU,SACjBV,EAAKW,OAAO,gBAAiBJ,GAC7B4sB,EAAI7U,KAAKtY,GACTmtB,EAAIpa,iBAAiB,QAAQ,WAC3B,IAAMpT,EAAWgK,KAAKmP,MAAMqU,EAAIoK,cAChCnL,EAAQzsB,MAEVwtB,EAAIpa,iBAAiB,SAAS,WAC5B,IAAM7S,EAAQyJ,KAAKmP,MAAMqU,EAAIoK,cAC7BpL,EAAOjsB,S,ICSMs3B,G,YACnB,aAAe,IAAD,8BACZ,+CACKpvB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKg0B,oBAAsB,EAAKA,oBAAoBh0B,KAAzB,gBAC3B,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK8zB,oBAAsBA,GAAoB9zB,KAApB,gBAG3B,EAAKI,MAAQ,CACXrC,KAAM,GACN+E,SAAU,KACVyK,YAAaC,eAAY8mB,cACzBz4B,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCuB,MAAO,KACPuuB,UAAW,KACXlnB,YAAa,KACbxN,KAAM,GAlBI,E,kFAwBZmF,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,WAAY/B,KAAKxD,W,+BAM3C,IACMsG,EADSwyB,wBAAat1B,KAAKmB,MAAMmN,YAAYinB,qBAAqBC,OACnDx4B,KAAI,SAAAy4B,GAAK,OAAMA,EAAM9sB,KAAK+sB,OAAmBD,EAAM9sB,KAAf,QAAqBzL,KAAK,MAC/EU,EAAO,CAAEiF,MAAO7C,KAAKmB,MAAM0B,MAAOqC,QAASpC,EAAOuvB,WAAYryB,KAAKmB,MAAMiwB,UAAWpjB,MAAOsnB,wBAAat1B,KAAKmB,MAAMmN,YAAYinB,sBACnI,GAAIv1B,KAAKmB,MAAM0B,MACbb,EAAsB,QAASpE,EAAMoC,KAAKmB,MAAMvE,WAC3C,CACQoD,KACRsyB,IAAIG,OAAOzF,MAAMntB,EAAK81B,gBAAiB91B,EAAKmtB,U,0CAIjC1e,GAClBtO,KAAKyB,SAAS,CACZ6M,kB,wCAKc5E,GAChB1J,KAAKyB,SAASiI,K,0CAKd1J,KAAK6I,a,iCAIL7G,EAAkB,cAAehC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,yCAGhDg5B,EAAMC,M,gCAIvB,IAAIhyB,EAAWhC,EAAWrF,UACtBuD,EAAQ8B,EAAWM,WACnB0B,GAAsB,YAAV9D,GACdC,KAAKyB,SAAS,CACZoC,SAAUA,M,oCAOd7D,KAAK2J,UAAUC,SAAS,a,+BAOhB,IAAD,EACiC5J,KAAKmB,MAArCrC,EADD,EACCA,KAAMwP,EADP,EACOA,YAAazK,EADpB,EACoBA,SAC3B,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQhB,MAAOhD,EAAKi2B,YACpB,kBAAC,GAAD,CAAUh3B,KAAMA,EAAM+E,SAAUA,EAAUyK,YAAaA,EAAaymB,oBAAqB/0B,KAAK+0B,oBAAqB/uB,OAAQhG,KAAKgG,OAAQqD,aAAcrJ,KAAKyH,kBAAmBotB,oBAAqB70B,KAAK60B,2B,GA/FxK9vB,aCAnBgxB,G,YACnB,aAAe,IAAD,8BACZ,+CACK/vB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKg0B,oBAAsB,EAAKA,oBAAoBh0B,KAAzB,gBAC3B,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK8zB,oBAAsBA,GAAoB9zB,KAApB,gBAG3B,EAAKI,MAAQ,CACXrC,KAAM,CAAC+D,MAAO,GAAImL,MAAO,IACzBM,YAAaC,eAAY8mB,cACzBz4B,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCpD,GAAI,KACJ2E,MAAO,KACPmL,MAAO,KACPtR,KAAM,GAlBI,E,kFAuBZmF,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,WAAY/B,KAAKxD,W,+BAS3C,IACMsG,EADSwyB,wBAAat1B,KAAKmB,MAAMmN,YAAYinB,qBAAqBC,OACnDx4B,KAAI,SAAAy4B,GAAK,OAAMA,EAAM9sB,KAAK+sB,OAAmBD,EAAM9sB,KAAf,QAAqBzL,KAAK,MAC/EU,EAAO,CAACM,GAAI8B,KAAKmB,MAAMjD,GAAI2E,MAAO7C,KAAKmB,MAAM0B,MAAOqC,QAASpC,EAAOuvB,WAAYryB,KAAKmB,MAAMiwB,UAAWpjB,MAAOsnB,wBAAat1B,KAAKmB,MAAMmN,YAAYinB,sBACrJ,GAAIv1B,KAAKmB,MAAM0B,MACbb,EAAyB,QAASpE,EAAMoC,KAAKmB,MAAMvE,WAC9C,CACQoD,KACRsyB,IAAIG,OAAOzF,MAAMntB,EAAK81B,gBAAiB91B,EAAKmtB,U,0CAKnDhtB,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QAChElI,KAAK4H,SAASjL,OAAd,QACFqF,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,OAAgCqD,KAAKmB,MAAMvE,S,uEAS5E,IAAIkC,EAAO+C,EAAWK,aAEtB,GAAIpD,EAAK,CACP,IAAMsP,EAAeC,0BAAevP,EAAKkP,OACnCM,EAAcC,eAAYC,kBAAkBJ,GAClDpO,KAAKyB,SAAS,CACZ3C,KAAMA,EACN+D,MAAO/D,EAAK+D,MACZ3E,GAAIY,EAAKZ,GACToQ,YAAaA,IAGjBvQ,QAAQC,IAAIc,K,wCAGI4K,GAChB1J,KAAKyB,SAASiI,K,0CAGI4E,GAChBtO,KAAKyB,SAAS,CACd6M,kB,oCAOFtO,KAAK2J,UAAUC,SAAS,a,+BAIhB,IAAD,EACuC5J,KAAKmB,MAA3CrC,EADD,EACCA,KAAM+D,EADP,EACOA,MAAMyL,EADb,EACaA,YAAazK,EAD1B,EAC0BA,SACjC,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQhB,MAAOhD,EAAKi2B,YACpB,kBAAC,GAAD,CAAUh3B,KAAMA,EAAM+D,MAAOA,EAAOgB,SAAUA,EAAUyK,YAAaA,EAAaymB,oBAAqB/0B,KAAK+0B,oBAAqB/uB,OAAQhG,KAAKgG,OAAQqD,aAAcrJ,KAAKyH,kBAAmBotB,oBAAqB70B,KAAK60B,2B,GA1GtL9vB,aCiBzBixB,GApCU,SAAC/wB,GACxB,GAAIA,EAAMnB,eAAiBmB,EAAMnB,cAAc3D,OAAS,EAAG,CAAC,IAKjD81B,EAAT,SAAoBC,GAClB,IAAKA,EAAaC,KAChB,MAAO,aAGX,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,MACA,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAM3tB,WAAS,GACZvD,EAAMnB,cAAc9G,KAAI,SAACk5B,GAAD,OACvB,kBAAC,IAAD,CACEhzB,UAAW,SAAW+yB,EAAWC,GACjCj5B,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IACjClE,KAAM,IAAMyzB,EAAaE,YAAc,IAAMF,EAAaG,UAC1DxzB,OAnBSO,EAmBU8yB,EAAa9yB,QAlBlC,kBAAC,IAAD,CAAM6E,KAAK,cAAc7E,EAAQyJ,WAmB/BlE,KAAMutB,EAAaI,kBAAkBzzB,OAErC,yBAAKsF,KAAK,QAAQoF,IAAK2oB,EAAa9yB,QAAQoK,OAAQC,MAAM,KAAKC,OAAO,QAtBlF,IAAqBtK,OA2BjB,kBAAC,IAAD,OAIJ,OAAQ,8BCnBGmzB,GAdW,SAACtxB,GACzB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAKiE,eAClB,kBAAC,IAAD,CAAMwvB,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,WAIb,kBAAC,GAAD,CAAkBzvB,cAAemB,EAAMnB,cAAe+J,SAAU5I,EAAM4I,aCNvD2oB,G,YACnB,aAAe,IAAD,8BACZ,+CACKh6B,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK0rB,SAAWA,GAAS1rB,KAAT,gBAChB,EAAKmJ,YAAc,EAAKA,YAAYnJ,KAAjB,gBACnB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK2yB,OAAS,EAAKA,OAAO3yB,KAAZ,gBACd,EAAK8M,SAAW,EAAKA,SAAS9M,KAAd,gBAGhB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCwC,cAAe,GACf6vB,MAAO,KACPj3B,KAAM,GAdI,E,kFAkBZmF,EAAWC,GAAG,WAAY9B,KAAKxD,SAC/BqF,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,WAAY/B,KAAKxD,SAC3CqF,EAAWE,eAAe,eAAgB/B,KAAKnB,e,0CAK/CmB,KAAKysB,WACLzsB,KAAK6I,a,iCAIL7G,EAAkB,gBAAiBhC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,6BAG9D8M,GAAM,IAAD,OACV1J,KAAKyB,SAAS,CAAEqC,cAAe,GAAIpH,KAAM,IACzCsD,KAAKyB,SAASiI,GAAK,WACjB1H,EAAkB,uBAAwB,EAAKb,MAAMzE,KAAM,CAAEs3B,EAAG,EAAK7yB,MAAMwyB,a,iCAKnE,IAAD,OACL3zB,KAAKmB,MAAMwyB,OAAS3zB,KAAKmB,MAAMwyB,MAAMxzB,OAAS,EAChDH,KAAKyB,SAAS,CAAE/E,KAAMsD,KAAKmB,MAAMzE,KAAO,IAAK,WAC3CsF,EAAkB,uBAAwB,EAAKb,MAAMzE,KAAM,CAACs3B,EAAG,EAAK7yB,MAAMwyB,OAAS,EAAKxyB,MAAMvE,UAGhGoD,KAAKyB,SAAS,CAAE/E,KAAMsD,KAAKmB,MAAMzE,KAAO,IAAK,WAC3CsF,EAAkB,gBAAiB,EAAKb,MAAMzE,KAAM,GAAI,EAAKyE,MAAMvE,Y,oCAQvE,IAAIs5B,EAAer0B,EAAWK,aAC1Bg0B,GACFl2B,KAAKyB,SAAS,CAAEqC,cAAe9D,KAAKmB,MAAM2C,cAAc9G,KAAI,SAAAi3B,GAAE,OAAKA,EAAG/1B,KAAOg4B,EAAah4B,GAAKpB,OAAOgL,OAAO,GAAImsB,EAAIiC,GAAgBjC,S,gCAKvI,IAAInwB,EAAgBjC,EAAWrF,UAC3BuD,EAAQ8B,EAAWM,WACnB2B,EAAc3D,OAAS,GAAe,iBAAVJ,GAC9BC,KAAKyB,SAAS,CACZqC,cAAe9D,KAAKmB,MAAM2C,cAAciE,OAAOjE,KAInD9B,EAAsB,gBADX,GACkChC,KAAKmB,MAAMvE,S,kCAG9Cm1B,EAAkBC,EAAoBC,GAA6D,IAAvCC,EAAsC,uDAAxB,KAAMC,EAAkB,uDAAN,KAClGv0B,EAAO,CAAEm0B,iBAAkBA,EAAkBC,mBAAoBA,EAAoBC,qBAAsBA,EAAsBC,YAAaA,EAAaC,UAAWA,GAC1KnwB,EAAsB,eAAgBpE,EAAMoC,KAAKmB,MAAMvE,S,+BAG/C,IACAkH,EAAkB9D,KAAKmB,MAAvB2C,cACR,OAAQ,kBAAC,GAAD,CAAmBoG,YAAalK,KAAKkK,YAAa2D,SAAU7N,KAAK6N,SAAU/J,cAAeA,EAAe4vB,OAAQ1zB,KAAK0zB,a,GAtFxFvqB,IAAMpE,WCsCjC0xB,GAvCK,SAACxxB,GACnB,OAAIA,EAAMkG,SACRpN,QAAQC,IAAIiH,EAAMkG,QAAQvH,OAExB,kBAAC,IAAMH,SAAP,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKmK,OAAK,GACR,kBAAC,IAAD,CAAKH,MAAM,OAEX,kBAAC,IAAD,CAAKA,MAAM,MACT,kBAAC,IAAD,KAAQ,kBAAC,GAAD,CAAiBhR,MAAOwI,EAAMkG,QAASpL,MAAM,UAAUmK,YAAajF,EAAMiF,YAAaC,WAAW,UAAUC,SAAUnF,EAAMkG,QAAQjN,SAIlJ,kBAAC,IAAD,CAAK0P,OAAK,GACR,kBAAC,IAAD,CAAKH,MAAM,MAAMiB,YAAY,MAC3B,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAYxL,UAAU,SAAS+B,EAAMkG,QAAQtI,OAC7C,kBAAC,IAAD,CAAaK,UAAU,yBAAyB+B,EAAMkG,QAAQjG,WAGlE,kBAAC,IAAD,CAAKuI,MAAM,MAAMiB,YAAY,MAC3B,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAYxL,UAAU,SAASrD,EAAK62B,QACpC,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAM/rB,QAAS1F,EAAMkG,QAAQ/H,QAAQyJ,SAAU5E,KAAM,aAAehD,EAAMkG,QAAQ/H,QAAQlF,IAAI,yBAAKgF,UAAU,wBAAuB,yBAAKqK,IAAKtI,EAAMkG,QAAQ/H,QAAQoK,OAAQC,MAAM,KAAKC,OAAO,aAMtM,kBAAC,IAAD,KAAa7N,EAAK82B,cAClB,kBAAC,GAAD,CAAU/yB,MAAOqB,EAAMkG,QAAQvH,MAAOsG,YAAajF,EAAMiF,YAAaC,WAAW,UAAUC,SAAUnF,EAAMkG,QAAQjN,OAI/G,MC9BSwJ,G,YACnB,aAAe,IAAD,8BACZ,+CACK/I,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKmJ,YAAc,EAAKA,YAAYnJ,KAAjB,gBACnB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0rB,SAAWA,GAAS1rB,KAAT,gBAEhB,EAAKI,MAAQ,CACXgK,QAAS,KACTJ,aAAa,EACbnO,MAAOwE,OAAOC,aAAaC,QAAQ,UAVzB,E,kFAgBZO,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,0CAI/CmB,KAAKysB,WACLzqB,EAAsB,WAAYhC,KAAK4H,SAASjL,OAAd,UAAmCqD,KAAKmB,MAAMvE,S,oCAIhF,IAAIuO,EAAUtJ,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACnBgJ,GAAqB,YAAVpL,GACbC,KAAKyB,SAAS,CACZ0J,QAASA,IAGbpN,QAAQC,IAAI,UAAWmN,K,oCAIvB,IAAIA,EAAUtJ,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACpBgJ,GAAqB,YAAVpL,GACZC,KAAKyB,SAAS,CACZ0J,QAASA,IAGbpN,QAAQC,IAAImN,K,4BAKZ,GAAInL,KAAKmB,MAAMgK,SAAWnL,KAAKmB,MAAMgK,QAAQtE,SAC3C,OACE,kBAAC,IAAD,CAAKoB,KAAM,aAAajI,KAAKmB,MAAMgK,QAAQjN,GAAG,QAASsG,OAAO,aAAc0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,QACpH,kBAAC,IAAD,CAAMG,IAAI,UAAUC,OAAO,UAAUC,GAAG,kBACxC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,sB,kCAMtC2qB,EAAkBC,EAAoBC,GAAwD,IAAlCC,EAAiC,uDAArB,KAAMC,EAAe,uDAAL,KAC9Fv0B,EAAO,CAACm0B,iBAAkBA,EAAkBC,mBAAoBA,EAAoBC,qBAAsBA,EAAsBC,YAAaA,EAAaC,UAAWA,GACzKnwB,EAAsB,eAAgBpE,EAAMoC,KAAKmB,MAAMvE,S,+BAG/C,IAAD,EACwBoD,KAAKmB,MAA7BgK,EADA,EACAA,QAASJ,EADT,EACSA,YAChB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQlI,MAAOhD,EAAKgE,SAAUwE,SAAUxI,EAAKkG,MAC7C,kBAAC,IAAD,CAAMutB,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,WAIVvzB,KAAKsI,MACN,kBAAC,GAAD,CAAa6C,QAASA,EAASJ,YAAaA,EAAab,YAAalK,KAAKkK,mB,GAjF/CnF,aC0BrB6xB,GAjCK,SAAC3xB,GACnB,OAAIA,EAAMpB,UAAYoB,EAAMpB,SAAS1D,OAAS,EAE1C,kBAAC,IAAMsD,SAAP,KACA,kBAAC,IAAD,CAAKmK,OAAK,GACP3I,EAAMpB,SAAS7G,KAAI,SAACmO,GAAD,OAClB,kBAAC,IAAD,CAAKsC,MAAM,MAAMiB,YAAY,KAAKzR,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KACjE,kBAAC,IAAD,CAAMzD,UAAU,sBACd,kBAAC,IAAD,CAAYA,UAAU,aACpB,yBAAKA,UAAU,wBAAuB,yBAAKqK,IAAKpC,EAAQqC,OAAQC,MAAM,KAAKC,OAAO,QAClF,yBAAKxK,UAAU,wBAAuB,kBAAC,IAAD,CAAMyH,QAASQ,EAAQtI,MAAOK,UAAU,aAAa+E,KAAM,aAAekD,EAAQjN,IAAKiN,EAAQtI,MAAMkJ,UAAU,EAAG,MACxJ,yBAAK7I,UAAU,sBAAqB,kBAAC,GAAD,CAAiBzG,MAAO0O,EAASpL,MAAM,UAAUmK,YAAajF,EAAMiF,YAAaC,WAAW,UAAUC,SAAUe,EAAQjN,OAE9J,kBAAC,IAAD,CAAagF,UAAU,mBACnB,0BAAOA,UAAU,SAASiI,EAAQjG,QAAQ6G,UAAU,EAAG,KAAO,OAC9D,yBAAK7I,UAAU,sBACb,kBAAC,IAAD,CAAMA,UAAU,aAAa+E,KAAM,aAAekD,EAAQjN,IACvD2B,EAAKmD,KACN,uBAAGE,UAAU,uCAYvB,8BCeG2zB,GA9CM,SAAC5xB,GAiBpB,OACE,kBAAC,IAAD,KAME,kBAAC,IAAD,CAAQpC,MAAOhD,EAAKgE,UAClB,kBAAC,IAAD,CAAMyvB,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,UAEX,kBAAC,IAAD,CAAWC,OAAO,GAChB,kBAAC,IAAD,CACEC,kBAAmB5zB,EAAK6K,OACxBjF,YAAa5F,EAAK6zB,OAClBrvB,SAAU,SAACC,GACTW,EAAMyuB,OAAO,CAAEC,MAAOrvB,EAAEE,OAAO1B,aAKvC,yBAAK8wB,MAAO,CAACC,UAAW,WAAxB,KACA,kBAAC,IAAD,MAtCJ,SAAarxB,GACX,IAAIG,EAAS,GAab,OAZIsC,EAAM1D,SACR0D,EAAM1D,QAAQvE,KAAI,SAAC4F,GACbA,EAAGC,QAAUL,GAAKI,EAAGE,OACvBH,EAAOvC,KACL,kBAAC,IAAD,CAAK6H,KAAK,gBAAgBzD,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,cACxF,kBAAC,IAAD,CAAMG,IAAI,SAASC,OAAO,SAASC,GAAG,iBACtC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,wBAM3CzE,EAyBJ2F,CAAI,eACL,kBAAC,GAAD,CAAazE,SAAUoB,EAAMpB,SAAUqG,YAAajF,EAAMiF,YAAa2D,SAAU5I,EAAM4I,aCpCxEipB,G,YACnB,aAAe,IAAD,8BACZ,+CACKt6B,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK0rB,SAAWA,GAAS1rB,KAAT,gBAChB,EAAKmJ,YAAc,EAAKA,YAAYnJ,KAAjB,gBACnB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK2yB,OAAS,EAAKA,OAAO3yB,KAAZ,gBACd,EAAK8M,SAAW,EAAKA,SAAS9M,KAAd,gBAEhB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCuC,SAAU,GACV8vB,MAAO,KACPj3B,KAAM,EACN6E,QAAS,KACTC,UAAW,KACXuyB,eAAe,EACfX,eAAe,GAlBL,E,kFAsBZvxB,EAAWC,GAAG,WAAY9B,KAAKxD,SAC/BqF,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,WAAY/B,KAAKxD,SAC3CqF,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI/CqB,KAAKysB,WACLzsB,KAAK6I,a,oCAKL,IAAI5G,EAAOJ,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBF,GAAkB,aAAVlC,GACVC,KAAKyB,SAAS,CACZF,QAASU,EAAKG,YACdZ,UAAWS,EAAKM,e,iCAOpBP,EAAkB,WAAYhC,KAAKmB,MAAMzE,KAAM,GAAKsD,KAAKmB,MAAMvE,OAC/DoF,EAAsB,QAAS,OAAQhC,KAAKmB,MAAMvE,S,6BAG7C8M,GAAM,IAAD,OACV1J,KAAKyB,SAAS,CAAEoC,SAAU,GAAInH,KAAM,IACpCsD,KAAKyB,SAASiI,GAAK,WACjB1H,EAAkB,kBAAmB,EAAKb,MAAMzE,KAAM,CAAEs3B,EAAG,EAAK7yB,MAAMwyB,OAAS,EAAKxyB,MAAMvE,Y,oCAM5F,IAAIuO,EAAUtJ,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACpBgJ,GAAqB,YAAVpL,GACZC,KAAKyB,SAAS,CAACoC,SAAU7D,KAAKmB,MAAM0C,SAAS7G,KAAI,SAAAi3B,GAAE,OAAKA,EAAG/1B,KAAOiN,EAAQjN,GAAKpB,OAAOgL,OAAO,GAAImsB,EAAI9oB,GAAW8oB,S,iCAMxG,IAAD,OACLj0B,KAAKmB,MAAMwyB,OAAS3zB,KAAKmB,MAAMwyB,MAAMxzB,OAAS,EAChDH,KAAKyB,SAAS,CAAE/E,KAAMsD,KAAKmB,MAAMzE,KAAO,IAAK,WAC3CsF,EAAkB,kBAAmB,EAAKb,MAAMzE,KAAM,CAACs3B,EAAG,EAAK7yB,MAAMwyB,OAAS,EAAKxyB,MAAMvE,WAG3FoD,KAAKyB,SAAS,CAAE/E,KAAMsD,KAAKmB,MAAMzE,KAAO,IAAK,WAC3CsF,EAAkB,WAAY,EAAKb,MAAMzE,KAAM,GAAI,EAAKyE,MAAMvE,UAEhEoD,KAAKyB,SAAS,CAAE2xB,eAAe,O,gCAMjC,IAAIvvB,EAAWhC,EAAWrF,UACtBuD,EAAQ8B,EAAWM,WACnB0B,EAAS1D,OAAS,GAAe,kBAAVJ,GACzBC,KAAKyB,SAAS,CACZoC,SAAUA,IAGVA,EAAS1D,OAAS,GAAe,YAAVJ,GACzBC,KAAKyB,SAAS,CACZoC,SAAU7D,KAAKmB,MAAM0C,SAASkE,OAAOlE,KAGzC7D,KAAKyB,SAAS,CAAE2xB,eAAe,M,kCAGrBrB,EAAkBC,EAAoBC,GAAwD,IAAlCC,EAAiC,uDAArB,KAAMC,EAAe,uDAAL,KAC9Fv0B,EAAO,CAACm0B,iBAAkBA,EAAkBC,mBAAoBA,EAAoBC,qBAAsBA,EAAsBC,YAAaA,EAAaC,UAAWA,GACzKnwB,EAAsB,eAAgBpE,EAAMoC,KAAKmB,MAAMvE,S,+BAG/C,IAAD,EAC+CoD,KAAKmB,MAApD0C,EADA,EACAA,SAAUtC,EADV,EACUA,QAAoB6xB,GAD9B,EACmB5xB,UADnB,EAC8B4xB,eACrC,OACE,kBAAC,GAAD,CACElpB,YAAalK,KAAKkK,YAAawpB,OAAQ1zB,KAAK0zB,OAC5C7lB,SAAU7N,KAAK6N,SAAUhK,SAAUA,EACnCtC,QAASA,EAAS6xB,cAAeA,Q,GApHJjqB,IAAMpE,WC8B1BgyB,GAnCG,SAAC9xB,GACnB,OAAIA,EAAMkG,QAEN,kBAAC,IAAM1H,SAAP,KACE,kBAAC,IAAD,CAAMyC,MAAI,GACR,kBAAC,IAAD,CACEV,MAAO3F,EAAKgD,MACZnF,KAAK,OACL+H,YAAY,MACZ3C,MAAOmC,EAAMpC,MACb6C,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAExG,MAAOyB,EAAEE,OAAO1B,WAGzC,kBAAC,IAAD,CACE0C,MAAO3F,EAAKm3B,QACZt5B,KAAK,WACL+H,YAAY,MACZ3C,MAAOmC,EAAMC,QACboH,WAAS,EACT5G,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEnE,QAASZ,EAAEE,OAAO1B,YAI7C,kBAAC,IAAD,CAAOuI,QAAM,EAACnI,UAAU,WACtB,kBAAC,IAAD,CAAKoI,IAAI,KACP,kBAAC,IAAD,CAAQpI,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,WAKxD,MCrCP,SAAS6uB,GAAoB12B,GAClC,OAAO,IAAIirB,SACT,SAACY,EAASD,GACR,IAAMgB,EAAM,IAAIiK,eAChBjK,EAAIkK,KAAK,OAAQ,oCACjBlK,EAAImK,iBAAiB,gBAAiB,6BACtC,IAAMt3B,EAAO,IAAIU,SACjBV,EAAKW,OAAO,gBAAiBJ,GAC7B4sB,EAAI7U,KAAKtY,GACTmtB,EAAIpa,iBAAiB,QAAQ,WAC3B,IAAMpT,EAAWgK,KAAKmP,MAAMqU,EAAIoK,cAChCnL,EAAQzsB,MAEVwtB,EAAIpa,iBAAiB,SAAS,WAC5B,IAAM7S,EAAQyJ,KAAKmP,MAAMqU,EAAIoK,cAC7BpL,EAAOjsB,S,ICSMm5B,G,YACnB,aAAe,IAAD,8BACZ,+CACKjxB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKg0B,oBAAsB,EAAKA,oBAAoBh0B,KAAzB,gBAC3B,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK8zB,oBAAsBA,GAAoB9zB,KAApB,gBAG3B,EAAKI,MAAQ,CACXgK,QAAS,GACTmD,YAAaC,eAAY8mB,cACzBz4B,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCuB,MAAO,KACPqC,QAAS,KACTgF,YAAa,KACbxN,KAAM,GAjBI,E,kFAuBZmF,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,WAAY/B,KAAKxD,W,+BAO3CwF,EAAsB,WADX,CAACa,MAAO7C,KAAKmB,MAAM0B,MAAOqC,QAASlF,KAAKmB,MAAM+D,SACjBlF,KAAKmB,MAAMvE,S,0CAGjC0R,GAClBtO,KAAKyB,SAAS,CACZ6M,kB,wCAKc5E,GAChB1J,KAAKyB,SAASiI,K,0CAKd1J,KAAK6I,a,2GAYL7I,KAAK2J,UAAUC,SAAS,gB,+BAOhB,IAAD,EACwB5J,KAAKmB,MAA7BgK,EADA,EACAA,QAASmD,EADT,EACSA,YAChB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQzL,MAAOhD,EAAKq3B,aAAc7uB,SAAUxI,EAAKkG,OACjD,kBAAC,IAAD,KAAalG,EAAKq3B,cAClB,kBAAC,GAAD,CAAa/rB,QAASA,EAAUmD,YAAaA,EAAaymB,oBAAqB/0B,KAAK+0B,oBAAqB/uB,OAAQhG,KAAKgG,OAASqD,aAAcrJ,KAAKyH,kBAAmBotB,oBAAqB70B,KAAK60B,2B,GA9E5J9vB,aCFtBoyB,G,YACnB,aAAe,IAAD,8BACZ,+CACKnxB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKg0B,oBAAsB,EAAKA,oBAAoBh0B,KAAzB,gBAC3B,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBAEf,EAAKI,MAAQ,CACXgK,QAAS,CAACtI,MAAO,GAAImL,MAAO,IAC5BpR,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCpD,GAAI,KACJ2E,MAAO,KACPqC,QAAS,KACTxI,KAAM,GAfI,E,kFAoBZmF,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,WAAY/B,KAAKxD,W,+BAK3CwF,EAAyB,WADd,CAAC9D,GAAI8B,KAAKmB,MAAMjD,GAAI2E,MAAO7C,KAAKmB,MAAM0B,MAAOqC,QAASlF,KAAKmB,MAAM+D,SACjClF,KAAKmB,MAAMvE,S,0CAItDoD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QAChElI,KAAK4H,SAASjL,OAAd,WACFqF,EAAsB,WAAYhC,KAAK4H,SAASjL,OAAd,UAAmCqD,KAAKmB,MAAMvE,S,uEASlF,IAAIuO,EAAUtJ,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACnBgJ,GAAqB,YAAVpL,GACbC,KAAKyB,SAAS,CACZ0J,QAASA,EACTtI,MAAOsI,EAAQtI,MACf3E,GAAIiN,EAAQjN,GACZgH,QAASiG,EAAQjG,Y,wCAKLwE,GAChB1J,KAAKyB,SAASiI,K,0CAGI4E,GAChBtO,KAAKyB,SAAS,CACd6M,kB,oCAOFtO,KAAK2J,UAAUC,SAAS,gB,+BAIhB,IAAD,EAC4B5J,KAAKmB,MAAhCgK,EADD,EACCA,QAAStI,EADV,EACUA,MAAOqC,EADjB,EACiBA,QACxB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQrC,MAAOhD,EAAKqG,KAAMmC,SAAUxI,EAAKkG,OACzC,kBAAC,IAAD,KAAalG,EAAKq3B,cAClB,kBAAC,GAAD,CAAa/rB,QAASA,EAAStI,MAAOA,EAAOqC,QAASA,EAAU6vB,oBAAqB/0B,KAAK+0B,oBAAqB/uB,OAAQhG,KAAKgG,OAASqD,aAAcrJ,KAAKyH,yB,GAzFrH1C,aCH5BqyB,GAfK,SAACnyB,GACnB,IAAI5B,EAAU,CAAC,4BAAQP,MAAM,MAC7B,GAAGmC,EAAMoyB,MACP,IAAK,IAAIp3B,EAAI,EAAGA,EAAIgF,EAAMoyB,MAAMl3B,OAAQF,IACtCoD,EAAQjD,KACN,4BAAQ0C,MAAOmC,EAAMoyB,MAAMp3B,GAAG/B,IAC3B+G,EAAMoyB,MAAMp3B,GAAGq3B,QAMxB,OAAOj0B,GCYQk0B,GAvBM,SAACtyB,GACpB,OACE,kBAAC,IAAMxB,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAK23B,iBAClB,kBAAC,IAAD,CAAMtxB,MAAI,EAACyH,OAAK,GACd,kBAAC,IAAD,CACE9K,MAAOhD,EAAKy3B,MACZ1xB,aAAW,GAEX,4BAAQxB,KAAK,UACXC,SAAU,SAACC,GAASW,EAAMoE,aAAa,CAAEouB,QAASnzB,EAAEE,OAAO1B,UAC3D,kBAAC,GAAD,CAAau0B,MAAOpyB,EAAMoyB,WAIlC,kBAAC,IAAD,CAAOhsB,QAAM,EAACsC,OAAK,GACjB,kBAAC,IAAD,CAAKrC,IAAI,KACP,kBAAC,IAAD,CAAQpI,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,YCuBrD0xB,GAxCE,SAACzyB,GACd,IAAIoB,EAAO,GACb,GAAGpB,EAAMoyB,MAAM,CAGb,IAHc,IAAD,WAGJp3B,GACI,GACToG,EAAKjG,KAAK,wBAAInD,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAC/C,wBAAI1J,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAAM1B,EAAMoyB,MAAMp3B,GAAG/B,IAC1D,wBAAIjB,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAAM1B,EAAMoyB,MAAMp3B,GAAGq3B,OAC1D,wBAAIp0B,UAAU,gBAAgBjG,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAC3D,kBAAC,IAAD,CAAQI,MAAM,OAAOrC,QAAS,kBAAMO,EAAM0yB,WAAW1yB,EAAMoyB,MAAMp3B,GAAG/B,MAClE,kBAAC,IAAD,CAAMgJ,IAAI,WAAWC,OAAO,WAAWC,GAAG,wBAP3CnH,EAAI,EAAGA,EAAIgF,EAAMoyB,MAAMl3B,OAAQF,IAAK,GAApCA,GAaX,OACE,yBAAKiD,UAAU,mBACb,+BACE,+BACE,4BACE,kCACA,uCAIJ,+BACGmD,KAQT,OAAO,MCFMuxB,GAlCW,SAAC3yB,GACvB,OACI,kBAAC,IAAMxB,SAAP,KACI,kBAAC,IAAD,KAAa5D,EAAKg4B,qBAClB,kBAAC,IAAD,CAAM3xB,MAAI,EAACyH,OAAK,GACZ,kBAAC,IAAD,CACInI,MAAO3F,EAAK8tB,KACZjwB,KAAK,OACL+H,YAAY,MACZC,QAAS,SAACpB,GACNW,EAAMoE,aAAa,CAAEyuB,aAAcxzB,EAAEE,OAAO1B,WAGpD,kBAAC,IAAD,CACI0C,MAAO3F,EAAKiD,MACZpF,KAAK,SACLkJ,cAAc,EACdnB,YAAY,mBACZpB,SAAU,SAACC,GACPW,EAAMoE,aAAa,CAAE0uB,aAAczzB,EAAEE,OAAO1B,UAGhD,4BAAQA,OAAO,GAAOjD,EAAKm4B,MAC3B,4BAAQl1B,OAAO,GAAQjD,EAAKo4B,SAGpC,kBAAC,IAAD,CAAO5sB,QAAM,EAACsC,OAAK,GACf,kBAAC,IAAD,CAAKrC,IAAI,KACL,kBAAC,IAAD,CAAQpI,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMizB,YAAar4B,EAAKmG,YCcnEmyB,GA3CK,SAAClzB,GACjB,IAAIoB,EAAO,GACX,GAAIpB,EAAM1D,QAAS,CAGf,IAHgB,IAAD,WAGNtB,GACI,GACToG,EAAKjG,KAAK,wBAAInD,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAC3C,wBAAI1J,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAAM1B,EAAM1D,QAAQtB,GAAG4C,OAC5D,wBAAI5F,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAAM9G,EAAKoF,EAAM1D,QAAQtB,GAAG6C,QACjE,wBAAII,UAAU,gBAAgBjG,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,KAC3D,kBAAC,IAAD,CAAQI,MAAM,OAAOrC,QAAS,kBAAMO,EAAMmzB,cAAcnzB,EAAM1D,QAAQtB,GAAG4C,SACrE,kBAAC,IAAD,CAAMqE,IAAI,WAAWC,OAAO,WAAWC,GAAG,wBAPjDnH,EAAI,EAAGA,EAAIgF,EAAM1D,QAAQpB,OAAQF,IAAK,GAAtCA,GAaT,OACI,kBAAC,IAAMwD,SAAP,KACA,kBAAC,IAAD,KAAa5D,EAAKw4B,qBAClB,yBAAKn1B,UAAU,mBACX,+BACI,+BACI,4BACI,4BAAKrD,EAAKgD,OACV,4BAAKhD,EAAKiD,SAIlB,+BACKuD,MASjB,OAAQ,MCbDiyB,GAvBE,SAACrzB,GAChB,OAAIA,EAAM3B,KAEN,kBAAC,IAAMG,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAKgD,OAClB,kBAAC,IAAD,CAAMyE,eAAA,GACJ,kBAAC,IAAD,KAAWrC,EAAM3B,KAAKT,QAGxB,kBAAC,GAAD,CAAoBtB,QAAS0D,EAAM1D,QAAS62B,cAAenzB,EAAMmzB,gBACjE,kBAAC,GAAD,CAAoBF,WAAYjzB,EAAMizB,WAAY7uB,aAAcpE,EAAMoE,eAGtE,kBAAC,GAAD,CAAgBguB,MAAOpyB,EAAMszB,cAAeZ,WAAY1yB,EAAM0yB,aAC9D,kBAAC,GAAD,CAAgBN,MAAOpyB,EAAMoyB,MAAQrxB,OAAQf,EAAMe,OAAQqD,aAAcpE,EAAMoE,gBAM5E,MCTU3B,G,YACnB,aAAe,IAAD,8BACZ,+CACK/I,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKiF,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAK42B,WAAa,EAAKA,WAAW52B,KAAhB,gBAClB,EAAKm3B,WAAa,EAAKA,WAAWn3B,KAAhB,gBAClB,EAAKq3B,cAAgB,EAAKA,cAAcr3B,KAAnB,gBAIrB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCgC,KAAM,KACNpF,GAAI,KACJm5B,MAAO,KACPkB,cAAe,KACfd,QAAS,KACTK,aAAc,GACdC,cAAc,EACdx2B,QAAS,MArBC,E,kFA0BZM,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,WAAY9B,KAAKxD,SAC/BqF,EAAWC,GAAG,mBAAoB9B,KAAKrB,e,6CAIvCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,WAAY/B,KAAKxD,SAC3CqF,EAAWE,eAAe,mBAAoB/B,KAAKrB,e,0CAInDqD,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,OAAgCqD,KAAKmB,MAAMvE,OAC1EoF,EAAkB,QAAShC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,oCAI3D,IAAI0G,EAAOzB,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBmB,GAAkB,SAAVvD,GACVC,KAAKyB,SAAS,CACZ6B,KAAMA,EACNpF,GAAIoF,EAAKpF,GACTq6B,cAAej1B,EAAK+zB,MACpB91B,QAAS+B,EAAK/B,Y,gCAMlB,IAAI81B,EAAQx1B,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnBk1B,GAAmB,SAAVt3B,GACXC,KAAKyB,SAAS,CACZ41B,MAAOA,M,+BAOXr1B,EAAsB,oBADX,CAAEmB,QAASnD,KAAKmB,MAAMjD,GAAIu5B,QAASz3B,KAAKmB,MAAMs2B,SACRz3B,KAAKmB,MAAMvE,S,mCAK5DoF,EAAsB,kBADX,CAAE9D,GAAI8B,KAAKmB,MAAMjD,GAAIs6B,cAAex4B,KAAKmB,MAAM22B,aAAcW,cAAez4B,KAAKmB,MAAM42B,cACnD/3B,KAAKmB,MAAMvE,S,wCAG1C8M,GAChB1J,KAAKyB,SAASiI,K,4BAId,GAAI1J,KAAKmB,MAAMmC,KACb,OACE,kBAAC,IAAD,CAAK2E,KAAM,UAAYjI,KAAKmB,MAAMmC,KAAKpF,GAAK,QAASsG,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,QACjH,kBAAC,IAAD,CAAMG,IAAI,UAAUC,OAAO,UAAUC,GAAG,kBACxC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,sB,iCAMvCqwB,GACTz1B,EAAyB,oBAAqB,CAAEy1B,QAASA,EAASt0B,QAASnD,KAAKmB,MAAMjD,IAAM8B,KAAKmB,MAAMvE,S,oCAG3FiG,GACZb,EAAyB,kBAAmB,CAAE9D,GAAI8B,KAAKmB,MAAMjD,GAAI2E,MAAOA,GAAS7C,KAAKmB,MAAMvE,S,+BAGpF,IAAD,EACyCoD,KAAKmB,MAA7CmC,EADD,EACCA,KAAM+zB,EADP,EACOA,MAAOkB,EADd,EACcA,cAAeh3B,EAD7B,EAC6BA,QACpC,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQsB,MAAOhD,EAAKwC,MAAOgG,SAAUxI,EAAKkG,OAC1C,kBAAC,IAAD,MACC/F,KAAKsI,MACN,kBAAC,GAAD,CAAUhF,KAAMA,EAAM+zB,MAAOA,EAAO91B,QAASA,EAAS62B,cAAep4B,KAAKo4B,cAAeG,cAAeA,EAAeL,WAAYl4B,KAAKk4B,WAAYP,WAAY33B,KAAK23B,WAAY3xB,OAAQhG,KAAKgG,OAAQqD,aAAcrJ,KAAKyH,yB,GA5G7L1C,aCKnB2zB,GArBA,SAACzzB,GAEhB,OAAIA,EAAM5C,MAEN,kBAAC,IAAD,CAAMmG,WAAS,GACZvD,EAAM5C,MAAMrF,KAAI,SAACsG,GAAD,OACf,kBAAC,IAAD,CACErG,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IACjClE,KAAM,UAAYa,EAAKpF,GACvB6E,aAAa,EACbF,MAAOS,EAAKT,MACZ4F,MAAM,GACNC,SAAS,GACTC,KAAK,SAKH,8BCHCgwB,GAdG,SAAC1zB,GACjB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAKwC,MAAOgG,SAAUxI,EAAKkG,OAE1C,kBAAC,IAAD,KAAalG,EAAKlC,MAClB,kBAAC,IAAD,CAAKsK,KAAK,aAAazD,OAAO,aAAc0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,cACpF,kBAAC,IAAD,CAAMG,IAAI,SAASC,OAAO,SAASC,GAAG,iBACtC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,oBAE5C,kBAAC,GAAD,CAAU/E,MAAO4C,EAAM5C,UCNRqF,G,YACnB,aAAe,IAAD,8BACZ,+CACKlL,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCe,MAAO,MALG,E,kFASZR,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,WAAY/B,KAAKxD,W,0CAI3CwD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QACpElG,EAAkB,QAAShC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,gCAI3D,IAAIyF,EAAQR,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnBE,GAAmB,SAAVtC,GACXC,KAAKyB,SAAS,CACZY,MAAOA,M,+BAKH,IACDA,EAASrC,KAAKmB,MAAdkB,MACP,OAAO,kBAAC,GAAD,CAAWA,MAAOA,Q,GAvCO8G,IAAMpE,WCsC3B6zB,GAzCE,SAAC3zB,GAChB,GAAIA,EAAM4zB,YACR,IAAIC,GAAgB,OAEhBA,GAAgB,EAEtB,OACE,kBAAC,IAAMr1B,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAKyD,MAClB,kBAAC,IAAD,CAAM4C,MAAI,GACR,kBAAC,IAAD,CACEV,MAAO3F,EAAKgD,MACZnF,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAM3B,KAAKT,MACzB6C,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAExG,MAAOyB,EAAEE,OAAO1B,WAGzC,kBAAC,IAAD,CAAUi2B,OAAK,EAACj2B,OAAO,EAAOk2B,SAAUF,EAAe10B,KAAK,cAAcvB,MAAOhD,EAAKo5B,WACpF50B,SAAU,SAACC,GACTvG,QAAQC,IAAIsG,GACZW,EAAMoE,aAAa,CAAEwvB,YAAatxB,KAAKmP,MAAMpS,EAAEE,OAAO1B,YAG1D,kBAAC,IAAD,CAAUi2B,OAAK,EAACj2B,OAAO,EAAMk2B,QAASF,EAAe10B,KAAK,cAAcvB,MAAOhD,EAAKq5B,QAClF70B,SAAU,SAACC,GACTvG,QAAQC,IAAIsG,GACZW,EAAMoE,aAAa,CAAEwvB,YAAatxB,KAAKmP,MAAMpS,EAAEE,OAAO1B,aAK5D,kBAAC,IAAD,CAAOuI,QAAM,GACX,kBAAC,IAAD,CAAKC,IAAI,KACP,kBAAC,IAAD,CAAQpI,UAAU,MAAM+C,MAAI,EAACkzB,UAAWl0B,EAAM6E,QAASpF,QAASO,EAAMe,QAASnG,EAAKmG,YCpBzEozB,G,YACnB,aAAe,IAAD,8BACZ,+CACKpzB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBAEzB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCgC,KAAM,GACNu1B,aAAa,GATH,E,kFAeZh3B,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAK/CmD,EAAsB,QADX,CAACa,MAAO7C,KAAKmB,MAAM0B,MAAOw2B,aAAcr5B,KAAKmB,MAAM03B,aACzB74B,KAAKmB,MAAMvE,S,wCAIhC8M,GAChB1J,KAAKyB,SAASiI,K,oCAKd1J,KAAK2J,UAAUC,SAAS,a,+BAKhB,IAAD,EACqB5J,KAAKmB,MAA1BmC,EADA,EACAA,KAAMu1B,EADN,EACMA,YACb,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQh2B,MAAOhD,EAAKy5B,UAAWjxB,SAAUxI,EAAKkG,OAC9C,kBAAC,IAAD,KAAalG,EAAKy5B,WAClB,kBAAC,GAAD,CACEh2B,KAAMA,EAAM0C,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAC1CT,aAAcrJ,KAAKyH,kBAAmBoxB,YAAaA,S,GAhDrB9zB,aCCnBgF,G,YACnB,aAAe,IAAD,8BACZ,+CACK/D,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBAGzB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCgC,KAAO,GACPu1B,YAAa,MAXH,E,kFAgBZh3B,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAO/CmD,EAAyB,QADd,CAAC9D,GAAG8B,KAAKmB,MAAMjD,GAAI2E,MAAO7C,KAAKmB,MAAM0B,MAAOw2B,aAAcr5B,KAAKmB,MAAM03B,aACvC74B,KAAKmB,MAAMvE,S,0CAGpDoD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QAChElI,KAAK4H,SAASjL,OAAd,QACFqF,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,OAAiCqD,KAAKmB,MAAMvE,S,oCAM7E,IAAI0G,EAAOzB,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBmB,GAAkB,SAAVvD,GACVC,KAAKyB,SAAS,CACZoB,MAAOS,EAAKT,MACZ3E,GAAIoF,EAAKpF,GACToF,KAAMA,EACNu1B,YAAav1B,EAAK+1B,iB,wCAKN3vB,GAChB1J,KAAKyB,SAASiI,K,oCAMd1J,KAAK2J,UAAUC,SAAS,a,+BAIhB,IAAD,EACyB5J,KAAKmB,MAA1BmC,EADJ,EACIA,KAAMu1B,EADV,EACUA,YACjB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQh2B,MAAOhD,EAAKy5B,UAAWjxB,SAAUxI,EAAKkG,OAC9C,kBAAC,IAAD,KAAalG,EAAKy5B,WAClB,kBAAC,GAAD,CAAUh2B,KAAMA,EAAMu1B,YAAaA,EAAa7yB,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,yB,GA3EnE1C,aCQ7Bw0B,GArBK,SAACt0B,GACnB,OAAIA,EAAMu0B,QAEN,kBAAC,IAAM/1B,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAKgD,OAClB,kBAAC,IAAD,CAAMyE,eAAA,GACJ,kBAAC,IAAD,KAAWrC,EAAMu0B,QAAQ32B,QAG3B,kBAAC,IAAD,KAAahD,EAAKqF,SAClB,kBAAC,IAAD,CAAMoC,eAAA,GACJ,kBAAC,IAAD,KAAWrC,EAAMu0B,QAAQt0B,WAOxB,MCPUwC,G,YACnB,aAAe,IAAD,8BACZ,+CACK/I,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKiF,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAK04B,cAAgB,EAAKA,cAAc14B,KAAnB,gBACrB,EAAKm3B,WAAa,EAAKA,WAAWn3B,KAAhB,gBAClB,EAAKq3B,cAAgB,EAAKA,cAAcr3B,KAAnB,gBAIrB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCk4B,QAAS,KACTt7B,GAAI,KACJm5B,MAAO,KACPkB,cAAe,KACfd,QAAS,KACTK,aAAc,GACdC,cAAc,EACdx2B,QAAS,MArBC,E,kFA0BZM,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,WAAY9B,KAAKxD,SAC/BqF,EAAWC,GAAG,mBAAoB9B,KAAKrB,e,6CAIvCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,WAAY/B,KAAKxD,SAC3CqF,EAAWE,eAAe,mBAAoB/B,KAAKrB,e,0CAInDqD,EAAsB,WAAYhC,KAAK4H,SAASjL,OAAd,UAAmCqD,KAAKmB,MAAMvE,OAChFoF,EAAkB,QAAShC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,oCAI3D,IAAI48B,EAAU33B,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACnBq3B,GAAqB,YAAVz5B,GACbC,KAAKyB,SAAS,CACZ+3B,QAASA,EACTt7B,GAAIs7B,EAAQt7B,GACZq6B,cAAeiB,EAAQnC,MACvB91B,QAASi4B,EAAQj4B,Y,gCAMrB,IAAI81B,EAAQx1B,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnBk1B,GAAmB,SAAVt3B,GACXC,KAAKyB,SAAS,CACZ41B,MAAOA,M,+BAOXr1B,EAAsB,oBADX,CAAE03B,WAAY15B,KAAKmB,MAAMjD,GAAIu5B,QAASz3B,KAAKmB,MAAMs2B,SACXz3B,KAAKmB,MAAMvE,S,mCAK5DoF,EAAsB,qBADX,CAAE9D,GAAI8B,KAAKmB,MAAMjD,GAAIs6B,cAAex4B,KAAKmB,MAAM22B,aAAcW,cAAez4B,KAAKmB,MAAM42B,cAChD/3B,KAAKmB,MAAMvE,S,wCAG7C8M,GAChB1J,KAAKyB,SAASiI,K,4BAId,GAAI1J,KAAKmB,MAAMq4B,QACb,OACE,kBAAC,IAAD,CAAKvxB,KAAM,aAAejI,KAAKmB,MAAMq4B,QAAQt7B,GAAK,QAASsG,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,QACvH,kBAAC,IAAD,CAAMG,IAAI,UAAUC,OAAO,UAAUC,GAAG,kBACxC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,sB,oCAMpCqwB,GACZz1B,EAAyB,oBAAqB,CAAEy1B,QAASA,EAASiC,WAAY15B,KAAKmB,MAAMjD,IAAM8B,KAAKmB,MAAMvE,S,oCAG9FiG,GACZb,EAAyB,qBAAsB,CAAE9D,GAAI8B,KAAKmB,MAAMjD,GAAI2E,MAAOA,GAAS7C,KAAKmB,MAAMvE,S,+BAGvF,IAAD,EAC4CoD,KAAKmB,MAAhDq4B,EADD,EACCA,QAASnC,EADV,EACUA,MAAOkB,EADjB,EACiBA,cAAeh3B,EADhC,EACgCA,QACvC,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQsB,MAAOhD,EAAK8E,SAAU0D,SAAUxI,EAAKkG,OAC7C,kBAAC,IAAD,MACC/F,KAAKsI,MACN,kBAAC,GAAD,CAAakxB,QAASA,EAASnC,MAAOA,EAAO91B,QAASA,EAAS62B,cAAep4B,KAAKo4B,cAAeG,cAAeA,EAAeL,WAAYl4B,KAAKk4B,WAAYuB,cAAez5B,KAAKy5B,cAAezzB,OAAQhG,KAAKgG,OAAQqD,aAAcrJ,KAAKyH,yB,GA5G5M1C,aCKnB40B,GArBG,SAAC10B,GAEnB,OAAIA,EAAMN,SAEN,kBAAC,IAAD,CAAM6D,WAAS,GACZvD,EAAMN,SAAS3H,KAAI,SAACw8B,GAAD,OAClB,kBAAC,IAAD,CACEv8B,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IACjClE,KAAM,aAAe+2B,EAAQt7B,GAC7B6E,aAAa,EACbF,MAAO22B,EAAQ32B,MACf4F,MAAM,GACNC,SAAS,GACTC,KAAK,SAKH,8BCHCixB,GAdM,SAAC30B,GACpB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAK8E,SAAU0D,SAAUxI,EAAKkG,OAE7C,kBAAC,IAAD,KAAalG,EAAKlC,MAClB,kBAAC,IAAD,CAAKsK,KAAK,gBAAgBzD,OAAO,aAAc0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,cACvF,kBAAC,IAAD,CAAMG,IAAI,SAASC,OAAO,SAASC,GAAG,iBACtC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,oBAE5C,kBAAC,GAAD,CAAazC,SAAUM,EAAMN,aCNd+C,G,YACnB,aAAe,IAAD,8BACZ,+CACKlL,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCqD,SAAU,MALA,E,kFASZ9C,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,WAAY/B,KAAKxD,W,0CAI3CwD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QACpElG,EAAkB,WAAYhC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,gCAI9D,IAAI+H,EAAW9C,EAAWrF,UACtBuD,EAAQ8B,EAAWM,WACnBwC,GAAsB,YAAV5E,GACdC,KAAKyB,SAAS,CACZkD,SAAUA,M,+BAKN,IACDA,EAAY3E,KAAKmB,MAAjBwD,SACP,OAAO,kBAAC,GAAD,CAAcA,SAAUA,Q,GAvCCwE,IAAMpE,WCiC3B80B,GApCK,SAAC50B,GAEnB,OADAlH,QAAQC,IAAIiH,GAEV,kBAAC,IAAMxB,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAK25B,SAClB,kBAAC,IAAD,CAAMtzB,MAAI,GACR,kBAAC,IAAD,CACEV,MAAM,QACN8D,WAAY,CAACC,UAAW,OACxB7L,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAMpC,MACpB6C,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAExG,MAAOyB,EAAEE,OAAO1B,WAGzC,kBAAC,IAAD,CACE0C,MAAM,SACN9H,KAAK,OACL4L,WAAY,CAACC,UAAW,OACxBzG,MAAOmC,EAAMC,QACbO,YAAY,OACZC,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEnE,QAASZ,EAAEE,OAAO1B,YAK7C,kBAAC,IAAD,CAAOuI,QAAM,GACX,kBAAC,IAAD,CAAKC,IAAI,KACP,kBAAC,IAAD,CAAQpI,UAAU,MAAM+C,MAAI,EAACkzB,UAAWl0B,EAAM6E,QAASpF,QAASO,EAAMe,QAASnG,EAAKmG,YCfzE8zB,G,YACnB,aAAe,IAAD,8BACZ,+CACK9zB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBAEzB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCuB,MAAO,GACPqC,QAAS,IATC,E,kFAeZrD,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAK/CmD,EAAsB,WADX,CAACa,MAAO7C,KAAKmB,MAAM0B,MAAOqC,QAASlF,KAAKmB,MAAM+D,SACjBlF,KAAKmB,MAAMvE,S,wCAInC8M,GAChB1J,KAAKyB,SAASiI,K,oCAKd1J,KAAK2J,UAAUC,SAAS,gB,+BAKhB,IAAD,EACkB5J,KAAKmB,MAAvB0B,EADA,EACAA,MAAOqC,EADP,EACOA,QACd,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQrC,MAAOhD,EAAKk6B,aAAc1xB,SAAUxI,EAAKkG,OACjD,kBAAC,IAAD,KAAalG,EAAKk6B,cAClB,kBAAC,GAAD,CAAal3B,MAAOA,EAAOqC,QAASA,EAASc,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,yB,GA9CjE1C,aCAtB+0B,G,YACnB,aAAe,IAAD,8BACZ,+CACK9zB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBAGnB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCuB,MAAO,GACP3E,GAAI,KACJgH,QAAS,IAZC,E,kFAkBZrD,EAAWC,GAAG,eAAgB9B,KAAKnB,aACnCgD,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CgD,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI/CqD,EAAsB,WAAYhC,KAAK4H,SAASjL,OAAd,UAAmCqD,KAAKmB,MAAMvE,S,oCAKhF,IAAI48B,EAAU33B,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACnBq3B,GAAqB,YAAVz5B,GACbC,KAAKyB,SAAS,CACZoB,MAAO22B,EAAQ32B,MACf3E,GAAIs7B,EAAQt7B,GACZgH,QAASs0B,EAAQt0B,Y,+BAOrBlD,EAAyB,WADd,CAAC9D,GAAI8B,KAAKmB,MAAMjD,GAAI2E,MAAO7C,KAAKmB,MAAM0B,MAAOqC,QAASlF,KAAKmB,MAAM+D,SACjClF,KAAKmB,MAAMvE,S,wCAItC8M,GAChB1J,KAAKyB,SAASiI,K,oCAKd1J,KAAK2J,UAAUC,SAAS,gB,+BAKhB,IAAD,EACkB5J,KAAKmB,MAAvB0B,EADA,EACAA,MAAOqC,EADP,EACOA,QACd,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQrC,MAAOhD,EAAKk6B,aAAc1xB,SAAUxI,EAAKkG,OACjD,kBAAC,IAAD,KAAalG,EAAKk6B,cAClB,kBAAC,GAAD,CAAal3B,MAAOA,EAAOqC,QAASA,EAASc,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,yB,GApEjE1C,aCW5Bi1B,I,OA3BY,SAAC/0B,GAC1B,OAAIA,EAAMpB,UAAYoB,EAAMpB,SAAS1D,OAAS,GAC5CpC,QAAQC,IAAIiH,EAAMpB,UAEhB,kBAAC,IAAMJ,SAAP,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KACG5D,EAAKgE,UAER,kBAAC,IAAD,KACA,kBAAC,IAAD,KACGoB,EAAMpB,SAAS7G,KAAI,SAACmO,GAAD,OAClB,kBAAC,IAAD,CACE1I,KAAM,aAAa0I,EAAQjN,GAC3B2E,MAAOsI,EAAQtI,MAAMkJ,UAAU,EAAG,cAUtC,+BCQGkuB,GA7BO,SAACh1B,GAEnB,OAAIA,EAAMi1B,UACFj1B,EAAM4B,SAEF,kBAAC,IAAD,CAAK+G,OAAK,GACL3I,EAAMi1B,UAAUl9B,KAAI,SAACm9B,GAAD,OACjB,uBAAGz1B,QAAS,kBAAMO,EAAMm1B,gBAAgBD,KACpC,kBAAC,IAAD,CAAMxxB,KAAMwxB,EAAQE,aAAa,UAC7B,kBAAC,IAAD,CAAMlyB,KAAK,QAAQhB,OAAO,mBAQ1C,kBAAC,IAAD,CAAKyG,OAAK,GACL3I,EAAMi1B,UAAUl9B,KAAI,SAACm9B,GAAD,OACjB,uBAAGlyB,KAAM,cAAckyB,GAAQ,kBAAC,IAAD,CAAMxxB,KAAMwxB,SAOnD,MCRDG,GAlBI,SAACr1B,GAClB,OAAGA,EAAMs1B,SAEL,kBAAC,IAAD,KACGt1B,EAAMs1B,SAASv9B,KAAI,SAACoG,GAAD,OAClB,kBAAC,IAAD,CACAP,MAAOO,EAAQyJ,SACfnE,SAAS,MACTjG,KAAM,aAAaW,EAAQlF,IAC3B,yBAAKiK,KAAK,QAAQoF,IAAKnK,EAAQoK,OAAQC,MAAM,YAM3C,8BCEG+sB,GAhBG,SAACv1B,GAEf,OADAlH,QAAQC,IAAIiH,GACRA,EAAMw1B,UAEF,kBAAC,IAAD,KACI,kBAAC,IAAD,KACK56B,EAAK46B,WAEV,kBAAC,IAAD,KACI,kBAAC,GAAD,CAAYF,SAAUt1B,EAAMw1B,cAIhC,MCEDD,GAfG,SAACv1B,GACf,OAAIA,EAAMy1B,UAEF,kBAAC,IAAD,KACI,kBAAC,IAAD,KACK76B,EAAK66B,WAEV,kBAAC,IAAD,KACI,kBAAC,GAAD,CAAYH,SAAUt1B,EAAMy1B,cAIhC,MC8GDC,GAtHK,SAAC11B,GACNkE,IAAMyxB,SACjB,iBAAM,CACJ,CACEp1B,MAAO,WACP5H,KAAM,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,KAE7C,CACE4H,MAAO,WACP5H,KAAM,CAAC,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,GAAI,CAAC,EAAG,QAG/C,IAGWuL,IAAMyxB,SACjB,iBAAM,CACJ,CAAEC,SAAS,EAAMn9B,KAAM,SAAUwK,SAAU,UAC3C,CAAExK,KAAM,SAAUwK,SAAU,WAE9B,IAGF,OAAIjD,EAAM7B,QAGN,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKlF,GAAG,QAAQgF,UAAU,eAAe43B,WAAS,GAChD,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKrtB,MAAM,MAAMiB,YAAY,MAE3B,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,yBAAKnB,IAAKtI,EAAM7B,QAAQoK,OAAQC,MAAM,OACtC,yBAAKvK,UAAU,gBAAgB+B,EAAM7B,QAAQyJ,UAC7C,yBAAK3J,UAAU,sBAAqB,kBAAC,GAAD,CAAiBzG,MAAOwI,EAAM7B,QAASrD,MAAM,UAAUmK,YAAajF,EAAMiF,YAAaC,WAAW,UAAUC,SAAUnF,EAAM7B,QAAQlF,OAE1K,kBAAC,IAAD,KACE,kBAAC,GAAD,CAAeg8B,UAAWj1B,EAAM7B,QAAQ82B,cAG5C,kBAAC,GAAD,CAAWO,UAAWx1B,EAAM7B,QAAQq3B,UAAWr3B,QAAS6B,EAAM7B,WAGhE,kBAAC,IAAD,CAAKqK,MAAM,MAAMiB,YAAY,MAC7B,kBAAC,GAAD,CAAoB7K,SAAUoB,EAAMpB,WACpC,kBAAC,GAAD,CAAW62B,UAAWz1B,EAAM7B,QAAQs3B,UAAWt3B,QAAS6B,EAAM7B,aAKlE,kBAAC,IAAD,CAAKlF,GAAG,QAAQgF,UAAU,gBACxB,kBAAC,IAAD,CAAK0K,OAAK,GACR,kBAAC,IAAD,CAAKH,MAAM,MAAMiB,YAAY,MAgB1BzJ,EAAMmD,MAAMpL,KAAI,SAAC+9B,GAAD,OACf,kBAAC,IAAMt3B,SAAP,KACE,kBAAC,EAAD,CAAY4B,KAAM01B,EAAE11B,KAAMwB,UAAU,EAAOT,QAAS20B,EAAE30B,QAASY,aAAc/B,EAAM+B,sBAO7F,kBAAC,IAAD,CAAK9I,GAAG,QAAQgF,UAAU,gBACxB,yBAAKA,UAAU,eAAf,4BACA,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKuK,MAAM,MAAMiB,YAAY,OAC3B,yBAAKxL,UAAU,2BACb,yBAAKA,UAAU,iBACb,yBAAKA,UAAU,sBAAf,MAAuC,uCACvC,yBAAKA,UAAU,0BACf,yBAAKA,UAAU,yBACb,yBAAKA,UAAU,uBACb,yBAAKA,UAAU,sBAAf,SACA,yBAAKA,UAAU,uBAAf,SACA,yBAAKA,UAAU,0BAAf,YACA,yBAAKA,UAAU,sBAAf,WAIN,yBAAKA,UAAU,iBACb,yBAAKA,UAAU,sBAAf,MAAuC,uCACvC,yBAAKA,UAAU,0BACf,yBAAKA,UAAU,yBACb,yBAAKA,UAAU,uBACb,yBAAKA,UAAU,sBAAf,SACA,yBAAKA,UAAU,uBAAf,SACA,yBAAKA,UAAU,0BAAf,YACA,yBAAKA,UAAU,sBAAf,gBAYV,MC5GSwE,G,YACnB,aAAe,IAAD,8BACZ,+CACK/I,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKi6B,OAAS,EAAKA,OAAOj6B,KAAZ,gBACd,EAAKmJ,YAAc,EAAKA,YAAYnJ,KAAjB,gBAEnB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnC8B,QAAS,KACTlF,GAAI,KACJkI,QAAS,KACTgC,MAAO,KACPvE,SAAU,KACVgD,UAAU,GAbA,E,kFAkBZhF,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI/CqD,EAAsB,WAAYhC,KAAK4H,SAASjL,OAAd,UAAmCqD,KAAKmB,MAAMvE,S,oCAIhF,IAAIwG,EAAUvB,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACnBiB,GAAqB,YAAVrD,GACbC,KAAKyB,SAAS,CACZ2B,QAASA,EACTlF,GAAIkF,EAAQlF,GACZkI,QAAShD,EAAQgD,QACjBgC,MAAOhF,EAAQgF,MACfvE,SAAUT,EAAQS,SAClBgD,SAAUzD,EAAQyD,a,4BAMtB,GAAI7G,KAAKmB,MAAMiC,SAAWpD,KAAKmB,MAAM0F,SACnC,OACE,kBAAC,IAAD,CAAKoB,KAAM,aAAejI,KAAKmB,MAAMiC,QAAQlF,GAAK,QAASsG,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,QACvH,kBAAC,IAAD,CAAMG,IAAI,UAAUC,OAAO,UAAUC,GAAG,kBACxC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,sB,+BAOhDrJ,QAAQC,IAAI,S,kCAGF+zB,EAAkBC,EAAoBC,GAA6D,IAAvCC,EAAsC,uDAAxB,KAAMC,EAAkB,uDAAN,KAClGv0B,EAAO,CAAEm0B,iBAAkBA,EAAkBC,mBAAoBA,EAAoBC,qBAAsBA,EAAsBC,YAAaA,EAAaC,UAAWA,GAC1KnwB,EAAsB,eAAgBpE,EAAMoC,KAAKmB,MAAMvE,S,+BAG/C,IAAD,EACiDoD,KAAKmB,MAArDiC,EADD,EACCA,QAASgD,EADV,EACUA,QAASgC,EADnB,EACmBA,MAAOvE,EAD1B,EAC0BA,SAAUgD,EADpC,EACoCA,SAC3C,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQhE,MAAOhD,EAAK06B,SAAUU,eAAe,EAAM5yB,SAAUxI,EAAKkG,OAClE,kBAAC,IAAD,CAASm1B,QAAM,EAACC,QAAM,GACpB,kBAAC,IAAD,CAAMC,QAAQ,SAASC,eAAa,GAAC,uBAAGn4B,UAAU,+BAClD,kBAAC,IAAD,CAAMk4B,QAAQ,UAAS,uBAAGl4B,UAAU,6BACpC,kBAAC,IAAD,CAAMk4B,QAAQ,UAAS,uBAAGl4B,UAAU,yBAErClD,KAAKsI,MACN,kBAAC,GAAD,CACElF,QAASA,EAASgD,QAASA,EAASvC,SAAUA,EAC9CuE,MAAOA,EAAO4yB,OAAQh7B,KAAKg7B,OAAQ9wB,YAAalK,KAAKkK,YACrDrD,SAAUA,S,GA/EgB9B,aCYrBu2B,GAvBK,SAACr2B,GAEnB,OAAIA,EAAMs1B,SAEN,kBAAC,IAAD,CAAM/xB,WAAS,GACZvD,EAAMs1B,SAASv9B,KAAI,SAACoG,GAAD,OAClB,kBAAC,IAAD,CACAnG,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IACjClE,KAAM,aAAeW,EAAQlF,GAC7B2E,MAAOO,EAAQyJ,SACfpE,MAAM,GACNC,SAAS,GACTC,KAAK,IAEC,yBAAKR,KAAK,QAAQoF,IAAKnK,EAAQoK,OAAQC,MAAM,KAAKC,OAAO,YAM7D,8BCDG6tB,GAvBM,SAACt2B,GACpB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAK06B,UAClB,kBAAC,IAAD,CAAMjH,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,UAEX,kBAAC,IAAD,CAAWC,OAAO,GAChB,kBAAC,IAAD,CACEC,kBAAmB5zB,EAAK6K,OACxBjF,YAAa5F,EAAK6zB,OAClBrvB,SAAU,SAACC,GACTW,EAAMyuB,OAAO,CAAEC,MAAOrvB,EAAEE,OAAO1B,aAMvC,kBAAC,GAAD,CAAay3B,SAAUt1B,EAAMs1B,SAAUrwB,YAAajF,EAAMiF,gBCd3CxC,G,YACnB,aAAe,IAAD,8BACZ,+CACKlL,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK2yB,OAAS,EAAKA,OAAO3yB,KAAZ,gBACd,EAAKmJ,YAAc,EAAKA,YAAYnJ,KAAjB,gBAInB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCi5B,SAAU,KACV5G,MAAO,MAXG,E,kFAeZ9xB,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,WAAY/B,KAAKxD,W,0CAI3CwD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QACpElG,EAAkB,WAAYhC,KAAKmB,MAAMzE,Q,6BAGpCgN,GAAK,IAAD,OACT1J,KAAKyB,SAASiI,GAAK,WACjB1H,EAAkB,kBAAmB,EAAKb,MAAMzE,KAAM,CAACs3B,EAAG,EAAK7yB,MAAMwyB,a,gCAKvE,IAAI4G,EAAW14B,EAAWrF,UACtBuD,EAAQ8B,EAAWM,WACnBo4B,GAAsB,YAAVx6B,GACdC,KAAKyB,SAAS,CACZ84B,SAAUA,M,kCAKJxI,EAAkBC,EAAoBC,GAAwD,IAAlCC,EAAiC,uDAArB,KAAMC,EAAe,uDAAL,KAC9Fv0B,EAAO,CAACm0B,iBAAkBA,EAAkBC,mBAAoBA,EAAoBC,qBAAsBA,EAAsBC,YAAaA,EAAaC,UAAWA,GACzKnwB,EAAsB,eAAgBpE,EAAMoC,KAAKmB,MAAMvE,S,+BAG/C,IACD29B,EAAYv6B,KAAKmB,MAAjBo5B,SACP,OAAO,kBAAC,GAAD,CAAcA,SAAUA,EAAUrwB,YAAalK,KAAKkK,YAAawpB,OAAQ1zB,KAAK0zB,a,GAxDrDvqB,IAAMpE,W,qBC2F3By2B,GA5FK,SAACv2B,GACnB,OAAIA,EAAMb,MAAQa,EAAMmD,OAASnD,EAAM4B,SAEnC,kBAAC,IAAMpD,SAAP,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAa5D,EAAK47B,cAClB,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAMv1B,MAAI,GACR,kBAAC,IAAD,CACEV,MAAO3F,EAAK67B,UACZh+B,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAMb,KACpBsB,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEjF,KAAME,EAAEE,OAAO1B,WAIxC,kBAAC,IAAD,CACE0C,MAAO3F,EAAK87B,SACZj+B,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAM02B,SACpBj2B,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEsyB,SAAUr3B,EAAEE,OAAO1B,aAKhD,kBAAC,IAAD,KACE,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAQI,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAKmG,UAI9D,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAanG,EAAKq6B,WAClB,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,GAAD,CAAeA,UAAWj1B,EAAMi1B,UAAWrzB,UAAU,EAAMuzB,gBAAiBn1B,EAAMm1B,oBAItF,kBAAC,IAAD,CAAMl0B,MAAI,GACR,kBAAC,IAAD,CACEV,MAAO3F,EAAK+7B,cACZl+B,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAMk1B,OACpBz0B,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAE8wB,OAAQ71B,EAAEE,OAAO1B,aAM9C,kBAAC,IAAD,KACE,kBAAC,IAAD,MACA,kBAAC,IAAD,CAAQI,UAAU,MAAM+C,MAAI,EAACvB,QAASO,EAAM42B,iBAAkBh8B,EAAKmG,UAKvE,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,yBAAKuH,IAAKtI,EAAMuI,OAAQC,MAAM,QAEhC,kBAAC,KAAD,CACEquB,UAAU,EACVC,WAAYl8B,EAAKm8B,aACjB33B,SAAUY,EAAMg3B,OAChBC,gBAAgB,aAChBC,aAAc,CAAC,OAAQ,QAAS,QAChCC,YAAa,WAGhBn3B,EAAMmD,MAAMpL,KAAI,SAAC+9B,GAAD,OACf,kBAAC,IAAMt3B,SAAP,KACE,kBAAC,EAAD,CAAY4B,KAAM01B,EAAE11B,KAAMwB,UAAU,EAAMT,QAAS20B,EAAE30B,QAASY,aAAc/B,EAAM+B,eAClF,kBAAC,EAAD,CAAY3B,KAAM01B,EAAE11B,KAAMW,OAAQf,EAAMo3B,aAAc12B,cAAeV,EAAMq3B,+BAQ3E,MC3ESC,G,YACnB,aAAe,IAAD,8BACZ,+CACKv2B,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKu7B,wBAA0B,EAAKA,wBAAwBv7B,KAA7B,gBAC/B,EAAKiG,aAAe,EAAKA,aAAajG,KAAlB,gBACpB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKs7B,aAAe,EAAKA,aAAat7B,KAAlB,gBACpB,EAAKk7B,OAAS,EAAKA,OAAOl7B,KAAZ,gBACd,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBAGf,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBAEf,EAAKI,MAAQ,CACXiC,QAAS,GACTgF,MAAO,KACPxL,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCqG,OAAQ,GACRvD,KAAM,KACNu3B,SAAU,GACVa,SAAU,GACVhvB,OAAQ,MAvBE,E,kFA6BZ3L,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,mBAAoB9B,KAAKrB,aACvCkD,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,mBAAoB/B,KAAKrB,aACnDkD,EAAWE,eAAe,WAAY/B,KAAKxD,W,0CAI3CwD,KAAK6I,a,iCAKL7G,EAAkB,QAAShC,KAAKmB,MAAMzE,Q,6BAGjC+/B,GACL1+B,QAAQC,IAAIy+B,EAAQ,IACpBz6B,EAAqB,WAAYhC,KAAKmB,MAAMjD,GAAIu+B,EAAQ,GAAIz8B,KAAKmB,MAAMvE,S,+BAMvEoF,EAAyB,WADd,CAAC9D,GAAI8B,KAAKmB,MAAMjD,GAAIkG,KAAMpE,KAAKmB,MAAMiD,KAAMu3B,SAAU37B,KAAKmB,MAAMw6B,UAChC37B,KAAKmB,MAAMvE,S,qCAKtDoF,EAAsB,UADX,CAACgG,QAAShI,KAAKmB,MAAM2F,OAAQ5B,QAASlF,KAAKmB,MAAMwG,QACrB3H,KAAKmB,MAAMvE,S,wCAIlC8M,GAChB1J,KAAKyB,SAASiI,K,8CAGQzM,EAAK6F,EAAOgE,GAClC,IAAIa,EAAS3H,KAAKmB,MAAMwG,OACxB,GAAIA,EAAOxH,OAAS,EAClB,IAAK,IAAIF,EAAI,EAAGA,EAAI0H,EAAOxH,OAAQF,IACjC,GAAI0H,EAAO1H,GAAGkF,KAAOwC,EAAO1H,GAAGkF,MAAQlI,EAAK,CAC1C,IAAI4K,EAAW/K,OAAOgL,OAAO,GAAI9H,KAAKmB,OACtC0G,EAASF,OAAO1H,GAAK,CAAEkF,IAAKlI,EAAK6F,MAAOA,EAAOgE,OAAQA,GACvD9G,KAAKyB,SAASoG,QAEd7H,KAAKyB,SAAS,CAAEkG,OAAQ3H,KAAKmB,MAAMwG,OAAOI,OAAO,CAAE5C,IAAKlI,EAAK6F,MAAOA,EAAQgE,OAAOA,WAIvF9G,KAAKyB,SAAS,CAAEkG,OAAQ3H,KAAKmB,MAAMwG,OAAOI,OAAO,CAAE5C,IAAKlI,EAAK6F,MAAOA,EAAOgE,OAAOA,Q,oCAMpF9G,KAAK2J,UAAUC,SAAS,gB,oCAIxB,IAAIxG,EAAUvB,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACnBiB,GAAqB,YAAVrD,GACbC,KAAKyB,SAAS,CACZ2G,MAAOhF,EAAQgF,MACfhF,QAASA,M,mCAMF6D,GACXjF,EAAyB,UAAW,CAACiF,KAAMA,M,gCAI3C,IAAImB,EAAQvG,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnBiG,GAAmB,SAAVrI,GACXC,KAAKyB,SAAS,CACZ2G,MAAOA,M,+BAOH,IAAD,EAC0CpI,KAAKmB,MAAtCiH,GADT,EACAhF,QADA,EACSgF,OAAOhE,EADhB,EACgBA,KAAMoJ,EADtB,EACsBA,OAAQmuB,EAD9B,EAC8BA,SACrC,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQ94B,MAAOhD,EAAK68B,aAAcr0B,SAAUxI,EAAKkG,OACjD,kBAAC,IAAD,KAAalG,EAAK68B,cAClB,kBAAC,GAAD,CAAat4B,KAAMA,EAAMoJ,OAAQA,EAAQmuB,SAAUA,EAAUvzB,MAAOA,EAAO6zB,OAAQj8B,KAAKi8B,OAAQj1B,aAAchH,KAAKgH,aAAcq1B,aAAcr8B,KAAKq8B,aAAcr2B,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMwyB,wBAAyBt8B,KAAKs8B,wBAAyBjzB,aAAcrJ,KAAKyH,yB,GAjI7O1C,aCTtBw3B,G,YACnB,aAAe,IAAD,8BACZ,+CACKv2B,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKu7B,wBAA0B,EAAKA,wBAAwBv7B,KAA7B,gBAC/B,EAAKiG,aAAe,EAAKA,aAAajG,KAAlB,gBACpB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKs7B,aAAe,EAAKA,aAAat7B,KAAlB,gBACpB,EAAKk7B,OAAS,EAAKA,OAAOl7B,KAAZ,gBACd,EAAKvE,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK86B,gBAAkB,EAAKA,gBAAgB96B,KAArB,gBACvB,EAAKq5B,gBAAkB,EAAKA,gBAAgBr5B,KAArB,gBAKvB,EAAKI,MAAQ,CACXiD,KAAM,KACNu3B,SAAU,KACVvzB,MAAO,KACPtB,OAAQ,KACRV,QAAS,KACT8zB,UAAW,KACXC,OAAQ,KACRv9B,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCqG,OAAQ,GACRzJ,GAAI,KACJs+B,SAAU,GACVhvB,OAAQ,KACR3G,UAAU,GA9BA,E,kFAoCZhF,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,mBAAoB9B,KAAKrB,aACvCkD,EAAWC,GAAG,cAAe9B,KAAKrB,e,6CAIlCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,mBAAoB/B,KAAKrB,aACnDkD,EAAWE,eAAe,cAAe/B,KAAKrB,e,0CAI9CqB,KAAK6I,a,iCAID7I,KAAK4H,SAASjL,OAAd,WACFqF,EAAsB,WAAYhC,KAAK4H,SAASjL,OAAd,UAAmCqD,KAAKmB,MAAMvE,S,6BAI7E6/B,GACL1+B,QAAQC,IAAIy+B,EAAQ,IACpBz6B,EAAqB,WAAYhC,KAAKmB,MAAMjD,GAAIu+B,EAAQ,GAAIz8B,KAAKmB,MAAMvE,S,+BAMvEoF,EAAyB,WADd,CAAC9D,GAAI8B,KAAKmB,MAAMjD,GAAIkG,KAAMpE,KAAKmB,MAAMiD,KAAMu3B,SAAU37B,KAAKmB,MAAMw6B,UAChC37B,KAAKmB,MAAMvE,S,qCAKtDoF,EAAsB,UADX,CAACgG,QAAShI,KAAKmB,MAAM2F,OAAQ5B,QAASlF,KAAKmB,MAAMwG,QACrB3H,KAAKmB,MAAMvE,S,wCAIlD,IAAIgB,EAAO,CAACM,GAAI8B,KAAKmB,MAAMjD,GAAIg8B,UAAWl6B,KAAKmB,MAAMg5B,QACrDn4B,EAAsB,0BAA0BhC,KAAK4H,SAASjL,OAAd,UAAmCiB,EAAMoC,KAAKmB,MAAMvE,S,sCAGtFs9B,GACd,IAAIt8B,EAAO,CAACM,GAAI8B,KAAKmB,MAAMjD,GAAIg8B,UAAWA,GAC1Cl4B,EAAsB,6BAA6BhC,KAAK4H,SAASjL,OAAd,UAAmCiB,EAAMoC,KAAKmB,MAAMvE,S,wCAIvF8M,GAChB1J,KAAKyB,SAASiI,K,8CAGQzM,EAAK6F,EAAOgE,GAClC,IAAIa,EAAS3H,KAAKmB,MAAMwG,OACxB,GAAIA,EAAOxH,OAAS,EAClB,IAAK,IAAIF,EAAI,EAAGA,EAAI0H,EAAOxH,OAAQF,IACjC,GAAI0H,EAAO1H,GAAGkF,KAAOwC,EAAO1H,GAAGkF,MAAQlI,EAAK,CAC1C,IAAI4K,EAAW/K,OAAOgL,OAAO,GAAI9H,KAAKmB,OACtC0G,EAASF,OAAO1H,GAAK,CAAEkF,IAAKlI,EAAK6F,MAAOA,EAAOgE,OAAQA,GACvD9G,KAAKyB,SAASoG,QAEd7H,KAAKyB,SAAS,CAAEkG,OAAQ3H,KAAKmB,MAAMwG,OAAOI,OAAO,CAAE5C,IAAKlI,EAAK6F,MAAOA,EAAQgE,OAAOA,WAIvF9G,KAAKyB,SAAS,CAAEkG,OAAQ3H,KAAKmB,MAAMwG,OAAOI,OAAO,CAAE5C,IAAKlI,EAAK6F,MAAOA,EAAOgE,OAAOA,Q,oCAOpF9G,KAAK2J,UAAUC,SAAS,gB,oCAIxB,IAAIxG,EAAUvB,EAAWK,aACrBnC,EAAQ8B,EAAWM,WACnBiB,GAAqB,YAAVrD,GACbC,KAAKyB,SAAS,CACZvD,GAAIkF,EAAQlF,GACZkK,MAAOhF,EAAQgF,MACfhE,KAAMhB,EAAQgB,KACdu3B,SAAWv4B,EAAQu4B,SACnBnuB,OAAQpK,EAAQoK,OAChB3G,SAAUzD,EAAQyD,SAClBqzB,UAAW92B,EAAQ82B,c,mCAMZjzB,GACXjF,EAAyB,UAAW,CAACiF,KAAMA,M,gCAI3C,IAAImB,EAAQvG,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnBiG,GAAmB,SAAVrI,GACXC,KAAKyB,SAAS,CACZ2G,MAAOA,M,+BAOH,IAAD,EAC8DpI,KAAKmB,MAAnEiD,EADA,EACAA,KAAMu3B,EADN,EACMA,SAAUnuB,EADhB,EACgBA,OAAOpF,EADvB,EACuBA,MAAgB8xB,GADvC,EAC8B9zB,QAD9B,EACuC8zB,WAAWrzB,EADlD,EACkDA,SACzD,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQhE,MAAOhD,EAAK68B,aAAcr0B,SAAUxI,EAAKkG,OACjD,kBAAC,IAAD,KAAalG,EAAK68B,cAClB,kBAAC,GAAD,CACEt4B,KAAMA,EAAMoJ,OAAQA,EAAQmuB,SAAUA,EACtCvzB,MAAOA,EAAO8xB,UAAWA,EAAW+B,OAAQj8B,KAAKi8B,OACjDj1B,aAAchH,KAAKgH,aAAcq1B,aAAcr8B,KAAKq8B,aACpDr2B,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAC9BwyB,wBAAyBt8B,KAAKs8B,wBAC9BjzB,aAAcrJ,KAAKyH,kBAAmBo0B,gBAAiB77B,KAAK67B,gBAC5DzB,gBAAiBp6B,KAAKo6B,gBAAiBvzB,SAAUA,S,GAhKhB9B,aCc5B43B,GAlBS,SAAC13B,GACrB,OAAIA,EAAM23B,WAEF,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAQ/5B,MAAOhD,EAAK06B,SAAUlyB,SAAUxI,EAAKkG,MACzC,kBAAC,IAAD,CAAMutB,UAAU,SACZ,kBAAC,IAAD,CAAMC,GAAG,WAIjB,kBAAC,IAAD,MACA,kBAAC,GAAD,CAAYgH,SAAUt1B,EAAM23B,WAAWlC,aAIvC,MCfKmC,G,YACnB,aAAe,IAAD,8BACZ,+CACKl+B,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK0rB,SAAWA,GAAS1rB,KAAT,gBAGhB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCs7B,WAAY,KACZjJ,MAAO,KACPj3B,KAAM,GAVI,E,kFAcZmF,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI/CqB,KAAKysB,WACLzsB,KAAK6I,a,iCAIL7G,EAAsB,cAAehC,KAAK4H,SAASjL,OAAd,SAAkCqD,KAAKmB,MAAMvE,S,oCAKlF,IAAIggC,EAAa/6B,EAAWK,aACxBnC,EAAQ8B,EAAWM,WACnBy6B,GAAwB,eAAV78B,GAChBC,KAAKyB,SAAS,CACZm7B,WAAYA,EACZ1+B,GAAI0+B,EAAW1+B,KAGnBH,QAAQC,IAAI4+B,EAAY78B,K,+BAKhB,IACA68B,EAAe58B,KAAKmB,MAApBy7B,WACR,OAAQ,kBAAC,GAAD,CAAkBA,WAAYA,Q,GAhDFzzB,IAAMpE,WC6D/B+3B,GA/DM,SAAC73B,GAClB,GAAIA,EAAM83B,eAAgB,CAAC,IACdC,EAAT,SAAqBr4B,EAAU9B,GAC3B,IAAK,IAAI5C,EAAI,EAAGA,EAAI0E,EAASxE,OAAQF,IACjC,GAAG0E,EAAS1E,GAAG4C,OAASA,EACpB,OAAO8B,EAAS1E,GAAG6C,OAuB/B,OACI,kBAAC,IAAD,KACI,kBAAC,IAAD,CAAQD,MAAOhD,EAAKoE,iBAAkBoE,SAAUxI,EAAKkG,MACjD,kBAAC,IAAD,CAAMutB,UAAU,SACZ,kBAAC,IAAD,CAAMC,GAAG,WAGjB,kBAAC,IAAD,KACI,kBAAC,IAAD,KAAa1zB,EAAK8E,UAClB,kBAAC,IAAD,KACI,kBAAC,IAAD,KACKM,EAAM83B,eAAeE,gBAAgBjgC,KAAI,SAACkgC,GAAD,OACtC,kBAAC,IAAD,CACI13B,MAAO03B,EAAO13B,MACd9H,KAAK,SACL2G,SAAU,SAACC,GACPW,EAAMwC,kBAAmBy1B,EAAOr6B,MAAOyB,EAAEE,OAAO1B,SAnChF,SAAiBq6B,EAAIt6B,EAAM8B,GAGvB,IAFA,IAAIhC,EAAS,CAAC,kCACVa,GAAW,EACNvD,EAAI,EAAGA,EAAIk9B,EAAGh9B,OAAQF,IAEvBuD,EADD25B,EAAGl9B,GAAG4C,OAASm6B,EAAYr4B,EAAU9B,GAKxCF,EAAOvC,KACH,4BAAQ0C,MAAOq6B,EAAGl9B,GAAG4C,MAAOW,SAAUA,GACjC25B,EAAGl9B,GAAGuF,QAInB,OAAO7C,EAwBkBU,CAAQ65B,EAAO75B,QAAS65B,EAAOr6B,MAAOoC,EAAMm4B,uBAI7D,kBAAC,IAAD,KACI,kBAAC,IAAD,MACC,kBAAC,IAAD,CAAQl6B,UAAU,MAAM+C,MAAI,EAAEvB,QAASO,EAAMe,QAASnG,EAAKmG,WAM5E,OAAQ,MCxDK0B,G,YACnB,aAAe,IAAD,8BACZ,+CACK/I,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKiF,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBAEnB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCy7B,eAAgB,KAChBK,gBAAiB,KACjBz1B,OAAQ,IAXE,E,kFAiBZ9F,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAKnCgD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,0CAI/CmD,EAAsB,UAAW,EAAGhC,KAAKmB,MAAMvE,S,oCAI/C,IAAImgC,EAAiBl7B,EAAWK,aAC5BnC,EAAQ8B,EAAWM,WACnB46B,GAA4B,YAAVh9B,GACpBC,KAAKyB,SAAS,CACZs7B,eAAgBA,EAChBK,gBAAiBL,EAAe94B,iBAChC0D,OAASo1B,EAAe94B,qB,oCAMfjE,KACRsyB,IAAIG,OAAOzF,MAAMntB,EAAKw9B,uBAAwBx9B,EAAKgX,W,+BAMxD7U,EAAsB,UADX,CAAE9D,GAAI,EAAGo/B,QAASt9B,KAAKmB,MAAMwG,QACD3H,KAAKmB,MAAMvE,S,wCAKlCK,EAAK6F,GACrB,IAAI6E,EAAS3H,KAAKmB,MAAMwG,OACxB,GAAIA,EAAOxH,OAAS,GAClB,IAAK,IAAIF,EAAI,EAAGA,EAAI0H,EAAOxH,OAAQF,IACjC,GAAI0H,EAAO1H,GAAG4C,OAAS8E,EAAO1H,GAAG4C,OAAS5F,EAAK,CAC7C,IAAI4K,EAAW/K,OAAOgL,OAAO,GAAI9H,KAAKmB,OACtC0G,EAASF,OAAO1H,GAAK,CAAE4C,MAAO5F,EAAK6F,MAAOA,GAC1C9C,KAAKyB,SAASoG,SAIlB7H,KAAKyB,SAAS,CAAEkG,OAAQ3H,KAAKmB,MAAMwG,OAAOI,OAAO,CAAElF,MAAO5F,EAAK6F,MAAOA,Q,+BAIhE,IAAD,EACqC9C,KAAKmB,MAAzC47B,EADD,EACCA,eAAgBK,EADjB,EACiBA,gBACxB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQv6B,MAAOhD,EAAKoE,iBAAkBoE,SAAUxI,EAAKkG,OACrD,kBAAC,GAAD,CAAcg3B,eAAgBA,EAAgBK,gBAAiBA,EAAiB31B,kBAAmBzH,KAAKyH,kBAAmBzB,OAAQhG,KAAKgG,c,GA7E5GjB,aCgBrBw4B,GArBM,SAACt4B,GAEpB,OADAlH,QAAQC,IAAIiH,EAAMlB,WACdkB,EAAMlB,UAEN,kBAAC,IAAD,KACGkB,EAAMlB,UAAU/G,KAAI,SAACqN,GAAD,OACnB,kBAAC,IAAD,CACEnH,UAAW,SACXjG,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IACjClE,KAAM,IAAM4H,EAAS5N,MAAQ,IAAM4N,EAASnM,GAC5C2E,MAAOwH,EAASxH,YAQhB,8BCJG26B,GAdO,SAACv4B,GACrB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAKkE,WAClB,kBAAC,IAAD,CAAMuvB,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,WAIb,kBAAC,GAAD,CAAcxvB,UAAWkB,EAAMlB,UAAW8J,SAAU5I,EAAM4I,aCL3CnG,G,YACnB,aAAe,IAAD,8BACZ,+CACKlL,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCyC,UAAW,MALD,E,kFASZlC,EAAWC,GAAG,WAAY9B,KAAKxD,W,6CAI/BqF,EAAWE,eAAe,WAAY/B,KAAKxD,W,0CAI3CwD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QACpElG,EAAkB,YAAahC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,gCAI/D,IAAImH,EAAYlC,EAAWrF,UACvBuD,EAAQ8B,EAAWM,WACnB4B,GAAuB,aAAVhE,GACfC,KAAKyB,SAAS,CACZsC,UAAWA,IAGfhG,QAAQC,IAAI+F,EAAWhE,K,+BAGf,IACDgE,EAAa/D,KAAKmB,MAAlB4C,UACP,OAAO,kBAAC,GAAD,CAAeA,UAAWA,Q,GAxCDoF,IAAMpE,WCuC3B04B,GA3CG,SAACx4B,GACjB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAK69B,SAClB,kBAAC,IAAD,CAAMpK,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,WAGb,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAa1zB,EAAK+E,OAClB,kBAAC,IAAD,CAAa1B,UAAU,WACrB,kBAAC,IAAD,KACE,kBAAC,IAAD,CACEsC,MAAO3F,EAAKy3B,MACZ55B,KAAK,OACLigC,WAAW,EACXl4B,YAAa5F,EAAK+9B,iBAClB96B,MAAOmC,EAAMqyB,MACb5xB,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEiuB,MAAOhzB,EAAEE,OAAO1B,aAc7C,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAMmF,KAAK,YAAY41B,SAAS,EAAO96B,aAAa,GAAOlD,EAAKi+B,gBAAhE,KACA,kBAAC,IAAD,CAAQ73B,MAAI,EAAC/C,UAAU,uCAAuC+E,KAAK,2FAA4F41B,SAAS,EAAO96B,aAAa,GAAOlD,EAAKk+B,IAAxM,KACA,kBAAC,IAAD,CAAM76B,UAAU,eAChB,kBAAC,IAAD,CAAQA,UAAU,UAAU+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAK+E,W,eClBtE,aAAe,IAAD,8BACZ,+CACKoB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBAEnB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCg2B,MAAO,GACP0G,SAAU,IATA,E,kFAcZn8B,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,0CAG5CmB,KAAK4H,SAASjL,OAAd,OACDqF,EAAsB,uBAAwB,GAAIhC,KAAK4H,SAASjL,OAAd,OAEjDqD,KAAKmB,MAAMvE,OAASoD,KAAKmB,MAAMvE,MAAMuD,OAAS,IAC/C6B,EAAsB,uBAAwB,GAAIhC,KAAKmB,MAAMvE,S,+BAM/DoF,EAAsB,cADX,CAACs1B,MAAOt3B,KAAKmB,MAAMm2B,MAAO0G,SAAUh+B,KAAKmB,MAAM68B,a,oCAK1D,IAAIj+B,EAAQ8B,EAAWM,WACT,UAAVpC,GACFC,KAAK2J,UAAUC,SAAS,iBAAiB5J,KAAKmB,MAAMm2B,OAExC,aAAVv3B,IACFC,KAAK2J,UAAUC,SAAS,KACxBxI,OAAOO,SAAS+sB,UAElB3wB,QAAQC,IAAI+B,K,wCAII2J,GAChB1J,KAAKyB,SAASiI,K,+BAGN,IAAD,EACsB1J,KAAKmB,MAD3B,EACA88B,SADA,EACUD,SACjB,OACE,kBAACE,GAAD,CAAWl4B,OAAQhG,KAAKgG,OAAQqD,aAAcrJ,KAAKyH,wB,GAvD5B0B,IAAMpE,W,eCCjC,aAAe,IAAD,8BACZ,+CACK0C,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBAEnB,EAAKI,MAAQ,CACXm2B,MAAO,GACP0G,SAAU,IAPA,E,kFAYZn8B,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,0CAG/CmD,EAAsB,uBAAwB,GAAIhC,KAAK4H,SAASjL,OAAd,S,oCAIlD,IAAIsF,EAAOJ,EAAWK,aAEtB,GAAc,aADFL,EAAWM,WACG,CACxBf,OAAOC,aAAaqrB,QAAQ,QAASzqB,EAAKrF,OAC1C,IAAIuhC,EAAO/8B,OAAOC,aAAaC,QAAQ,OACpC68B,GAAQA,EAAKh+B,OAAS,GAEvBiB,OAAOO,SAASC,QAAQu8B,GACxB/8B,OAAOC,aAAaqrB,QAAQ,MAAO,IACnCpc,YAAW,WACTlP,OAAOO,SAAS+sB,cAGlB1uB,KAAK2J,UAAUC,SAAS,KACxB0G,YAAW,WACTlP,OAAOO,SAAS+sB,kBAIpB1uB,KAAK2J,UAAUC,SAAS,iBACxB0G,YAAW,WACTlP,OAAOO,SAAS+sB,c,wCAOJhlB,GAChB1J,KAAKyB,SAASiI,K,+BAGN,IAAD,EACsB1J,KAAKmB,MAD3B,EACA88B,SADA,EACUD,SACjB,OACE,kBAACE,GAAD,CAAWl4B,OAAQhG,KAAKgG,OAAQqD,aAAcrJ,KAAKyH,wB,GA3D5B0B,IAAMpE,WC2DpBq5B,GA7EI,SAACn5B,GAClB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAK69B,SAClB,kBAAC,IAAD,CAAMpK,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,WAGb,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAa1zB,EAAK69B,SAClB,kBAAC,IAAD,KACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CACEl4B,MAAO3F,EAAK67B,UAAY,KACxBj2B,YAAa5F,EAAKw+B,gBAClB3gC,KAAK,OACL0G,KAAMoC,IAAOC,IAAIC,UAAUC,OAAO,IAClCjB,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEjF,KAAME,EAAEE,OAAO1B,WAIxC,kBAAC,IAAD,CACE0C,MAAO3F,EAAK87B,SAAW,KACvBl2B,YAAa5F,EAAKy+B,oBAClB5gC,KAAK,OACL0G,KAAMoC,IAAOC,IAAIC,UAAUC,OAAO,IAClCjB,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEsyB,SAAUr3B,EAAEE,OAAO1B,WAK5C,kBAAC,IAAD,CACE0C,MAAO,MAAQ3F,EAAKy3B,MACpB55B,KAAK,QACL6gC,UAAQ,EACR94B,YAAa5F,EAAK+9B,iBAClB16B,UAAU,MACVJ,MAAOmC,EAAMqyB,MACb5xB,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEiuB,MAAOhzB,EAAEE,OAAO1B,aA2B7C,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAMmF,KAAK,WAAWpI,EAAK2+B,cAAe,OAAU3+B,EAAK4+B,cAAzD,KACA,kBAAC,IAAD,CAAMv7B,UAAU,eAChB,kBAAC,IAAD,CAAQA,UAAU,UAAU+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAK69B,a,eCpDtE,aAAe,IAAD,8BACZ,+CACK13B,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBAEnB,EAAKI,MAAQ,CACXm2B,MAAO,GACPlzB,KAAM,GACNu3B,SAAU,IATA,E,kFAcZ95B,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAI/CmB,KAAKuuB,GAAG,QAAQE,OAChBzuB,KAAKuuB,GAAG,eAAe5lB,KAAK9I,EAAK6+B,YACjC,IAAI9gC,EAAO,CACT05B,MAAOt3B,KAAKmB,MAAMm2B,MACjBlzB,KAAMpE,KAAKmB,MAAMiD,KACjBu3B,SAAU37B,KAAKmB,MAAMw6B,UACxB,GACG37B,KAAKmB,MAAMm2B,OAASt3B,KAAKmB,MAAMm2B,MAAMn3B,OAAS,GAC9CH,KAAKmB,MAAMiD,MAAQpE,KAAKmB,MAAMiD,KAAKjE,OAAS,GAC5CH,KAAKmB,MAAMw6B,UAAY37B,KAAKmB,MAAMw6B,SAASx7B,OAAS,EAErD6B,EAAsB,gBAAiBpE,OAClC,CACQoC,KACRsyB,IAAIG,OAAOzF,MAAMntB,EAAK81B,gBAAiB91B,EAAKmtB,U,oCAMrC,WADFnrB,EAAWM,aAErBnC,KAAKuuB,GAAG,QAAQvlB,OAChBhJ,KAAK2J,UAAUC,SAAS,iBAAiB5J,KAAKmB,MAAMm2B,U,wCAKtC5tB,GAChB1J,KAAKyB,SAASiI,GACd3L,QAAQC,IAAI0L,K,+BAGJ,IAAD,EACwB1J,KAAKmB,MAD7B,EACC88B,SADD,EACWD,SAClB,OACE,kBAACW,GAAD,CAAY34B,OAAQhG,KAAKgG,OAAQqD,aAAcrJ,KAAKyH,wB,GA1D7B0B,IAAMpE,WCuBpB04B,GAzCG,SAACx4B,GACjB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAK++B,cAClB,kBAAC,IAAD,CAAMtL,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,WAGb,kBAAC,IAAD,KACE,kBAAC,IAAD,KAAa1zB,EAAK+E,OAClB,kBAAC,IAAD,KACE,kBAAC,IAAD,KACA,kBAAC,IAAD,CACIY,MAAO3F,EAAKy3B,MACZ55B,KAAK,OACLigC,WAAW,EACXl4B,YAAa5F,EAAK+9B,iBAClB96B,MAAOmC,EAAMqyB,MACb5xB,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAEiuB,MAAOhzB,EAAEE,OAAO1B,WAGzC,kBAAC,IAAD,CACE0C,MAAO3F,EAAKg/B,kBACZnhC,KAAK,OACL+H,YAAa5F,EAAKi/B,wBAClBp5B,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAE01B,iBAAkBz6B,EAAEE,OAAO1B,aAKxD,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAMmF,KAAK,YAAY41B,SAAS,EAAO96B,aAAa,GAAOlD,EAAKi+B,gBAAhE,KACA,kBAAC,IAAD,CAAM56B,UAAU,eAChB,kBAAC,IAAD,CAAQA,UAAU,UAAU+C,MAAI,EAACvB,QAASO,EAAMe,QAASnG,EAAK+E,W,eChBtE,aAAe,IAAD,8BACZ,+CACKoB,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBACzB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBAEnB,EAAKI,MAAQ,CACX49B,iBAAkB,GAClBzH,MAAO,IARG,E,kFAaZz1B,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,0CAI/CmB,KAAKyB,SAAS,CAAC61B,MAAOt3B,KAAK4H,SAASjL,OAAd,U,+BAKtBqF,EAAsB,eADX,CAAC68B,kBAAmB7+B,KAAKmB,MAAM49B,qB,oCAK1C,IAAI98B,EAAOJ,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACvB,GAAIF,GAAiB,UAATlC,EAAkB,CAC5BqB,OAAOC,aAAaqrB,QAAQ,QAASzqB,EAAKrF,OAC1C,IAAIuhC,EAAO/8B,OAAOC,aAAaC,QAAQ,OACpC68B,EAAKh+B,OAAS,GAEfiB,OAAOO,SAASC,QAAQu8B,GACxB/8B,OAAOC,aAAaqrB,QAAQ,MAAO,IACnCtrB,OAAOO,SAAS+sB,WAEhB1uB,KAAK2J,UAAUC,SAAS,KACxBxI,OAAOO,SAAS+sB,a,wCAOJhlB,GAChB1J,KAAKyB,SAASiI,K,+BAGN,IAAD,EACmB1J,KAAKmB,MAAdm2B,GADV,EACA2G,SADA,EACU3G,OACjB,OACE,kBAAC0H,GAAD,CAAkBh5B,OAAQhG,KAAKgG,OAAQsxB,MAAOA,EAAOjuB,aAAcrJ,KAAKyH,wB,GAzDjD0B,IAAMpE,WC6KpBk6B,GA7KG,SAACh6B,GACjB,SAASi6B,EAAOC,EAAMjhC,GACpB,IAAIuP,EAAQ,MACRC,EAAS,MAKb,MAJa,SAATyxB,IACF1xB,EAAQ,MACRC,EAAS,IAGT,yBAAKlC,MAAM,oBAAoBvO,IAAK,aAAeiB,GACjD,2BACEkhC,UAAU,EACVniC,IAAKiB,EACLA,GAAI,SAAWA,EACfqP,IAAI,GACJE,MAAOA,EACPC,OAAQA,EACR2xB,UAAQ,EACRC,aAAW,EACX1N,MAAO3sB,EAAM2sB,SAqHrB,OACE,kBAAC,IAAD,CAAM2N,mBAAoB,kBAAMt6B,EAAMu6B,eACpC,kBAAC,IAAD,CAAQ38B,MARZ,WACE,GAAIoC,EAAM0pB,KACR,OAAQ1pB,EAAM0pB,KAAK9rB,MAMJA,GAASwF,SAAUxI,EAAKkG,MACrC,kBAAC,IAAD,CAAMutB,UAAU,SACd,kBAAC,IAAD,CAAMC,GAAG,WAGb,kBAAC,IAAD,CAAWrwB,UAAU,4BACnB,8BACA,yBAAKA,UAAU,IACb,uBAAGwB,QAAS,kBAAMO,EAAMsrB,kBAAiB,uBAAG/kB,MAAM,0BAA0B2C,cAAY,UACxF,uBAAGzJ,QAAS,kBAAMO,EAAMurB,sBAAqB,uBAAGhlB,MAAM,wBAAwB2C,cAAY,UAC1F,uBAAGzJ,QAAS,kBAAMO,EAAM8S,aAAY,uBAAGvM,MAAM,qBAAqB2C,cAAY,UAC9E,uBAAGzJ,QAAS,kBAAMO,EAAMw6B,iBAAgB,uBAAGj0B,MAAM,0BAA0B2C,cAAY,YAI3F,yBAAKylB,MAAO,CAAEC,UAAW,SAAU6L,WAAY,WAA/C,KACA,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAKx8B,UAAU,SAAShF,GAAG,SAlIjC,WACE,IAAIyE,EAAS,GAoBb,OAnBIsC,EAAMwoB,OAENxoB,EAAMwoB,MAAMzwB,KAAI,SAACyyB,GAGmB,YAA9BxqB,EAAM8qB,WAAWN,EAAKvxB,MACxBH,QAAQC,IAAIyxB,EAAKvxB,GAAI,gBACrByE,EAAOvC,KAAK8+B,EAAO,OAAQ,KAAOzP,EAAKvxB,SAYxCyE,EA8GAg9B,KAIL,kBAAC,IAAD,CAAOt0B,QAAM,GAvFjB,WACE,IAAI1I,EAAS,GAqCb,OApCIsC,EAAMkrB,UACRlrB,EAAMkrB,SAASnzB,KAAI,SAACgZ,GAClBrT,EAAOvC,KACL,yBAAK8C,UAAU,6BACb,uBAAGwB,QAAS,kBAAMO,EAAM26B,cAAc5pB,EAAQ/O,QAC5C,yBAAK/D,UAAU,oCACb,uBAAGsI,MAAM,cAAc2C,cAAY,WAGvC,uBAAGzJ,QAAS,kBAAMO,EAAM46B,cAAc7pB,EAAQ/O,QAC5C,yBAAK/D,UAAU,mCACb,uBAAGsI,MAAM,iBAAiB2C,cAAY,WAG1C,yBAAKjL,UAAU,uCACb,uBAAGsI,MAAM,mBAAmB2C,cAAY,UAE1C,yBAAKjL,UAAU,0CACb,uBAAGsI,MAAM,yBAAyB2C,cAAY,UAGhD,yBAAKjL,UAAU,uCACb,uBAAGsI,MAAM,YAAY2C,cAAY,UAGnC,yBAAKjL,UAAU,0CACb,uBAAGsI,MAAM,cAAc2C,cAAY,UAGrC,yBAAKjL,UAAU,oBAAoB8S,EAAQsX,cAO5C3qB,EAkDFwtB,GACD,6BAhDN,WACE,IAAIxtB,EAAS,GAYb,OAXIsC,EAAMqpB,cACRrpB,EAAMqpB,aAAatxB,KAAI,SAACkyB,GACtBvsB,EAAOvC,KACL,yBAAK8C,UAAU,aAEb,yBAAKA,UAAU,oBAAoBgsB,EAAY5B,cAMhD3qB,EAoCF2rB,IAGH,kBAAC,IAAD,KArHJ,WACE,IAAI3rB,EAAS,GAoBb,OAnBIsC,EAAMwoB,OAENxoB,EAAMwoB,MAAMzwB,KAAI,SAACyyB,GAEmB,aAA9BxqB,EAAM8qB,WAAWN,EAAKvxB,MACxBH,QAAQC,IAAIyxB,EAAKvxB,GAAI,iBACrByE,EAAOvC,KAAK8+B,EAAO,MAAOzP,EAAKvxB,SAahCyE,EAiGFm9B,MCnLYp4B,G,YACnB,aAAe,IAAD,8BACZ,+CACKlL,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAK4rB,cAAgB,EAAKA,cAAc5rB,KAAnB,gBACrB,EAAKgsB,iBAAmB,EAAKA,iBAAiBhsB,KAAtB,gBACxB,EAAKwsB,cAAgB,EAAKA,cAAcxsB,KAAnB,gBACrB,EAAKwvB,cAAgB,EAAKA,cAAcxvB,KAAnB,gBACrB,EAAKyvB,kBAAoB,EAAKA,kBAAkBzvB,KAAvB,gBACzB,EAAKg/B,IAAM,EAAKA,IAAIh/B,KAAT,gBACX,EAAKe,GAAK,EAAKA,GAAGf,KAAR,gBACV,EAAKowB,YAAc,EAAKA,YAAYpwB,KAAjB,gBACnB,EAAKytB,eAAiB,EAAKA,eAAeztB,KAApB,gBACtB,EAAKi/B,OAAS,EAAKA,OAAOj/B,KAAZ,gBACd,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAKgX,SAAW,EAAKA,SAAShX,KAAd,gBAChB,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0+B,aAAe,EAAKA,aAAa1+B,KAAlB,gBACpB,EAAKguB,YAAc,EAAKA,YAAYhuB,KAAjB,gBACnB,EAAK6+B,cAAgB,EAAKA,cAAc7+B,KAAnB,gBACrB,EAAK8+B,cAAgB,EAAKA,cAAc9+B,KAAnB,gBACrB,EAAKqsB,eAAiB,EAAKA,eAAersB,KAApB,gBACtB,EAAKitB,kBAAoB,EAAKA,kBAAkBjtB,KAAvB,gBACzB,EAAKiwB,cAAgB,EAAKA,cAAcjwB,KAAnB,gBACrB,EAAKouB,qBAAuB,EAAKA,qBAAqBpuB,KAA1B,gBAC5B,EAAKqtB,gBAAkB,EAAKA,gBAAgBrtB,KAArB,gBACvB,EAAKuuB,qBAAuB,EAAKA,qBAAqBvuB,KAA1B,gBAC5B,EAAK2vB,iBAAmB,EAAKA,iBAAiB3vB,KAAtB,gBACxB,EAAKsuB,mBAAqB,EAAKA,mBAAmBtuB,KAAxB,gBAC1B,EAAKiuB,eAAiB,EAAKA,eAAejuB,KAApB,gBACtB,EAAKkuB,aAAe,EAAKA,aAAaluB,KAAlB,gBACpB,EAAKgvB,WAAa,EAAKA,WAAWhvB,KAAhB,gBAClB,EAAKk/B,YAAc,EAAKA,YAAYl/B,KAAjB,gBACnB,EAAKuvB,gBAAkB,EAAKA,gBAAgBvvB,KAArB,gBACvB,EAAKy+B,aAAe,EAAKA,aAAaz+B,KAAlB,gBAGpB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnC+vB,UAAW,KACX90B,OAAQD,EAAKg1B,YACbzE,MAAO,KACPC,QAAS,KACThF,SAAU,iBAAmB5Y,GAAM+G,aAAa,IAChD2Y,OAAQ,KACR2C,WAAY,KACZrE,KAAM,KACNsE,SAAU,KACVrE,QAAS,iBAAmBje,GAAM+G,aAAa,IAC/C6Y,IAAK,KACLrB,MAAO,GACPgE,YAAa,GACbC,aAAc,GACdrE,SAAU,KACVxgB,SAAU,KACVshB,SAAS,EACTpc,KAAM,GACNse,gBAAgB,EAChBsB,qBAAqB,EACrBC,OAAO,EACPzB,SAAU,GACVjC,SAAU,GACVI,aAAc,GACdK,KAAM,MA9DI,E,kFAkEZ9sB,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,aAC/CuC,OAAOmmB,oBAAoB,eAAgBvnB,KAAKgxB,iB,iFAShDhvB,EAAsB,cADX,CAAEk+B,QAASlgC,KAAKmB,MAAMytB,QACU5uB,KAAKmB,MAAMvE,S,yCAItDoF,EAAsB,cAAehC,KAAKmB,MAAMytB,OAAQ5uB,KAAKmB,MAAMvE,S,sCAInE,IAAIgwB,EAAO5sB,KACXkP,GAAMwB,KAAK,CACTkB,MAAO,OACPxB,SAAU,WACR,IAAIyc,EAAQ,IAAI3d,GAAM,CACpB3S,OAAQqwB,EAAKzrB,MAAM5E,OACnByU,QAAS,WACP6b,EAAMjF,OAAO,CACXC,OAAQ,yBACRC,SAAU8E,EAAKzrB,MAAM2mB,SACrB9W,QAAS,SAAUuD,GACjBqY,EAAKnrB,SAAS,CAAEorB,MAAOA,IACvBD,EAAKnrB,SAAS,CAAEqrB,QAASvY,IACzBrF,GAAMlR,IACJ,qBACA4uB,EAAKzrB,MAAM2rB,QAAQ3E,YACnB,QACAyE,EAAKzrB,MAAM2rB,QAAQ5E,QACnB,KAEFhZ,GAAMlR,IAAI,oCACV4uB,EAAKG,oBAGPjvB,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,iCAAkCA,GAC9CsD,OAAO4rB,MAAM,6BAA+BlvB,IAE9C0jB,cAAe,SAAU1f,GACvBoN,GAAM0C,MACJ,6BAA+B9P,EAAK,KAAO,OAAS,SAGxDga,SAAU,SAAU3a,GAClB+N,GAAMlR,IAAI,wBAA0BmD,IAEtCkU,WAAY,SAAUpC,EAAQnR,GAC5BoN,GAAMlR,IACJ,UACC8D,EAAK,UAAY,WAClB,kBACAmR,IAGJ+B,YAAa,SAAUlT,GACrBoN,GAAMlR,IACJ,4CACC8D,EAAK,KAAO,QACb,SAGJ+T,UAAW,SAAUoX,EAAKrX,GACxB1G,GAAMlR,IAAI,qCAAsCivB,GAChD,IAAIrc,EAAQqc,EAAG,UAEf,GADA/d,GAAM0C,MAAM,UAAYhB,GACpBA,EACF,GAAc,WAAVA,GAUF,GATA7S,QAAQC,IAAI,UACZ4uB,EAAKnrB,SAAS,CACZyrB,KAAMD,EAAG,GACTE,QAASF,EAAG,aAIdL,EAAKQ,eAAeH,EAAG,GAAQL,EAAKzrB,MAAM0L,SAAW,OAAM+f,EAAKzrB,MAAMksB,UAElEJ,EAAG,WAAgB,CACrB,IAAItvB,EAAOsvB,EAAG,WAKd,IAAK,IAAIhE,KAJTlrB,QAAQC,IACN,4CACAL,GAEYA,EAAM,CAClB,IAAIO,EAAKP,EAAKsrB,GAAL,GACLqE,EAAU3vB,EAAKsrB,GAAL,QACV7H,EAAQzjB,EAAKsrB,GAAL,YACR5I,EAAQ1iB,EAAKsrB,GAAL,YACZ/Z,GAAM0C,MACJ,SACA1T,EACA,KACAovB,EACA,YACAlM,EACA,YACAf,EACA,KAEFuM,EAAKQ,eAAezvB,EAAKsrB,GAAL,GAAetrB,EAAKsrB,GAAL,SACnC2D,EAAKW,cAAcrvB,EAAIovB,EAASlM,EAAOf,UAItC,GAAc,cAAVzP,EAET1B,GAAMiF,KAAK,qCACN,GAAc,UAAVvD,EAET,GAAIqc,EAAG,WAAgB,CACjBtvB,EAAOsvB,EAAG,WAKd,IAAK,IAAIhE,KAJT/Z,GAAMlR,IACJ,4CACAL,GAEYA,EAAM,CACdO,EAAKP,EAAKsrB,GAAL,GACLqE,EAAU3vB,EAAKsrB,GAAL,QACV7H,EAAQzjB,EAAKsrB,GAAL,YACR5I,EAAQ1iB,EAAKsrB,GAAL,YACZ/Z,GAAMlR,IACJ,SACAE,EACA,KACAovB,EACA,YACAlM,EACA,YACAf,EACA,KAGFuM,EAAKQ,eAAezvB,EAAKsrB,GAAL,GAAetrB,EAAKsrB,GAAL,SACnC2D,EAAKW,cAAcrvB,EAAIovB,EAASlM,EAAOf,SAIpC,GAAI4M,EAAG,QAAa,CACzB,IAAIO,EAAUP,EAAG,QACjBlvB,QAAQC,IAAI,sBAAwBwvB,GACpCZ,EAAKnrB,SACH,CACEgsB,MAAOb,EAAKzrB,MAAMssB,MAAMC,QACtB,SAACC,GAAD,OAAUA,EAAKC,MAAQJ,OAG3B,kBAAMzvB,QAAQC,IAAI,cAAe4uB,EAAKzrB,MAAMssB,UAM5B,OADdI,GAHAC,EAAkBlB,EAAKzrB,MAAMssB,MAAMC,QACrC,SAACC,GAAD,OAAUA,EAAKC,OAASJ,MAEOO,UAE/BF,EAAWzY,SAEbwX,EAAKoB,kBAAkBR,QAClB,GAAIP,EAAG,YAAiB,CAC7B,IAAIgB,EAAchB,EAAG,YAErB,GADAlvB,QAAQC,IAAI,mBAAqBiwB,GACb,OAAhBA,EAEF,YADArB,EAAKzrB,MAAM2rB,QAAQ7X,SAGrB2X,EAAKnrB,SACH,CACEgsB,MAAOb,EAAKzrB,MAAMssB,MAAMC,QACtB,SAACC,GAAD,OAAUA,EAAKC,MAAQK,OAI7B,IAYIJ,EAZAC,EAAkBlB,EAAKzrB,MAAMssB,MAAMC,QACrC,SAACC,GAAD,OAAUA,EAAKC,OAASK,KAG1BrB,EAAKnrB,SACH,CACEysB,SAAUtB,EAAKzrB,MAAM+sB,SAASR,QAC5B,SAACC,GAAD,OAAUA,EAAKC,MAAQK,OAMX,OADdJ,EAAaC,EAAgBC,UAE/BF,EAAWzY,SAEbwX,EAAKoB,kBAAkBC,QACdhB,EAAG,OAELA,EAAG,YAEHA,EAAG,SACVL,EAAKQ,eAAeH,EAAG,QAAY/uB,GAAI+uB,EAAG,QAAYK,SAIxD1X,IACF1G,GAAMlR,IAAI,0BAA2B4X,GACrCgX,EAAKzrB,MAAM2rB,QAAQlE,iBAAiB,CAAEhT,KAAMA,MAIhDuI,cAAe,SAAU/E,GACvBrb,QAAQC,IAAI,8BAA+Bob,GAC3Crb,QAAQC,IAAI4uB,EAAKzrB,MAAM2rB,QAAQ5uB,IAIN,IAHT0uB,EAAKzrB,MAAMssB,MAAMC,QAC/B,SAACC,GAAD,OAAUA,EAAKzvB,KAAO0uB,EAAKzrB,MAAM2rB,QAAQ5uB,MAE7BiC,SACZysB,EAAKzrB,MAAM2rB,QAAQc,KAAOhB,EAAKzrB,MAAM+rB,KAErCN,EAAKnrB,SAAS,CACZgsB,MAAOb,EAAKzrB,MAAMssB,MAAM1lB,OAAO6kB,EAAKzrB,MAAM2rB,WAEzCF,EAAKzrB,MAAMgtB,SACZvB,EAAKwB,gBAAgBxB,EAAKzrB,MAAMksB,WAMpC,IAAIgB,EAAcjV,EAAOE,iBAEpB+U,GAAsC,IAAvBA,EAAYluB,QAI9BpC,QAAQC,IAAI4uB,EAAKzrB,MAAMmtB,cACvB1B,EAAK2B,GAAG,UAAY3B,EAAKzrB,MAAM2rB,QAAQ5uB,IAAI8K,OAC3C4jB,EAAK4B,eAAe5B,EAAKzrB,MAAM2rB,UAL/BF,EAAK2B,GAAG,UAAY3B,EAAKzrB,MAAM2rB,QAAQ5uB,IAAIuwB,QAa/C9R,eAAgB,SAAUvD,GACxBlK,GAAMlR,IAAI,+BAAgCob,IAG5CtB,OAAQ,SAAUla,GAChBsR,GAAM0C,MAAM,oCAAqChU,IAGnDgpB,UAAW,WAET1X,GAAMlR,IACJ,mEAKRF,MAAO,SAAUA,GACfoR,GAAMpR,MAAMA,GACZsD,OAAO4rB,MAAMlvB,GAAO,WAClBsD,OAAOO,SAAS+sB,aAGpBxd,UAAW,WACT9P,OAAOO,SAAS+sB,iB,yCAOxB,IACI7tB,EAAW,CACbmV,QAAS,OACT2Y,KAHS3uB,KAGEmB,MAAMytB,OACjBC,MAAO,YACPvB,QALSttB,KAKKmB,MAAM0L,SAAW,QALtB7M,KAKkCmB,MAAMksB,SACjDyB,IANS9uB,KAMCmB,MAAM2tB,KANP9uB,KAQNmB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QAAShW,IACnCyP,WAAW,WACTtQ,KAAK+uB,eACLhuB,KAAKf,MAAO,O,qCAGD4tB,GACb,IAAIH,EAAQztB,KAAKmB,MAAMssB,MAAMC,QAC3B,SAACC,GAAD,OAAUA,EAAKC,OAASA,KAE1B,GAAIH,GAASA,EAAM,GACjB,OAAOA,EAAM,K,mCAIJvvB,GACX,IAAIuvB,EAAQztB,KAAKmB,MAAMssB,MAAMC,QAC3B,SAACC,GAAD,OAAUA,EAAKzvB,KAAOA,KAExB,GAAIuvB,GAASA,EAAM,GACjB,OAAOA,EAAM,K,mCAIJvvB,GACX,IAAIuvB,EAAQztB,KAAKmB,MAAMssB,MAAMC,QAC3B,SAACC,GAAD,OAAUA,EAAKzvB,KAAOA,KAExB,GAAIuvB,GAASA,EAAM,GACjB,OAAOA,EAAM,GAAGG,O,qCAIL1vB,EAAIirB,GACjB,IACI+F,EAAc/F,EAAE/I,MAAM,QACtBpgB,KAAKmvB,qBAAqBD,EAAY,KAF/BlvB,KAGJyB,SAAS,CAAE6sB,aAHPtuB,KAG0BmB,MAAMmtB,aAAavmB,OAAO,CAAE7J,GAAIA,EAAIovB,QAAS4B,EAAY,GAAIjoB,KAAMioB,EAAY,GAAI5rB,KAAM,eAE9HvF,QAAQC,IAAI,qBAAsBkxB,EAAY,M,2CAG3BE,GAKnB,OAAyB,IAJdpvB,KACUmB,MAAMmtB,aAAaZ,QACtC,SAACC,GAAD,OAAUA,EAAK1mB,OAASmoB,KAEZjvB,S,yCAOGjC,GACjB,IAAIowB,EAAetuB,KAAKmB,MAAMmtB,aAAaZ,QAAO,SAAAC,GAAI,OAAIA,EAAKzvB,KAAOA,KACtE,GAAIowB,GAAgBA,EAAa,GAC/B,OAAOA,EAAa,K,2CAIHpwB,GACnB,IAAIowB,EAAetuB,KAAKmB,MAAMmtB,aAAaZ,QAAO,SAAAC,GAAI,OAAIA,EAAK1mB,OAAS/I,KACxE,GAAIowB,GAAgBA,EAAa,GAC/B,OAAOA,EAAa,K,wCAINpwB,GACL8B,KACNyB,SAAS,CACZ6sB,aAFStuB,KAEUmB,MAAMmtB,aAAaZ,QACpC,SAACC,GAAD,OAAUA,EAAKzvB,KAAOA,S,oCAMdA,EAAIuvB,EAAOH,EAASlM,EAAOf,GACvC,IAAIuM,EAAO5sB,KAEP6tB,EAAa,KACjBjB,EAAKzrB,MAAM0rB,MAAMjF,OAAO,CACtBC,OAAQ,yBACRC,SAAU9nB,KAAKmB,MAAM2mB,SACrB9W,QAAS,SAAUuD,IACjBsZ,EAAatZ,GACFgb,kBAAmB,EAC9BrgB,GAAMlR,IACJ,qBACA6vB,EAAW1F,YACX,QACA0F,EAAW3F,QACX,KAEFhZ,GAAMlR,IAAI,6BAEV,IAAIwxB,EAAY,CACdxZ,QAAS,OACT2Y,KAAM/B,EAAKzrB,MAAMytB,OACjBC,MAAO,aACPC,IAAKlC,EAAKzrB,MAAM2tB,IAChBW,KAAMvxB,EACNwxB,WAAY9C,EAAKzrB,MAAMgsB,SAQwB,WAA/Cje,GAAMyL,cAAcC,eAAeC,SACxB,QAAVwF,IAA8B,QAAVA,GAAoBnR,GAAM8c,aAE3C3L,IAAOA,EAAQA,EAAMsP,eACzB5xB,QAAQC,IACN,sBACAqiB,EACA,oDAEFmP,EAAS,aAAkB,GAE7B3B,EAAW+B,WAAavP,EACxBwN,EAAW3X,KAAK,CAAEW,QAAS2Y,KAE7B1xB,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,iCAAkCA,GAC9CsD,OAAO4rB,MAAM,6BAA+BlvB,IAE9C+X,UAAW,SAAUoX,EAAKrX,GACxB1G,GAAM0C,MAAM,sCAAuCqb,GACnD,IAAIrc,EAAQqc,EAAG,UACf/d,GAAMlR,IAAI,UAAY4S,GAClBqc,EAAG,MACL7rB,OAAO4rB,MAAMC,EAAG,OACPrc,GACK,aAAVA,IACFid,EAAWD,KAAOX,EAAG,GACrBY,EAAWgC,UAAY5C,EAAG,QAC1BL,EAAKnrB,SAAS,CAAEgsB,MAAOb,EAAKzrB,MAAMssB,MAAM1lB,OAAO8lB,KAC/CjB,EAAKnrB,SAAS,CAAEysB,SAAUtB,EAAKzrB,MAAM+sB,SAASnmB,OAAO8lB,KAChDxN,GAAUe,GACbwL,EAAK2B,GAAG,UAAYV,EAAW3vB,IAAIuwB,OAMrCvf,GAAMlR,IACJ,iCACA6vB,EAAWD,KACX,KACAC,EAAWgC,UACX,aACA5C,EAAG,OAOLrX,IACF1G,GAAMlR,IAAI,0BAA2B4X,GACrCiY,EAAWjO,aAAa,CACtBhK,KAAMA,EAGNuD,MAAO,CAAEqF,WAAW,EAAOK,WAAW,EAAOjhB,MAAM,GACnDoT,QAAS,SAAU4E,GACjB1G,GAAMlR,IAAI,WAAY4X,GACtB,IAAIvP,EAAO,CAAE2P,QAAS,QAAS2Y,KAAM/B,EAAKzrB,MAAMytB,QAChDf,EAAW3X,KAAK,CAAEW,QAASxQ,EAAMuP,KAAMA,KAEzC9X,MAAO,SAAUA,GACfoR,GAAMlR,IAAI,gBAAiBF,GAC3BsD,OAAO4rB,MAAM,mBAAqBlvB,EAAM+Y,cAKhDiF,SAAU,SAAU3a,GAClB+N,GAAMlR,IACJ,kDACA6vB,EAAWiC,QACX,gBACA3uB,IAIJ6T,YAAa,SAAUlT,GACrBoN,GAAMlR,IACJ,gDACA6vB,EAAWiC,QACX,SACChuB,EAAK,KAAO,QACb,QAES,SAAPA,GACF8qB,EAAKoB,kBAAkBH,EAAWD,OAGtCzP,cAAe,SAAU/E,GACvBrb,QAAQC,IAAI,cAAeob,IAE7BuD,eAAgB,SAAUvD,GAEzB,IAAIiV,EAAcjV,EAAOE,iBAMxBvb,QAAQC,IAAI,gBAAiB4uB,EAAKmD,WAAWlC,EAAW3vB,IAAK2vB,EAAW3vB,IACnEmwB,GAAsC,IAAvBA,EAAYluB,QAK9BysB,EAAK2B,GAAG,UAA2BV,EAAW3vB,IAAI8K,OAInDkG,GAAMoc,kBACHrb,SAAS+f,eAAeC,SAAqBpC,EAAW3vB,IACxDkb,IAVFwT,EAAK2B,GAAG,UAAYV,EAAW3vB,IAAIuwB,OAarC,IAAIyB,EAAc9W,EAAOC,iBACpB6W,GAAsC,IAAvBA,EAAY/vB,QAI9B+O,GAAMoc,kBACJrb,SAAS+f,eAAe,SAAWnC,EAAW3vB,IAC9Ckb,IAKNtB,OAAQ,SAAUla,GAEhBG,QAAQC,IAAIJ,GACZ,IAAIiZ,EAAUtP,KAAKmP,MAAM9Y,GAMA,IALTgvB,EAAKzrB,MAAMgvB,SAASzC,QAClC,SAACC,GAAD,OAAUA,EAAK1mB,OAAS4P,EAAO,QAInB1W,QAAuC,OAAvB0W,EAAO,SACnC+V,EAAKnrB,SAAS,CAAE0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASpoB,OAAO,CAAEulB,QAASzW,EAAO,QAAa5P,KAAM4P,EAAO,SAGxE,kBAAvBA,EAAO,SACT+V,EAAKnrB,SAAS,CACZ0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASzC,QAAO,SAAAC,GAAI,OAAIA,EAAK1mB,MAAQ4P,EAAO,UAI1C,kBAAvBA,EAAO,UACT+V,EAAKnrB,SAAS,CACZ0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASzC,QAAO,SAAAC,GAAI,OAAIA,EAAK1mB,MAAQ4P,EAAO,UAEnE+V,EAAKwB,gBAAgBvX,EAAO,MACxBA,EAAO,OAAa+V,EAAKzrB,MAAMksB,WACjCtvB,QAAQC,IAAI,+BAAW4uB,EAAKzrB,MAAMkvB,gBAC9BzD,EAAKzrB,MAAMkvB,gBACbzD,EAAK0D,kBACL1D,EAAK2D,cAAc,KAEnB3D,EAAK4D,uBAOb5J,UAAW,WACT1X,GAAMlR,IACJ,gDAAkDE,EAAK,c,iCAMpDuyB,GACT,IAAIhB,EAAOzvB,KAAKivB,aAAawB,GAC7B,GAAIhB,GAAQA,EAAK7B,KACf,IAAIsB,EAAclvB,KAAKqvB,mBAAmBI,EAAK7B,MACjD,GAAIsB,EACF,OAAOA,EAAY5rB,O,kCAIX2sB,EAAcQ,EAAQrX,GAChClK,GAAMoc,kBACJrb,SAAS+f,eAAeC,EAAe,IAAMQ,GAC7CrX,K,sCAKY+mB,GAAc,IAAD,OACvBt4B,EAAW/K,OAAOgL,OAAO,GAAI9H,KAAKmB,OAClC+tB,EAAclvB,KAAKsvB,qBAAqB6Q,GACxCxP,EAAQ3wB,KAAK0wB,iBAAiByP,GAClCt4B,EAASymB,aAAaqC,GAAS,CAAEzyB,GAAIgxB,EAAYhxB,GAAIovB,QAAS4B,EAAY5B,QAASrmB,KAAMioB,EAAYjoB,KAAM3D,KAAM,WACjHtD,KAAKyB,SAASoG,GAAU,WACtB,IAAI4nB,EAAO,EAAKT,eAAeE,EAAYhxB,IACvCuxB,GAEF,EAAKjB,eAAeiB,Q,uCAOTvxB,GACf,IAAIyyB,EAAQ3wB,KAAKmB,MAAMmtB,aAAasC,WAAU,SAAAjD,GAAI,OAAIA,EAAK1mB,OAAS/I,KAEpE,GADAH,QAAQC,IAAI2yB,GACRE,OAAOC,UAAUH,GACnB,OAAOA,I,2CAIUwP,GACnB,IAAIjR,EAAclvB,KAAKsvB,qBAAqB6Q,GAC5C,SAAIjR,GAAoC,YAArBA,EAAY5rB,Q,qCAOlBmsB,GACb1xB,QAAQC,IAAIyxB,EAAKvxB,IACbuxB,EAAKvxB,IAAMuxB,EAAKhb,aAAegb,EAAKhb,YAAYiI,cAClDpM,WAAW,WACTpB,GAAMoc,kBACJrb,SAAS+f,eAAe,WAAaP,EAAKvxB,IAC1CuxB,EAAKhb,YAAYiI,eAEnB3b,KAAKf,MAAO,Q,iCAMhB,IAAI6W,EAAU,CACZka,SAAU,UACVxb,YAAarG,GAAM+G,aAAa,IAChC0Y,KAAM3uB,KAAKmB,MAAMytB,OACjBjmB,KAAM,SAER3I,KAAKmB,MAAM2rB,QAAQlvB,KAAK,CACtB+K,KAAMpB,KAAKC,UAAUqP,GACrB/Y,MAAO,SAAU4X,GAAU3X,QAAQC,IAAI0X,IACvC1E,QAAS,WAAcjT,QAAQC,IAAI,a,qCAKrC,IAAI4uB,EAAO5sB,KACP6W,EAAU,CACZka,SAAU,UACVxb,YAAarG,GAAM+G,aAAa,IAChC0Y,KAAM3uB,KAAKmB,MAAMytB,OACjB5Y,QAAS,KACT/O,KAAMjH,KAAKmB,MAAMksB,SACjBC,QAASttB,KAAKmB,MAAM0L,UAEtB7M,KAAKmB,MAAM2rB,QAAQlvB,KAAK,CACtB+K,KAAMpB,KAAKC,UAAUqP,GACrB/Y,MAAO,SAAU4X,GAAU3X,QAAQC,IAAI0X,IACvC1E,QAAS,WACPjT,QAAQC,IAAI,gBAIa,IAHT4uB,EAAKzrB,MAAMgvB,SAASzC,QAClC,SAACC,GAAD,OAAUA,EAAK1mB,OAAS4P,EAAO,QAEnB1W,QAAuC,OAAvB0W,EAAO,SACnC+V,EAAKnrB,SAAS,CAAE0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASpoB,OAAO,CAAEulB,QAASzW,EAAO,QAAa5P,KAAM4P,EAAO,c,oCAOvG,IAAI+V,EAAO5sB,KACX4sB,EAAKzrB,MAAM2rB,QAAQ7M,YAAY,CAC7B9G,MAAO,CACLsF,WAAW,EACXK,WAAW,EACXlhB,MAAM,EACNihB,WAAW,EACXL,WAAW,GAGbxN,QAAS,SAAU4E,GAEjB,GADA1G,GAAM0C,MAAM,+BAAgCgE,GACxCA,EAAM,CAORgX,EAAKzrB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QANZ,CACZb,QAAS,UACToL,OAAO,EACPf,OAAO,EACPziB,MAAM,GAEoCgY,KAAMA,MAItD9X,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,sBAAuBA,Q,sCAMvC,IAAI8uB,EAAO5sB,KACX4sB,EAAKzrB,MAAM2rB,QAAQ7M,YAAY,CAC7B9G,MAAO,CACLsF,WAAW,EACXK,WAAW,EACXlhB,MAAM,EACNihB,WAAW,EAEXL,WAAW,GAGbxN,QAAS,SAAU4E,GAEjB,GADA1G,GAAM0C,MAAM,+BAAgCgE,GACxCA,EAAM,CAORgX,EAAKzrB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QANV,CACdb,QAAS,YACToL,OAAO,EACPf,OAAO,EACPziB,MAAM,GAEsCgY,KAAMA,MAGxD9X,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,sBAAuBA,Q,sCAKZ,IAAf6d,EAAc,uDAAJ,GAClBiR,EAAO5sB,KACPgW,EAAU,GAEZA,GADE4W,EAAKzrB,MAAMwwB,oBACH,aAIZ/E,EAAKzrB,MAAM2rB,QAAQ7M,YAAY,CAC7B9G,MAAO,CACLsF,WAAW,EACXK,WAAW,EACXlhB,MAAM,EACNihB,WAAW,EAEXL,UAAWoO,EAAKzrB,MAAMwwB,qBAGxB3gB,QAAS,SAAU4E,GAGjB,GAFA1G,GAAM0C,MAAM,+BAAgCgE,GAC9C7X,QAAQC,IAAI,gBAAkB2d,GACxB/F,EAAM,CACR,IAAIwqB,EAAU,CACZpqB,QAASA,EACToL,MAAOwL,EAAKzrB,MAAMwwB,oBAClBtR,OAAO,EACPziB,MAAM,EACN+d,QAAmB,IAAVA,EACT0kB,aAAa,EACbC,WAAY,OAEd1T,EAAKzrB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QAASupB,EAASxqB,KAAMA,IAEpDgX,EAAKnrB,SAAS,CAAE4uB,gBAAiBzD,EAAKzrB,MAAMkvB,kBAE9CvyB,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,sBAAuBA,Q,wCAMvCC,QAAQC,IAAI,mBACZ,IAAI4uB,EAAO5sB,KACX4sB,EAAKzrB,MAAM2rB,QAAQ7M,YAAY,CAC7B9G,MAAO,CACLsF,WAAW,EACXK,WAAW,EACXlhB,MAAM,EACNihB,WAAW,EACXL,UAAWoO,EAAKzrB,MAAMwwB,qBAGxB3gB,QAAS,SAAU4E,GAGjB,GAFA1G,GAAM0C,MAAM,+BAAgCgE,GAExCA,EAAM,CACR,IAAIwqB,EAAU,CACZpqB,QAAS,YACToL,MAAOwL,EAAKzrB,MAAMwwB,oBAClBtR,OAAO,EACPziB,MAAM,GAERgvB,EAAKzrB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QAASupB,EAASxqB,KAAMA,IAEpDgX,EAAKnrB,SAAS,CAAE4uB,gBAAgB,KAElCvyB,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,sBAAuBA,Q,0CAMvC,IAAI8uB,EAAO5sB,KACX4sB,EAAKzrB,MAAM2rB,QAAQ7M,YAAY,CAC7B9G,MAAO,CACLsF,WAAW,EACXK,WAAW,EACXlhB,MAAM,EACN4gB,WAAYoO,EAAKzrB,MAAMwwB,oBACvB/S,YAAagO,EAAKzrB,MAAMwwB,oBACxB9S,UAAW+N,EAAKzrB,MAAMkvB,gBAGxBrf,QAAS,SAAU4E,GAEjB,GADA1G,GAAM0C,MAAM,+BAAgCgE,GACxCA,EAAM,CACR,IAAIwqB,EAAU,CAAEpqB,QAAS,YAAapY,MAAM,EAAMwjB,OAAQwL,EAAKzrB,MAAMwwB,oBAAqBtR,MAAOuM,EAAKzrB,MAAMkvB,gBAC5GzD,EAAKzrB,MAAM2rB,QAAQ5W,KAAK,CAAEW,QAASupB,EAASxqB,KAAMA,IAClDgX,EAAKnrB,SAAS,CACZkwB,qBAAsB/E,EAAKzrB,MAAMwwB,wBAIvC7zB,MAAO,SAAUA,GACfoR,GAAMpR,MAAM,sBAAuBA,Q,4BAMvCC,QAAQC,IAAIgC,KAAKmB,MAAMssB,OACvB,IAAIpnB,EAAO,CACT2P,QAAS,SACTyZ,KAAMzvB,KAAKmB,MAAMssB,MAAM,GAAGG,KAC1BvN,OAAO,GAETrgB,KAAKmB,MAAMssB,MAAM,GAAGvX,KAAK,CAAEW,QAASxQ,M,2BAIpCtI,QAAQC,IAAIgC,KAAKmB,MAAMssB,OACvB,IAAIpnB,EAAO,CACT2P,QAAS,SACTyZ,KAAMzvB,KAAKmB,MAAMssB,MAAM,GAAGG,KAC1BvN,OAAO,GAETrgB,KAAKmB,MAAMssB,MAAM,GAAGvX,KAAK,CAAEW,QAASxQ,M,0CAIpCrE,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,OAAgCqD,KAAKmB,MAAMvE,OAC1EwE,OAAOuP,iBAAiB,eAAgB3Q,KAAKgxB,iB,oCAGhC,IAAD,OACRrC,EAAO9sB,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBwsB,GAAkB,SAAV5uB,GACVC,KAAKyB,SAAS,CACZktB,KAAMA,EACNzwB,GAAIywB,EAAKzwB,GACT0wB,OAAQD,EAAKuR,QACbpR,IAAKH,EAAKG,IACVzB,SAAUsB,EAAK4R,UACf1zB,SAAU8hB,EAAK6R,cACf39B,MAAO8rB,EAAK9rB,MACZsrB,QAASQ,EAAK8R,WACb,kBAAM,EAAKtP,iBAEhBnxB,KAAKuuB,GAAG,QAAQvlB,S,oCAIhBsH,WAAW,WACTtQ,KAAK2sB,gBACL3sB,KAAKggC,UACLj/B,KAAKf,MAAO,Q,iCAIS8I,IAAWpK,SAC/BqK,MAAMC,KAAK,CACZL,KAAM9I,EAAKoJ,UACXC,aAAc,IACdhB,SAAU,QAEZlG,EAAkB,YAAahC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,8EAQ/D,IAAIy0B,EAAYxvB,EAAWrF,UACvBuD,EAAQ8B,EAAWM,WACnBkvB,GAAuB,aAAVtxB,GACfC,KAAKyB,SAAS,CACZ4vB,UAAWA,M,+BAMfrxB,KAAKyB,SAAS,CAAEmwB,OAAO,M,oCAGX3qB,GACZ,IAAI2lB,EAAO5sB,KACP6W,EAAU,CACZka,SAAU,UACVxb,YAAarG,GAAM+G,aAAa,IAChC0Y,KAAM3uB,KAAKmB,MAAMytB,OACjB5Y,QAAS,gBACT/O,KAAMA,GAERjH,KAAKmB,MAAM2rB,QAAQlvB,KAAK,CACtB+K,KAAMpB,KAAKC,UAAUqP,GACrB/Y,MAAO,SAAU4X,GAAU3X,QAAQC,IAAI0X,IACvC1E,QAAS,WACP4b,EAAKnrB,SAAS,CACZ0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASzC,QAAO,SAAAC,GAAI,OAAIA,EAAK1mB,MAAQA,OAE5D2lB,EAAKwB,gBAAgBnnB,Q,oCAKbA,GACZ,IAAI2lB,EAAO5sB,KACP6W,EAAU,CACZka,SAAU,UACVxb,YAAarG,GAAM+G,aAAa,IAChC0Y,KAAM3uB,KAAKmB,MAAMytB,OACjB5Y,QAAS,gBACT/O,KAAMA,GAERjH,KAAKmB,MAAM2rB,QAAQlvB,KAAK,CACtB+K,KAAMpB,KAAKC,UAAUqP,GACrB/Y,MAAO,SAAU4X,GAAU3X,QAAQC,IAAI0X,IACvC1E,QAAS,WACP4b,EAAKnrB,SAAS,CACZ0uB,SAAUvD,EAAKzrB,MAAMgvB,SAASzC,QAAO,SAAAC,GAAI,OAAIA,EAAK1mB,MAAQA,Y,qCAOhElJ,QAAQC,IAAI,gBACZgC,KAAKswB,oB,+BAGG,IAAD,EAYHtwB,KAAKmB,MAVPkwB,EAFK,EAELA,UACAtf,EAHK,EAGLA,KACA4f,EAJK,EAILA,oBACAtB,EALK,EAKLA,eACA5C,EANK,EAMLA,MACAmE,EAPK,EAOLA,MACA1D,EARK,EAQLA,SACAiC,EATK,EASLA,SACA7B,EAVK,EAULA,aACAK,EAXK,EAWLA,KAEF,OACE,kBAAC,GAAD,CACE6Q,aAAcx/B,KAAKw/B,aACnBrO,YAAanxB,KAAKmxB,YAClBE,UAAWA,EACX7C,eAAgBxuB,KAAKwuB,eACrBa,mBAAoBrvB,KAAKqvB,mBACzBqR,qBAAsB1gC,KAAK0gC,qBAC3B3Q,WAAY/vB,KAAK+vB,WACjBhe,KAAMA,EACNguB,IAAK//B,KAAK+/B,IACVj+B,GAAI9B,KAAK8B,GACT2rB,MAAOA,EACPmE,MAAOA,EACP1D,SAAUA,EACViC,SAAUA,EACVxB,KAAMA,EACNL,aAAcA,EACd0R,OAAQhgC,KAAKggC,OACb3P,eAAgBA,EAChBsB,oBAAqBA,EACrBpB,cAAevwB,KAAKuwB,cACpBC,kBAAmBxwB,KAAKwwB,kBACxBzY,SAAU/X,KAAK+X,SACf0nB,aAAcz/B,KAAKy/B,aACnBkB,OAAQ3gC,KAAK2gC,OACbf,cAAe5/B,KAAK4/B,cACpBC,cAAe7/B,KAAK6/B,oB,GA1iCQ12B,IAAMpE,WCczB67B,GArBA,SAAC37B,GAEhB,OAAIA,EAAM47B,MAEN,kBAAC,IAAD,CAAMr4B,WAAS,GACZvD,EAAM47B,MAAM7jC,KAAI,SAAC2xB,GAAD,OACf,kBAAC,IAAD,CACE1xB,IAAKuJ,IAAOC,IAAIC,UAAUC,OAAO,IACjClE,KAAM,UAAYksB,EAAKzwB,GACvB6E,aAAa,EACbF,MAAO8rB,EAAK9rB,MACZ4F,MAAM,GACNC,SAAS,GACTC,KAAK,SAKH,8BCWCs2B,GA5BG,SAACh6B,GAkBjB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQpC,MAAOhD,EAAKghC,MAAOx4B,SAAUxI,EAAKkG,OAE1C,kBAAC,IAAD,KAAalG,EAAKlC,MArBtB,SAAa6E,GACXzE,QAAQC,IAAIiH,EAAM1D,SAClB,IAAIoB,EAAS,GAab,OAZIsC,EAAM1D,SACR0D,EAAM1D,QAAQvE,KAAI,SAAC4F,GACbA,EAAGC,QAAUL,GAAKI,EAAGE,OACvBH,EAAOvC,KACL,kBAAC,IAAD,CAAK6H,KAAK,aAAazD,OAAO,aAAa0D,SAAS,cAAcC,KAAK,QAAQpB,MAAM,cACrF,kBAAC,IAAD,CAAMG,IAAI,SAASC,OAAO,SAASC,GAAG,iBACtC,kBAAC,IAAD,CAAMF,IAAI,WAAWC,OAAO,WAAWC,GAAG,wBAM3CzE,EAOJ2F,CAAI,YACL,kBAAC,GAAD,CAAUu4B,MAAO57B,EAAM47B,UCpBRn5B,G,YACnB,aAAe,IAAD,8BACZ,+CACKlL,QAAU,EAAKA,QAAQuE,KAAb,gBACf,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBAEnB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCu/B,MAAO,KACPt/B,QAAS,KACTC,UAAW,MATD,E,kFAaZK,EAAWC,GAAG,WAAY9B,KAAKxD,SAC/BqF,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,WAAY/B,KAAKxD,SAC3CqF,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI/CqB,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QACpElG,EAAkB,QAAShC,KAAKmB,MAAMzE,KAAM,GAAIsD,KAAKmB,MAAMvE,S,gCAI3D,IAAIikC,EAAQh/B,EAAWrF,UACnBuD,EAAQ8B,EAAWM,WACnB0+B,GAAmB,SAAV9gC,GACXC,KAAKyB,SAAS,CACZo/B,MAAOA,M,oCAOX,IAAI5+B,EAAOJ,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBF,GAAkB,aAAVlC,GACVC,KAAKyB,SAAS,CACZF,QAASU,EAAKG,YACdZ,UAAWS,EAAKM,e,+BAKZ,IAAD,EACkBvC,KAAKmB,MAAvB0/B,EADA,EACAA,MAAOt/B,EADP,EACOA,QACd,OAAO,kBAAC,GAAD,CAAWs/B,MAAOA,EAAOt/B,QAASA,Q,GAzDT4H,IAAMpE,WCmD3B+7B,GAtDE,SAAC77B,GAChB,GAAIA,EAAM87B,YACR,IAAIC,GAAgB,OAEhBA,GAAgB,EAGtB,OACE,kBAAC,IAAMv9B,SAAP,KACE,kBAAC,IAAD,KAAa5D,EAAK8uB,MAClB,kBAAC,IAAD,KACE,kBAAC,IAAD,CACEnpB,MAAO3F,EAAKgD,MACZ5F,IAAI,aACJS,KAAK,OACL+H,YAAY,MACZmB,aAAc3B,EAAM0pB,KAAK9rB,MACzB6C,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAExG,MAAOyB,EAAEE,OAAO1B,WAGzC,kBAAC,IAAD,CACE0C,MAAO3F,EAAKm3B,QACZt5B,KAAK,WACL+H,YAAa5F,EAAKohC,8BAClBn+B,MAAOmC,EAAM+xB,QACbtxB,QAAS,SAACpB,GACRW,EAAMoE,aAAa,CAAE2tB,QAAS1yB,EAAEE,OAAO1B,WAI3C,kBAAC,IAAD,CAAUi2B,OAAK,EAACj2B,OAAO,EAAOk2B,SAAUgI,EAAe58B,KAAK,cAAcvB,MAAOhD,EAAKqhC,WACpF78B,SAAU,SAACC,GACTvG,QAAQC,IAAIsG,GACZW,EAAMoE,aAAa,CAAE83B,YAAa55B,KAAKmP,MAAMpS,EAAEE,OAAO1B,YAG1D,kBAAC,IAAD,CAAUi2B,OAAK,EAACj2B,OAAO,EAAMk2B,QAASgI,EAAe58B,KAAK,cAAcvB,MAAOhD,EAAKuhC,QAClF/8B,SAAU,SAACC,GACTvG,QAAQC,IAAIsG,GACZW,EAAMoE,aAAa,CAAE83B,YAAa55B,KAAKmP,MAAMpS,EAAEE,OAAO1B,aAK5D,kBAAC,IAAD,CAAOuI,QAAM,GACX,kBAAC,IAAD,CAAKC,IAAI,KACP,kBAAC,IAAD,CAAMpI,UAAU,eAChB,kBAAC,IAAD,CAAQA,UAAU,UAAU+C,MAAI,EAACkzB,UAAWl0B,EAAM6E,QAASpF,QAASO,EAAMe,QAASnG,EAAKmG,YCjC7Eq7B,G,YACnB,aAAe,IAAD,8BACZ,+CACKr7B,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBAEzB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCqtB,KAAM,GACNoS,aAAa,GATH,E,kFAeZl/B,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAK/CmD,EAAsB,QADX,CAACa,MAAO7C,KAAKmB,MAAM0B,MAAOy+B,aAActhC,KAAKmB,MAAM4/B,aACzB/gC,KAAKmB,MAAMvE,S,wCAIhC8M,GAChB1J,KAAKyB,SAASiI,K,oCAKd1J,KAAK2J,UAAUC,SAAS,a,+BAKhB,IAAD,EACqB5J,KAAKmB,MAA1BwtB,EADA,EACAA,KAAMoS,EADN,EACMA,YACb,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQl+B,MAAOhD,EAAK0hC,UAAWl5B,SAAUxI,EAAKkG,OAC9C,kBAAC,IAAD,KAAalG,EAAK0hC,WAClB,kBAAC,GAAD,CAAU5S,KAAMA,EAAMoS,YAAaA,EAAa/6B,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,yB,GA9CvE1C,aCCnBgF,G,YACnB,aAAe,IAAD,8BACZ,+CACK/D,OAAS,EAAKA,OAAOjF,KAAZ,gBACd,EAAKlC,YAAc,EAAKA,YAAYkC,KAAjB,gBACnB,EAAKpC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK0G,kBAAoB,EAAKA,kBAAkB1G,KAAvB,gBAGzB,EAAKI,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCqtB,KAAO,GACPoS,YAAa,MAXH,E,kFAgBZl/B,EAAWC,GAAG,eAAgB9B,KAAKrB,aACnCkD,EAAWC,GAAG,eAAgB9B,KAAKnB,e,6CAInCgD,EAAWE,eAAe,eAAgB/B,KAAKrB,aAC/CkD,EAAWE,eAAe,eAAgB/B,KAAKnB,e,+BAO/CmD,EAAyB,QADd,CAAC9D,GAAG8B,KAAKmB,MAAMjD,GAAI2E,MAAO7C,KAAKmB,MAAM0B,MAAOy+B,aAActhC,KAAKmB,MAAM4/B,aACvC/gC,KAAKmB,MAAMvE,S,0CAGpDoD,KAAK6I,a,iCAIkBC,IAAWpK,SAC/BqK,MAAMC,KAAK,CAAEL,KAAM9I,EAAKoJ,UAAWC,aAAc,IAAMhB,SAAU,QAChElI,KAAK4H,SAASjL,OAAd,QACFqF,EAAsB,QAAShC,KAAK4H,SAASjL,OAAd,OAAiCqD,KAAKmB,MAAMvE,S,oCAM7E,IAAI+xB,EAAO9sB,EAAWK,aAClBnC,EAAQ8B,EAAWM,WACnBwsB,GAAkB,SAAV5uB,GACVC,KAAKyB,SAAS,CACZoB,MAAO8rB,EAAK9rB,MACZ3E,GAAIywB,EAAKzwB,GACTywB,KAAMA,EACNoS,YAAapS,EAAK2S,iB,wCAKN53B,GAChB1J,KAAKyB,SAASiI,K,oCAMd1J,KAAK2J,UAAUC,SAAS,a,+BAIhB,IAAD,EACyB5J,KAAKmB,MAA1BwtB,EADJ,EACIA,KAAMoS,EADV,EACUA,YACjB,OACE,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQl+B,MAAOhD,EAAK0hC,UAAWl5B,SAAUxI,EAAKkG,OAC9C,kBAAC,IAAD,KAAalG,EAAK0hC,WAClB,kBAAC,GAAD,CAAU5S,KAAMA,EAAMoS,YAAaA,EAAa/6B,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,yB,GA3EnE1C,aCwM7B80B,GAxNK,SAAC50B,GACR,IACAu0B,EAAT,SAAiB7L,GAEf,SAAI1oB,EAAMu8B,uBAAwBv8B,EAAMu8B,qBAAqB7T,MAGvD1oB,EAAMu8B,sBAAwBv8B,EAAMu8B,qBAAqB7T,IACnD,IA8Jd,OACE,kBAAC,IAAMlqB,SAAP,KAEE,yBAAKP,UAAU,mBACb,2BAAOA,UAAU,SACf,+BACE,4BACE,4BAAKrD,EAAK4hC,mBACV,4BAAK5hC,EAAK6hC,mBACV,4BAAK7hC,EAAK8hC,mBACV,4BAAK9hC,EAAK+hC,OAGd,+BACE,4BACE,wBAAI1+B,UAAU,SAASrD,EAAKgiC,+BAC5B,4BAAI,kBAAC,IAAD,CAAQ3+B,UAAU,OAAO81B,QAASQ,EAAQ,uCAAwCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,2CAC9H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,sCAAuCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,0CAC7H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,qCAAsCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,0CArJxI,WACE,IAAI3B,EAAS,GA0Eb,OAzEIsC,EAAM1D,SACR0D,EAAM1D,QAAQvE,KAAI,SAAC4F,GACA,aAAbA,EAAGC,OACLF,EAAOvC,KACL,kBAAC,IAAMqD,SAAP,KACE,4BACE,wBAAIP,UAAU,SAASrD,EAAKkiC,sBAC5B,4BAAI,kBAAC,IAAD,CAAQ7+B,UAAU,OAAO81B,QAASQ,EAAQ,8BAA+Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,kCACrH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,6BAA8Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,iCACpH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,4BAA6Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,iCAErH,4BACE,wBAAIpB,UAAU,SAASrD,EAAKmiC,4BAC5B,4BAAI,kBAAC,IAAD,CAAQ9+B,UAAU,OAAO81B,QAASQ,EAAQ,mCAAoCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,uCAC1H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,kCAAmCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCACzH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,iCAAkCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCAE1H,4BACE,wBAAIpB,UAAU,SAASrD,EAAKoiC,oBAC5B,4BAAI,kBAAC,IAAD,CAAQ/+B,UAAU,OAAO81B,QAASQ,EAAQ,4BAA6Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,gCACnH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,2BAA4Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,+BAClH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,0BAA2Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,+BAEnH,4BACE,wBAAIpB,UAAU,SAASrD,EAAKqiC,yBAC5B,4BAAI,kBAAC,IAAD,CAAQh/B,UAAU,OAAO81B,QAASQ,EAAQ,iCAAkCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,qCACxH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,gCAAiCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,oCACvH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,+BAAgCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,oCAExH,4BACE,wBAAIpB,UAAU,SAASrD,EAAKsiC,wBAC5B,4BAAI,kBAAC,IAAD,CAAQj/B,UAAU,OAAO81B,QAASQ,EAAQ,gCAAiCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,oCACvH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,+BAAgCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,mCACtH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,8BAA+Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,mCAEvH,4BACE,wBAAIpB,UAAU,SAASrD,EAAKuiC,6BAC5B,4BAAI,kBAAC,IAAD,CAAQl/B,UAAU,OAAO81B,QAASQ,EAAQ,qCAAsCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,yCAC5H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,oCAAqCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,wCAC3H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,mCAAoCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,wCAG5H,4BACE,wBAAIpB,UAAU,SAASrD,EAAKwiC,sBAC5B,4BAAI,kBAAC,IAAD,CAAQn/B,UAAU,OAAO81B,QAASQ,EAAQ,8BAA+Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,kCACrH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,6BAA8Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,iCACpH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,4BAA6Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,iCAErH,4BACE,wBAAIpB,UAAU,SAASrD,EAAKyiC,2BAC5B,4BAAI,kBAAC,IAAD,CAAQp/B,UAAU,OAAO81B,QAASQ,EAAQ,mCAAoCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,uCAC1H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,kCAAmCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCACzH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,iCAAkCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCAI1H,4BACE,wBAAIpB,UAAU,SAASrD,EAAK0iC,qBAC5B,4BAAI,kBAAC,IAAD,CAAQr/B,UAAU,OAAO81B,QAASQ,EAAQ,6BAA8Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,iCACpH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,4BAA6Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,gCACnH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,2BAA4Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,gCAEpH,4BACE,wBAAIpB,UAAU,SAASrD,EAAK2iC,0BAC5B,4BAAI,kBAAC,IAAD,CAAQt/B,UAAU,OAAO81B,QAASQ,EAAQ,kCAAmCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCACzH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,iCAAkCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,qCACxH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,gCAAiCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,0CAO5H3B,EA4EE8/B,GACD,4BACE,6BACA,6BACA,6BACA,8BA9EZ,WACE,IAAI9/B,EAAS,GAiDb,OAhDIsC,EAAM1D,SACR0D,EAAM1D,QAAQvE,KAAI,SAAC4F,GACA,gBAAbA,EAAGC,OACLF,EAAOvC,KACL,kBAAC,IAAMqD,SAAP,KACE,4BACE,wBAAIP,UAAU,SAASrD,EAAK6iC,uBAC5B,4BAAI,kBAAC,IAAD,CAAQx/B,UAAU,OAAO81B,QAASQ,EAAQ,+BAAgCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,mCACtH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,8BAA+Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,kCACrH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,6BAA8Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,kCAEtH,4BACE,wBAAIpB,UAAU,SAASrD,EAAK8iC,4BAC5B,4BAAI,kBAAC,IAAD,CAAQz/B,UAAU,OAAO81B,QAASQ,EAAQ,oCAAqCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,wCAC3H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,mCAAoCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,uCAC1H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,kCAAmCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,uCAE3H,4BACE,wBAAIpB,UAAU,SAASrD,EAAK+iC,2BAC5B,4BAAI,kBAAC,IAAD,CAAQ1/B,UAAU,OAAO81B,QAASQ,EAAQ,mCAAoCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,uCAC1H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,kCAAmCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCACzH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,iCAAkCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCAE1H,4BACE,wBAAIpB,UAAU,SAASrD,EAAKgjC,gCAC5B,4BAAI,kBAAC,IAAD,CAAQ3/B,UAAU,OAAO81B,QAASQ,EAAQ,wCAAyCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,4CAC/H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,uCAAwCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,2CAC9H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,sCAAuCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,2CAG/H,4BACE,wBAAIpB,UAAU,SAASrD,EAAKijC,yBAC5B,4BAAI,kBAAC,IAAD,CAAQ5/B,UAAU,OAAO81B,QAASQ,EAAQ,iCAAkCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,qCACxH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,gCAAiCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,oCACvH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,+BAAgCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,oCAExH,4BACE,wBAAIpB,UAAU,SAASrD,EAAKkjC,8BAC5B,4BAAI,kBAAC,IAAD,CAAQ7/B,UAAU,OAAO81B,QAASQ,EAAQ,sCAAuCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,0CAC7H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,qCAAsCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,yCAC5H,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,oCAAqCn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,8CAQhI3B,EA8BEqgC,GACD,4BACE,wBAAI9/B,UAAU,SAASrD,EAAKojC,sBAC5B,4BAAI,kBAAC,IAAD,CAAQ//B,UAAU,OAAO81B,QAASQ,EAAQ,8BAA+Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,kCACrH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,6BAA8Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,iCACpH,4BAAI,kBAAC,IAAD,CAAQpB,UAAU,OAAO81B,QAASQ,EAAQ,4BAA6Bn1B,SAAU,SAACC,GAAD,OAAOW,EAAM68B,cAAcx9B,EAAG,sCCjJpH,IACb,CACE4+B,KAAM,IACNC,UAAWnQ,IAEb,CACEkQ,KAAM,UACNC,UAAWjF,IAEb,CACEgF,KAAM,YACNC,UAAWxE,IAEb,CACEuE,KAAM,uBACNC,UAAWnE,IAEb,CACEkE,KAAM,oBACNC,UAAWC,IAEb,CACEF,KAAM,gBACNC,UAAWniC,GAEb,CACEkiC,KAAM,cACNC,UAAW3F,IAGb,CACE0F,KAAM,UACNC,UAAWlE,IAEb,CACEiE,KAAM,sBACNC,UAAWE,IAEb,CACEH,KAAM,aACNC,UAAW9B,IAEb,CACE6B,KAAM,iBACNC,UAAWG,IAGb,CACEJ,KAAM,UACNC,UAAWv6B,GAEb,CACEs6B,KAAM,sBACNC,UAAWI,GAEb,CACEL,KAAM,aACNC,UAAW15B,GAEb,CACEy5B,KAAM,iBACNC,UAAW97B,GAGb,CACE67B,KAAM,kBACNC,UAAW5M,IAGb,CACE2M,KAAM,UACNC,UAAWnQ,IAEb,CACEkQ,KAAM,sBACNC,UAAWpN,IAEb,CACEmN,KAAM,aACNC,UAAW/N,IAEb,CACE8N,KAAM,iBACNC,UAAWp1B,IAGb,CACEm1B,KAAM,aACNC,UAAWtM,IAEb,CACEqM,KAAM,4BACNC,UAAWhM,IAEb,CACE+L,KAAM,gBACNC,UAAWlM,IAEb,CACEiM,KAAM,uBACNC,UAAW1M,IAGb,CACEyM,KAAM,UACNC,UAAWxK,IAEb,CACEuK,KAAM,sBACNC,UAAWK,IAEb,CACEN,KAAM,aACNC,UAAW/J,IAEb,CACE8J,KAAM,iBACNC,UAAW7K,IAGb,CACE4K,KAAM,aACNC,UAAW5H,IAEb,CACE2H,KAAM,4BACNC,UAAWM,IAEb,CACEP,KAAM,gBACNC,UAAW5G,IAEb,CACE2G,KAAM,uBACNC,UAAWxI,IAEb,CACEuI,KAAM,yBACNC,UAAWxG,IAEb,CACEuG,KAAM,qBACNC,UAAWrG,IAGb,CACEoG,KAAM,aACNC,UAAWvJ,IAEb,CACEsJ,KAAM,4BACNC,UAAWO,IAEb,CACER,KAAM,gBACNC,UAAWrJ,IAEb,CACEoJ,KAAM,uBACNC,UAAW5J,IAGb,CACE2J,KAAM,0BACNC,U,YCjNF,aAAe,IAAD,gCACZ,+CAEKxkC,YAAc,EAAKA,YAAYoC,KAAjB,gBACnB,EAAK+gC,cAAgB,EAAKA,cAAc/gC,KAAnB,gBACrB,EAAK4iC,cAAgB,EAAKA,cAAc5iC,KAAnB,gBACrB,EAAK6iC,cAAgB,EAAKA,cAAc7iC,KAAnB,gBAIrB,EAAKI,OAAL,GACEvE,MAAOwE,OAAOC,aAAaC,QAAQ,SACnCk4B,QAAS,GACT32B,MAAO,KACP3E,GAAI,MAJN,wBAKW,MALX,qCAMwB,IANxB,0BAOa,IAPb,wBAQW,MARX,0BASa,MATb,GAVY,E,kFAyBZ2D,EAAWC,GAAG,eAAgB9B,KAAKrB,e,6CAInCkD,EAAWE,eAAe,eAAgB/B,KAAKrB,e,0CAI/CqB,KAAK6I,a,iCAIL7G,EAAsB,wBAAyB,EAAGhC,KAAKmB,MAAMvE,OAC7DoF,EAAsB,QAAS,OAAQhC,KAAKmB,MAAMvE,S,oCAIlDoD,KAAK2jC,kB,sCAKL,IAAM/W,EAAO5sB,KACP6jC,EAAMjX,EAAK0F,IACjBuR,EAAIC,aAAaC,OAAO,CACtBC,OAAQ,QACRC,SAAU,kBACVC,UAAU,EACVC,cAAe,KACfC,aAAc,WACdC,qBAAsBxkC,EAAK6K,OAC3B45B,mBAAoBzkC,EAAKqL,MACzBq5B,aAAc1kC,EAAK2kC,UACnBC,MAAO,GACPpQ,qBAAsBx0B,EAAK6zB,OAE3BgR,OAAQ,SAAU/Q,EAAOgR,GACvB,IACIC,EAAU,GACO,IAAjBjR,EAAMxzB,OAOV0jC,EAAI7tB,QAAQ,CACV5X,IAAK9B,EAAKC,OAAS,mBACnBqtB,OAAQ,MACRiB,SAAU,OAEVjtB,KAAM,CACJo2B,EAAGL,GAEL3iB,QAAS,SAAU2c,GAEjB,IAAK,IAAI1tB,EAAI,EAAGA,EAAI0tB,EAAK/vB,KAAKuC,OAAQF,IACnC2kC,EAAQxkC,KAAKutB,EAAK/vB,KAAKqC,IAK1B0kC,EAAOC,MAtBTD,EAAOC,IA0BX9iC,GAAI,CACF+iC,OAAQ,SAAU/hC,GACZA,GAASA,EAAMA,EAAM3C,OAAS,KAChCysB,EAAKnrB,SAAS,CAAEqjC,UAAWlY,EAAKzrB,MAAM2jC,UAAU/8B,OAAO,CAAE8E,SAAU/J,EAAMA,EAAM3C,OAAS,GAAG0M,SAAU3O,GAAI4E,EAAMA,EAAM3C,OAAS,GAAGjC,OAEjI8D,EAAsB,kCADX,CAACO,WAAYO,EAAMA,EAAM3C,OAAS,GAAGjC,IACe0uB,EAAKzrB,MAAMvE,c,oCAYlF,IAAIH,EAAQoF,EAAWK,aACnBnC,EAAQ8B,EAAWM,WACnB1F,GAAmB,wBAAVsD,GACXC,KAAKyB,SAAS,CACZoB,MAAOpG,EAAMoG,MACb3E,GAAIzB,EAAMyB,GACVsjC,qBAAsB/kC,EAAM+kC,uBAG5B/kC,GAAmB,aAAVsD,GACXC,KAAKyB,SAAS,CACZF,QAAS9E,EAAM2F,YACfC,MAAO5F,EAAM6F,UACbd,UAAW/E,EAAM8F,e,oCAMT+B,EAAGqpB,GACf,IAAI/vB,EAAO,CAAE+vB,KAAMA,GACfrpB,EAAEE,OAAOw0B,SACXh5B,KAAKyB,UAAS,SAAAsjC,GACZ,IAAIvD,EAAuB1kC,OAAOgL,OAAO,GAAIi9B,EAAUvD,sBAEvD,OADAA,EAAqB7T,IAAQ,EACtB,CAAE6T,2BAEXx/B,EAAsB,4BAA6BpE,EAAMoC,KAAKmB,MAAMvE,SAEpEoD,KAAKyB,UAAS,SAAAsjC,GACZ,IAAIvD,EAAuB1kC,OAAOgL,OAAO,GAAIi9B,EAAUvD,sBAEvD,OADAA,EAAqB7T,IAAQ,EACtB,CAAE6T,2BAEXx/B,EAAsB,+BAAgCpE,EAAMoC,KAAKmB,MAAMvE,U,oCAI7DsB,GACZ8B,KAAKyB,SAAS,CACZqjC,UAAW9kC,KAAKmB,MAAM2jC,UAAUpX,QAAO,SAAUtqB,GAC/C,OAAOA,EAAQlF,KAAOA,OAI1B8D,EAAsB,qCADX,CAACO,WAAYrE,GAC0C8B,KAAKmB,MAAMvE,S,+BAMrE,IAAD,EACqDoD,KAAKmB,MAAzDqgC,EADD,EACCA,qBAAsB3+B,EADvB,EACuBA,MAAOiiC,EAD9B,EAC8BA,UAAWvjC,EADzC,EACyCA,QAChD,OACE,kBAAC,IAAD,CAAMyjC,cAAehlC,KAAKmxB,YAAYpwB,KAAKf,OACzC,kBAAC,IAAD,CAAQ6C,MAAOhD,EAAKolC,UAAW58B,SAAUxI,EAAKkG,OAC9C,kBAAC,IAAD,KAAalG,EAAKolC,WAClB,kBAAC,GAAD,CACEzD,qBAAsBA,EAAsBjgC,QAASA,EACrDsB,MAAOA,EAAOi/B,cAAe9hC,KAAK8hC,cAAegD,UAAWA,EAC5D9+B,OAAQhG,KAAKgG,OAAQ8D,SAAS,EAAMT,aAAcrJ,KAAKyH,kBACvDm8B,cAAe5jC,KAAK4jC,qB,GA1Ka7+B,cDsNzC,CACEm+B,KAAM,OACNC,UElOW,kBACb,kBAAC,IAAD,KACE,kBAAC,IAAD,CAAQtgC,MAAM,YAAYwF,SAAS,SACnC,kBAAC,IAAD,CAAOgD,QAAM,GACX,oCACA,gE,eCOJ,aAAe,IAAD,8BACZ,+CAEKlK,MAAQ,CACXvE,MAAOwE,OAAOC,aAAaC,QAAQ,UAJzB,E,mMASNuiC,GADAjX,EAAO5sB,MACIsyB,IAEb5yB,GACFA,EAAUwlC,oBACP5nC,KADH,sBACQ,8BAAAkF,EAAA,sEACgB9C,EAAUylC,WAD1B,OACEvoC,EADF,OAEAgB,EAAO,CAAEhB,MAAOA,GAChBgwB,EAAKzrB,MAAMvE,OAASgwB,EAAKzrB,MAAMvE,MAAMuD,OAAS,IAChD6B,EAAsB,UAAWpE,EAAMgvB,EAAKzrB,MAAMvE,OAJhD,4CAOLiB,OAAM,SAAU+lB,GACf7lB,QAAQC,IAAI,sCAAuC4lB,MAGzDvU,UAAU+1B,cAAcz0B,iBAAiB,WAAW,SAACkG,GAEpDgtB,EAAI3N,aAAa6N,OAAO,CACrBrhC,KAAM,GAENG,MAAOgU,EAAQjZ,KAAKynC,kBAAkB7a,QAAQ0L,aAAarzB,MAC3DyiC,eAAgB,GAChBC,SAAU,eACV78B,SAAUmO,EAAQjZ,KAAKynC,kBAAkB7a,QAAQ0L,aAAa7vB,KAC9D6C,aAAc,MACb+rB,U,qIAQL,IAAMuQ,EAAW,CACftnC,GAAI,wBACJkG,KAAM,aACNqhC,MAAO,SACPC,MAAO,CACLC,gBAAiB,KAEnB3iC,KAAM,CAIJ4iC,oBAAqB,GACrBC,gBAAgB,GAGlBC,WAIF,OACE,kBAAC,IAAD,CAAKnpC,OAAQ6oC,GAEX,kBAAC,IAAD,MAKA,kBAAC,IAAD,CAAOO,OAAK,EAACC,QAAM,EAACC,WAAS,GAC3B,kBAAC,IAAD,CAAM7nC,IAAI,mBAIZ,kBAAC,IAAD,CAAMF,GAAG,YAAYE,IAAI,IAAI8nC,WAAW,EAAMC,MAAI,EAACjjC,UAAU,oB,GA3ExCiG,IAAMpE,W,0CCFfqhC,QACW,cAA7BhlC,OAAOO,SAAS0kC,UAEe,UAA7BjlC,OAAOO,SAAS0kC,UAEhBjlC,OAAOO,SAAS0kC,SAAS52B,MACvB,2DCUN3G,IAAWw9B,IAAIC,KAGfC,IAAS7B,OAAOx7B,IAAMs9B,cAAcC,IAClCz2B,SAAS+f,eAAe,SDiGpB,kBAAmB3gB,WACrBA,UAAU+1B,cAAcuB,MAAMrpC,MAAK,SAAAspC,GACjCA,EAAaC,iB,iBEnInBC,EAAOC,QAAU,CAGf,cAAe,uCACf,iBAAkB,qBAGlB,mCAAoC,KACpC,mCAAoC,KACpC,mCAAoC,KACpC,mCAAoC,KACpC,mCAAoC,KACpC,mCAAoC,KACpC,2CAA4C,aAC5C,qCAAsC,OACtC,0CAA2C,aAC3C,uCAAwC,SAGxC,8CAA+C,eAC/C,uCAAwC,OACxC,6CAA8C,YAG9C,wCAAyC,WACzC,4CAA6C,gBAC7C,yCAA0C,aAG1C,kCAAmC,QAGnC,4CAA6C,OAG7C,wCAAyC,YAGzC,sCAAuC,UACvC,mCAAoC,OACpC,mCAAoC,OAGpC,kCAAmC,qBACnC,uCAAwC,mDACxC,kCAAmC,iCACnC,yCAA0C,iGAG1C,kCAAmC,OACnC,oCAAqC,SACrC,uCAAwC,YACxC,2CAA4C,gBAC5C,uCAAwC,YACxC,yCAA0C,cAC1C,uCAAwC,YAGxC,qCAAsC,gEACtC,sCAAuC,2BACvC,4CAA6C,uGAC7C,gCAAiC,iCACjC,kCAAmC,oDAGnC,gCAAiC,OACjC,qCAAsC,YACtC,mCAAoC,UACpC,kCAAmC,SACnC,mCAAoC,UAGpC,oCAAqC,SAGrC,0CAA2C,aAC3C,qCAAsC,OACtC,uCAAwC,SACxC,sCAAuC,QACvC,wCAAyC,a","file":"static/js/main.7a56a83a.chunk.js","sourcesContent":["import { Dispatcher } from \"flux\";\n\nexport default new Dispatcher;\n","export const conf = { \n'server' : '/v1',\n//'server' : 'http://localhost:3001/v1',\n'janusServer' : 'https://kaarafarinan.ir:8089/janus'\n};","import dispatcher from \"../dispatcher\";\nimport axios, {put} from 'axios';\nimport { conf } from '../conf';\nconst server= conf.server;\n//const server='/v1';\n//const server='http://95.156.255.115/api';\n\n\nexport function getList(model, page=1, params={}, token) {\n  var queryString = Object.keys(params).map(key => key + '=' + params[key]).join('&');\n  axios.get(server + '/'+ model +'?page='+page+'&'+queryString, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"LIST_MODEL_SUCCESS\",\n      list: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function fileUpload(model, id , file, token){\n  const url = server + '/'+ model +'/'+id;\n  const formData = new FormData();\n  formData.append('profile[avatar]',file)\n  formData.append('profile[id]',id)\n  const config = {\n      headers: {\n          'content-type': 'multipart/form-data',\n          'Authorization': \"bearer \" + token \n      }\n  }\n  put(url, formData,config).then(function (response) {\n    dispatcher.dispatch({\n      type: \"POST_FILE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function getInstance(model, id, token, page=1) {\n  axios.get(server + '/'+ model +'/'+id+'?page='+page, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"GET_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function removeInstance(model, params={}, token ) {\n  var queryString = Object.keys(params).map(key => key + '=' + params[key]).join('&');\n  axios.get(server + '/'+ model +'/delete?'+queryString, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"DELETE_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function setInstance(model, data, token) {\n  axios.post(server + '/'+ model +'/', data, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"SET_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n\nexport function updateInstance(model, data, token) {\n  axios.put(server + '/'+ model +'/'+data.id, data, { headers: {'Content-Type': 'application/json', 'Authorization': \"bearer \" + token } })\n  .then(function (response) {\n    dispatcher.dispatch({\n      type: \"SET_INSTANCE_SUCCESS\",\n      instance: response.data,\n    });\n  })\n  .catch(function (error) {\n    console.log(error);\n  });\n}\n","import * as firebase from \"firebase/app\";\nimport \"firebase/messaging\";\nconst initializedFirebaseApp = firebase.initializeApp({\n    apiKey: \"AIzaSyAbQ1NDkKB_E_SbfgHY3w-esVWhjwj9DeE\",\n    authDomain: \"tavan-e768d.firebaseapp.com\",\n    databaseURL: \"https://tavan-e768d.firebaseio.com\",\n    projectId: \"tavan-e768d\",\n    storageBucket: \"tavan-e768d.appspot.com\",\n    messagingSenderId: \"498708095861\",\n    appId: \"1:498708095861:web:00428b1330b24e1eece93c\",\n    measurementId: \"G-55DLXZ4VZY\"\n \n});\n//const messaging = initializedFirebaseApp.messaging();\nvar messaging = null;\nif (firebase.messaging.isSupported()){\n  messaging = initializedFirebaseApp.messaging();\n  messaging.usePublicVapidKey(\n    // Project Settings => Cloud Messaging => Web Push certificates\n    \"BGtSQdySGVQOeOwFha6rSVdmtfIUo_V33Eq-RTRb5kUNLvvwM7AVGCLtChjnGlD50fudRx8D4Aw-7br71Qfefrc\"\n  );\n  \n} else {\n \n}\nexport { messaging }; ","export const dict = {\n  'home' : 'خانه',\n  'name' : 'نام و نام خانوادگی ',\n  'login' : 'ورود',\n  'username' :  'نام کاربری ',\n  'password' : 'رمز عبور ',\n  'password_confirmation': 'تکرار رمز عبور',\n  'mobile' : 'شماره موبایل ',\n  'error': 'خطا',\n  'sign_in' : 'ورود ',\n  'sign_up' : 'ثبت نام',\n  'back' : 'بازگشت',\n  'signed_up_already': 'تا کنون ثبت نام نکرده اید؟',\n  'new_advert': 'درج آگهی ',\n  'title': 'عنوان',\n  'abstract': 'چکیده',\n  'content': 'متن',\n  'submit': 'ثبت ',\n  'upload_from_gallery': 'انتخاب از گالری',\n  'welcome': 'خوش آمدید',\n  'sign_out': 'خروج',\n  'phone_number': 'شماره تلفن',\n  'telegram_channel': 'کانال تلگرام',\n  'instagram_page': 'صفحه اینستاگرام',\n  'address': 'آدرس ',\n  'email': 'ایمیل ',\n  'contact_information':'اطلاعات تماس ',\n  'search': 'جستجو ',\n  'cancel' : 'بیخیال',\n  'view': 'نمایش',\n  'edit': 'ویرایش',\n  'delete': 'حذف',\n  'adverts_nes': 'عنوان، متن و شماره تلفن اجباری است',\n  'my_pins': ' نشان شده‌ها ',\n  'pin' : 'نشان کن',\n  'pinned': 'نشان شده',\n  'message_to_seller': 'ارسال پیام',\n  'messages': 'پیام ها ',\n  'send_message': 'پیام خود را بنویسید',\n  'province': 'استان',\n  'city': 'شهر',\n  'website': 'وبسایت',\n  'call': 'تماس بگیرید',\n  'ago': ' قبل',\n  'all_above': 'همه ی موارد فوق',\n  'no_result': 'موردی یافت نشد ',\n  'category': 'دسته بندی ',\n  'leg':'مسیر',\n  'date':'تاریخ',\n  'time': 'زمان',\n  'numberOfPassngers': 'تعداد مسافران ',\n  'surename': 'نام خانوادگی',\n  'fathername':'نام پدر',\n  'ssn':'کدملی',\n  'birthplace':'محل تولد',\n  'pass_no': 'شماره گذرنامه',\n  'birthdate': 'تاریخ تولد',\n  'place_of_birth': 'محل تولد',\n  'required_fields': 'فیلدهای اجباری',\n  'en_father_name': 'نام پدر لاتین',\n  'en_name': 'نام لاتین',\n  'en_surename': 'نام خانوادگی لاتین ',\n  'passport_no': 'شماره گذرنامه',\n  'final_confirm' : 'تایید نهایی ',\n  'document_form': 'فرم اسناد ',\n  'save': 'ذخیره',\n  'documents':'اسناد ',\n  'type' : 'نوع',\n  'string': 'متن کوتاه',\n  'text': 'متن بلند',\n  'select': 'گزینه',\n  'multiSelect': 'چند گزینه',\n  'table': 'جدول',\n  'date':'تاریخ',\n  'refundable': 'قابل اعاده',\n  'yes':'بله',\n  'no':'خیر',\n  'commentable':'قابل نظردهی',\n  'end_point':'نقطه پایان',\n  'start_point':'نقطه شروع',\n  'votable':'رای گیری',\n  'publishable':'قابل انتشار',\n  'field_name': 'نام فیلد',\n  'add': 'افزودن ',\n  'remove': 'حذف',\n  'auxiliary_tables': 'جداول کمکی',\n  'create_by':'ایجاد شده توسط',\n  'list': 'لیست',\n  'workflows': 'گردش کارها',\n  'auxiliary_records': 'مقادیر کمکی',\n  'basic_table': 'جدول پایه',\n  'relation_table': 'جدول رابطه',\n  'auxiliary_table_form': 'فرم جدول کمکی ' ,\n  'Basic': 'پایه',\n  'Relation': 'رابطه ',\n  'Divan': 'دیوان',\n  'workflow_form':'فرم گردش کار',\n  'submitting':'در حال ارسال ... ',\n  'settings':'تنظیمات',\n  'receiving':'در حال دریافت ...',\n  'workflow_tables': 'جداول کمکی گردش کار ',\n  'auxiliary_table': 'جدول کمکی',\n  'workflow':'گردش کار',\n  'actions' : 'عملیات',\n  'roles': 'نقش ها',\n  'divan': 'دیوان',\n  'enter_your_email': 'ایمیل خود را وارد کنید',\n  'enter_your_password': 'رمز عبور را وارد کنید ',\n  'enter_your_password_confirmation': 'رمز عبور را تکرار کنید ',\n  'profiles': 'افراد ',\n  'firstname': 'نام',\n  'if_registered': 'اگر قبلا ثبت نام کرده اید',\n  'you_can_login':'وارد شوید ',\n  'if_not_registered': 'اگر ثبت نام نکرده اید',\n  'you_can_sign_up':'ثبت نام کنید',\n  'new_assignment': 'اعطای نقش جدید',\n  'posts': 'پست ها',\n  'bookmark': 'نشان',\n  'like':'علاقه',\n  'follow':'دنبال',\n  'share':'اشتراک',\n  'social_acts':'عملگرهای اجتماعی ',\n  'channels': 'کانال ها',\n  'close': 'بستن',\n  'channel':'کانال ',\n  'details': 'شرح',\n  'Shoa': 'شعاع ',\n  'role': 'نقش',\n  'Default': 'پیش فرض',\n  'NonDefault':'غیر پیش فرض ',\n  'value': ' مقدار',\n  'true': 'مثبت',\n  'false': 'منفی',\n  'access_control_list':'لیست کنترل دسترسی',\n  'access_control_form':'فرم کنترل دسترسی',\n  'assignment_form':'فرم اعطای نقش',\n  'comment_form': 'نظر بدهید',\n  'post_form': 'فرم پست',\n  'metas':'پیش جداول',\n  'shoa': 'شعاع',\n  'form' : 'ورود اطلاعات',\n  'choose_image': 'انتخاب عکس',\n  'logout': 'خروج',\n  'more': 'بیشتر ...',\n  'social': 'اجتماعی',\n  'others': 'دیگران',\n  'related' : 'مرتبط',\n  'mine': 'من',\n  'info':'اطلاعات',\n  'admins': 'مدیران',\n  'recent_posts': 'پست های اخیر',\n  'profile_info':'اطلاعات فردی ',\n  'experties': 'تخصص ها و مهارت ها',\n  'new_experties': 'افزودن تخصص',\n  'notifications' : 'آگاهسازی ها',\n  'enter_your_name':'نام خود را وارد کنید',\n  'enter_your_surename':'نام خانوادگی خود را وارد کنید',\n  'incomplete_data':'اطلاعات ناقص',\n  'alert':'آیا اطمینان دارید؟',\n  'followers': 'دنبال کنندگان',\n  'followees':'دنبال شوندگان',\n  'verification': 'احراز هویت',\n  'verification_code':  'کد احراز',\n  'enter_verification_code':  'کد احراز را وارد کنید',\n  'faculty': 'دانشکده',\n  'enter_your_faculty': 'نام دانشکده خود را وارد کنید',\n  'new_post' : 'پست جدید',\n  'full_list': 'لیست کامل',\n  'privacy_settings': 'حریم خصوصی',\n  'global_settings' : 'تنظیمات عمومی',\n  'message': 'پیام',\n  'completed_successfully': 'با موفقیت انجام شد',\n  'cas': 'احراز هویت مرکزی',\n  'in_reply_to': 'در پاسخ به',\n  'notification_settings': 'تنظیمات آگاهسازی',\n  'add_comment_to_posts':'افزودن نظر به پست',\n  'add_comment_to_followed_posts':'افزودن نظر به پست های دنبال شده',\n  'remove_comments_from_posts':'حذف نظر از پست',\n  'add_likes_to_posts':'ابراز علاقه به پست',\n  'remove_likes_from_posts':'حذف ابراز علاقه به پست',\n  'add_bookmarks_to_posts':'افزودن نشان به پست',\n  'remove_bookmarks_from_posts':'حذف نشان از پست',\n  'add_follows_to_posts':'دنبال کردن پست',\n  'remove_follows_from_posts':'دنبال نکردن پست',\n  'add_shares_to_posts':'بازنشر پست',\n  'remove_shares_from_posts':'عدم بازنشر پست',\n  'add_likes_to_channels':'ابراز علاقه به کانال',\n  'remove_likes_from_channels':'حذف ابراز علاقه به کانال',\n  'add_bookmarks_to_channels':'نشان کردن کانال',\n  'remove_bookmarks_from_channels':'عدم نشان کانال',\n  'add_follows_to_channels':'دنبال کردن کانال',\n  'remove_follows_from_channels':'عدم دنبال کردن کانال',\n  'add_post_to_channels':'افزودن پست به کانال',\n  'notification_type':'نوع آگاهسازی',\n  'mail_notification':'ایمیل',\n  'push_notification':'وب',\n  'sms':'پیامک',\n  'NonPrivate' : 'عمومی',\n  'Private': 'خصوصی',\n  'privacy': 'حریم خصوصی' ,\n  'profile': 'پروفایل',\n  'dashboard': 'میزکار',\n  'user_settings':'تنظیمات کاربر',\n  'change_role': 'تغییر نقش',\n  'bookmarks':'نشان گذاری ها',\n  'rooms': 'نشست ها'\n};\n","import { EventEmitter } from \"events\";\n\nimport dispatcher from \"../dispatcher\";\n\nclass ModelStore extends EventEmitter {\n  constructor() {\n    super()\n    this.list = [];\n    this.instance = null;\n    this.klass= null;\n  }\n\n  listModel(list){\n    this.list = [];\n    this.klass = list.klass\n    for (var i = 0, len = list.data.length; i < len; ++i) {\n      this.list.push(list.data[i]);\n      if (i === len - 1 ) {\n        this.emit(\"got_list\");\n      }\n    }\n    if(list.data.length == 0){\n      this.emit(\"got_list\");\n    }\n\n  }\n\n  showIntance(instance){\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"got_instance\");\n  }\n\n  setIntance(instance){\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"set_instance\");\n  }\n\n\n  deleteIntance(instance){\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"deleted_instance\");\n  }\n\n  postFile(instance){\n    console.log(instance)\n    this.klass = instance.klass\n    this.instance = instance.data\n    this.emit(\"file_posted\");\n  }\n\n  getIntance() {\n    return this.instance\n  }\n\n  getList(){\n    return this.list\n  }\n\n  getListnKlass(){\n    return [this.list, this.klass]\n  }\n\n  getKlass(){\n    return this.klass\n  }\n\n  handleActions(action) {\n    switch(action.type) {\n      case \"LIST_MODEL_SUCCESS\": {\n        this.listModel(action.list);\n        break;\n      }\n      case \"GET_INSTANCE_SUCCESS\": {\n        this.showIntance(action.instance);\n        break;\n      }\n      case \"DELETE_INSTANCE_SUCCESS\": {\n        this.deleteIntance(action.instance);\n        break;\n      }\n      case \"SET_INSTANCE_SUCCESS\": {\n        this.setIntance(action.instance);\n        break;\n      }\n      case \"POST_FILE_SUCCESS\": {\n        this.postFile(action.instance);\n        break;\n      }\n\n      \n    }\n  }\n}\n\n\nconst modelStore = new ModelStore;\ndispatcher.register(modelStore.handleActions.bind(modelStore));\n\nexport default modelStore;\n","import React, { Component } from 'react';\nimport { Menu, MenuItem, MenuDropdown, MenuDropdownItem, Page, Navbar, Block, BlockTitle, List, ListItem, FabButton, FabButtons, Fab, Icon } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { thresholdScott } from 'd3';\n\nexport default class PanelRightPage extends Component {\n  constructor() {\n    super();\n    this.logout = this.logout.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.check_ability = this.check_ability.bind(this);\n\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      ability: null,\n      profileId: null,\n    }\n  }\n\n  logout() {\n    this.setState({ token: null });\n    window.localStorage.removeItem('token');\n    window.location.replace('/')\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    if (this.state.token && this.state.token.length > 10) {\n      MyActions.getInstance('users', 'role', this.state.token);\n    }\n  }\n\n  getInstance() {\n    var user = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (user && klass === 'UserRole') {\n      this.setState({\n        ability: user.the_ability,\n        roles: user.the_roles,\n        profileId: user.profile_id\n      });\n    }\n\n  }\n\n  check_ability(a, link, icon) {\n    var result = []\n    if (this.state.ability) {\n      this.state.ability.map((ab) => {\n        if (ab.title === a && ab.value) {\n          result.push(\n            <ListItem link={\"/\" + link + \"/\"} ignoreCache={true} key={'panel' + link} view=\"#main-view\" panelClose>\n              <i className={\"va ml-5 fa fa-\" + icon}></i>\n              <span>{dict[link]}</span>\n            </ListItem>\n          )\n        }\n      })\n    }\n    return result\n  }\n\n  changeRole(role_id) {\n    var data = {role_id: role_id}\n    MyActions.setInstance('users/change_role', data, this.state.token);\n  }\n\n  profile() {\n    if (this.state.profileId) {\n      return (\n        <ListItem link={\"/profiles/\" + this.state.profileId} view=\"#main-view\" panelClose>\n          <i className=\"va ml-5 fa fa-user-circle-o\"></i>\n          <span>{dict.profile}</span>\n        </ListItem>\n      )\n    }\n  }\n\n  roles() {\n    var options = []\n    if (this.state.roles) {\n      this.state.roles.map((role) => {\n        if(role.current){\n          options.push(<option value={role.id} key={'role' + role.id} selected >{role.title}</option>)\n        } else {\n          options.push(<option value={role.id} key={'role' + role.id} >{role.title}</option>)\n        }\n        \n      }\n      )\n    }\n    return options\n  }\n\n  logged_in(token) {\n    if (token) {\n      return (\n        <React.Fragment>\n          <BlockTitle> <i className=\"va ml-5 fa fa-tachometer\"></i>{dict.dashboard}</BlockTitle>\n          <List className='fs-13'>\n            <ListItem link=\"/posts/\" ignoreCache={false} reloadCurrent={false} view=\"#main-view\" panelClose>\n              <i className=\"va ml-5 fa fa-pencil\"></i>\n              <span>{dict.posts}</span>\n            </ListItem>\n\n            <ListItem link=\"/channels/\" ignoreCache={false} reloadCurrent={false}  view=\"#main-view\" panelClose>\n              <i className=\"va ml-5 fa fa-bullhorn\"></i>\n              <span>{dict.channels}</span>\n            </ListItem>\n\n            <ListItem link=\"/notifications/\" ignoreCache={false} reloadCurrent={false} view=\"#main-view\" panelClose>\n              <i className=\"va ml-5 fa fa-circle-o-notch\"></i>\n              <span>{dict.notifications}</span>\n            </ListItem>\n\n            <ListItem link=\"/bookmarks/\" ignoreCache={false} reloadCurrent={false} view=\"#main-view\" panelClose>\n              <i className=\"va ml-5 fa fa-bookmark\"></i>\n              <span>{dict.bookmarks}</span>\n            </ListItem>\n\n            {this.check_ability('view_rooms', 'rooms', 'vcard')}\n            \n          </List>\n\n          \n\n          <BlockTitle><i className=\"va ml-5 fa fa-cogs\"></i>{dict.user_settings}</BlockTitle>\n          <List>\n            <ListItem link=\"/privacy_settings/\" ignoreCache={true} view=\"#main-view\" panelClose>\n              <i className=\"va ml-5 fa fa-user-secret\"></i>\n              <span>{dict.privacy_settings}</span>\n            </ListItem>\n            <ListItem link=\"/notification_settings/\" ignoreCache={true} view=\"#main-view\" panelClose>\n              <i className=\"va ml-5 fa fa-cog\"></i>\n              <span>{dict.notification_settings}</span>\n            </ListItem>\n            {this.profile()}\n\n            <li className=\"\">\n              <a className=\"item-link panel-close smart-select smart-select-init\" data-open-in=\"popover\">\n                <select name=\"superhero\" onChange={(e) => { this.changeRole(e.target.value) }}>\n                  {this.roles()}\n                </select>\n                <div className=\"item-content\">\n                  <div className=\"item-inner\">\n                    <div className=\"item-title\">{dict.change_role}</div>\n                  </div>\n                </div>\n              </a>\n            </li>\n\n            <ListItem view=\"#main-view\" panelClose onClick={this.logout}>\n              <i className=\"va ml-5 fa fa-power-off\"></i>\n              <span>{dict.logout}</span>\n            </ListItem>\n          </List>\n\n\n          <BlockTitle> <i className=\"va ml-5 fa fa-cog\"></i>{dict.settings}</BlockTitle>\n          <List className='fs-13'>\n            {this.check_ability('change_role', \"roles\", \"shield\")}\n          </List>\n        </React.Fragment>\n      )\n    } else {\n      return (\n        <React.Fragment>\n          <BlockTitle>{dict.user_settings}</BlockTitle>\n          <List>\n            <ListItem link=\"/login/\" title={dict.login} view=\"#main-view\" panelClose></ListItem>\n          </List>\n        </React.Fragment>\n      )\n    }\n  }\n\n  render() {\n    const { token } = this.state;\n    return (\n      <Page >\n        <Navbar title={dict.tavan} />\n        {this.logged_in(token)}\n      </Page>\n    );\n  }\n}","import React from \"react\";\n\nconst ActualOptions = (props) => {\n  var options = [<option value=''></option>]\n  if(props.content){\n    for (let i = 0; i < props.content.length; i++) {\n      options.push(\n        <option value={props.content[i].content[0].fid}>\n          {props.content[i].content[0].value}\n        </option>\n      )\n    }\n\n  }\n  return options\n\n}\nexport default ActualOptions;","import React from \"react\";\nimport { List, ListInput, BlockTitle, Block, Link, Button, Card, CardHeader, CardFooter, ListItem, Row} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ActualOptions from \"../actuals/options\";\n\nconst ActualForm = (props) => {\n    if (props.meta && props.meta.meta_schema) {\n\n        var meta_schema = props.meta.meta_schema\n        var items = []\n        for (let i = 0; i < meta_schema.length; i++) {\n          switch (meta_schema[i].type) {\n            case 'String':\n            items.push(\n              <ListInput\n                label={meta_schema[i].label}\n                type=\"text\"\n                placeholder=\"...\"\n                onInput={(e) => props.onChangeValue(meta_schema[i].fid, e.target.value, props.meta.id)}\n                />)\n            break;\n            case 'Text':\n                items.push(\n                  <ListInput\n                    label={meta_schema[i].name}\n                    type=\"textarea\"\n                    placeholder=\"...\"\n                    onInput={(e) => props.onChangeValue(meta_schema[i].fid, e.target.value, props.meta.id)}\n                    />\n                )\n            break;\n            case 'Table':\n                if (meta_schema[i].content) {\n                  items.push(\n                    <ListItem\n                      title={meta_schema[i].content.title}\n                      smartSelect\n                      smartSelectParams={{pageBackLinkText: dict.back}}\n                      >\n                      <select name=\"content\"\n                        onChange={(e) => props.onChangeValue(meta_schema[i].fid, e.target.value, props.meta.id)}\n                        >\n                        <ActualOptions content={meta_schema[i].content}/>\n                      </select>\n                    </ListItem>\n                  )}\n              break;\n            }\n            }\n              var submit = null\n              if (props.submit) {\n                submit = <CardFooter><Link></Link><Button className=\"col\" fill onClick={props.submit}>{dict.submit}</Button></CardFooter>\n              }\n              return(\n                <Card>\n                  <CardHeader>{dict.form} {props.meta.label}</CardHeader>\n                  <List form>\n                    {items}\n                    {submit}\n                  </List>\n                </Card>\n              )\n            }\n            else {\n              return(<div></div>)\n            }\n          }\n  export default ActualForm;\n","import React from \"react\";\nimport { Button, Icon, Card, ListInput, List, BlockTitle} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport crypto from 'crypto-js';\nconst ActualList = (props) => {\n  var meta_schema =props.meta.meta_schema\n  if(props.meta && props.actuals){\n  var body = [<BlockTitle>{props.meta.label}</BlockTitle>]\n    var td = []\n    var actuals =  props.actuals\n    for (let i = 0; i < actuals.length; i++) {\n     var content = actuals[i].content\n     var td = []\n      for (let j= 0; j < content.length; j++) {\n        //console.log(content[j])\n          td.push(<ListInput key={crypto.lib.WordArray.random(32)} label={content[j].label} type=\"text\" defaultValue={content[j].value}/>)\n        \n        if( props.editable && content[j] && j == meta_schema.length - 1 && props.meta.id == content[j].metaId){\n          td.push(<Button color='gray' onClick={() => props.removeActual(actuals[i].uuid)}>\n          <Icon ios=\"f7:trash\" aurora=\"f7:trash\" md=\"material:trash\"></Icon>\n        </Button>)\n        }\n      }\n      body.push(<Card><List key={crypto.lib.WordArray.random(32)}>{td}</List></Card>)\n    }\n\n    \n\n\n  return(\n    <React.Fragment>\n      {body}\n    </React.Fragment>\n  )\n}\nelse {\n  return(<div></div>)\n}\n}\nexport default ActualList;","import React from \"react\";\nimport { Card, CardHeader, List, BlockTitle, ListItem, Fab, Icon,Preloader, Block} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ActualForm from \"../actuals/form\";\nimport ActualList from \"../actuals/list\";\nimport JSONPretty from 'react-json-pretty';\n\nconst MetaShow = (props) => {\n  if (props.meta){\n    return(\n      <React.Fragment>\n        <Card>\n        <CardHeader>{dict.title}: {props.meta.title}</CardHeader>\n        <List simple-list>\n          <ListItem className=''>\n          <JSONPretty id=\"json-pretty\" data={JSON.stringify(props.meta.meta_schema)}></JSONPretty></ListItem>\n        </List>\n        </Card>\n        <ActualList meta={props.meta} editable={true} actuals={props.meta.actuals} removeActual={props.removeActual} />\n        <ActualForm meta={props.meta} submit={props.submit} onChangeValue={props.handleChangeValue} />\n      </React.Fragment>\n    )\n  } else {\n    return(null)\n  }\n}\nexport default MetaShow;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon, Fab\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport MetaShow from \"../../containers/metas/show\"\n\nexport default class Layout extends Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.submit = this.submit.bind(this);\n    this.removeActual = this.removeActual.bind(this);\n\n    \n    this.state = {\n      meta: null,\n      metaId: null,\n      token: window.localStorage.getItem('token'),\n      fields: [],\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.getInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('metas', this.$f7route.params['metaId']);\n  }\n\n  getInstance() {\n    var meta = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (meta && klass === 'Meta') {\n      this.setState({\n        meta: meta,\n        metaId: meta.id \n      });\n    }\n  }\n\n  handleChangeValue(key, value) {\n    var fields = this.state.fields\n    if (fields.length > 0) {\n      for (let i = 0; i < fields.length; i++) {\n        if (fields[i].fid && fields[i].fid === key) {\n          let newState = Object.assign({}, this.state);\n          newState.fields[i] = { fid: key, value: value }\n          this.setState(newState);\n        } else {\n          this.setState({ fields: this.state.fields.concat({ fid: key, value: value }) });\n        }\n      }\n    } else {\n      this.setState({ fields: this.state.fields.concat({ fid: key, value: value }) });\n    }\n  }\n\n  removeActual(uuid){\n    MyActions.removeInstance('actuals', {uuid: uuid});\n  }\n\n  submit(){\n    var data = {meta_id: this.state.metaId, content: this.state.fields}\n    MyActions.setInstance('actuals', data, this.state.token);\n  }\n\n  fab() {\n    if (this.state.meta) {\n      return (\n        <Fab href={\"/metas/\" + this.state.meta.id + \"/edit\"} target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"lime\">\n          <Icon ios=\"f7:edit\" aurora=\"f7:edit\" md=\"material:edit\"></Icon>\n          <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n        </Fab>\n      )\n    }\n  }\n\n  render() {\n    const { meta } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.metas} backLink={dict.back} />\n        <BlockTitle></BlockTitle>\n        {this.fab()}\n        <MetaShow meta={meta} removeActual={this.removeActual} handleChangeValue={this.handleChangeValue} submit={this.submit}/>\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem} from 'framework7-react';\nimport crypto from 'crypto-js';\n\nconst MetaList = (props) => {\n\n  if (props.metas) {\n    return (\n      <List mediaList>\n        {props.metas.map((meta) =>\n          <ListItem\n            key={crypto.lib.WordArray.random(32)}\n            link={\"/metas/\" + meta.id}\n            ignoreCache={true}\n            title={meta.title}\n            after=\"\"\n            subtitle=\"\"\n            text=\"\"\n            ></ListItem>\n        )}\n      </List>\n    )} else {\n      return (<ul></ul>)\n    }\n  }\n  export default MetaList;\n","import React from \"react\";\nimport { Page, Navbar, List, BlockTitle, ListItem, Fab, Icon,Preloader, Block} from 'framework7-react';\nimport MetaList from \"./list\"\nimport { dict} from '../../Dict';\n\nconst MetaIndex = (props) => {\n  return(\n    <Page>\n      <Navbar title={dict.metas} backLink={dict.back} >\n      </Navbar>\n      <BlockTitle>{dict.list}</BlockTitle>\n      <Fab href=\"/metas/new\" target=\"#main-view\"  position=\"left-bottom\" slot=\"fixed\" color=\"deeporange\">\n        <Icon ios=\"f7:add\" aurora=\"f7:add\" md=\"material:add\"></Icon>\n        <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n      </Fab>\n      <MetaList metas={props.metas}/>\n    </Page>\n  )\n}\nexport default MetaIndex;\n","import React from \"react\"\nimport { Page,Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport MetaIndex from \"../../containers/metas/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict} from '../../Dict';\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class Layout extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.state = {\n      metas: null,\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    MyActions.getList('metas', this.state.page);\n  }\n\n  getList() {\n    var metas = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (metas  && klass === 'Meta'){\n      this.setState({\n        metas: metas,\n      });\n    }\n  }\n\n  render() {\n    const {metas} = this.state;\n    return(<MetaIndex metas={metas}/>)\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, ListInput, Card, CardFooter, Button, Link } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\n\n\nconst MetaForm = (props) => {\n  return (\n    <Card>\n      <List form>\n        <ListInput\n          label={dict.title}\n          type=\"text\"\n          placeholder='...'\n          defaultValue={props.meta.title}\n          onInput={(e) => {\n            props.handleChange({ title: e.target.value })\n          }}\n        />\n        <ListInput\n          label={dict.label}\n          type=\"text\"\n          placeholder='...'\n          defaultValue={props.meta.label}\n          onInput={(e) => {\n            props.handleChange({ label: e.target.value })\n          }}\n        />\n        <ListInput\n          label=\"Schema\"\n          type=\"text\"\n          inputStyle={{direction: 'ltr'}}\n          defaultValue={JSON.stringify(props.meta.meta_schema)}\n          placeholder=\"JSON\"\n          onInput={(e) => {\n            props.handleChange({ metaSchema: e.target.value })\n          }}\n        ></ListInput>\n\n\n      </List>\n      <CardFooter>\n        <Link></Link>\n        <Button className=\"col\" fill onClick={props.submit}>{dict.submit}</Button>\n      </CardFooter>\n    </Card>\n  )\n}\nexport default MetaForm;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport MetaForm from \"../../containers/metas/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class MetaCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      meta: {},\n      metaSchema: null,\n      title: null,\n      label: null,\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  submit(){\n    var data = {title: this.state.title, label: this.state.label,  meta_schema: this.state.metaSchema}\n    MyActions.setInstance('metas', data, this.state.token);\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/metas/');\n  }\n\n\n\n  render() {\n    const {meta} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.meta_form} backLink={dict.back} />\n        <BlockTitle>{dict.meta_form}</BlockTitle>\n        <MetaForm meta={meta} submit={this.submit} editing={true} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport MetaForm from \"../../containers/metas/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class DocumentUpdate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n\n\n    this.state = {\n      meta : {},\n      title: null,\n      metaSchema: null,\n      id: null,\n      label: null,\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n\n  }\n\n\n  submit(){\n    var data = {id:this.state.id, title: this.state.title, label: this.state.label, meta_schema: this.state.metaSchema}\n    MyActions.updateInstance('metas', data);\n  }\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    if (this.$f7route.params['metaId']) {\n      MyActions.getInstance('metas', this.$f7route.params['metaId']);\n    }\n  }\n\n\n  getInstance(){\n    var meta = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    console.log(meta);\n    if (meta && klass === 'Meta'){\n      this.setState({\n        title: meta.title,\n        id: meta.id,\n        meta: meta,\n        metaSchema: meta.metaSchema,\n        label: meta.label\n      });\n    }\n  }\n\n  handleChangeValue(obj) {\n    console.log(obj);\n    this.setState(obj);\n  }\n\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/metas/');\n  }\n\n\n  render() {\n        const {meta} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.meta_form} backLink={dict.back} />\n        <BlockTitle>{dict.meta_form}</BlockTitle>\n        <MetaForm meta={meta} submit={this.submit} editing={true} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { Actions, ActionsLabel, ActionsGroup, ActionsButton, Icon, Button, Sheet, Toolbar, Link, PageContent, Block} from 'framework7-react';\nimport { dict} from '../../Dict';\n\n\nconst InteractionMenu = (props) => {\n  if (props.model){\n    return(\n      <React.Fragment>\n\n      <Actions id={\"actions-two-groups-\"+props.model.id}>\n        <ActionsGroup>\n          <ActionsLabel>{dict.social_acts}</ActionsLabel>\n          <ActionsButton onClick={() => props.interaction('Bookmark', props.model.id, props.klass, props.sourceType, props.sourceId)}><i className=\"va ml-5 fa fa-bookmark\"></i>{dict.bookmark} ({props.model.bookmarks})</ActionsButton>\n          <ActionsButton onClick={() => props.interaction('Like', props.model.id, props.klass, props.sourceType, props.sourceId)}><i className=\"va ml-5 fa fa-heart\"></i>{dict.like} ({props.model.likes})</ActionsButton>\n          <ActionsButton onClick={() => props.interaction('Follow', props.model.id, props.klass, props.sourceType, props.sourceId)}><i className=\"va ml-5 fa fa-link\"></i>{dict.follow} ({props.model.follows})</ActionsButton>\n        </ActionsGroup>\n        <ActionsGroup>\n          <ActionsButton color=\"red\">{dict.cancel}</ActionsButton>\n        </ActionsGroup>\n      </Actions>\n      \n      <Button tooltip={dict.social_acts} className=\"col\"  href={false} actionsOpen={\"#actions-two-groups-\"+props.model.id}><i className=\"va fa fa-users\"></i></Button>\n      </React.Fragment>\n    )\n  } else {\n    return(null)\n  }\n}\nexport default InteractionMenu;\n","import React from \"react\";\nimport { Actions, ActionsLabel, ActionsGroup, ActionsButton, Icon, Button, Sheet, Toolbar, Link, PageContent, Block, ListInput, List, Row } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\nconst ShareMenu = (props) => {\n  if (props.model) {\n    if (props.channels) {\n      var options = []\n      for (let i = 0; i < props.channels.length; i++) {\n        options.push(\n          <option value={props.channels[i].id}>\n            {props.channels[i].title}\n          </option>\n        )\n      }\n    }\n    return (\n      <React.Fragment>\n        <Sheet className=\"demo-sheet\" opened={props.sheetOpened} onSheetClosed={() => { props.handleChange({ sheetOpened: false }) }}>\n          <Toolbar>\n            <div className=\"left\"></div>\n            <div className=\"right\">\n              <Link sheetClose>{dict.close}</Link>\n            </div>\n          </Toolbar>\n          {/*  Scrollable sheet content */}\n          <PageContent>\n\n            <List>\n              <ListInput\n                label={dict.channel}\n                type=\"select\"\n                onChange={(e) => {\n                  props.handleChange({ selectedChannel: e.target.value })\n                }\n                }\n              >\n                {options}\n              </ListInput>\n            </List>\n            <Block strong>\n              <Row tag=\"p\">\n                <Button className=\"col\" fill onClick={props.submit}>{dict.submit}</Button>\n              </Row>\n            </Block>\n          </PageContent>\n        </Sheet>\n\n        <Button className=\"col\" href={false} sheetOpen=\".demo-sheet\"><i class=\"va fa fa-retweet\"></i></Button>\n      </React.Fragment>\n    )\n  } else {\n    return (null)\n  }\n}\nexport default ShareMenu;\n","import React from \"react\";\nimport { List, ListInput, Chip, Block, Link, Button, Card, CardHeader, CardFooter } from 'framework7-react';\nimport { dict } from '../../Dict';\n\n\n\nconst CommentForm = (props) => {\n  function replyTo(){\n    if(props.replyTo){\n      var content = ''\n      props.comments.map((cm) => { if(cm.id === props.replyTo){content = cm.content}})\n      return(<Chip text={dict.in_reply_to + ': '+ content.substring(0,20)} deleteable onClick={ props.removeReply } />)\n    }\n    \n  }\n  return (\n    <Card>\n      <CardHeader>{dict.comment_form} {replyTo()}</CardHeader>\n     <List >\n        <ListInput\n          label={dict.comment}\n          inputId={\"cm-form-\"+props.rnd}\n          type=\"textarea\"\n          placeholder='...'\n          maxlength='300'\n          resizable\n          clearButton={true}\n          onInput={(e) => {\n            props.handleChange({ commentContent: e.target.value })\n          }}\n        />\n        </List>\n      <CardFooter>\n        <Link></Link>\n        <Link className=\"btn-notice\"></Link>\n        <Button className=\"col btn\" fill onClick={props.submit}>{dict.submit}</Button>\n      </CardFooter>\n    </Card>\n  )\n}\nexport default CommentForm;\n","import React from \"react\";\nimport { List, ListItem, BlockTitle, Row, Link, Col } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport 'moment/locale/fa';\n\nconst CommentList = (props) => {\n    var items = []\n    function editLink(comment) {\n        var result = []\n        if (comment.editable) {\n            result.push(\n                <Link onClick={() => props.deleteCommentConfirm(comment.id)}>\n                    <i className=\"va ml-5 fa fa-trash\"></i>\n                </Link>\n            )\n        }\n        result.push(\n            <Link onClick={() => props.replyToComment(comment.id)}>\n                <i className=\"va ml-5 fa fa-reply\"></i>\n            </Link>\n        )\n        return (result)\n    }\n\n    function title(comment){\n        var result = [<span>{comment.profile.fullname}: </span>]\n        if(comment.reply_to){\n            result.push(<span className='fs-10 f-color-gray'>{dict.in_reply_to} {comment.reply_to}</span>)\n        }\n        return(result)\n    }\n    if (props.comments) {\n\n        for (let i = 0; i < props.comments.length; i++) {\n            var date = new Date(new window.ODate(props.comments[i].created_at))\n            var time =\n                <React.Fragment>\n                    {editLink(props.comments[i])}\n                    <Moment locale=\"fa\" fromNow ago>{date}</Moment>\n                    {dict.ago}\n                </React.Fragment>\n            items.push(\n                <ListItem\n                    key={'comment' + props.comments[i].id}\n                    className='fs-10'\n                    id={'cm-'+props.comments[i].id}\n                    text={time}\n                    title={title(props.comments[i])}\n                    subtitle={props.comments[i].content}\n                >\n                    <img slot=\"media\" src={props.comments[i].profile.avatar} width=\"44\" height=\"44\" />\n                </ListItem>\n\n\n\n            )\n        }\n\n        return (\n            <React.Fragment>\n                <BlockTitle>{dict.comments}</BlockTitle>\n                <List mediaList inset>\n                    {items}\n                </List>\n                <Row noGap>\n                    <Col></Col>\n                    <Col className='center'>\n                        <a className=\"gray-color\" onClick={() => props.loadMore()}>\n                            {dict.more}\n                        </a>\n                    </Col>\n                    <Col></Col>\n                </Row>\n                <BlockTitle></BlockTitle>\n            </React.Fragment>\n        )\n    }\n    else {\n        return (<BlockTitle></BlockTitle>)\n    }\n}\nexport default CommentList;","import React from \"react\";\nimport { List, BlockTitle, ListItem, Block, Row, Col, Button } from 'framework7-react';\nimport { stateToHTML } from \"draft-js-export-html\";\nimport { EditorState, convertFromRaw } from \"draft-js\";\nimport { Editor } from 'react-draft-wysiwyg';\nimport { dict } from '../../Dict';\nimport InteractionMenu from \"../interactions/menu\"\nimport ShareMenu from \"../shares/menu\"\nimport CommentForm from \"../comments/form\"\nimport CommentList from \"../comments/list\"\nimport { post } from \"jquery\";\n\nconst PostShow = (props) => {\n  if (props.post && props.post.draft) {\n    const contentState = convertFromRaw(props.post.draft);\n    const editorState = EditorState.createWithContent(contentState);\n  /* let options = {\n      entityStyleFn: (entity) => {\n        const entityType = entity.get('type').toLowerCase();\n        if (entityType === 'link') {\n          const data = entity.getData();\n          return {\n            element: 'a',\n            attributes: {\n              href: data.url,\n              target:'_blank',\n              class: 'external'\n            },\n            style: {\n              // Put styles here...\n            },\n          };\n        } \n      }\n    };*/\n    let options = {}\n    let html = stateToHTML(contentState, options);\n\n    function content() {\n      if (props.post.content.length > 1) {\n        return (\n          <React.Fragment>\n            <BlockTitle>{dict.content}</BlockTitle>\n            <Editor editorState={editorState}\n              toolbar={{ options: [] }}\n              readOnly={true}\n            />\n          </React.Fragment>\n        )\n      }\n\n    }\n\n    function rated(i) {\n      if (props.post.rating >= i) {\n        return (<i class=\"fa fa-star\" aria-hidden=\"true\"></i>)\n      } else {\n        return (<i class=\"fa fa-star-o\" aria-hidden=\"true\"></i>)\n      }\n    }\n\n    function rating() {\n      return (\n        <Block strong>\n          <a onClick={() => props.rating(1)}>{rated(1)}</a>\n          <a onClick={() => props.rating(2)}>{rated(2)}</a>\n          <a onClick={() => props.rating(3)}>{rated(3)}</a>\n          <a onClick={() => props.rating(4)}>{rated(4)}</a>\n          <a onClick={() => props.rating(5)}>{rated(5)}</a>\n          <span className='fs-11 mr-2'>({props.post.rated})</span>\n        </Block>\n      )\n    }\n\n    function deleteable() {\n      if (props.deletable) {\n        return (\n          <Col width=\"25\" tabletWidth='10' className='ml-5'>\n            <Button fill color=\"red\" onClick={() => props.deletePostConfirm()}><i class=\"fa fa-trash-o\" aria-hidden=\"true\"></i></Button>\n          </Col>)\n      }\n    }\n\n    function createMarkup() {\n      return {\n         __html: html    };\n   }; \n  \n    return (\n      <React.Fragment>\n        <Block>\n          <Row>\n            <Col width='50' tabletWidth='60'></Col>\n            {deleteable()}\n            <Col width=\"25\" tabletWidth='15' className='ml-5'>\n              <Button tooltip={dict.share} fill><ShareMenu model={props.post} submit={props.submit} channels={props.channels} klass='Post' sheetOpened={props.sheetOpened} handleChange={props.handleChange} klass='Channel' interaction={props.interaction} /></Button>\n            </Col>\n            <Col width=\"25\" tabletWidth='15'>\n              <Button  tooltip={dict.social_acts} fill><InteractionMenu model={props.post} klass='Post' interaction={props.interaction} /></Button>\n            </Col>\n          </Row>\n        </Block>\n        <BlockTitle>{dict.title}</BlockTitle>\n        <List simple-list>\n          <ListItem>{props.post.title}</ListItem>\n        </List>\n        <Block strong>\n\n      {content()}\n        </Block>\n\n        {rating()}\n\n        <CommentForm\n          model={props.post} submit={props.submitComment}\n          handleChange={props.handleChange} replyTo={props.replyTo}\n          comments={props.comments} removeReply={props.removeReply}\n          rnd={props.rnd}\n        />\n        <CommentList\n          comments={props.comments} deleteCommentConfirm={props.deleteCommentConfirm}\n          replyToComment={props.replyToComment}\n        />\n      </React.Fragment>\n    )\n  } else {\n    return (null)\n  }\n}\nexport default PostShow;\n","/*\n\tThe MIT License (MIT)\n\n\tCopyright (c) 2016 Meetecho\n\n\tPermission is hereby granted, free of charge, to any person obtaining\n\ta copy of this software and associated documentation files (the \"Software\"),\n\tto deal in the Software without restriction, including without limitation\n\tthe rights to use, copy, modify, merge, publish, distribute, sublicense,\n\tand/or sell copies of the Software, and to permit persons to whom the\n\tSoftware is furnished to do so, subject to the following conditions:\n\n\tThe above copyright notice and this permission notice shall be included\n\tin all copies or substantial portions of the Software.\n\n\tTHE SOFTWARE IS PROVIDED \"AS IS\", WITHOUT WARRANTY OF ANY KIND, EXPRESS\n\tOR IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,\n\tFITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL\n\tTHE AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR\n\tOTHER LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE,\n\tARISING FROM, OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR\n\tOTHER DEALINGS IN THE SOFTWARE.\n */\n\n// List of sessions\nimport jQuery from 'jquery';\nimport adapter from 'webrtc-adapter';\n\nconst RTCRtpTransceiver = window.RTCRtpTransceiver;\nJanus.sessions = {};\n\nJanus.isExtensionEnabled = function() {\n\tif(navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {\n\t\t// No need for the extension, getDisplayMedia is supported\n\t\treturn true;\n\t}\n\tif(window.navigator.userAgent.match('Chrome')) {\n\t\tvar chromever = parseInt(window.navigator.userAgent.match(/Chrome\\/(.*) /)[1], 10);\n\t\tvar maxver = 33;\n\t\tif(window.navigator.userAgent.match('Linux'))\n\t\t\tmaxver = 35;\t// \"known\" crash in chrome 34 and 35 on linux\n\t\tif(chromever >= 26 && chromever <= maxver) {\n\t\t\t// Older versions of Chrome don't support this extension-based approach, so lie\n\t\t\treturn true;\n\t\t}\n\t\treturn Janus.extension.isInstalled();\n\t} else {\n\t\t// Firefox of others, no need for the extension (but this doesn't mean it will work)\n\t\treturn true;\n\t}\n};\n\nvar defaultExtension = {\n\t// Screensharing Chrome Extension ID\n\textensionId: 'hapfgfdkleiggjjpfpenajgdnfckjpaj',\n\tisInstalled: function() { return document.querySelector('#janus-extension-installed') !== null; },\n\tgetScreen: function (callback) {\n\t\tvar pending = window.setTimeout(function () {\n\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\terror.name = 'The required Chrome extension is not installed: click <a href=\"#\">here</a> to install it. (NOTE: this will need you to refresh the page)';\n\t\t\treturn callback(error);\n\t\t}, 1000);\n\t\tthis.cache[pending] = callback;\n\t\twindow.postMessage({ type: 'janusGetScreen', id: pending }, '*');\n\t},\n\tinit: function () {\n\t\tvar cache = {};\n\t\tthis.cache = cache;\n\t\t// Wait for events from the Chrome Extension\n\t\twindow.addEventListener('message', function (event) {\n\t\t\tif(event.origin != window.location.origin)\n\t\t\t\treturn;\n\t\t\tif(event.data.type == 'janusGotScreen' && cache[event.data.id]) {\n\t\t\t\tvar callback = cache[event.data.id];\n\t\t\t\tdelete cache[event.data.id];\n\n\t\t\t\tif (event.data.sourceId === '') {\n\t\t\t\t\t// user canceled\n\t\t\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\t\t\terror.name = 'You cancelled the request for permission, giving up...';\n\t\t\t\t\tcallback(error);\n\t\t\t\t} else {\n\t\t\t\t\tcallback(null, event.data.sourceId);\n\t\t\t\t}\n\t\t\t} else if (event.data.type == 'janusGetScreenPending') {\n\t\t\t\tconsole.log('clearing ', event.data.id);\n\t\t\t\twindow.clearTimeout(event.data.id);\n\t\t\t}\n\t\t});\n\t}\n};\n\nJanus.useDefaultDependencies = function (deps) {\n\tvar f = (deps && deps.fetch) || fetch;\n\tvar p = (deps && deps.Promise) || Promise;\n\tvar socketCls = (deps && deps.WebSocket) || WebSocket;\n\n\treturn {\n\t\tnewWebSocket: function(server, proto) { return new socketCls(server, proto); },\n\t\textension: (deps && deps.extension) || defaultExtension,\n\t\tisArray: function(arr) { return Array.isArray(arr); },\n\t\twebRTCAdapter: (deps && deps.adapter) || adapter,\n\t\thttpAPICall: function(url, options) {\n\t\t\tvar fetchOptions = {\n\t\t\t\tmethod: options.verb,\n\t\t\t\theaders: {\n\t\t\t\t\t'Accept': 'application/json, text/plain, */*'\n\t\t\t\t},\n\t\t\t\tcache: 'no-cache'\n\t\t\t};\n\t\t\tif(options.verb === \"POST\") {\n\t\t\t\tfetchOptions.headers['Content-Type'] = 'application/json';\n\t\t\t}\n\t\t\tif(options.withCredentials !== undefined) {\n\t\t\t\tfetchOptions.credentials = options.withCredentials === true ? 'include' : (options.withCredentials ? options.withCredentials : 'omit');\n\t\t\t}\n\t\t\tif(options.body) {\n\t\t\t\tfetchOptions.body = JSON.stringify(options.body);\n\t\t\t}\n\n\t\t\tvar fetching = f(url, fetchOptions).catch(function(error) {\n\t\t\t\treturn p.reject({message: 'Probably a network error, is the server down?', error: error});\n\t\t\t});\n\n\t\t\t/*\n\t\t\t * fetch() does not natively support timeouts.\n\t\t\t * Work around this by starting a timeout manually, and racing it agains the fetch() to see which thing resolves first.\n\t\t\t */\n\n\t\t\tif(options.timeout) {\n\t\t\t\tvar timeout = new p(function(resolve, reject) {\n\t\t\t\t\tvar timerId = setTimeout(function() {\n\t\t\t\t\t\tclearTimeout(timerId);\n\t\t\t\t\t\treturn reject({message: 'Request timed out', timeout: options.timeout});\n\t\t\t\t\t}, options.timeout);\n\t\t\t\t});\n\t\t\t\tfetching = p.race([fetching, timeout]);\n\t\t\t}\n\n\t\t\tfetching.then(function(response) {\n\t\t\t\tif(response.ok) {\n\t\t\t\t\tif(typeof(options.success) === typeof(Janus.noop)) {\n\t\t\t\t\t\treturn response.json().then(function(parsed) {\n\t\t\t\t\t\t\toptions.success(parsed);\n\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\treturn p.reject({message: 'Failed to parse response body', error: error, response: response});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\telse {\n\t\t\t\t\treturn p.reject({message: 'API call failed', response: response});\n\t\t\t\t}\n\t\t\t}).catch(function(error) {\n\t\t\t\tif(typeof(options.error) === typeof(Janus.noop)) {\n\t\t\t\t\toptions.error(error.message || '<< internal error >>', error);\n\t\t\t\t}\n\t\t\t});\n\n\t\t\treturn fetching;\n\t\t}\n\t}\n};\n\nJanus.useOldDependencies = function (deps) {\n\tvar jq = (deps && deps.jQuery) || jQuery;\n\tvar socketCls = (deps && deps.WebSocket) || WebSocket;\n\treturn {\n\t\tnewWebSocket: function(server, proto) { return new socketCls(server, proto); },\n\t\tisArray: function(arr) { return jq.isArray(arr); },\n\t\textension: (deps && deps.extension) || defaultExtension,\n\t\twebRTCAdapter: (deps && deps.adapter) || adapter,\n\t\thttpAPICall: function(url, options) {\n\t\t\tvar payload = options.body !== undefined ? {\n\t\t\t\tcontentType: 'application/json',\n\t\t\t\tdata: JSON.stringify(options.body)\n\t\t\t} : {};\n\t\t\tvar credentials = options.withCredentials !== undefined ? {xhrFields: {withCredentials: options.withCredentials}} : {};\n\n\t\t\treturn jq.ajax(jq.extend(payload, credentials, {\n\t\t\t\turl: url,\n\t\t\t\ttype: options.verb,\n\t\t\t\tcache: false,\n\t\t\t\tdataType: 'json',\n\t\t\t\tasync: options.async,\n\t\t\t\ttimeout: options.timeout,\n\t\t\t\tsuccess: function(result) {\n\t\t\t\t\tif(typeof(options.success) === typeof(Janus.noop)) {\n\t\t\t\t\t\toptions.success(result);\n\t\t\t\t\t}\n\t\t\t\t},\n\t\t\t\terror: function(xhr, status, err) {\n\t\t\t\t\tif(typeof(options.error) === typeof(Janus.noop)) {\n\t\t\t\t\t\toptions.error(status, err);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}));\n\t\t}\n\t};\n};\n\nJanus.noop = function() {};\n\nJanus.dataChanDefaultLabel = \"JanusDataChannel\";\n\n// Note: in the future we may want to change this, e.g., as was\n// attempted in https://github.com/meetecho/janus-gateway/issues/1670\nJanus.endOfCandidates = null;\n\n// Initialization\nJanus.init = function(options) {\n\toptions = options || {};\n\toptions.callback = (typeof options.callback == \"function\") ? options.callback : Janus.noop;\n\tif(Janus.initDone) {\n\t\t// Already initialized\n\t\toptions.callback();\n\t} else {\n\t\tif(typeof console == \"undefined\" || typeof console.log == \"undefined\") {\n\t\t\tconsole = { log: function() {} };\n\t\t}\n\t\t// Console logging (all debugging disabled by default)\n\t\tJanus.trace = Janus.noop;\n\t\tJanus.debug = Janus.noop;\n\t\tJanus.vdebug = Janus.noop;\n\t\tJanus.log = Janus.noop;\n\t\tJanus.warn = Janus.noop;\n\t\tJanus.error = Janus.noop;\n\t\tif(options.debug === true || options.debug === \"all\") {\n\t\t\t// Enable all debugging levels\n\t\t\tJanus.trace = console.trace.bind(console);\n\t\t\tJanus.debug = console.debug.bind(console);\n\t\t\tJanus.vdebug = console.debug.bind(console);\n\t\t\tJanus.log = console.log.bind(console);\n\t\t\tJanus.warn = console.warn.bind(console);\n\t\t\tJanus.error = console.error.bind(console);\n\t\t} else if(Array.isArray(options.debug)) {\n\t\t\tfor(var d of options.debug) {\n\t\t\t\tswitch(d) {\n\t\t\t\t\tcase \"trace\":\n\t\t\t\t\t\tJanus.trace = console.trace.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"debug\":\n\t\t\t\t\t\tJanus.debug = console.debug.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"vdebug\":\n\t\t\t\t\t\tJanus.vdebug = console.debug.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"log\":\n\t\t\t\t\t\tJanus.log = console.log.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"warn\":\n\t\t\t\t\t\tJanus.warn = console.warn.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tcase \"error\":\n\t\t\t\t\t\tJanus.error = console.error.bind(console);\n\t\t\t\t\t\tbreak;\n\t\t\t\t\tdefault:\n\t\t\t\t\t\tconsole.error(\"Unknown debugging option '\" + d + \"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')\");\n\t\t\t\t\t\tbreak;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tJanus.log(\"Initializing library\");\n\n\t\tvar usedDependencies = options.dependencies || Janus.useDefaultDependencies();\n\t\tJanus.isArray = usedDependencies.isArray;\n\t\tJanus.webRTCAdapter = usedDependencies.webRTCAdapter;\n\t\tJanus.httpAPICall = usedDependencies.httpAPICall;\n\t\tJanus.newWebSocket = usedDependencies.newWebSocket;\n\t\tJanus.extension = usedDependencies.extension;\n\t\tJanus.extension.init();\n\n\t\t// Helper method to enumerate devices\n\t\tJanus.listDevices = function(callback, config) {\n\t\t\tcallback = (typeof callback == \"function\") ? callback : Janus.noop;\n\t\t\tif (config == null) config = { audio: true, video: true };\n\t\t\tif(Janus.isGetUserMediaAvailable()) {\n\t\t\t\tnavigator.mediaDevices.getUserMedia(config)\n\t\t\t\t.then(function(stream) {\n\t\t\t\t\tnavigator.mediaDevices.enumerateDevices().then(function(devices) {\n\t\t\t\t\t\tJanus.debug(devices);\n\t\t\t\t\t\tcallback(devices);\n\t\t\t\t\t\t// Get rid of the now useless stream\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tvar tracks = stream.getTracks();\n\t\t\t\t\t\t\tfor(var mst of tracks) {\n\t\t\t\t\t\t\t\tif(mst)\n\t\t\t\t\t\t\t\t\tmst.stop();\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t} catch(e) {}\n\t\t\t\t\t});\n\t\t\t\t})\n\t\t\t\t.catch(function(err) {\n\t\t\t\t\tJanus.error(err);\n\t\t\t\t\tcallback([]);\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tJanus.warn(\"navigator.mediaDevices unavailable\");\n\t\t\t\tcallback([]);\n\t\t\t}\n\t\t};\n\t\t// Helper methods to attach/reattach a stream to a video element (previously part of adapter.js)\n\t\tJanus.attachMediaStream = function(element, stream) {\n\t\t\ttry {\n\t\t\t\telement.srcObject = stream;\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\telement.src = URL.createObjectURL(stream);\n\t\t\t\t} catch (e) {\n\t\t\t\t\tJanus.error(\"Error attaching stream to element\");\n\t\t\t\t\tconsole.log(\"Error attaching stream to element\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\tJanus.reattachMediaStream = function(to, from) {\n\t\t\ttry {\n\t\t\t\tto.srcObject = from.srcObject;\n\t\t\t} catch (e) {\n\t\t\t\ttry {\n\t\t\t\t\tto.src = from.src;\n\t\t\t\t} catch (e) {\n\t\t\t\t\tJanus.error(\"Error reattaching stream to element\");\n\t\t\t\t}\n\t\t\t}\n\t\t};\n\t\t// Detect tab close: make sure we don't loose existing onbeforeunload handlers\n\t\t// (note: for iOS we need to subscribe to a different event, 'pagehide', see\n\t\t// https://gist.github.com/thehunmonkgroup/6bee8941a49b86be31a787fe8f4b8cfe)\n\t\tvar iOS = ['iPad', 'iPhone', 'iPod'].indexOf(navigator.platform) >= 0;\n\t\tvar eventName = iOS ? 'pagehide' : 'beforeunload';\n\t\tvar oldOBF = window[\"on\" + eventName];\n\t\twindow.addEventListener(eventName, function(event) {\n\t\t\tJanus.log(\"Closing window\");\n\t\t\tfor(var s in Janus.sessions) {\n\t\t\t\tif(Janus.sessions[s] && Janus.sessions[s].destroyOnUnload) {\n\t\t\t\t\tJanus.log(\"Destroying session \" + s);\n\t\t\t\t\tJanus.sessions[s].destroy({unload: true, notifyDestroyed: false});\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(oldOBF && typeof oldOBF == \"function\") {\n\t\t\t\toldOBF();\n\t\t\t}\n\t\t});\n\t\t// If this is a Safari Technology Preview, check if VP8 is supported\n\t\tJanus.safariVp8 = false;\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'safari' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 605) {\n\t\t\t// Let's see if RTCRtpSender.getCapabilities() is there\n\t\t\tif(RTCRtpSender && RTCRtpSender.getCapabilities && RTCRtpSender.getCapabilities(\"video\") &&\n\t\t\t\t\tRTCRtpSender.getCapabilities(\"video\").codecs && RTCRtpSender.getCapabilities(\"video\").codecs.length) {\n\t\t\t\tfor(var codec of RTCRtpSender.getCapabilities(\"video\").codecs) {\n\t\t\t\t\tif(codec && codec.mimeType && codec.mimeType.toLowerCase() === \"video/vp8\") {\n\t\t\t\t\t\tJanus.safariVp8 = true;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(Janus.safariVp8) {\n\t\t\t\t\tJanus.log(\"This version of Safari supports VP8\");\n\t\t\t\t} else {\n\t\t\t\t\tJanus.warn(\"This version of Safari does NOT support VP8: if you're using a Technology Preview, \" +\n\t\t\t\t\t\t\"try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We do it in a very ugly way, as there's no alternative...\n\t\t\t\t// We create a PeerConnection to see if VP8 is in an offer\n\t\t\t\tvar testpc = new RTCPeerConnection({});\n\t\t\t\ttestpc.createOffer({offerToReceiveVideo: true}).then(function(offer) {\n\t\t\t\t\tJanus.safariVp8 = offer.sdp.indexOf(\"VP8\") !== -1;\n\t\t\t\t\tif(Janus.safariVp8) {\n\t\t\t\t\t\tJanus.log(\"This version of Safari supports VP8\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.warn(\"This version of Safari does NOT support VP8: if you're using a Technology Preview, \" +\n\t\t\t\t\t\t\t\"try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu\");\n\t\t\t\t\t}\n\t\t\t\t\ttestpc.close();\n\t\t\t\t\ttestpc = null;\n\t\t\t\t});\n\t\t\t}\n\t\t}\n\t\t// Check if this browser supports Unified Plan and transceivers\n\t\t// Based on https://codepen.io/anon/pen/ZqLwWV?editors=0010\n\t\tJanus.unifiedPlan = false;\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'firefox' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version >= 59) {\n\t\t\t// Firefox definitely does, starting from version 59\n\t\t\tJanus.unifiedPlan = true;\n\t\t} else if(Janus.webRTCAdapter.browserDetails.browser === 'chrome' &&\n\t\t\t\tJanus.webRTCAdapter.browserDetails.version < 72) {\n\t\t\t// Chrome does, but it's only usable from version 72 on\n\t\t\tJanus.unifiedPlan = false;\n\t\t} else if(!window.RTCRtpTransceiver || !('currentDirection' in RTCRtpTransceiver.prototype)) {\n\t\t\t// Safari supports addTransceiver() but not Unified Plan when\n\t\t\t// currentDirection is not defined (see codepen above).\n\t\t\tJanus.unifiedPlan = false;\n\t\t} else {\n\t\t\t// Check if addTransceiver() throws an exception\n\t\t\tvar tempPc = new RTCPeerConnection();\n\t\t\ttry {\n\t\t\t\ttempPc.addTransceiver('audio');\n\t\t\t\tJanus.unifiedPlan = true;\n\t\t\t} catch (e) {}\n\t\t\ttempPc.close();\n\t\t}\n\t\tJanus.initDone = true;\n\t\toptions.callback();\n\t}\n};\n\n// Helper method to check whether WebRTC is supported by this browser\nJanus.isWebrtcSupported = function() {\n\treturn !!window.RTCPeerConnection;\n};\n// Helper method to check whether devices can be accessed by this browser (e.g., not possible via plain HTTP)\nJanus.isGetUserMediaAvailable = function() {\n\treturn navigator.mediaDevices && navigator.mediaDevices.getUserMedia;\n};\n\n// Helper method to create random identifiers (e.g., transaction)\nJanus.randomString = function(len) {\n\tvar charSet = 'ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789';\n\tvar randomString = '';\n\tfor (var i = 0; i < len; i++) {\n\t\tvar randomPoz = Math.floor(Math.random() * charSet.length);\n\t\trandomString += charSet.substring(randomPoz,randomPoz+1);\n\t}\n\treturn randomString;\n};\n\nfunction Janus(gatewayCallbacks) {\n\tgatewayCallbacks = gatewayCallbacks || {};\n\tgatewayCallbacks.success = (typeof gatewayCallbacks.success == \"function\") ? gatewayCallbacks.success : Janus.noop;\n\tgatewayCallbacks.error = (typeof gatewayCallbacks.error == \"function\") ? gatewayCallbacks.error : Janus.noop;\n\tgatewayCallbacks.destroyed = (typeof gatewayCallbacks.destroyed == \"function\") ? gatewayCallbacks.destroyed : Janus.noop;\n\tif(!Janus.initDone) {\n\t\tgatewayCallbacks.error(\"Library not initialized\");\n\t\treturn {};\n\t}\n\tif(!Janus.isWebrtcSupported()) {\n\t\tgatewayCallbacks.error(\"WebRTC not supported by this browser\");\n\t\treturn {};\n\t}\n\tJanus.log(\"Library initialized: \" + Janus.initDone);\n\tif(!gatewayCallbacks.server) {\n\t\tgatewayCallbacks.error(\"Invalid server url\");\n\t\treturn {};\n\t}\n\tvar websockets = false;\n\tvar ws = null;\n\tvar wsHandlers = {};\n\tvar wsKeepaliveTimeoutId = null;\n\tvar servers = null;\n\tvar serversIndex = 0;\n\tvar server = gatewayCallbacks.server;\n\tif(Janus.isArray(server)) {\n\t\tJanus.log(\"Multiple servers provided (\" + server.length + \"), will use the first that works\");\n\t\tserver = null;\n\t\tservers = gatewayCallbacks.server;\n\t\tJanus.debug(servers);\n\t} else {\n\t\tif(server.indexOf(\"ws\") === 0) {\n\t\t\twebsockets = true;\n\t\t\tJanus.log(\"Using WebSockets to contact Janus: \" + server);\n\t\t} else {\n\t\t\twebsockets = false;\n\t\t\tJanus.log(\"Using REST API to contact Janus: \" + server);\n\t\t}\n\t}\n\tvar iceServers = gatewayCallbacks.iceServers || [{urls: \"stun:stun.l.google.com:19302\"}];\n\tvar iceTransportPolicy = gatewayCallbacks.iceTransportPolicy;\n\tvar bundlePolicy = gatewayCallbacks.bundlePolicy;\n\t// Whether IPv6 candidates should be gathered\n\tvar ipv6Support = (gatewayCallbacks.ipv6 === true);\n\t// Whether we should enable the withCredentials flag for XHR requests\n\tvar withCredentials = false;\n\tif(gatewayCallbacks.withCredentials !== undefined && gatewayCallbacks.withCredentials !== null)\n\t\twithCredentials = gatewayCallbacks.withCredentials === true;\n\t// Optional max events\n\tvar maxev = 10;\n\tif(gatewayCallbacks.max_poll_events !== undefined && gatewayCallbacks.max_poll_events !== null)\n\t\tmaxev = gatewayCallbacks.max_poll_events;\n\tif(maxev < 1)\n\t\tmaxev = 1;\n\t// Token to use (only if the token based authentication mechanism is enabled)\n\tvar token = null;\n\tif(gatewayCallbacks.token !== undefined && gatewayCallbacks.token !== null)\n\t\ttoken = gatewayCallbacks.token;\n\t// API secret to use (only if the shared API secret is enabled)\n\tvar apisecret = null;\n\tif(gatewayCallbacks.apisecret !== undefined && gatewayCallbacks.apisecret !== null)\n\t\tapisecret = gatewayCallbacks.apisecret;\n\t// Whether we should destroy this session when onbeforeunload is called\n\tthis.destroyOnUnload = true;\n\tif(gatewayCallbacks.destroyOnUnload !== undefined && gatewayCallbacks.destroyOnUnload !== null)\n\t\tthis.destroyOnUnload = (gatewayCallbacks.destroyOnUnload === true);\n\t// Some timeout-related values\n\tvar keepAlivePeriod = 25000;\n\tif(gatewayCallbacks.keepAlivePeriod !== undefined && gatewayCallbacks.keepAlivePeriod !== null)\n\t\tkeepAlivePeriod = gatewayCallbacks.keepAlivePeriod;\n\tif(isNaN(keepAlivePeriod))\n\t\tkeepAlivePeriod = 25000;\n\tvar longPollTimeout = 60000;\n\tif(gatewayCallbacks.longPollTimeout !== undefined && gatewayCallbacks.longPollTimeout !== null)\n\t\tlongPollTimeout = gatewayCallbacks.longPollTimeout;\n\tif(isNaN(longPollTimeout))\n\t\tlongPollTimeout = 60000;\n\n\t// overrides for default maxBitrate values for simulcasting\n\tfunction getMaxBitrates(simulcastMaxBitrates) {\n\t\tvar maxBitrates = {\n\t\t\thigh: 900000,\n\t\t\tmedium: 300000,\n\t\t\tlow: 100000,\n\t\t};\n\n\t\tif (simulcastMaxBitrates !== undefined && simulcastMaxBitrates !== null) {\n\t\t\tif (simulcastMaxBitrates.high)\n\t\t\t\tmaxBitrates.high = simulcastMaxBitrates.high;\n\t\t\tif (simulcastMaxBitrates.medium)\n\t\t\t\tmaxBitrates.medium = simulcastMaxBitrates.medium;\n\t\t\tif (simulcastMaxBitrates.low)\n\t\t\t\tmaxBitrates.low = simulcastMaxBitrates.low;\n\t\t}\n\n\t\treturn maxBitrates;\n\t}\n\n\tvar connected = false;\n\tvar sessionId = null;\n\tvar pluginHandles = {};\n\tvar that = this;\n\tvar retries = 0;\n\tvar transactions = {};\n\tcreateSession(gatewayCallbacks);\n\n\t// Public methods\n\tthis.getServer = function() { return server; };\n\tthis.isConnected = function() { return connected; };\n\tthis.reconnect = function(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks[\"reconnect\"] = true;\n\t\tcreateSession(callbacks);\n\t};\n\tthis.getSessionId = function() { return sessionId; };\n\tthis.destroy = function(callbacks) { destroySession(callbacks); };\n\tthis.attach = function(callbacks) { createHandle(callbacks); };\n\n\tfunction eventHandler() {\n\t\tif(sessionId == null)\n\t\t\treturn;\n\t\tJanus.debug('Long poll...');\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar longpoll = server + \"/\" + sessionId + \"?rid=\" + new Date().getTime();\n\t\tif(maxev)\n\t\t\tlongpoll = longpoll + \"&maxev=\" + maxev;\n\t\tif(token)\n\t\t\tlongpoll = longpoll + \"&token=\" + encodeURIComponent(token);\n\t\tif(apisecret)\n\t\t\tlongpoll = longpoll + \"&apisecret=\" + encodeURIComponent(apisecret);\n\t\tJanus.httpAPICall(longpoll, {\n\t\t\tverb: 'GET',\n\t\t\twithCredentials: withCredentials,\n\t\t\tsuccess: handleEvent,\n\t\t\ttimeout: longPollTimeout,\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\n\t\t\t\tretries++;\n\t\t\t\tif(retries > 3) {\n\t\t\t\t\t// Did we just lose the server? :-(\n\t\t\t\t\tconnected = false;\n\t\t\t\t\tgatewayCallbacks.error(\"Lost connection to the server (is it down?)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\teventHandler();\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private event handler: this will trigger plugin callbacks, if set\n\tfunction handleEvent(json, skipTimeout) {\n\t\tretries = 0;\n\t\tif(!websockets && sessionId !== undefined && sessionId !== null && skipTimeout !== true)\n\t\t\teventHandler();\n\t\tif(!websockets && Janus.isArray(json)) {\n\t\t\t// We got an array: it means we passed a maxev > 1, iterate on all objects\n\t\t\tfor(var i=0; i<json.length; i++) {\n\t\t\t\thandleEvent(json[i], true);\n\t\t\t}\n\t\t\treturn;\n\t\t}\n\t\tif(json[\"janus\"] === \"keepalive\") {\n\t\t\t// Nothing happened\n\t\t\tJanus.vdebug(\"Got a keepalive on session \" + sessionId);\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"ack\") {\n\t\t\t// Just an ack, we can probably ignore\n\t\t\tJanus.debug(\"Got an ack on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"success\") {\n\t\t\t// Success!\n\t\t\tJanus.debug(\"Got a success on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess)\n\t\t\t\t\treportSuccess(json);\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"trickle\") {\n\t\t\t// We got a trickle candidate from Janus\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar candidate = json[\"candidate\"];\n\t\t\tJanus.debug(\"Got a trickled candidate on session \" + sessionId);\n\t\t\tJanus.debug(candidate);\n\t\t\tvar config = pluginHandle.webrtcStuff;\n\t\t\tif(config.pc && config.remoteSdp) {\n\t\t\t\t// Add candidate right now\n\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t// end-of-candidates\n\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t} else {\n\t\t\t\t\t// New candidate\n\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// We didn't do setRemoteDescription (trickle got here before the offer?)\n\t\t\t\tJanus.debug(\"We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate\");\n\t\t\t\tif(!config.candidates)\n\t\t\t\t\tconfig.candidates = [];\n\t\t\t\tconfig.candidates.push(candidate);\n\t\t\t\tJanus.debug(config.candidates);\n\t\t\t}\n\t\t} else if(json[\"janus\"] === \"webrtcup\") {\n\t\t\t// The PeerConnection with the server is up! Notify this\n\t\t\tJanus.debug(\"Got a webrtcup event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.webrtcState(true);\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"hangup\") {\n\t\t\t// A plugin asked the core to hangup a PeerConnection on one of our handles\n\t\t\tJanus.debug(\"Got a hangup event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.webrtcState(false, json[\"reason\"]);\n\t\t\tpluginHandle.hangup();\n\t\t} else if(json[\"janus\"] === \"detached\") {\n\t\t\t// A plugin asked the core to detach one of our handles\n\t\t\tJanus.debug(\"Got a detached event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\t// Don't warn here because destroyHandle causes this situation.\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.detached = true;\n\t\t\tpluginHandle.ondetached();\n\t\t\tpluginHandle.detach();\n\t\t} else if(json[\"janus\"] === \"media\") {\n\t\t\t// Media started/stopped flowing\n\t\t\tJanus.debug(\"Got a media event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.mediaState(json[\"type\"], json[\"receiving\"]);\n\t\t} else if(json[\"janus\"] === \"slowlink\") {\n\t\t\tJanus.debug(\"Got a slowlink event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\t// Trouble uplink or downlink\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.debug(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tpluginHandle.slowLink(json[\"uplink\"], json[\"lost\"]);\n\t\t} else if(json[\"janus\"] === \"error\") {\n\t\t\t// Oops, something wrong happened\n\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\tJanus.debug(json);\n\t\t\tvar transaction = json[\"transaction\"];\n\t\t\tif(transaction) {\n\t\t\t\tvar reportSuccess = transactions[transaction];\n\t\t\t\tif(reportSuccess) {\n\t\t\t\t\treportSuccess(json);\n\t\t\t\t}\n\t\t\t\tdelete transactions[transaction];\n\t\t\t}\n\t\t\treturn;\n\t\t} else if(json[\"janus\"] === \"event\") {\n\t\t\tJanus.debug(\"Got a plugin event on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tvar sender = json[\"sender\"];\n\t\t\tif(!sender) {\n\t\t\t\tJanus.warn(\"Missing sender...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\tif(!plugindata) {\n\t\t\t\tJanus.warn(\"Missing plugindata...\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tJanus.debug(\"  -- Event is coming from \" + sender + \" (\" + plugindata[\"plugin\"] + \")\");\n\t\t\tvar data = plugindata[\"data\"];\n\t\t\tJanus.debug(data);\n\t\t\tvar pluginHandle = pluginHandles[sender];\n\t\t\tif(!pluginHandle) {\n\t\t\t\tJanus.warn(\"This handle is not attached to this session\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar jsep = json[\"jsep\"];\n\t\t\tif(jsep) {\n\t\t\t\tJanus.debug(\"Handling SDP as well...\");\n\t\t\t\tJanus.debug(jsep);\n\t\t\t}\n\t\t\tvar callback = pluginHandle.onmessage;\n\t\t\tif(callback) {\n\t\t\t\tJanus.debug(\"Notifying application...\");\n\t\t\t\t// Send to callback specified when attaching plugin handle\n\t\t\t\tcallback(data, jsep);\n\t\t\t} else {\n\t\t\t\t// Send to generic callback (?)\n\t\t\t\tJanus.debug(\"No provided notification callback\");\n\t\t\t}\n\t\t} else if(json[\"janus\"] === \"timeout\") {\n\t\t\tJanus.error(\"Timeout on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t\tif (websockets) {\n\t\t\t\tws.close(3504, \"Gateway timeout\");\n\t\t\t}\n\t\t\treturn;\n\t\t} else {\n\t\t\tJanus.warn(\"Unknown message/event  '\" + json[\"janus\"] + \"' on session \" + sessionId);\n\t\t\tJanus.debug(json);\n\t\t}\n\t}\n\n\t// Private helper to send keep-alive messages on WebSockets\n\tfunction keepAlive() {\n\t\tif(!server || !websockets || !connected)\n\t\t\treturn;\n\t\twsKeepaliveTimeoutId = setTimeout(keepAlive, keepAlivePeriod);\n\t\tvar request = { \"janus\": \"keepalive\", \"session_id\": sessionId, \"transaction\": Janus.randomString(12) };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tws.send(JSON.stringify(request));\n\t}\n\n\t// Private method to create a session\n\tfunction createSession(callbacks) {\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"create\", \"transaction\": transaction };\n\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t// We're reconnecting, claim the session\n\t\t\tconnected = false;\n\t\t\trequest[\"janus\"] = \"claim\";\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\t// If we were using websockets, ignore the old connection\n\t\t\tif(ws) {\n\t\t\t\tws.onopen = null;\n\t\t\t\tws.onerror = null;\n\t\t\t\tws.onclose = null;\n\t\t\t\tif(wsKeepaliveTimeoutId) {\n\t\t\t\t\tclearTimeout(wsKeepaliveTimeoutId);\n\t\t\t\t\twsKeepaliveTimeoutId = null;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(!server && Janus.isArray(servers)) {\n\t\t\t// We still need to find a working server from the list we were given\n\t\t\tserver = servers[serversIndex];\n\t\t\tif(server.indexOf(\"ws\") === 0) {\n\t\t\t\twebsockets = true;\n\t\t\t\tJanus.log(\"Server #\" + (serversIndex+1) + \": trying WebSockets to contact Janus (\" + server + \")\");\n\t\t\t} else {\n\t\t\t\twebsockets = false;\n\t\t\t\tJanus.log(\"Server #\" + (serversIndex+1) + \": trying REST API to contact Janus (\" + server + \")\");\n\t\t\t}\n\t\t}\n\t\tif(websockets) {\n\t\t\tws = Janus.newWebSocket(server, 'janus-protocol');\n\t\t\twsHandlers = {\n\t\t\t\t'error': function() {\n\t\t\t\t\tJanus.error(\"Error connecting to the Janus WebSockets server... \" + server);\n\t\t\t\t\tif (Janus.isArray(servers) && !callbacks[\"reconnect\"]) {\n\t\t\t\t\t\tserversIndex++;\n\t\t\t\t\t\tif (serversIndex === servers.length) {\n\t\t\t\t\t\t\t// We tried all the servers the user gave us and they all failed\n\t\t\t\t\t\t\tcallbacks.error(\"Error connecting to any of the provided Janus servers: Is the server down?\");\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t// Let's try the next server\n\t\t\t\t\t\tserver = null;\n\t\t\t\t\t\tsetTimeout(function() {\n\t\t\t\t\t\t\tcreateSession(callbacks);\n\t\t\t\t\t\t}, 200);\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tcallbacks.error(\"Error connecting to the Janus WebSockets server: Is the server down?\");\n\t\t\t\t},\n\n\t\t\t\t'open': function() {\n\t\t\t\t\t// We need to be notified about the success\n\t\t\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\t\t\tJanus.debug(json);\n\t\t\t\t\t\tif (json[\"janus\"] !== \"success\") {\n\t\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\t\tcallbacks.error(json[\"error\"].reason);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t\twsKeepaliveTimeoutId = setTimeout(keepAlive, keepAlivePeriod);\n\t\t\t\t\t\tconnected = true;\n\t\t\t\t\t\tsessionId = json[\"session_id\"] ? json[\"session_id\"] : json.data[\"id\"];\n\t\t\t\t\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t\t\t\t\tJanus.log(\"Claimed session: \" + sessionId);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tJanus.log(\"Created session: \" + sessionId);\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.sessions[sessionId] = that;\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t};\n\t\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t\t},\n\n\t\t\t\t'message': function(event) {\n\t\t\t\t\thandleEvent(JSON.parse(event.data));\n\t\t\t\t},\n\n\t\t\t\t'close': function() {\n\t\t\t\t\tif (!server || !connected) {\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tconnected = false;\n\t\t\t\t\t// FIXME What if this is called when the page is closed?\n\t\t\t\t\tgatewayCallbacks.error(\"Lost connection to the server (is it down?)\");\n\t\t\t\t}\n\t\t\t};\n\n\t\t\tfor(var eventName in wsHandlers) {\n\t\t\t\tws.addEventListener(eventName, wsHandlers[eventName]);\n\t\t\t}\n\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconnected = true;\n\t\t\t\tsessionId = json[\"session_id\"] ? json[\"session_id\"] : json.data[\"id\"];\n\t\t\t\tif(callbacks[\"reconnect\"]) {\n\t\t\t\t\tJanus.log(\"Claimed session: \" + sessionId);\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log(\"Created session: \" + sessionId);\n\t\t\t\t}\n\t\t\t\tJanus.sessions[sessionId] = that;\n\t\t\t\teventHandler();\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(Janus.isArray(servers) && !callbacks[\"reconnect\"]) {\n\t\t\t\t\tserversIndex++;\n\t\t\t\t\tif(serversIndex === servers.length) {\n\t\t\t\t\t\t// We tried all the servers the user gave us and they all failed\n\t\t\t\t\t\tcallbacks.error(\"Error connecting to any of the provided Janus servers: Is the server down?\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// Let's try the next server\n\t\t\t\t\tserver = null;\n\t\t\t\t\tsetTimeout(function() { createSession(callbacks); }, 200);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to destroy a session\n\tfunction destroySession(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\t// FIXME This method triggers a success even when we fail\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar unload = (callbacks.unload === true);\n\t\tvar notifyDestroyed = true;\n\t\tif(callbacks.notifyDestroyed !== undefined && callbacks.notifyDestroyed !== null)\n\t\t\tnotifyDestroyed = (callbacks.notifyDestroyed === true);\n\t\tvar cleanupHandles = (callbacks.cleanupHandles === true);\n\t\tJanus.log(\"Destroying session \" + sessionId + \" (unload=\" + unload + \")\");\n\t\tif(!sessionId) {\n\t\t\tJanus.warn(\"No session to destroy\");\n\t\t\tcallbacks.success();\n\t\t\tif(notifyDestroyed)\n\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\treturn;\n\t\t}\n\t\tif(cleanupHandles) {\n\t\t\tfor(var handleId in pluginHandles)\n\t\t\t\tdestroyHandle(handleId, { noRequest: true });\n\t\t}\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tsessionId = null;\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\t// No need to destroy all handles first, Janus will do that itself\n\t\tvar request = { \"janus\": \"destroy\", \"transaction\": Janus.randomString(12) };\n\t\tif(token)\n\t\t\trequest[\"token\"] = token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(unload) {\n\t\t\t// We're unloading the page: use sendBeacon for HTTP instead,\n\t\t\t// or just close the WebSocket connection if we're using that\n\t\t\tif(websockets) {\n\t\t\t\tws.onclose = null;\n\t\t\t\tws.close();\n\t\t\t\tws = null;\n\t\t\t} else {\n\t\t\t\tnavigator.sendBeacon(server + \"/\" + sessionId, JSON.stringify(request));\n\t\t\t}\n\t\t\tJanus.log(\"Destroyed session:\");\n\t\t\tsessionId = null;\n\t\t\tconnected = false;\n\t\t\tcallbacks.success();\n\t\t\tif(notifyDestroyed)\n\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\treturn;\n\t\t}\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\n\t\t\tvar unbindWebSocket = function() {\n\t\t\t\tfor(var eventName in wsHandlers) {\n\t\t\t\t\tws.removeEventListener(eventName, wsHandlers[eventName]);\n\t\t\t\t}\n\t\t\t\tws.removeEventListener('message', onUnbindMessage);\n\t\t\t\tws.removeEventListener('error', onUnbindError);\n\t\t\t\tif(wsKeepaliveTimeoutId) {\n\t\t\t\t\tclearTimeout(wsKeepaliveTimeoutId);\n\t\t\t\t}\n\t\t\t\tws.close();\n\t\t\t};\n\n\t\t\tvar onUnbindMessage = function(event){\n\t\t\t\tvar data = JSON.parse(event.data);\n\t\t\t\tif(data.session_id == request.session_id && data.transaction == request.transaction) {\n\t\t\t\t\tunbindWebSocket();\n\t\t\t\t\tcallbacks.success();\n\t\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t\t}\n\t\t\t};\n\t\t\tvar onUnbindError = function(event) {\n\t\t\t\tunbindWebSocket();\n\t\t\t\tcallbacks.error(\"Failed to destroy the server: Is the server down?\");\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t};\n\n\t\t\tws.addEventListener('message', onUnbindMessage);\n\t\t\tws.addEventListener('error', onUnbindError);\n\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Destroyed session:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tsessionId = null;\n\t\t\t\tconnected = false;\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tcallbacks.success();\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\t// Reset everything anyway\n\t\t\t\tsessionId = null;\n\t\t\t\tconnected = false;\n\t\t\t\tcallbacks.success();\n\t\t\t\tif(notifyDestroyed)\n\t\t\t\t\tgatewayCallbacks.destroyed();\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to create a plugin handle\n\tfunction createHandle(callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.consentDialog = (typeof callbacks.consentDialog == \"function\") ? callbacks.consentDialog : Janus.noop;\n\t\tcallbacks.iceState = (typeof callbacks.iceState == \"function\") ? callbacks.iceState : Janus.noop;\n\t\tcallbacks.mediaState = (typeof callbacks.mediaState == \"function\") ? callbacks.mediaState : Janus.noop;\n\t\tcallbacks.webrtcState = (typeof callbacks.webrtcState == \"function\") ? callbacks.webrtcState : Janus.noop;\n\t\tcallbacks.slowLink = (typeof callbacks.slowLink == \"function\") ? callbacks.slowLink : Janus.noop;\n\t\tcallbacks.onmessage = (typeof callbacks.onmessage == \"function\") ? callbacks.onmessage : Janus.noop;\n\t\tcallbacks.onlocalstream = (typeof callbacks.onlocalstream == \"function\") ? callbacks.onlocalstream : Janus.noop;\n\t\tcallbacks.onremotestream = (typeof callbacks.onremotestream == \"function\") ? callbacks.onremotestream : Janus.noop;\n\t\tcallbacks.ondata = (typeof callbacks.ondata == \"function\") ? callbacks.ondata : Janus.noop;\n\t\tcallbacks.ondataopen = (typeof callbacks.ondataopen == \"function\") ? callbacks.ondataopen : Janus.noop;\n\t\tcallbacks.oncleanup = (typeof callbacks.oncleanup == \"function\") ? callbacks.oncleanup : Janus.noop;\n\t\tcallbacks.ondetached = (typeof callbacks.ondetached == \"function\") ? callbacks.ondetached : Janus.noop;\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar plugin = callbacks.plugin;\n\t\tif(!plugin) {\n\t\t\tJanus.error(\"Invalid plugin\");\n\t\t\tcallbacks.error(\"Invalid plugin\");\n\t\t\treturn;\n\t\t}\n\t\tvar opaqueId = callbacks.opaqueId;\n\t\tvar handleToken = callbacks.token ? callbacks.token : token;\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"attach\", \"plugin\": plugin, \"opaque_id\": opaqueId, \"transaction\": transaction };\n\t\tif(handleToken)\n\t\t\trequest[\"token\"] = handleToken;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar handleId = json.data[\"id\"];\n\t\t\t\tJanus.log(\"Created handle: \" + handleId);\n\t\t\t\tvar pluginHandle =\n\t\t\t\t\t{\n\t\t\t\t\t\tsession : that,\n\t\t\t\t\t\tplugin : plugin,\n\t\t\t\t\t\tid : handleId,\n\t\t\t\t\t\ttoken : handleToken,\n\t\t\t\t\t\tdetached : false,\n\t\t\t\t\t\twebrtcStuff : {\n\t\t\t\t\t\t\tstarted : false,\n\t\t\t\t\t\t\tmyStream : null,\n\t\t\t\t\t\t\tstreamExternal : false,\n\t\t\t\t\t\t\tremoteStream : null,\n\t\t\t\t\t\t\tmySdp : null,\n\t\t\t\t\t\t\tmediaConstraints : null,\n\t\t\t\t\t\t\tpc : null,\n\t\t\t\t\t\t\tdataChannel : {},\n\t\t\t\t\t\t\tdtmfSender : null,\n\t\t\t\t\t\t\ttrickle : true,\n\t\t\t\t\t\t\ticeDone : false,\n\t\t\t\t\t\t\tvolume : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbitrate : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\tbsnow : null,\n\t\t\t\t\t\t\t\tbsbefore : null,\n\t\t\t\t\t\t\t\ttsnow : null,\n\t\t\t\t\t\t\t\ttsbefore : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetId : function() { return handleId; },\n\t\t\t\t\t\tgetPlugin : function() { return plugin; },\n\t\t\t\t\t\tgetVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetRemoteVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetLocalVolume : function() { return getVolume(handleId, false); },\n\t\t\t\t\t\tisAudioMuted : function() { return isMuted(handleId, false); },\n\t\t\t\t\t\tmuteAudio : function() { return mute(handleId, false, true); },\n\t\t\t\t\t\tunmuteAudio : function() { return mute(handleId, false, false); },\n\t\t\t\t\t\tisVideoMuted : function() { return isMuted(handleId, true); },\n\t\t\t\t\t\tmuteVideo : function() { return mute(handleId, true, true); },\n\t\t\t\t\t\tunmuteVideo : function() { return mute(handleId, true, false); },\n\t\t\t\t\t\tgetBitrate : function() { return getBitrate(handleId); },\n\t\t\t\t\t\tsend : function(callbacks) { sendMessage(handleId, callbacks); },\n\t\t\t\t\t\tdata : function(callbacks) { sendData(handleId, callbacks); },\n\t\t\t\t\t\tdtmf : function(callbacks) { sendDtmf(handleId, callbacks); },\n\t\t\t\t\t\tconsentDialog : callbacks.consentDialog,\n\t\t\t\t\t\ticeState : callbacks.iceState,\n\t\t\t\t\t\tmediaState : callbacks.mediaState,\n\t\t\t\t\t\twebrtcState : callbacks.webrtcState,\n\t\t\t\t\t\tslowLink : callbacks.slowLink,\n\t\t\t\t\t\tonmessage : callbacks.onmessage,\n\t\t\t\t\t\tcreateOffer : function(callbacks) { prepareWebrtc(handleId, true, callbacks); },\n\t\t\t\t\t\tcreateAnswer : function(callbacks) { prepareWebrtc(handleId, false, callbacks); },\n\t\t\t\t\t\thandleRemoteJsep : function(callbacks) { prepareWebrtcPeer(handleId, callbacks); },\n\t\t\t\t\t\tonlocalstream : callbacks.onlocalstream,\n\t\t\t\t\t\tonremotestream : callbacks.onremotestream,\n\t\t\t\t\t\tondata : callbacks.ondata,\n\t\t\t\t\t\tondataopen : callbacks.ondataopen,\n\t\t\t\t\t\toncleanup : callbacks.oncleanup,\n\t\t\t\t\t\tondetached : callbacks.ondetached,\n\t\t\t\t\t\thangup : function(sendRequest) { cleanupWebrtc(handleId, sendRequest === true); },\n\t\t\t\t\t\tdetach : function(callbacks) { destroyHandle(handleId, callbacks); }\n\t\t\t\t\t};\n\t\t\t\tpluginHandles[handleId] = pluginHandle;\n\t\t\t\tcallbacks.success(pluginHandle);\n\t\t\t};\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\tcallbacks.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tvar handleId = json.data[\"id\"];\n\t\t\t\tJanus.log(\"Created handle: \" + handleId);\n\t\t\t\tvar pluginHandle =\n\t\t\t\t\t{\n\t\t\t\t\t\tsession : that,\n\t\t\t\t\t\tplugin : plugin,\n\t\t\t\t\t\tid : handleId,\n\t\t\t\t\t\ttoken : handleToken,\n\t\t\t\t\t\tdetached : false,\n\t\t\t\t\t\twebrtcStuff : {\n\t\t\t\t\t\t\tstarted : false,\n\t\t\t\t\t\t\tmyStream : null,\n\t\t\t\t\t\t\tstreamExternal : false,\n\t\t\t\t\t\t\tremoteStream : null,\n\t\t\t\t\t\t\tmySdp : null,\n\t\t\t\t\t\t\tmediaConstraints : null,\n\t\t\t\t\t\t\tpc : null,\n\t\t\t\t\t\t\tdataChannel : {},\n\t\t\t\t\t\t\tdtmfSender : null,\n\t\t\t\t\t\t\ttrickle : true,\n\t\t\t\t\t\t\ticeDone : false,\n\t\t\t\t\t\t\tvolume : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\tbitrate : {\n\t\t\t\t\t\t\t\tvalue : null,\n\t\t\t\t\t\t\t\tbsnow : null,\n\t\t\t\t\t\t\t\tbsbefore : null,\n\t\t\t\t\t\t\t\ttsnow : null,\n\t\t\t\t\t\t\t\ttsbefore : null,\n\t\t\t\t\t\t\t\ttimer : null\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t},\n\t\t\t\t\t\tgetId : function() { return handleId; },\n\t\t\t\t\t\tgetPlugin : function() { return plugin; },\n\t\t\t\t\t\tgetVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetRemoteVolume : function() { return getVolume(handleId, true); },\n\t\t\t\t\t\tgetLocalVolume : function() { return getVolume(handleId, false); },\n\t\t\t\t\t\tisAudioMuted : function() { return isMuted(handleId, false); },\n\t\t\t\t\t\tmuteAudio : function() { return mute(handleId, false, true); },\n\t\t\t\t\t\tunmuteAudio : function() { return mute(handleId, false, false); },\n\t\t\t\t\t\tisVideoMuted : function() { return isMuted(handleId, true); },\n\t\t\t\t\t\tmuteVideo : function() { return mute(handleId, true, true); },\n\t\t\t\t\t\tunmuteVideo : function() { return mute(handleId, true, false); },\n\t\t\t\t\t\tgetBitrate : function() { return getBitrate(handleId); },\n\t\t\t\t\t\tsend : function(callbacks) { sendMessage(handleId, callbacks); },\n\t\t\t\t\t\tdata : function(callbacks) { sendData(handleId, callbacks); },\n\t\t\t\t\t\tdtmf : function(callbacks) { sendDtmf(handleId, callbacks); },\n\t\t\t\t\t\tconsentDialog : callbacks.consentDialog,\n\t\t\t\t\t\ticeState : callbacks.iceState,\n\t\t\t\t\t\tmediaState : callbacks.mediaState,\n\t\t\t\t\t\twebrtcState : callbacks.webrtcState,\n\t\t\t\t\t\tslowLink : callbacks.slowLink,\n\t\t\t\t\t\tonmessage : callbacks.onmessage,\n\t\t\t\t\t\tcreateOffer : function(callbacks) { prepareWebrtc(handleId, true, callbacks); },\n\t\t\t\t\t\tcreateAnswer : function(callbacks) { prepareWebrtc(handleId, false, callbacks); },\n\t\t\t\t\t\thandleRemoteJsep : function(callbacks) { prepareWebrtcPeer(handleId, callbacks); },\n\t\t\t\t\t\tonlocalstream : callbacks.onlocalstream,\n\t\t\t\t\t\tonremotestream : callbacks.onremotestream,\n\t\t\t\t\t\tondata : callbacks.ondata,\n\t\t\t\t\t\tondataopen : callbacks.ondataopen,\n\t\t\t\t\t\toncleanup : callbacks.oncleanup,\n\t\t\t\t\t\tondetached : callbacks.ondetached,\n\t\t\t\t\t\thangup : function(sendRequest) { cleanupWebrtc(handleId, sendRequest === true); },\n\t\t\t\t\t\tdetach : function(callbacks) { destroyHandle(handleId, callbacks); }\n\t\t\t\t\t}\n\t\t\t\tpluginHandles[handleId] = pluginHandle;\n\t\t\t\tcallbacks.success(pluginHandle);\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tif(errorThrown === \"\")\n\t\t\t\t\tcallbacks.error(textStatus + \": Is the server down?\");\n\t\t\t\telse\n\t\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to send a message\n\tfunction sendMessage(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar message = callbacks.message;\n\t\tvar jsep = callbacks.jsep;\n\t\tvar transaction = Janus.randomString(12);\n\t\tvar request = { \"janus\": \"message\", \"body\": message, \"transaction\": transaction };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(jsep) {\n\t\t\trequest.jsep = {\n\t\t\t\ttype: jsep.type,\n\t\t\t\tsdp: jsep.sdp\n\t\t\t};\n\t\t\tif(jsep.e2ee)\n\t\t\t\trequest.jsep.e2ee = true;\n\t\t}\n\t\tJanus.debug(\"Sending message to plugin (handle=\" + handleId + \"):\");\n\t\tJanus.debug(request);\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\ttransactions[transaction] = function(json) {\n\t\t\t\tJanus.debug(\"Message sent!\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] === \"success\") {\n\t\t\t\t\t// We got a success, must have been a synchronous transaction\n\t\t\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\t\t\tif(!plugindata) {\n\t\t\t\t\t\tJanus.warn(\"Request succeeded, but missing plugindata...\");\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Synchronous transaction successful (\" + plugindata[\"plugin\"] + \")\");\n\t\t\t\t\tvar data = plugindata[\"data\"];\n\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\tcallbacks.success(data);\n\t\t\t\t\treturn;\n\t\t\t\t} else if(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\t// Not a success and not an ack, must be an error\n\t\t\t\t\tif(json[\"error\"]) {\n\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\tcallbacks.error(json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.error(\"Unknown error\");\t// FIXME\n\t\t\t\t\t\tcallbacks.error(\"Unknown error\");\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If we got here, the plugin decided to handle the request asynchronously\n\t\t\t\tcallbacks.success();\n\t\t\t};\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.debug(\"Message sent!\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] === \"success\") {\n\t\t\t\t\t// We got a success, must have been a synchronous transaction\n\t\t\t\t\tvar plugindata = json[\"plugindata\"];\n\t\t\t\t\tif(!plugindata) {\n\t\t\t\t\t\tJanus.warn(\"Request succeeded, but missing plugindata...\");\n\t\t\t\t\t\tcallbacks.success();\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Synchronous transaction successful (\" + plugindata[\"plugin\"] + \")\");\n\t\t\t\t\tvar data = plugindata[\"data\"];\n\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\tcallbacks.success(data);\n\t\t\t\t\treturn;\n\t\t\t\t} else if(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\t// Not a success and not an ack, must be an error\n\t\t\t\t\tif(json[\"error\"]) {\n\t\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\t\tcallbacks.error(json[\"error\"].code + \" \" + json[\"error\"].reason);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.error(\"Unknown error\");\t// FIXME\n\t\t\t\t\t\tcallbacks.error(\"Unknown error\");\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If we got here, the plugin decided to handle the request asynchronously\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\tcallbacks.error(textStatus + \": \" + errorThrown);\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to send a trickle candidate\n\tfunction sendTrickleCandidate(handleId, candidate) {\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar request = { \"janus\": \"trickle\", \"candidate\": candidate, \"transaction\": Janus.randomString(12) };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tJanus.vdebug(\"Sending trickle candidate (handle=\" + handleId + \"):\");\n\t\tJanus.vdebug(request);\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.vdebug(\"Candidate sent!\");\n\t\t\t\tJanus.vdebug(json);\n\t\t\t\tif(json[\"janus\"] !== \"ack\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t}\n\t\t});\n\t}\n\n\t// Private method to create a data channel\n\tfunction createDataChannel(handleId, dclabel, dcprotocol, incoming, pendingData) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar onDataChannelMessage = function(event) {\n\t\t\tJanus.log('Received message on data channel:', event);\n\t\t\tvar label = event.target.label;\n\t\t\tpluginHandle.ondata(event.data, label);\n\t\t};\n\t\tvar onDataChannelStateChange = function(event) {\n\t\t\tJanus.log('Received state change on data channel:', event);\n\t\t\tvar label = event.target.label;\n\t\t\tvar protocol = event.target.protocol;\n\t\t\tvar dcState = config.dataChannel[label] ? config.dataChannel[label].readyState : \"null\";\n\t\t\tJanus.log('State change on <' + label + '> data channel: ' + dcState);\n\t\t\tif(dcState === 'open') {\n\t\t\t\t// Any pending messages to send?\n\t\t\t\tif(config.dataChannel[label].pending && config.dataChannel[label].pending.length > 0) {\n\t\t\t\t\tJanus.log(\"Sending pending messages on <\" + label + \">:\", config.dataChannel[label].pending.length);\n\t\t\t\t\tfor(var data of config.dataChannel[label].pending) {\n\t\t\t\t\t\tJanus.log(\"Sending data on data channel <\" + label + \">\");\n\t\t\t\t\t\tJanus.debug(data);\n\t\t\t\t\t\tconfig.dataChannel[label].send(data);\n\t\t\t\t\t}\n\t\t\t\t\tconfig.dataChannel[label].pending = [];\n\t\t\t\t}\n\t\t\t\t// Notify the open data channel\n\t\t\t\tpluginHandle.ondataopen(label, protocol);\n\t\t\t}\n\t\t};\n\t\tvar onDataChannelError = function(error) {\n\t\t\tJanus.error('Got error on data channel:', error);\n\t\t\t// TODO\n\t\t};\n\t\tif(!incoming) {\n\t\t\t// FIXME Add options (ordered, maxRetransmits, etc.)\n\t\t\tvar dcoptions = { ordered: true };\n\t\t\tif(dcprotocol)\n\t\t\t\tdcoptions.protocol = dcprotocol;\n\t\t\tconfig.dataChannel[dclabel] = config.pc.createDataChannel(dclabel, dcoptions);\n\t\t} else {\n\t\t\t// The channel was created by Janus\n\t\t\tconfig.dataChannel[dclabel] = incoming;\n\t\t}\n\t\tconfig.dataChannel[dclabel].onmessage = onDataChannelMessage;\n\t\tconfig.dataChannel[dclabel].onopen = onDataChannelStateChange;\n\t\tconfig.dataChannel[dclabel].onclose = onDataChannelStateChange;\n\t\tconfig.dataChannel[dclabel].onerror = onDataChannelError;\n\t\tconfig.dataChannel[dclabel].pending = [];\n\t\tif(pendingData)\n\t\t\tconfig.dataChannel[dclabel].pending.push(pendingData);\n\t}\n\n\t// Private method to send a data channel message\n\tfunction sendData(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar data = callbacks.text || callbacks.data;\n\t\tif(!data) {\n\t\t\tJanus.warn(\"Invalid data\");\n\t\t\tcallbacks.error(\"Invalid data\");\n\t\t\treturn;\n\t\t}\n\t\tvar label = callbacks.label ? callbacks.label : Janus.dataChanDefaultLabel;\n\t\tif(!config.dataChannel[label]) {\n\t\t\t// Create new data channel and wait for it to open\n\t\t\tcreateDataChannel(handleId, label, callbacks.protocol, false, data, callbacks.protocol);\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(config.dataChannel[label].readyState !== \"open\") {\n\t\t\tconfig.dataChannel[label].pending.push(data);\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tJanus.log(\"Sending data on data channel <\" + label + \">\");\n\t\tJanus.debug(data);\n\t\tconfig.dataChannel[label].send(data);\n\t\tcallbacks.success();\n\t}\n\n\t// Private method to send a DTMF tone\n\tfunction sendDtmf(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.dtmfSender) {\n\t\t\t// Create the DTMF sender the proper way, if possible\n\t\t\tif(config.pc) {\n\t\t\t\tvar senders = config.pc.getSenders();\n\t\t\t\tvar audioSender = senders.find(function(sender) {\n\t\t\t\t\treturn sender.track && sender.track.kind === 'audio';\n\t\t\t\t});\n\t\t\t\tif(!audioSender) {\n\t\t\t\t\tJanus.warn(\"Invalid DTMF configuration (no audio track)\");\n\t\t\t\t\tcallbacks.error(\"Invalid DTMF configuration (no audio track)\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\tconfig.dtmfSender = audioSender.dtmf;\n\t\t\t\tif(config.dtmfSender) {\n\t\t\t\t\tJanus.log(\"Created DTMF Sender\");\n\t\t\t\t\tconfig.dtmfSender.ontonechange = function(tone) { Janus.debug(\"Sent DTMF tone: \" + tone.tone); };\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(!config.dtmfSender) {\n\t\t\t\tJanus.warn(\"Invalid DTMF configuration\");\n\t\t\t\tcallbacks.error(\"Invalid DTMF configuration\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\tvar dtmf = callbacks.dtmf;\n\t\tif(!dtmf) {\n\t\t\tJanus.warn(\"Invalid DTMF parameters\");\n\t\t\tcallbacks.error(\"Invalid DTMF parameters\");\n\t\t\treturn;\n\t\t}\n\t\tvar tones = dtmf.tones;\n\t\tif(!tones) {\n\t\t\tJanus.warn(\"Invalid DTMF string\");\n\t\t\tcallbacks.error(\"Invalid DTMF string\");\n\t\t\treturn;\n\t\t}\n\t\tvar duration = (typeof dtmf.duration === 'number') ? dtmf.duration : 500; // We choose 500ms as the default duration for a tone\n\t\tvar gap = (typeof dtmf.gap === 'number') ? dtmf.gap : 50; // We choose 50ms as the default gap between tones\n\t\tJanus.debug(\"Sending DTMF string \" + tones + \" (duration \" + duration + \"ms, gap \" + gap + \"ms)\");\n\t\tconfig.dtmfSender.insertDTMF(tones, duration, gap);\n\t\tcallbacks.success();\n\t}\n\n\t// Private method to destroy a plugin handle\n\tfunction destroyHandle(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar noRequest = (callbacks.noRequest === true);\n\t\tJanus.log(\"Destroying handle \" + handleId + \" (only-locally=\" + noRequest + \")\");\n\t\tcleanupWebrtc(handleId);\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || pluginHandle.detached) {\n\t\t\t// Plugin was already detached by Janus, calling detach again will return a handle not found error, so just exit here\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(noRequest) {\n\t\t\t// We're only removing the handle locally\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tif(!connected) {\n\t\t\tJanus.warn(\"Is the server down? (connected=false)\");\n\t\t\tcallbacks.error(\"Is the server down? (connected=false)\");\n\t\t\treturn;\n\t\t}\n\t\tvar request = { \"janus\": \"detach\", \"transaction\": Janus.randomString(12) };\n\t\tif(pluginHandle.token)\n\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\tif(apisecret)\n\t\t\trequest[\"apisecret\"] = apisecret;\n\t\tif(websockets) {\n\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\tws.send(JSON.stringify(request));\n\t\t\tdelete pluginHandles[handleId];\n\t\t\tcallbacks.success();\n\t\t\treturn;\n\t\t}\n\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\tverb: 'POST',\n\t\t\twithCredentials: withCredentials,\n\t\t\tbody: request,\n\t\t\tsuccess: function(json) {\n\t\t\t\tJanus.log(\"Destroyed handle:\");\n\t\t\t\tJanus.debug(json);\n\t\t\t\tif(json[\"janus\"] !== \"success\") {\n\t\t\t\t\tJanus.error(\"Ooops: \" + json[\"error\"].code + \" \" + json[\"error\"].reason);\t// FIXME\n\t\t\t\t}\n\t\t\t\tdelete pluginHandles[handleId];\n\t\t\t\tcallbacks.success();\n\t\t\t},\n\t\t\terror: function(textStatus, errorThrown) {\n\t\t\t\tJanus.error(textStatus + \":\", errorThrown);\t// FIXME\n\t\t\t\t// We cleanup anyway\n\t\t\t\tdelete pluginHandles[handleId];\n\t\t\t\tcallbacks.success();\n\t\t\t}\n\t\t});\n\t}\n\n\t// WebRTC stuff\n\tfunction streamsDone(handleId, jsep, media, callbacks, stream) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tJanus.debug(\"streamsDone:\", stream);\n\t\tif(stream) {\n\t\t\tJanus.debug(\"  -- Audio tracks:\", stream.getAudioTracks());\n\t\t\tJanus.debug(\"  -- Video tracks:\", stream.getVideoTracks());\n\t\t}\n\t\t// We're now capturing the new stream: check if we're updating or if it's a new thing\n\t\tvar addTracks = false;\n\t\tif(!config.myStream || !media.update || config.streamExternal) {\n\t\t\tconfig.myStream = stream;\n\t\t\taddTracks = true;\n\t\t} else {\n\t\t\t// We only need to update the existing stream\n\t\t\tif(((!media.update && isAudioSendEnabled(media)) || (media.update && (media.addAudio || media.replaceAudio))) &&\n\t\t\t\t\tstream.getAudioTracks() && stream.getAudioTracks().length) {\n\t\t\t\tconfig.myStream.addTrack(stream.getAudioTracks()[0]);\n\t\t\t\tif(Janus.unifiedPlan) {\n\t\t\t\t\t// Use Transceivers\n\t\t\t\t\tJanus.log((media.replaceAudio ? \"Replacing\" : \"Adding\") + \" audio track:\", stream.getAudioTracks()[0]);\n\t\t\t\t\tvar audioTransceiver = null;\n\t\t\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(audioTransceiver && audioTransceiver.sender) {\n\t\t\t\t\t\taudioTransceiver.sender.replaceTrack(stream.getAudioTracks()[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.pc.addTrack(stream.getAudioTracks()[0], stream);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log((media.replaceAudio ? \"Replacing\" : \"Adding\") + \" audio track:\", stream.getAudioTracks()[0]);\n\t\t\t\t\tconfig.pc.addTrack(stream.getAudioTracks()[0], stream);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(((!media.update && isVideoSendEnabled(media)) || (media.update && (media.addVideo || media.replaceVideo))) &&\n\t\t\t\t\tstream.getVideoTracks() && stream.getVideoTracks().length) {\n\t\t\t\tconfig.myStream.addTrack(stream.getVideoTracks()[0]);\n\t\t\t\tif(Janus.unifiedPlan) {\n\t\t\t\t\t// Use Transceivers\n\t\t\t\t\tJanus.log((media.replaceVideo ? \"Replacing\" : \"Adding\") + \" video track:\", stream.getVideoTracks()[0]);\n\t\t\t\t\tvar videoTransceiver = null;\n\t\t\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tif(videoTransceiver && videoTransceiver.sender) {\n\t\t\t\t\t\tvideoTransceiver.sender.replaceTrack(stream.getVideoTracks()[0]);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tconfig.pc.addTrack(stream.getVideoTracks()[0], stream);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tJanus.log((media.replaceVideo ? \"Replacing\" : \"Adding\") + \" video track:\", stream.getVideoTracks()[0]);\n\t\t\t\t\tconfig.pc.addTrack(stream.getVideoTracks()[0], stream);\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// If we still need to create a PeerConnection, let's do that\n\t\tif(!config.pc) {\n\t\t\tvar pc_config = {\"iceServers\": iceServers, \"iceTransportPolicy\": iceTransportPolicy, \"bundlePolicy\": bundlePolicy};\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\") {\n\t\t\t\t// For Chrome versions before 72, we force a plan-b semantic, and unified-plan otherwise\n\t\t\t\tpc_config[\"sdpSemantics\"] = (Janus.webRTCAdapter.browserDetails.version < 72) ? \"plan-b\" : \"unified-plan\";\n\t\t\t}\n\t\t\tvar pc_constraints = {\n\t\t\t\t\"optional\": [{\"DtlsSrtpKeyAgreement\": true}]\n\t\t\t};\n\t\t\tif(ipv6Support) {\n\t\t\t\tpc_constraints.optional.push({\"googIPv6\":true});\n\t\t\t}\n\t\t\t// Any custom constraint to add?\n\t\t\tif(callbacks.rtcConstraints && typeof callbacks.rtcConstraints === 'object') {\n\t\t\t\tJanus.debug(\"Adding custom PeerConnection constraints:\", callbacks.rtcConstraints);\n\t\t\t\tfor(var i in callbacks.rtcConstraints) {\n\t\t\t\t\tpc_constraints.optional.push(callbacks.rtcConstraints[i]);\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\t\t// This is Edge, enable BUNDLE explicitly\n\t\t\t\tpc_config.bundlePolicy = \"max-bundle\";\n\t\t\t}\n\t\t\t// Check if a sender or receiver transform has been provided\n\t\t\tif(RTCRtpSender.prototype.createEncodedAudioStreams &&\n\t\t\t\t\tRTCRtpSender.prototype.createEncodedVideoStreams &&\n\t\t\t\t\t(callbacks.senderTransforms || callbacks.receiverTransforms)) {\n\t\t\t\tconfig.senderTransforms = callbacks.senderTransforms;\n\t\t\t\tconfig.receiverTransforms = callbacks.receiverTransforms;\n\t\t\t\tpc_config[\"forceEncodedAudioInsertableStreams\"] = true;\n\t\t\t\tpc_config[\"forceEncodedVideoInsertableStreams\"] = true;\n\t\t\t\tpc_config[\"encodedInsertableStreams\"] = true;\n\t\t\t}\n\t\t\tJanus.log(\"Creating PeerConnection\");\n\t\t\tJanus.debug(pc_constraints);\n\t\t\tconfig.pc = new RTCPeerConnection(pc_config, pc_constraints);\n\t\t\tJanus.debug(config.pc);\n\t\t\tif(config.pc.getStats) {\t// FIXME\n\t\t\t\tconfig.volume = {};\n\t\t\t\tconfig.bitrate.value = \"0 kbits/sec\";\n\t\t\t}\n\t\t\tJanus.log(\"Preparing local SDP and gathering candidates (trickle=\" + config.trickle + \")\");\n\t\t\tconfig.pc.oniceconnectionstatechange = function(e) {\n\t\t\t\tif(config.pc)\n\t\t\t\t\tpluginHandle.iceState(config.pc.iceConnectionState);\n\t\t\t};\n\t\t\tconfig.pc.onicecandidate = function(event) {\n\t\t\t\tif (!event.candidate ||\n\t\t\t\t\t\t(Janus.webRTCAdapter.browserDetails.browser === 'edge' && event.candidate.candidate.indexOf('endOfCandidates') > 0)) {\n\t\t\t\t\tJanus.log(\"End of candidates.\");\n\t\t\t\t\tconfig.iceDone = true;\n\t\t\t\t\tif(config.trickle === true) {\n\t\t\t\t\t\t// Notify end of candidates\n\t\t\t\t\t\tsendTrickleCandidate(handleId, {\"completed\": true});\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// No trickle, time to send the complete SDP (including all candidates)\n\t\t\t\t\t\tsendSDP(handleId, callbacks);\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\t\tvar candidate = {\n\t\t\t\t\t\t\"candidate\": event.candidate.candidate,\n\t\t\t\t\t\t\"sdpMid\": event.candidate.sdpMid,\n\t\t\t\t\t\t\"sdpMLineIndex\": event.candidate.sdpMLineIndex\n\t\t\t\t\t};\n\t\t\t\t\tif(config.trickle === true) {\n\t\t\t\t\t\t// Send candidate\n\t\t\t\t\t\tsendTrickleCandidate(handleId, candidate);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t};\n\t\t\tconfig.pc.ontrack = function(event) {\n\t\t\t\tJanus.log(\"Handling Remote Track\");\n\t\t\t\tJanus.debug(event);\n\t\t\t\tif(!event.streams)\n\t\t\t\t\treturn;\n\t\t\t\tconfig.remoteStream = event.streams[0];\n\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\tif(event.track.onended)\n\t\t\t\t\treturn;\n\t\t\t\tif(config.receiverTransforms) {\n\t\t\t\t\tvar receiverStreams = null;\n\t\t\t\t\tif(event.track.kind === \"audio\" && config.receiverTransforms[\"audio\"]) {\n\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedAudioStreams();\n\t\t\t\t\t} else if(event.track.kind === \"video\" && config.receiverTransforms[\"video\"]) {\n\t\t\t\t\t\treceiverStreams = event.receiver.createEncodedVideoStreams();\n\t\t\t\t\t}\n\t\t\t\t\tif(receiverStreams) {\n\t\t\t\t\t\treceiverStreams.readableStream\n\t\t\t\t\t\t\t.pipeThrough(config.receiverTransforms[event.track.kind])\n\t\t\t\t\t\t\t.pipeTo(receiverStreams.writableStream);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tvar trackMutedTimeoutId = null;\n\t\t\t\tJanus.log(\"Adding onended callback to track:\", event.track);\n\t\t\t\tevent.track.onended = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track removed:\", ev);\n\t\t\t\t\tif(config.remoteStream) {\n\t\t\t\t\t\tclearTimeout(trackMutedTimeoutId);\n\t\t\t\t\t\tconfig.remoteStream.removeTrack(ev.target);\n\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tevent.track.onmute = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track muted:\", ev);\n\t\t\t\t\tif(config.remoteStream && trackMutedTimeoutId == null) {\n\t\t\t\t\t\ttrackMutedTimeoutId = setTimeout(function() {\n\t\t\t\t\t\t\tJanus.log(\"Removing remote track\");\n\t\t\t\t\t\t\tconfig.remoteStream.removeTrack(ev.target);\n\t\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t\t\ttrackMutedTimeoutId = null;\n\t\t\t\t\t\t// Chrome seems to raise mute events only at multiples of 834ms;\n\t\t\t\t\t\t// we set the timeout to three times this value (rounded to 840ms)\n\t\t\t\t\t\t}, 3 * 840);\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t\tevent.track.onunmute = function(ev) {\n\t\t\t\t\tJanus.log(\"Remote track flowing again:\", ev);\n\t\t\t\t\tif(trackMutedTimeoutId != null) {\n\t\t\t\t\t\tclearTimeout(trackMutedTimeoutId);\n\t\t\t\t\t\ttrackMutedTimeoutId = null;\n\t\t\t\t\t} else {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tconfig.remoteStream.addTrack(ev.target);\n\t\t\t\t\t\t\tpluginHandle.onremotestream(config.remoteStream);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t};\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t};\n\t\t}\n\t\tif(addTracks && stream) {\n\t\t\tJanus.log('Adding local stream');\n\t\t\tvar simulcast2 = (callbacks.simulcast2 === true);\n\t\t\tstream.getTracks().forEach(function(track) {\n\t\t\t\tJanus.log('Adding local track:', track);\n\t\t\t\tif(!simulcast2) {\n\t\t\t\t\tvar sender = config.pc.addTrack(track, stream);\n\t\t\t\t\t// Check if insertable streams are involved\n\t\t\t\t\tif(sender && config.senderTransforms) {\n\t\t\t\t\t\tvar senderStreams = null;\n\t\t\t\t\t\tif(sender.track.kind === \"audio\" && config.senderTransforms[\"audio\"]) {\n\t\t\t\t\t\t\tsenderStreams = sender.createEncodedAudioStreams();\n\t\t\t\t\t\t} else if(sender.track.kind === \"video\" && config.senderTransforms[\"video\"]) {\n\t\t\t\t\t\t\tsenderStreams = sender.createEncodedVideoStreams();\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(senderStreams) {\n\t\t\t\t\t\t\tsenderStreams.readableStream\n\t\t\t\t\t\t\t\t.pipeThrough(config.senderTransforms[sender.track.kind])\n\t\t\t\t\t\t\t\t.pipeTo(senderStreams.writableStream);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(track.kind === \"audio\") {\n\t\t\t\t\t\tconfig.pc.addTrack(track, stream);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tJanus.log('Enabling rid-based simulcasting:', track);\n\t\t\t\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\t\t\t\tconfig.pc.addTransceiver(track, {\n\t\t\t\t\t\t\tdirection: \"sendrecv\",\n\t\t\t\t\t\t\tstreams: [stream],\n\t\t\t\t\t\t\tsendEncodings: [\n\t\t\t\t\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2 },\n\t\t\t\t\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4 }\n\t\t\t\t\t\t\t]\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t// Any data channel to create?\n\t\tif(isDataEnabled(media) && !config.dataChannel[Janus.dataChanDefaultLabel]) {\n\t\t\tJanus.log(\"Creating default data channel\");\n\t\t\tcreateDataChannel(handleId, Janus.dataChanDefaultLabel, null, false);\n\t\t\tconfig.pc.ondatachannel = function(event) {\n\t\t\t\tJanus.log(\"Data channel created by Janus:\", event);\n\t\t\t\tcreateDataChannel(handleId, event.channel.label, event.channel.protocol, event.channel);\n\t\t\t};\n\t\t}\n\t\t// If there's a new local stream, let's notify the application\n\t\tif(config.myStream) {\n\t\t\tpluginHandle.onlocalstream(config.myStream);\n\t\t}\n\t\t// Create offer/answer now\n\t\tif(!jsep) {\n\t\t\tcreateOffer(handleId, media, callbacks);\n\t\t} else {\n\t\t\tconfig.pc.setRemoteDescription(jsep)\n\t\t\t\t.then(function() {\n\t\t\t\t\tJanus.log(\"Remote description accepted!\");\n\t\t\t\t\tconfig.remoteSdp = jsep.sdp;\n\t\t\t\t\t// Any trickle candidate we cached?\n\t\t\t\t\tif(config.candidates && config.candidates.length > 0) {\n\t\t\t\t\t\tfor(var i = 0; i< config.candidates.length; i++) {\n\t\t\t\t\t\t\tvar candidate = config.candidates[i];\n\t\t\t\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t\t\t\t// end-of-candidates\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// New candidate\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig.candidates = [];\n\t\t\t\t\t}\n\t\t\t\t\t// Create the answer now\n\t\t\t\t\tcreateAnswer(handleId, media, callbacks);\n\t\t\t\t}, callbacks.error);\n\t\t}\n\t}\n\n\tfunction prepareWebrtc(handleId, offer, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : webrtcError;\n\t\tvar jsep = callbacks.jsep;\n\t\tif(offer && jsep) {\n\t\t\tJanus.error(\"Provided a JSEP to a createOffer\");\n\t\t\tcallbacks.error(\"Provided a JSEP to a createOffer\");\n\t\t\treturn;\n\t\t} else if(!offer && (!jsep || !jsep.type || !jsep.sdp)) {\n\t\t\tJanus.error(\"A valid JSEP is required for createAnswer\");\n\t\t\tcallbacks.error(\"A valid JSEP is required for createAnswer\");\n\t\t\treturn;\n\t\t}\n\t\t/* Check that callbacks.media is a (not null) Object */\n\t\tcallbacks.media = (typeof callbacks.media === 'object' && callbacks.media) ? callbacks.media : { audio: true, video: true };\n\t\tvar media = callbacks.media;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tconfig.trickle = isTrickleEnabled(callbacks.trickle);\n\t\t// Are we updating a session?\n\t\tif(!config.pc) {\n\t\t\t// Nope, new PeerConnection\n\t\t\tmedia.update = false;\n\t\t\tmedia.keepAudio = false;\n\t\t\tmedia.keepVideo = false;\n\t\t} else {\n\t\t\tJanus.log(\"Updating existing media session\");\n\t\t\tmedia.update = true;\n\t\t\t// Check if there's anything to add/remove/replace, or if we\n\t\t\t// can go directly to preparing the new SDP offer or answer\n\t\t\tif(callbacks.stream) {\n\t\t\t\t// External stream: is this the same as the one we were using before?\n\t\t\t\tif(callbacks.stream !== config.myStream) {\n\t\t\t\t\tJanus.log(\"Renegotiation involves a new external stream\");\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Check if there are changes on audio\n\t\t\t\tif(media.addAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\tmedia.removeAudio = false;\n\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\tif(config.myStream && config.myStream.getAudioTracks() && config.myStream.getAudioTracks().length) {\n\t\t\t\t\t\tJanus.error(\"Can't add audio stream, there already is one\");\n\t\t\t\t\t\tcallbacks.error(\"Can't add audio stream, there already is one\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if(media.removeAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\tmedia.addAudio = false;\n\t\t\t\t\tmedia.audioSend = false;\n\t\t\t\t} else if(media.replaceAudio) {\n\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\tmedia.addAudio = false;\n\t\t\t\t\tmedia.removeAudio = false;\n\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t}\n\t\t\t\tif(!config.myStream) {\n\t\t\t\t\t// No media stream: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\tif(media.replaceAudio) {\n\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(isAudioSendEnabled(media)) {\n\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\t\t\t// No audio track: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\t\tif(media.replaceAudio) {\n\t\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\t\tmedia.replaceAudio = false;\n\t\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\t\tmedia.audioSend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isAudioSendEnabled(media)) {\n\t\t\t\t\t\t\tmedia.keepAudio = false;\n\t\t\t\t\t\t\tmedia.addAudio = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We have an audio track: should we keep it as it is?\n\t\t\t\t\t\tif(isAudioSendEnabled(media) &&\n\t\t\t\t\t\t\t\t!media.removeAudio && !media.replaceAudio) {\n\t\t\t\t\t\t\tmedia.keepAudio = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Check if there are changes on video\n\t\t\t\tif(media.addVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\tmedia.removeVideo = false;\n\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\tif(config.myStream && config.myStream.getVideoTracks() && config.myStream.getVideoTracks().length) {\n\t\t\t\t\t\tJanus.error(\"Can't add video stream, there already is one\");\n\t\t\t\t\t\tcallbacks.error(\"Can't add video stream, there already is one\");\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t} else if(media.removeVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\tmedia.addVideo = false;\n\t\t\t\t\tmedia.videoSend = false;\n\t\t\t\t} else if(media.replaceVideo) {\n\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\tmedia.addVideo = false;\n\t\t\t\t\tmedia.removeVideo = false;\n\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t}\n\t\t\t\tif(!config.myStream) {\n\t\t\t\t\t// No media stream: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\tif(media.replaceVideo) {\n\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\t}\n\t\t\t\t\tif(isVideoSendEnabled(media)) {\n\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\t\t\t// No video track: if we were asked to replace, it's actually an \"add\"\n\t\t\t\t\t\tif(media.replaceVideo) {\n\t\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\t\tmedia.replaceVideo = false;\n\t\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\t\tmedia.videoSend = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(isVideoSendEnabled(media)) {\n\t\t\t\t\t\t\tmedia.keepVideo = false;\n\t\t\t\t\t\t\tmedia.addVideo = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We have a video track: should we keep it as it is?\n\t\t\t\t\t\tif(isVideoSendEnabled(media) && !media.removeVideo && !media.replaceVideo) {\n\t\t\t\t\t\t\tmedia.keepVideo = true;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\t// Data channels can only be added\n\t\t\t\tif(media.addData) {\n\t\t\t\t\tmedia.data = true;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we're updating and keeping all tracks, let's skip the getUserMedia part\n\t\t\tif((isAudioSendEnabled(media) && media.keepAudio) &&\n\t\t\t\t\t(isVideoSendEnabled(media) && media.keepVideo)) {\n\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, config.myStream);\n\t\t\t\treturn;\n\t\t\t}\n\t\t}\n\t\t// If we're updating, check if we need to remove/replace one of the tracks\n\t\tif(media.update && !config.streamExternal) {\n\t\t\tif(media.removeAudio || media.replaceAudio) {\n\t\t\t\tif(config.myStream && config.myStream.getAudioTracks() && config.myStream.getAudioTracks().length) {\n\t\t\t\t\tvar at = config.myStream.getAudioTracks()[0];\n\t\t\t\t\tJanus.log(\"Removing audio track:\", at);\n\t\t\t\t\tconfig.myStream.removeTrack(at);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tat.stop();\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\tif(config.pc.getSenders() && config.pc.getSenders().length) {\n\t\t\t\t\tvar ra = true;\n\t\t\t\t\tif(media.replaceAudio && Janus.unifiedPlan) {\n\t\t\t\t\t\t// We can use replaceTrack\n\t\t\t\t\t\tra = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(ra) {\n\t\t\t\t\t\tfor(var asnd of config.pc.getSenders()) {\n\t\t\t\t\t\t\tif(asnd && asnd.track && asnd.track.kind === \"audio\") {\n\t\t\t\t\t\t\t\tJanus.log(\"Removing audio sender:\", asnd);\n\t\t\t\t\t\t\t\tconfig.pc.removeTrack(asnd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(media.removeVideo || media.replaceVideo) {\n\t\t\t\tif(config.myStream && config.myStream.getVideoTracks() && config.myStream.getVideoTracks().length) {\n\t\t\t\t\tvar vt = config.myStream.getVideoTracks()[0];\n\t\t\t\t\tJanus.log(\"Removing video track:\", vt);\n\t\t\t\t\tconfig.myStream.removeTrack(vt);\n\t\t\t\t\ttry {\n\t\t\t\t\t\tvt.stop();\n\t\t\t\t\t} catch(e) {}\n\t\t\t\t}\n\t\t\t\tif(config.pc.getSenders() && config.pc.getSenders().length) {\n\t\t\t\t\tvar rv = true;\n\t\t\t\t\tif(media.replaceVideo && Janus.unifiedPlan) {\n\t\t\t\t\t\t// We can use replaceTrack\n\t\t\t\t\t\trv = false;\n\t\t\t\t\t}\n\t\t\t\t\tif(rv) {\n\t\t\t\t\t\tfor(var vsnd of config.pc.getSenders()) {\n\t\t\t\t\t\t\tif(vsnd && vsnd.track && vsnd.track.kind === \"video\") {\n\t\t\t\t\t\t\t\tJanus.log(\"Removing video sender:\", vsnd);\n\t\t\t\t\t\t\t\tconfig.pc.removeTrack(vsnd);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\t// Was a MediaStream object passed, or do we need to take care of that?\n\t\tif(callbacks.stream) {\n\t\t\tvar stream = callbacks.stream;\n\t\t\tJanus.log(\"MediaStream provided by the application\");\n\t\t\tJanus.debug(stream);\n\t\t\t// If this is an update, let's check if we need to release the previous stream\n\t\t\tif(media.update) {\n\t\t\t\tif(config.myStream && config.myStream !== callbacks.stream && !config.streamExternal) {\n\t\t\t\t\t// We're replacing a stream we captured ourselves with an external one\n\t\t\t\t\ttry {\n\t\t\t\t\t\t// Try a MediaStreamTrack.stop() for each track\n\t\t\t\t\t\tvar tracks = config.myStream.getTracks();\n\t\t\t\t\t\tfor(var mst of tracks) {\n\t\t\t\t\t\t\tJanus.log(mst);\n\t\t\t\t\t\t\tif(mst)\n\t\t\t\t\t\t\t\tmst.stop();\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t// Do nothing if this fails\n\t\t\t\t\t}\n\t\t\t\t\tconfig.myStream = null;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Skip the getUserMedia part\n\t\t\tconfig.streamExternal = true;\n\t\t\tpluginHandle.consentDialog(false);\n\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\treturn;\n\t\t}\n\t\tif(isAudioSendEnabled(media) || isVideoSendEnabled(media)) {\n\t\t\tif(!Janus.isGetUserMediaAvailable()) {\n\t\t\t\tcallbacks.error(\"getUserMedia not available\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tvar constraints = { mandatory: {}, optional: []};\n\t\t\tpluginHandle.consentDialog(true);\n\t\t\tvar audioSupport = isAudioSendEnabled(media);\n\t\t\tif(audioSupport && media && typeof media.audio === 'object')\n\t\t\t\taudioSupport = media.audio;\n\t\t\tvar videoSupport = isVideoSendEnabled(media);\n\t\t\tif(videoSupport && media) {\n\t\t\t\tvar simulcast = (callbacks.simulcast === true);\n\t\t\t\tvar simulcast2 = (callbacks.simulcast2 === true);\n\t\t\t\tif((simulcast || simulcast2) && !jsep && !media.video)\n\t\t\t\t\tmedia.video = \"hires\";\n\t\t\t\tif(media.video && media.video != 'screen' && media.video != 'window') {\n\t\t\t\t\tif(typeof media.video === 'object') {\n\t\t\t\t\t\tvideoSupport = media.video;\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvar width = 0;\n\t\t\t\t\t\tvar height = 0, maxHeight = 0;\n\t\t\t\t\t\tif(media.video === 'lowres') {\n\t\t\t\t\t\t\t// Small resolution, 4:3\n\t\t\t\t\t\t\theight = 240;\n\t\t\t\t\t\t\tmaxHeight = 240;\n\t\t\t\t\t\t\twidth = 320;\n\t\t\t\t\t\t} else if(media.video === 'lowres-16:9') {\n\t\t\t\t\t\t\t// Small resolution, 16:9\n\t\t\t\t\t\t\theight = 180;\n\t\t\t\t\t\t\tmaxHeight = 180;\n\t\t\t\t\t\t\twidth = 320;\n\t\t\t\t\t\t} else if(media.video === 'hires' || media.video === 'hires-16:9' || media.video === 'hdres') {\n\t\t\t\t\t\t\t// High(HD) resolution is only 16:9\n\t\t\t\t\t\t\theight = 720;\n\t\t\t\t\t\t\tmaxHeight = 720;\n\t\t\t\t\t\t\twidth = 1280;\n\t\t\t\t\t\t} else if(media.video === 'fhdres') {\n\t\t\t\t\t\t\t// Full HD resolution is only 16:9\n\t\t\t\t\t\t\theight = 1080;\n\t\t\t\t\t\t\tmaxHeight = 1080;\n\t\t\t\t\t\t\twidth = 1920;\n\t\t\t\t\t\t} else if(media.video === '4kres') {\n\t\t\t\t\t\t\t// 4K resolution is only 16:9\n\t\t\t\t\t\t\theight = 2160;\n\t\t\t\t\t\t\tmaxHeight = 2160;\n\t\t\t\t\t\t\twidth = 3840;\n\t\t\t\t\t\t} else if(media.video === 'stdres') {\n\t\t\t\t\t\t\t// Normal resolution, 4:3\n\t\t\t\t\t\t\theight = 480;\n\t\t\t\t\t\t\tmaxHeight = 480;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t} else if(media.video === 'stdres-16:9') {\n\t\t\t\t\t\t\t// Normal resolution, 16:9\n\t\t\t\t\t\t\theight = 360;\n\t\t\t\t\t\t\tmaxHeight = 360;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tJanus.log(\"Default video setting is stdres 4:3\");\n\t\t\t\t\t\t\theight = 480;\n\t\t\t\t\t\t\tmaxHeight = 480;\n\t\t\t\t\t\t\twidth = 640;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Adding media constraint:\", media.video);\n\t\t\t\t\t\tvideoSupport = {\n\t\t\t\t\t\t\t'height': {'ideal': height},\n\t\t\t\t\t\t\t'width': {'ideal': width}\n\t\t\t\t\t\t};\n\t\t\t\t\t\tJanus.log(\"Adding video constraint:\", videoSupport);\n\t\t\t\t\t}\n\t\t\t\t} else if(media.video === 'screen' || media.video === 'window') {\n\t\t\t\t\tif(navigator.mediaDevices && navigator.mediaDevices.getDisplayMedia) {\n\t\t\t\t\t\t// The new experimental getDisplayMedia API is available, let's use that\n\t\t\t\t\t\t// https://groups.google.com/forum/#!topic/discuss-webrtc/Uf0SrR4uxzk\n\t\t\t\t\t\t// https://webrtchacks.com/chrome-screensharing-getdisplaymedia/\n\t\t\t\t\t\tconstraints.video = {};\n\t\t\t\t\t\tif(media.screenshareFrameRate) {\n\t\t\t\t\t\t\tconstraints.video.frameRate = media.screenshareFrameRate;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(media.screenshareHeight) {\n\t\t\t\t\t\t\tconstraints.video.height = media.screenshareHeight;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tif(media.screenshareWidth) {\n\t\t\t\t\t\t\tconstraints.video.width = media.screenshareWidth;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconstraints.audio = media.captureDesktopAudio;\n\t\t\t\t\t\tnavigator.mediaDevices.getDisplayMedia(constraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tif(isAudioSendEnabled(media) && !media.keepAudio) {\n\t\t\t\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia({ audio: true, video: false })\n\t\t\t\t\t\t\t\t\t.then(function (audioStream) {\n\t\t\t\t\t\t\t\t\t\tstream.addTrack(audioStream.getAudioTracks()[0]);\n\t\t\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t}, function (error) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\treturn;\n\t\t\t\t\t}\n\t\t\t\t\t// We're going to try and use the extension for Chrome 34+, the old approach\n\t\t\t\t\t// for older versions of Chrome, or the experimental support in Firefox 33+\n\t\t\t\t\tfunction callbackUserMedia (error, stream) {\n\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\tif(error) {\n\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tfunction getScreenMedia(constraints, gsmCallback, useAudio) {\n\t\t\t\t\t\tJanus.log(\"Adding media constraint (screen capture)\");\n\t\t\t\t\t\tJanus.debug(constraints);\n\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia(constraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tif(useAudio) {\n\t\t\t\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia({ audio: true, video: false })\n\t\t\t\t\t\t\t\t\t.then(function (audioStream) {\n\t\t\t\t\t\t\t\t\t\tstream.addTrack(audioStream.getAudioTracks()[0]);\n\t\t\t\t\t\t\t\t\t\tgsmCallback(null, stream);\n\t\t\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\tgsmCallback(null, stream);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t})\n\t\t\t\t\t\t\t.catch(function(error) { pluginHandle.consentDialog(false); gsmCallback(error); });\n\t\t\t\t\t}\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === 'chrome') {\n\t\t\t\t\t\tvar chromever = Janus.webRTCAdapter.browserDetails.version;\n\t\t\t\t\t\tvar maxver = 33;\n\t\t\t\t\t\tif(window.navigator.userAgent.match('Linux'))\n\t\t\t\t\t\t\tmaxver = 35;\t// \"known\" crash in chrome 34 and 35 on linux\n\t\t\t\t\t\tif(chromever >= 26 && chromever <= maxver) {\n\t\t\t\t\t\t\t// Chrome 26->33 requires some awkward chrome://flags manipulation\n\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\tmandatory: {\n\t\t\t\t\t\t\t\t\t\tgoogLeakyBucket: true,\n\t\t\t\t\t\t\t\t\t\tmaxWidth: window.screen.width,\n\t\t\t\t\t\t\t\t\t\tmaxHeight: window.screen.height,\n\t\t\t\t\t\t\t\t\t\tminFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\tmaxFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\tchromeMediaSource: 'screen'\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taudio: isAudioSendEnabled(media) && !media.keepAudio\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tgetScreenMedia(constraints, callbackUserMedia);\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// Chrome 34+ requires an extension\n\t\t\t\t\t\t\tJanus.extension.getScreen(function (error, sourceId) {\n\t\t\t\t\t\t\t\tif (error) {\n\t\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\t\treturn callbacks.error(error);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\t\taudio: false,\n\t\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\t\tmandatory: {\n\t\t\t\t\t\t\t\t\t\t\tchromeMediaSource: 'desktop',\n\t\t\t\t\t\t\t\t\t\t\tmaxWidth: window.screen.width,\n\t\t\t\t\t\t\t\t\t\t\tmaxHeight: window.screen.height,\n\t\t\t\t\t\t\t\t\t\t\tminFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\t\tmaxFrameRate: media.screenshareFrameRate,\n\t\t\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\t\t\toptional: [\n\t\t\t\t\t\t\t\t\t\t\t{googLeakyBucket: true},\n\t\t\t\t\t\t\t\t\t\t\t{googTemporalLayeredScreencast: true}\n\t\t\t\t\t\t\t\t\t\t]\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\t\tconstraints.video.mandatory.chromeMediaSourceId = sourceId;\n\t\t\t\t\t\t\t\tgetScreenMedia(constraints, callbackUserMedia,\n\t\t\t\t\t\t\t\t\tisAudioSendEnabled(media) && !media.keepAudio);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t}\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser === 'firefox') {\n\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.version >= 33) {\n\t\t\t\t\t\t\t// Firefox 33+ has experimental support for screen sharing\n\t\t\t\t\t\t\tconstraints = {\n\t\t\t\t\t\t\t\tvideo: {\n\t\t\t\t\t\t\t\t\tmozMediaSource: media.video,\n\t\t\t\t\t\t\t\t\tmediaSource: media.video\n\t\t\t\t\t\t\t\t},\n\t\t\t\t\t\t\t\taudio: isAudioSendEnabled(media) && !media.keepAudio\n\t\t\t\t\t\t\t};\n\t\t\t\t\t\t\tgetScreenMedia(constraints, function (err, stream) {\n\t\t\t\t\t\t\t\tcallbackUserMedia(err, stream);\n\t\t\t\t\t\t\t\t// Workaround for https://bugzilla.mozilla.org/show_bug.cgi?id=1045810\n\t\t\t\t\t\t\t\tif (!err) {\n\t\t\t\t\t\t\t\t\tvar lastTime = stream.currentTime;\n\t\t\t\t\t\t\t\t\tvar polly = window.setInterval(function () {\n\t\t\t\t\t\t\t\t\t\tif(!stream)\n\t\t\t\t\t\t\t\t\t\t\twindow.clearInterval(polly);\n\t\t\t\t\t\t\t\t\t\tif(stream.currentTime == lastTime) {\n\t\t\t\t\t\t\t\t\t\t\twindow.clearInterval(polly);\n\t\t\t\t\t\t\t\t\t\t\tif(stream.onended) {\n\t\t\t\t\t\t\t\t\t\t\t\tstream.onended();\n\t\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t\t\tlastTime = stream.currentTime;\n\t\t\t\t\t\t\t\t\t}, 500);\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvar error = new Error('NavigatorUserMediaError');\n\t\t\t\t\t\t\terror.name = 'Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)';\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error(error);\n\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t}\n\t\t\t// If we got here, we're not screensharing\n\t\t\tif(!media || media.video !== 'screen') {\n\t\t\t\t// Check whether all media sources are actually available or not\n\t\t\t\tnavigator.mediaDevices.enumerateDevices().then(function(devices) {\n\t\t\t\t\tvar audioExist = devices.some(function(device) {\n\t\t\t\t\t\treturn device.kind === 'audioinput';\n\t\t\t\t\t}),\n\t\t\t\t\tvideoExist = isScreenSendEnabled(media) || devices.some(function(device) {\n\t\t\t\t\t\treturn device.kind === 'videoinput';\n\t\t\t\t\t});\n\n\t\t\t\t\t// Check whether a missing device is really a problem\n\t\t\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\t\t\tvar needAudioDevice = isAudioSendRequired(media);\n\t\t\t\t\tvar needVideoDevice = isVideoSendRequired(media);\n\t\t\t\t\tif(audioSend || videoSend || needAudioDevice || needVideoDevice) {\n\t\t\t\t\t\t// We need to send either audio or video\n\t\t\t\t\t\tvar haveAudioDevice = audioSend ? audioExist : false;\n\t\t\t\t\t\tvar haveVideoDevice = videoSend ? videoExist : false;\n\t\t\t\t\t\tif(!haveAudioDevice && !haveVideoDevice) {\n\t\t\t\t\t\t\t// FIXME Should we really give up, or just assume recvonly for both?\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('No capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if(!haveAudioDevice && needAudioDevice) {\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('Audio capture is required, but no capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t} else if(!haveVideoDevice && needVideoDevice) {\n\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\tcallbacks.error('Video capture is required, but no capture device found');\n\t\t\t\t\t\t\treturn false;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\n\t\t\t\t\tvar gumConstraints = {\n\t\t\t\t\t\taudio: (audioExist && !media.keepAudio) ? audioSupport : false,\n\t\t\t\t\t\tvideo: (videoExist && !media.keepVideo) ? videoSupport : false\n\t\t\t\t\t};\n\t\t\t\t\tJanus.debug(\"getUserMedia constraints\", gumConstraints);\n\t\t\t\t\tif (!gumConstraints.audio && !gumConstraints.video) {\n\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t} else {\n\t\t\t\t\t\tnavigator.mediaDevices.getUserMedia(gumConstraints)\n\t\t\t\t\t\t\t.then(function(stream) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tstreamsDone(handleId, jsep, media, callbacks, stream);\n\t\t\t\t\t\t\t}).catch(function(error) {\n\t\t\t\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\t\t\t\tcallbacks.error({code: error.code, name: error.name, message: error.message});\n\t\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t})\n\t\t\t\t.catch(function(error) {\n\t\t\t\t\tpluginHandle.consentDialog(false);\n\t\t\t\t\tcallbacks.error('enumerateDevices error', error);\n\t\t\t\t});\n\t\t\t}\n\t\t} else {\n\t\t\t// No need to do a getUserMedia, create offer/answer right away\n\t\t\tstreamsDone(handleId, jsep, media, callbacks);\n\t\t}\n\t}\n\n\tfunction prepareWebrtcPeer(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : webrtcError;\n\t\tvar jsep = callbacks.jsep;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(jsep) {\n\t\t\tif(!config.pc) {\n\t\t\t\tJanus.warn(\"Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep\");\n\t\t\t\tcallbacks.error(\"No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep\");\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tconfig.pc.setRemoteDescription(jsep)\n\t\t\t\t.then(function() {\n\t\t\t\t\tJanus.log(\"Remote description accepted!\");\n\t\t\t\t\tconfig.remoteSdp = jsep.sdp;\n\t\t\t\t\t// Any trickle candidate we cached?\n\t\t\t\t\tif(config.candidates && config.candidates.length > 0) {\n\t\t\t\t\t\tfor(var i = 0; i< config.candidates.length; i++) {\n\t\t\t\t\t\t\tvar candidate = config.candidates[i];\n\t\t\t\t\t\t\tJanus.debug(\"Adding remote candidate:\", candidate);\n\t\t\t\t\t\t\tif(!candidate || candidate.completed === true) {\n\t\t\t\t\t\t\t\t// end-of-candidates\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(Janus.endOfCandidates);\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t// New candidate\n\t\t\t\t\t\t\t\tconfig.pc.addIceCandidate(candidate);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t\tconfig.candidates = [];\n\t\t\t\t\t}\n\t\t\t\t\t// Done\n\t\t\t\t\tcallbacks.success();\n\t\t\t\t}, callbacks.error);\n\t\t} else {\n\t\t\tcallbacks.error(\"Invalid JSEP\");\n\t\t}\n\t}\n\n\tfunction createOffer(handleId, media, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.customizeSdp = (typeof callbacks.customizeSdp == \"function\") ? callbacks.customizeSdp : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar simulcast = (callbacks.simulcast === true);\n\t\tif(!simulcast) {\n\t\t\tJanus.log(\"Creating offer (iceDone=\" + config.iceDone + \")\");\n\t\t} else {\n\t\t\tJanus.log(\"Creating offer (iceDone=\" + config.iceDone + \", simulcast=\" + simulcast + \")\");\n\t\t}\n\t\t// https://code.google.com/p/webrtc/issues/detail?id=3508\n\t\tvar mediaConstraints = {};\n\t\tif(Janus.unifiedPlan) {\n\t\t\t// We can use Transceivers\n\t\t\tvar audioTransceiver = null, videoTransceiver = null;\n\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\tif(!audioTransceiver) {\n\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\tif(!videoTransceiver) {\n\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\t}\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle audio (and related changes, if any)\n\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\tvar audioRecv = isAudioRecvEnabled(media);\n\t\t\tif(!audioSend && !audioRecv) {\n\t\t\t\t// Audio disabled: have we removed it?\n\t\t\t\tif(media.removeAudio && audioTransceiver) {\n\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\taudioTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\taudioTransceiver.direction = \"inactive\";\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Setting audio transceiver to inactive:\", audioTransceiver);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of audio m-line\n\t\t\t\tif(audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendrecv:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(audioSend && !audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendonly:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(!audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to recvonly:\", audioTransceiver);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\taudioTransceiver = config.pc.addTransceiver(\"audio\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly audio transceiver:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle video (and related changes, if any)\n\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\tvar videoRecv = isVideoRecvEnabled(media);\n\t\t\tif(!videoSend && !videoRecv) {\n\t\t\t\t// Video disabled: have we removed it?\n\t\t\t\tif(media.removeVideo && videoTransceiver) {\n\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\tvideoTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t} else {\n\t\t\t\t\t\tvideoTransceiver.direction = \"inactive\";\n\t\t\t\t\t}\n\t\t\t\t\tJanus.log(\"Setting video transceiver to inactive:\", videoTransceiver);\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of video m-line\n\t\t\t\tif(videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendrecv:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(videoSend && !videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendonly:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t} else if(!videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to recvonly:\", videoTransceiver);\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\tvideoTransceiver = config.pc.addTransceiver(\"video\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly video transceiver:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tmediaConstraints[\"offerToReceiveAudio\"] = isAudioRecvEnabled(media);\n\t\t\tmediaConstraints[\"offerToReceiveVideo\"] = isVideoRecvEnabled(media);\n\t\t}\n\t\tvar iceRestart = (callbacks.iceRestart === true);\n\t\tif(iceRestart) {\n\t\t\tmediaConstraints[\"iceRestart\"] = true;\n\t\t}\n\t\tJanus.debug(mediaConstraints);\n\t\t// Check if this is Firefox and we've been asked to do simulcasting\n\t\tvar sendVideo = isVideoSendEnabled(media);\n\t\tif(sendVideo && simulcast && Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n\t\t\t// FIXME Based on https://gist.github.com/voluntas/088bc3cc62094730647b\n\t\t\tJanus.log(\"Enabling Simulcasting for Firefox (RID)\");\n\t\t\tvar sender = config.pc.getSenders().find(function(s) {return s.track.kind === \"video\"});\n\t\t\tif(sender) {\n\t\t\t\tvar parameters = sender.getParameters();\n\t\t\t\tif(!parameters) {\n\t\t\t\t\tparameters = {};\n\t\t\t\t}\n\t\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\t\tparameters.encodings = [\n\t\t\t\t\t{ rid: \"h\", active: true, maxBitrate: maxBitrates.high },\n\t\t\t\t\t{ rid: \"m\", active: true, maxBitrate: maxBitrates.medium, scaleResolutionDownBy: 2 },\n\t\t\t\t\t{ rid: \"l\", active: true, maxBitrate: maxBitrates.low, scaleResolutionDownBy: 4 }\n\t\t\t\t];\n\t\t\t\tsender.setParameters(parameters);\n\t\t\t}\n\t\t}\n\t\tconfig.pc.createOffer(mediaConstraints)\n\t\t\t.then(function(offer) {\n\t\t\t\tJanus.debug(offer);\n\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\tvar jsep = {\n\t\t\t\t\t\"type\": offer.type,\n\t\t\t\t\t\"sdp\": offer.sdp\n\t\t\t\t};\n\t\t\t\tcallbacks.customizeSdp(jsep);\n\t\t\t\toffer.sdp = jsep.sdp;\n\t\t\t\tJanus.log(\"Setting local description\");\n\t\t\t\tif(sendVideo && simulcast) {\n\t\t\t\t\t// This SDP munging only works with Chrome (Safari STP may support it too)\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\" ||\n\t\t\t\t\t\t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\") {\n\t\t\t\t\t\tJanus.log(\"Enabling Simulcasting for Chrome (SDP munging)\");\n\t\t\t\t\t\toffer.sdp = mungeSdpForSimulcasting(offer.sdp);\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser !== \"firefox\") {\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is not Chrome nor Firefox, ignoring\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconfig.mySdp = offer.sdp;\n\t\t\t\tconfig.pc.setLocalDescription(offer)\n\t\t\t\t\t.catch(callbacks.error);\n\t\t\t\tconfig.mediaConstraints = mediaConstraints;\n\t\t\t\tif(!config.iceDone && !config.trickle) {\n\t\t\t\t\t// Don't do anything until we have all candidates\n\t\t\t\t\tJanus.log(\"Waiting for all candidates...\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If transforms are present, notify Janus that the media is end-to-end encrypted\n\t\t\t\tif(config.senderTransforms || config.receiverTransforms) {\n\t\t\t\t\toffer[\"e2ee\"] = true;\n\t\t\t\t}\n\t\t\t\tcallbacks.success(offer);\n\t\t\t}, callbacks.error);\n\t}\n\n\tfunction createAnswer(handleId, media, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tcallbacks.customizeSdp = (typeof callbacks.customizeSdp == \"function\") ? callbacks.customizeSdp : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\tcallbacks.error(\"Invalid handle\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tvar simulcast = (callbacks.simulcast === true);\n\t\tif(!simulcast) {\n\t\t\tJanus.log(\"Creating answer (iceDone=\" + config.iceDone + \")\");\n\t\t} else {\n\t\t\tJanus.log(\"Creating answer (iceDone=\" + config.iceDone + \", simulcast=\" + simulcast + \")\");\n\t\t}\n\t\tvar mediaConstraints = null;\n\t\tif(Janus.unifiedPlan) {\n\t\t\t// We can use Transceivers\n\t\t\tmediaConstraints = {};\n\t\t\tvar audioTransceiver = null, videoTransceiver = null;\n\t\t\tvar transceivers = config.pc.getTransceivers();\n\t\t\tif(transceivers && transceivers.length > 0) {\n\t\t\t\tfor(var t of transceivers) {\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"audio\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"audio\")) {\n\t\t\t\t\t\tif(!audioTransceiver)\n\t\t\t\t\t\t\taudioTransceiver = t;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif((t.sender && t.sender.track && t.sender.track.kind === \"video\") ||\n\t\t\t\t\t\t\t(t.receiver && t.receiver.track && t.receiver.track.kind === \"video\")) {\n\t\t\t\t\t\tif(!videoTransceiver)\n\t\t\t\t\t\t\tvideoTransceiver = t;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle audio (and related changes, if any)\n\t\t\tvar audioSend = isAudioSendEnabled(media);\n\t\t\tvar audioRecv = isAudioRecvEnabled(media);\n\t\t\tif(!audioSend && !audioRecv) {\n\t\t\t\t// Audio disabled: have we removed it?\n\t\t\t\tif(media.removeAudio && audioTransceiver) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\taudioTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\taudioTransceiver.direction = \"inactive\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to inactive:\", audioTransceiver);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of audio m-line\n\t\t\t\tif(audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendrecv:\", audioTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(audioSend && !audioRecv) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to sendonly:\", audioTransceiver);\n\t\t\t\t\t\t}\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t} else if(!audioSend && audioRecv) {\n\t\t\t\t\tif(audioTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (audioTransceiver.setDirection) {\n\t\t\t\t\t\t\t\taudioTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\taudioTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting audio transceiver to recvonly:\", audioTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\taudioTransceiver = config.pc.addTransceiver(\"audio\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly audio transceiver:\", audioTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Handle video (and related changes, if any)\n\t\t\tvar videoSend = isVideoSendEnabled(media);\n\t\t\tvar videoRecv = isVideoRecvEnabled(media);\n\t\t\tif(!videoSend && !videoRecv) {\n\t\t\t\t// Video disabled: have we removed it?\n\t\t\t\tif(media.removeVideo && videoTransceiver) {\n\t\t\t\t\ttry {\n\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"inactive\");\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\tvideoTransceiver.direction = \"inactive\";\n\t\t\t\t\t\t}\n\t\t\t\t\t\tJanus.log(\"Setting video transceiver to inactive:\", videoTransceiver);\n\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} else {\n\t\t\t\t// Take care of video m-line\n\t\t\t\tif(videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendrecv\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendrecv\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendrecv:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(videoSend && !videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"sendonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"sendonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to sendonly:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t} else if(!videoSend && videoRecv) {\n\t\t\t\t\tif(videoTransceiver) {\n\t\t\t\t\t\ttry {\n\t\t\t\t\t\t\tif (videoTransceiver.setDirection) {\n\t\t\t\t\t\t\t\tvideoTransceiver.setDirection(\"recvonly\");\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tvideoTransceiver.direction = \"recvonly\";\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\tJanus.log(\"Setting video transceiver to recvonly:\", videoTransceiver);\n\t\t\t\t\t\t} catch(e) {\n\t\t\t\t\t\t\tJanus.error(e);\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// In theory, this is the only case where we might not have a transceiver yet\n\t\t\t\t\t\tvideoTransceiver = config.pc.addTransceiver(\"video\", { direction: \"recvonly\" });\n\t\t\t\t\t\tJanus.log(\"Adding recvonly video transceiver:\", videoTransceiver);\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t}\n\t\t} else {\n\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"firefox\" || Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\t\tmediaConstraints = {\n\t\t\t\t\tofferToReceiveAudio: isAudioRecvEnabled(media),\n\t\t\t\t\tofferToReceiveVideo: isVideoRecvEnabled(media)\n\t\t\t\t};\n\t\t\t} else {\n\t\t\t\tmediaConstraints = {\n\t\t\t\t\tmandatory: {\n\t\t\t\t\t\tOfferToReceiveAudio: isAudioRecvEnabled(media),\n\t\t\t\t\t\tOfferToReceiveVideo: isVideoRecvEnabled(media)\n\t\t\t\t\t}\n\t\t\t\t};\n\t\t\t}\n\t\t}\n\t\tJanus.debug(mediaConstraints);\n\t\t// Check if this is Firefox and we've been asked to do simulcasting\n\t\tvar sendVideo = isVideoSendEnabled(media);\n\t\tif(sendVideo && simulcast && Janus.webRTCAdapter.browserDetails.browser === \"firefox\") {\n\t\t\t// FIXME Based on https://gist.github.com/voluntas/088bc3cc62094730647b\n\t\t\tJanus.log(\"Enabling Simulcasting for Firefox (RID)\");\n\t\t\tvar sender = config.pc.getSenders()[1];\n\t\t\tJanus.log(sender);\n\t\t\tvar parameters = sender.getParameters();\n\t\t\tJanus.log(parameters);\n\n\t\t\tvar maxBitrates = getMaxBitrates(callbacks.simulcastMaxBitrates);\n\t\t\tsender.setParameters({encodings: [\n\t\t\t\t{ rid: \"high\", active: true, priority: \"high\", maxBitrate: maxBitrates.high },\n\t\t\t\t{ rid: \"medium\", active: true, priority: \"medium\", maxBitrate: maxBitrates.medium },\n\t\t\t\t{ rid: \"low\", active: true, priority: \"low\", maxBitrate: maxBitrates.low }\n\t\t\t]});\n\t\t}\n\t\tconfig.pc.createAnswer(mediaConstraints)\n\t\t\t.then(function(answer) {\n\t\t\t\tJanus.debug(answer);\n\t\t\t\t// JSON.stringify doesn't work on some WebRTC objects anymore\n\t\t\t\t// See https://code.google.com/p/chromium/issues/detail?id=467366\n\t\t\t\tvar jsep = {\n\t\t\t\t\t\"type\": answer.type,\n\t\t\t\t\t\"sdp\": answer.sdp\n\t\t\t\t};\n\t\t\t\tcallbacks.customizeSdp(jsep);\n\t\t\t\tanswer.sdp = jsep.sdp;\n\t\t\t\tJanus.log(\"Setting local description\");\n\t\t\t\tif(sendVideo && simulcast) {\n\t\t\t\t\t// This SDP munging only works with Chrome\n\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"chrome\") {\n\t\t\t\t\t\t// FIXME Apparently trying to simulcast when answering breaks video in Chrome...\n\t\t\t\t\t\t//~ Janus.log(\"Enabling Simulcasting for Chrome (SDP munging)\");\n\t\t\t\t\t\t//~ answer.sdp = mungeSdpForSimulcasting(answer.sdp);\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is an answer, and video breaks in Chrome if we enable it\");\n\t\t\t\t\t} else if(Janus.webRTCAdapter.browserDetails.browser !== \"firefox\") {\n\t\t\t\t\t\tJanus.warn(\"simulcast=true, but this is not Chrome nor Firefox, ignoring\");\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tconfig.mySdp = answer.sdp;\n\t\t\t\tconfig.pc.setLocalDescription(answer)\n\t\t\t\t\t.catch(callbacks.error);\n\t\t\t\tconfig.mediaConstraints = mediaConstraints;\n\t\t\t\tif(!config.iceDone && !config.trickle) {\n\t\t\t\t\t// Don't do anything until we have all candidates\n\t\t\t\t\tJanus.log(\"Waiting for all candidates...\");\n\t\t\t\t\treturn;\n\t\t\t\t}\n\t\t\t\t// If transforms are present, notify Janus that the media is end-to-end encrypted\n\t\t\t\tif(config.senderTransforms || config.receiverTransforms) {\n\t\t\t\t\tanswer[\"e2ee\"] = true;\n\t\t\t\t}\n\t\t\t\tcallbacks.success(answer);\n\t\t\t}, callbacks.error);\n\t}\n\n\tfunction sendSDP(handleId, callbacks) {\n\t\tcallbacks = callbacks || {};\n\t\tcallbacks.success = (typeof callbacks.success == \"function\") ? callbacks.success : Janus.noop;\n\t\tcallbacks.error = (typeof callbacks.error == \"function\") ? callbacks.error : Janus.noop;\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle, not sending anything\");\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tJanus.log(\"Sending offer/answer SDP...\");\n\t\tif(!config.mySdp) {\n\t\t\tJanus.warn(\"Local SDP instance is invalid, not sending anything...\");\n\t\t\treturn;\n\t\t}\n\t\tconfig.mySdp = {\n\t\t\t\"type\": config.pc.localDescription.type,\n\t\t\t\"sdp\": config.pc.localDescription.sdp\n\t\t};\n\t\tif(config.trickle === false)\n\t\t\tconfig.mySdp[\"trickle\"] = false;\n\t\tJanus.debug(callbacks);\n\t\tconfig.sdpSent = true;\n\t\tcallbacks.success(config.mySdp);\n\t}\n\n\tfunction getVolume(handleId, remote) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn 0;\n\t\t}\n\t\tvar stream = remote ? \"remote\" : \"local\";\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.volume[stream])\n\t\t\tconfig.volume[stream] = { value: 0 };\n\t\t// Start getting the volume, if audioLevel in getStats is supported (apparently\n\t\t// they're only available in Chrome/Safari right now: https://webrtc-stats.callstats.io/)\n\t\tif(config.pc.getStats && (Janus.webRTCAdapter.browserDetails.browser === \"chrome\" ||\n\t\t\t\tJanus.webRTCAdapter.browserDetails.browser === \"safari\")) {\n\t\t\tif(remote && !config.remoteStream) {\n\t\t\t\tJanus.warn(\"Remote stream unavailable\");\n\t\t\t\treturn 0;\n\t\t\t} else if(!remote && !config.myStream) {\n\t\t\t\tJanus.warn(\"Local stream unavailable\");\n\t\t\t\treturn 0;\n\t\t\t}\n\t\t\tif(!config.volume[stream].timer) {\n\t\t\t\tJanus.log(\"Starting \" + stream + \" volume monitor\");\n\t\t\t\tconfig.volume[stream].timer = setInterval(function() {\n\t\t\t\t\tconfig.pc.getStats()\n\t\t\t\t\t\t.then(function(stats) {\n\t\t\t\t\t\t\tstats.forEach(function (res) {\n\t\t\t\t\t\t\t\tif(!res || res.kind !== \"audio\")\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tif((remote && !res.remoteSource) || (!remote && res.type !== \"media-source\"))\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tconfig.volume[stream].value = (res.audioLevel ? res.audioLevel : 0);\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t}, 200);\n\t\t\t\treturn 0;\t// We don't have a volume to return yet\n\t\t\t}\n\t\t\treturn config.volume[stream].value;\n\t\t} else {\n\t\t\t// audioInputLevel and audioOutputLevel seem only available in Chrome? audioLevel\n\t\t\t// seems to be available on Chrome and Firefox, but they don't seem to work\n\t\t\tJanus.warn(\"Getting the \" + stream + \" volume unsupported by browser\");\n\t\t\treturn 0;\n\t\t}\n\t}\n\n\tfunction isMuted(handleId, video) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn true;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn true;\n\t\t}\n\t\tif(!config.myStream) {\n\t\t\tJanus.warn(\"Invalid local MediaStream\");\n\t\t\treturn true;\n\t\t}\n\t\tif(video) {\n\t\t\t// Check video track\n\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No video track\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn !config.myStream.getVideoTracks()[0].enabled;\n\t\t} else {\n\t\t\t// Check audio track\n\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No audio track\");\n\t\t\t\treturn true;\n\t\t\t}\n\t\t\treturn !config.myStream.getAudioTracks()[0].enabled;\n\t\t}\n\t}\n\n\tfunction mute(handleId, video, mute) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn false;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc) {\n\t\t\tJanus.warn(\"Invalid PeerConnection\");\n\t\t\treturn false;\n\t\t}\n\t\tif(!config.myStream) {\n\t\t\tJanus.warn(\"Invalid local MediaStream\");\n\t\t\treturn false;\n\t\t}\n\t\tif(video) {\n\t\t\t// Mute/unmute video track\n\t\t\tif(!config.myStream.getVideoTracks() || config.myStream.getVideoTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No video track\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconfig.myStream.getVideoTracks()[0].enabled = !mute;\n\t\t\treturn true;\n\t\t} else {\n\t\t\t// Mute/unmute audio track\n\t\t\tif(!config.myStream.getAudioTracks() || config.myStream.getAudioTracks().length === 0) {\n\t\t\t\tJanus.warn(\"No audio track\");\n\t\t\t\treturn false;\n\t\t\t}\n\t\t\tconfig.myStream.getAudioTracks()[0].enabled = !mute;\n\t\t\treturn true;\n\t\t}\n\t}\n\n\tfunction getBitrate(handleId) {\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle || !pluginHandle.webrtcStuff) {\n\t\t\tJanus.warn(\"Invalid handle\");\n\t\t\treturn \"Invalid handle\";\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(!config.pc)\n\t\t\treturn \"Invalid PeerConnection\";\n\t\t// Start getting the bitrate, if getStats is supported\n\t\tif(config.pc.getStats) {\n\t\t\tif(!config.bitrate.timer) {\n\t\t\t\tJanus.log(\"Starting bitrate timer (via getStats)\");\n\t\t\t\tconfig.bitrate.timer = setInterval(function() {\n\t\t\t\t\tconfig.pc.getStats()\n\t\t\t\t\t\t.then(function(stats) {\n\t\t\t\t\t\t\tstats.forEach(function (res) {\n\t\t\t\t\t\t\t\tif(!res)\n\t\t\t\t\t\t\t\t\treturn;\n\t\t\t\t\t\t\t\tvar inStats = false;\n\t\t\t\t\t\t\t\t// Check if these are statistics on incoming media\n\t\t\t\t\t\t\t\tif((res.mediaType === \"video\" || res.id.toLowerCase().indexOf(\"video\") > -1) &&\n\t\t\t\t\t\t\t\t\t\tres.type === \"inbound-rtp\" && res.id.indexOf(\"rtcp\") < 0) {\n\t\t\t\t\t\t\t\t\t// New stats\n\t\t\t\t\t\t\t\t\tinStats = true;\n\t\t\t\t\t\t\t\t} else if(res.type == 'ssrc' && res.bytesReceived &&\n\t\t\t\t\t\t\t\t\t\t(res.googCodecName === \"VP8\" || res.googCodecName === \"\")) {\n\t\t\t\t\t\t\t\t\t// Older Chromer versions\n\t\t\t\t\t\t\t\t\tinStats = true;\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t// Parse stats now\n\t\t\t\t\t\t\t\tif(inStats) {\n\t\t\t\t\t\t\t\t\tconfig.bitrate.bsnow = res.bytesReceived;\n\t\t\t\t\t\t\t\t\tconfig.bitrate.tsnow = res.timestamp;\n\t\t\t\t\t\t\t\t\tif(config.bitrate.bsbefore === null || config.bitrate.tsbefore === null) {\n\t\t\t\t\t\t\t\t\t\t// Skip this round\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.bsbefore = config.bitrate.bsnow;\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.tsbefore = config.bitrate.tsnow;\n\t\t\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\t\t\t// Calculate bitrate\n\t\t\t\t\t\t\t\t\t\tvar timePassed = config.bitrate.tsnow - config.bitrate.tsbefore;\n\t\t\t\t\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"safari\")\n\t\t\t\t\t\t\t\t\t\t\ttimePassed = timePassed/1000;\t// Apparently the timestamp is in microseconds, in Safari\n\t\t\t\t\t\t\t\t\t\tvar bitRate = Math.round((config.bitrate.bsnow - config.bitrate.bsbefore) * 8 / timePassed);\n\t\t\t\t\t\t\t\t\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"safari\")\n\t\t\t\t\t\t\t\t\t\t\tbitRate = parseInt(bitRate/1000);\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.value = bitRate + ' kbits/sec';\n\t\t\t\t\t\t\t\t\t\t//~ Janus.log(\"Estimated bitrate is \" + config.bitrate.value);\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.bsbefore = config.bitrate.bsnow;\n\t\t\t\t\t\t\t\t\t\tconfig.bitrate.tsbefore = config.bitrate.tsnow;\n\t\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t\t}\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t}, 1000);\n\t\t\t\treturn \"0 kbits/sec\";\t// We don't have a bitrate value yet\n\t\t\t}\n\t\t\treturn config.bitrate.value;\n\t\t} else {\n\t\t\tJanus.warn(\"Getting the video bitrate unsupported by browser\");\n\t\t\treturn \"Feature unsupported by browser\";\n\t\t}\n\t}\n\n\tfunction webrtcError(error) {\n\t\tJanus.error(\"WebRTC error:\", error);\n\t}\n\n\tfunction cleanupWebrtc(handleId, hangupRequest) {\n\t\tJanus.log(\"Cleaning WebRTC stuff\");\n\t\tvar pluginHandle = pluginHandles[handleId];\n\t\tif(!pluginHandle) {\n\t\t\t// Nothing to clean\n\t\t\treturn;\n\t\t}\n\t\tvar config = pluginHandle.webrtcStuff;\n\t\tif(config) {\n\t\t\tif(hangupRequest === true) {\n\t\t\t\t// Send a hangup request (we don't really care about the response)\n\t\t\t\tvar request = { \"janus\": \"hangup\", \"transaction\": Janus.randomString(12) };\n\t\t\t\tif(pluginHandle.token)\n\t\t\t\t\trequest[\"token\"] = pluginHandle.token;\n\t\t\t\tif(apisecret)\n\t\t\t\t\trequest[\"apisecret\"] = apisecret;\n\t\t\t\tJanus.debug(\"Sending hangup request (handle=\" + handleId + \"):\");\n\t\t\t\tJanus.debug(request);\n\t\t\t\tif(websockets) {\n\t\t\t\t\trequest[\"session_id\"] = sessionId;\n\t\t\t\t\trequest[\"handle_id\"] = handleId;\n\t\t\t\t\tws.send(JSON.stringify(request));\n\t\t\t\t} else {\n\t\t\t\t\tJanus.httpAPICall(server + \"/\" + sessionId + \"/\" + handleId, {\n\t\t\t\t\t\tverb: 'POST',\n\t\t\t\t\t\twithCredentials: withCredentials,\n\t\t\t\t\t\tbody: request\n\t\t\t\t\t});\n\t\t\t\t}\n\t\t\t}\n\t\t\t// Cleanup stack\n\t\t\tconfig.remoteStream = null;\n\t\t\tif(config.volume) {\n\t\t\t\tif(config.volume[\"local\"] && config.volume[\"local\"].timer)\n\t\t\t\t\tclearInterval(config.volume[\"local\"].timer);\n\t\t\t\tif(config.volume[\"remote\"] && config.volume[\"remote\"].timer)\n\t\t\t\t\tclearInterval(config.volume[\"remote\"].timer);\n\t\t\t}\n\t\t\tconfig.volume = {};\n\t\t\tif(config.bitrate.timer)\n\t\t\t\tclearInterval(config.bitrate.timer);\n\t\t\tconfig.bitrate.timer = null;\n\t\t\tconfig.bitrate.bsnow = null;\n\t\t\tconfig.bitrate.bsbefore = null;\n\t\t\tconfig.bitrate.tsnow = null;\n\t\t\tconfig.bitrate.tsbefore = null;\n\t\t\tconfig.bitrate.value = null;\n\t\t\ttry {\n\t\t\t\t// Try a MediaStreamTrack.stop() for each track\n\t\t\t\tif(!config.streamExternal && config.myStream) {\n\t\t\t\t\tJanus.log(\"Stopping local stream tracks\");\n\t\t\t\t\tvar tracks = config.myStream.getTracks();\n\t\t\t\t\tfor(var mst of tracks) {\n\t\t\t\t\t\tJanus.log(mst);\n\t\t\t\t\t\tif(mst)\n\t\t\t\t\t\t\tmst.stop();\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t} catch(e) {\n\t\t\t\t// Do nothing if this fails\n\t\t\t}\n\t\t\tconfig.streamExternal = false;\n\t\t\tconfig.myStream = null;\n\t\t\t// Close PeerConnection\n\t\t\ttry {\n\t\t\t\tconfig.pc.close();\n\t\t\t} catch(e) {\n\t\t\t\t// Do nothing\n\t\t\t}\n\t\t\tconfig.pc = null;\n\t\t\tconfig.candidates = null;\n\t\t\tconfig.mySdp = null;\n\t\t\tconfig.remoteSdp = null;\n\t\t\tconfig.iceDone = false;\n\t\t\tconfig.dataChannel = {};\n\t\t\tconfig.dtmfSender = null;\n\t\t\tconfig.senderTransforms = null;\n\t\t\tconfig.receiverTransforms = null;\n\t\t}\n\t\tpluginHandle.oncleanup();\n\t}\n\n\t// Helper method to munge an SDP to enable simulcasting (Chrome only)\n\tfunction mungeSdpForSimulcasting(sdp) {\n\t\t// Let's munge the SDP to add the attributes for enabling simulcasting\n\t\t// (based on https://gist.github.com/ggarber/a19b4c33510028b9c657)\n\t\tvar lines = sdp.split(\"\\r\\n\");\n\t\tvar video = false;\n\t\tvar ssrc = [ -1 ], ssrc_fid = [ -1 ];\n\t\tvar cname = null, msid = null, mslabel = null, label = null;\n\t\tvar insertAt = -1;\n\t\tfor(var i=0; i<lines.length; i++) {\n\t\t\tvar mline = lines[i].match(/m=(\\w+) */);\n\t\t\tif(mline) {\n\t\t\t\tvar medium = mline[1];\n\t\t\t\tif(medium === \"video\") {\n\t\t\t\t\t// New video m-line: make sure it's the first one\n\t\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\t\tvideo = true;\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\t// New non-video m-line: do we have what we were looking for?\n\t\t\t\t\tif(ssrc[0] > -1) {\n\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\tbreak;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(!video)\n\t\t\t\tcontinue;\n\t\t\tvar fid = lines[i].match(/a=ssrc-group:FID (\\d+) (\\d+)/);\n\t\t\tif(fid) {\n\t\t\t\tssrc[0] = fid[1];\n\t\t\t\tssrc_fid[0] = fid[2];\n\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t\tif(ssrc[0]) {\n\t\t\t\tvar match = lines[i].match('a=ssrc:' + ssrc[0] + ' cname:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tcname = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' msid:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tmsid = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' mslabel:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tmslabel = match[1];\n\t\t\t\t}\n\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' label:(.+)')\n\t\t\t\tif(match) {\n\t\t\t\t\tlabel = match[1];\n\t\t\t\t}\n\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc_fid[0]) === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc[0]) === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t\tif(lines[i].length == 0) {\n\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\tcontinue;\n\t\t\t}\n\t\t}\n\t\tif(ssrc[0] < 0) {\n\t\t\t// Couldn't find a FID attribute, let's just take the first video SSRC we find\n\t\t\tinsertAt = -1;\n\t\t\tvideo = false;\n\t\t\tfor(var i=0; i<lines.length; i++) {\n\t\t\t\tvar mline = lines[i].match(/m=(\\w+) */);\n\t\t\t\tif(mline) {\n\t\t\t\t\tvar medium = mline[1];\n\t\t\t\t\tif(medium === \"video\") {\n\t\t\t\t\t\t// New video m-line: make sure it's the first one\n\t\t\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\t\t\tvideo = true;\n\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t} else {\n\t\t\t\t\t\t// New non-video m-line: do we have what we were looking for?\n\t\t\t\t\t\tif(ssrc[0] > -1) {\n\t\t\t\t\t\t\t// We're done, let's add the new attributes here\n\t\t\t\t\t\t\tinsertAt = i;\n\t\t\t\t\t\t\tbreak;\n\t\t\t\t\t\t}\n\t\t\t\t\t}\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t\tif(!video)\n\t\t\t\t\tcontinue;\n\t\t\t\tif(ssrc[0] < 0) {\n\t\t\t\t\tvar value = lines[i].match(/a=ssrc:(\\d+)/);\n\t\t\t\t\tif(value) {\n\t\t\t\t\t\tssrc[0] = value[1];\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t} else {\n\t\t\t\t\tvar match = lines[i].match('a=ssrc:' + ssrc[0] + ' cname:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tcname = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' msid:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tmsid = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' mslabel:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tmslabel = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tmatch = lines[i].match('a=ssrc:' + ssrc[0] + ' label:(.+)')\n\t\t\t\t\tif(match) {\n\t\t\t\t\t\tlabel = match[1];\n\t\t\t\t\t}\n\t\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc_fid[0]) === 0) {\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t\tif(lines[i].indexOf('a=ssrc:' + ssrc[0]) === 0) {\n\t\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\t\tcontinue;\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t\tif(lines[i].length === 0) {\n\t\t\t\t\tlines.splice(i, 1); i--;\n\t\t\t\t\tcontinue;\n\t\t\t\t}\n\t\t\t}\n\t\t}\n\t\tif(ssrc[0] < 0) {\n\t\t\t// Still nothing, let's just return the SDP we were asked to munge\n\t\t\tJanus.warn(\"Couldn't find the video SSRC, simulcasting NOT enabled\");\n\t\t\treturn sdp;\n\t\t}\n\t\tif(insertAt < 0) {\n\t\t\t// Append at the end\n\t\t\tinsertAt = lines.length;\n\t\t}\n\t\t// Generate a couple of SSRCs (for retransmissions too)\n\t\t// Note: should we check if there are conflicts, here?\n\t\tssrc[1] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc[2] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc_fid[1] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\tssrc_fid[2] = Math.floor(Math.random()*0xFFFFFFFF);\n\t\t// Add attributes to the SDP\n\t\tfor(var i=0; i<ssrc.length; i++) {\n\t\t\tif(cname) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' cname:' + cname);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(msid) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' msid:' + msid);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(mslabel) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' mslabel:' + mslabel);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(label) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc[i] + ' label:' + label);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\t// Add the same info for the retransmission SSRC\n\t\t\tif(cname) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' cname:' + cname);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(msid) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' msid:' + msid);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(mslabel) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' mslabel:' + mslabel);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t\tif(label) {\n\t\t\t\tlines.splice(insertAt, 0, 'a=ssrc:' + ssrc_fid[i] + ' label:' + label);\n\t\t\t\tinsertAt++;\n\t\t\t}\n\t\t}\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[2] + ' ' + ssrc_fid[2]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[1] + ' ' + ssrc_fid[1]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:FID ' + ssrc[0] + ' ' + ssrc_fid[0]);\n\t\tlines.splice(insertAt, 0, 'a=ssrc-group:SIM ' + ssrc[0] + ' ' + ssrc[1] + ' ' + ssrc[2]);\n\t\tsdp = lines.join(\"\\r\\n\");\n\t\tif(!sdp.endsWith(\"\\r\\n\"))\n\t\t\tsdp += \"\\r\\n\";\n\t\treturn sdp;\n\t}\n\n\t// Helper methods to parse a media object\n\tfunction isAudioSendEnabled(media) {\n\t\tJanus.debug(\"isAudioSendEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.audio === false)\n\t\t\treturn false;\t// Generic audio has precedence\n\t\tif(media.audioSend === undefined || media.audioSend === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.audioSend === true);\n\t}\n\n\tfunction isAudioSendRequired(media) {\n\t\tJanus.debug(\"isAudioSendRequired:\", media);\n\t\tif(!media)\n\t\t\treturn false;\t// Default\n\t\tif(media.audio === false || media.audioSend === false)\n\t\t\treturn false;\t// If we're not asking to capture audio, it's not required\n\t\tif(media.failIfNoAudio === undefined || media.failIfNoAudio === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.failIfNoAudio === true);\n\t}\n\n\tfunction isAudioRecvEnabled(media) {\n\t\tJanus.debug(\"isAudioRecvEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.audio === false)\n\t\t\treturn false;\t// Generic audio has precedence\n\t\tif(media.audioRecv === undefined || media.audioRecv === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.audioRecv === true);\n\t}\n\n\tfunction isVideoSendEnabled(media) {\n\t\tJanus.debug(\"isVideoSendEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.video === false)\n\t\t\treturn false;\t// Generic video has precedence\n\t\tif(media.videoSend === undefined || media.videoSend === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.videoSend === true);\n\t}\n\n\tfunction isVideoSendRequired(media) {\n\t\tJanus.debug(\"isVideoSendRequired:\", media);\n\t\tif(!media)\n\t\t\treturn false;\t// Default\n\t\tif(media.video === false || media.videoSend === false)\n\t\t\treturn false;\t// If we're not asking to capture video, it's not required\n\t\tif(media.failIfNoVideo === undefined || media.failIfNoVideo === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.failIfNoVideo === true);\n\t}\n\n\tfunction isVideoRecvEnabled(media) {\n\t\tJanus.debug(\"isVideoRecvEnabled:\", media);\n\t\tif(!media)\n\t\t\treturn true;\t// Default\n\t\tif(media.video === false)\n\t\t\treturn false;\t// Generic video has precedence\n\t\tif(media.videoRecv === undefined || media.videoRecv === null)\n\t\t\treturn true;\t// Default\n\t\treturn (media.videoRecv === true);\n\t}\n\n\tfunction isScreenSendEnabled(media) {\n\t\tJanus.debug(\"isScreenSendEnabled:\", media);\n\t\tif (!media)\n\t\t\treturn false;\n\t\tif (typeof media.video !== 'object' || typeof media.video.mandatory !== 'object')\n\t\t\treturn false;\n\t\tvar constraints = media.video.mandatory;\n\t\tif (constraints.chromeMediaSource)\n\t\t\treturn constraints.chromeMediaSource === 'desktop' || constraints.chromeMediaSource === 'screen';\n\t\telse if (constraints.mozMediaSource)\n\t\t\treturn constraints.mozMediaSource === 'window' || constraints.mozMediaSource === 'screen';\n\t\telse if (constraints.mediaSource)\n\t\t\treturn constraints.mediaSource === 'window' || constraints.mediaSource === 'screen';\n\t\treturn false;\n\t}\n\n\tfunction isDataEnabled(media) {\n\t\tJanus.debug(\"isDataEnabled:\", media);\n\t\tif(Janus.webRTCAdapter.browserDetails.browser === \"edge\") {\n\t\t\tJanus.warn(\"Edge doesn't support data channels yet\");\n\t\t\treturn false;\n\t\t}\n\t\tif(media === undefined || media === null)\n\t\t\treturn false;\t// Default\n\t\treturn (media.data === true);\n\t}\n\n\tfunction isTrickleEnabled(trickle) {\n\t\tJanus.debug(\"isTrickleEnabled:\", trickle);\n\t\treturn (trickle === false) ? false : true;\n\t}\n}\nexport default Janus;","\nexport function loggedIn() {\n    var token = window.localStorage.getItem('token');\n    if (token) {\n      return true\n    } else {\n      window.localStorage.setItem('url', window.location.href);\n      this.$f7router.navigate('/login/');\n      \n    }\n\n}\n","import Janus from \"../../janus.js\";\nexport function sessionCreate() {\n  var self = this;\n  Janus.init({\n    debug: \"all\",\n    callback: function () {\n      var janus = new Janus({\n        server: self.state.server,\n        success: function () {\n          janus.attach({\n            plugin: \"janus.plugin.videoroom\",\n            opaqueId: self.state.opaqueId,\n            success: function (pluginHandle) {\n              self.setState({ janus: janus });\n              self.setState({ sfutest: pluginHandle });\n              Janus.log(\n                \"Plugin attached! (\" +\n                  self.state.sfutest.getPlugin() +\n                  \", id=\" +\n                  self.state.sfutest.getId() +\n                  \")\"\n              );\n              Janus.log(\"  -- This is a publisher/manager\");\n              self.registerUsername();\n              //self.publishData();\n            },\n            error: function (error) {\n              Janus.error(\"  -- Error attaching plugin...\", error);\n              window.alert(\"Error attaching plugin... \" + error);\n            },\n            consentDialog: function (on) {\n              Janus.debug(\n                \"Consent dialog should be \" + (on ? \"on\" : \"off\") + \" now\"\n              );\n            },\n            iceState: function (state) {\n              Janus.log(\"ICE state changed to \" + state);\n            },\n            mediaState: function (medium, on) {\n              Janus.log(\n                \"Janus \" +\n                  (on ? \"started\" : \"stopped\") +\n                  \" receiving our \" +\n                  medium\n              );\n            },\n            webrtcState: function (on) {\n              Janus.log(\n                \"Janus says our WebRTC PeerConnection is \" +\n                  (on ? \"up\" : \"down\") +\n                  \" now\"\n              );\n            },\n            onmessage: function (msg, jsep) {\n              Janus.log(\" ::: Got a message (publisher) :::\", msg);\n              var event = msg[\"videoroom\"];\n              Janus.debug(\"Event: \" + event);\n              if (event) {\n                if (event === \"joined\") {\n                  console.log(\"joined\");\n                  self.setState({\n                    myid: msg[\"id\"],\n                    mypvtid: msg[\"private_id\"],\n                  });\n                  //self.publishData();\n                  // console.log('message ??????', msg)\n                  self.addParticipant(\n                    msg[\"id\"],\n                    self.state.fullname + \"§\" + self.state.userUUID\n                  );\n\n                  if (msg[\"publishers\"]) {\n                    var list = msg[\"publishers\"];\n                    console.log(\n                      \"Got a list of available publishers/feeds:\",\n                      list\n                    );\n                    for (var f in list) {\n                      var id = list[f][\"id\"];\n                      var display = list[f][\"display\"];\n                      var audio = list[f][\"audio_codec\"];\n                      var video = list[f][\"video_codec\"];\n                      Janus.debug(\n                        \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (audio: \" +\n                          audio +\n                          \", video: \" +\n                          video +\n                          \")\"\n                      );\n                      self.addParticipant(list[f][\"id\"], list[f][\"display\"]);\n                      self.newRemoteFeed(id, display, audio, video);\n                    }\n                  }\n                } else if (event === \"destroyed\") {\n                  // The room has been destroyed\n                  Janus.warn(\"The room has been destroyed!\");\n                } else if (event === \"event\") {\n                  // Any new feed to attach to?\n                  if (msg[\"publishers\"]) {\n                    var list = msg[\"publishers\"];\n                    Janus.log(\n                      \"Got a list of available publishers/feeds:\",\n                      list\n                    );\n                    for (var f in list) {\n                      var id = list[f][\"id\"];\n                      var display = list[f][\"display\"];\n                      var audio = list[f][\"audio_codec\"];\n                      var video = list[f][\"video_codec\"];\n                      Janus.log(\n                        \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (audio: \" +\n                          audio +\n                          \", video: \" +\n                          video +\n                          \")\"\n                      );\n                      // if(audio || video) {\n                      self.addParticipant(list[f][\"id\"], list[f][\"display\"]);\n                      self.newRemoteFeed(id, display, audio, video);\n                      // }\n                    }\n                  } else if (msg[\"leaving\"]) {\n                    var leaving = msg[\"leaving\"];\n                    console.log(\"Publisher leaving: \" + leaving);\n                    self.setState(\n                      {\n                        feeds: self.state.feeds.filter(\n                          (item) => item.rfid != leaving\n                        ),\n                      },\n                      () => console.log(\"feeds: >>>>\", self.state.feeds)\n                    );\n                    var unPublishedFeed = self.state.feeds.filter(\n                      (item) => item.rfid === leaving\n                    );\n                    var remoteFeed = unPublishedFeed.shift();\n                    if (remoteFeed != null) {\n                      remoteFeed.detach();\n                    }\n                    self.removeParticipant(leaving);\n                  } else if (msg[\"unpublished\"]) {\n                    var unpublished = msg[\"unpublished\"];\n                    console.log(\"Publisher left: \" + unpublished);\n                    if (unpublished === \"ok\") {\n                      self.state.sfutest.hangup();\n                      return;\n                    }\n                    self.setState({\n                      feeds: self.state.feeds.filter(\n                        (item) => item.rfid != unpublished\n                      ),\n                    });\n                    var unPublishedFeed = self.state.feeds.filter(\n                      (item) => item.rfid === unpublished\n                    );\n\n                    self.setState({\n                      lowFeeds: self.state.lowFeeds.filter(\n                        (item) => item.rfid != unpublished\n                      ),\n                    });\n\n                    var remoteFeed = unPublishedFeed.shift();\n                    if (remoteFeed != null) {\n                      remoteFeed.detach();\n                    }\n                    self.removeParticipant(unpublished);\n                  } else if (msg[\"error\"]) {\n                  } else if (msg[\"configured\"]) {\n                  } else if (msg[\"joining\"]) {\n                    self.addParticipant(\n                      msg[\"joining\"].id,\n                      msg[\"joining\"].display\n                    );\n                  }\n                }\n              }\n              if (jsep) {\n                Janus.log(\"Handling SDP as well...\", jsep);\n                self.state.sfutest.handleRemoteJsep({ jsep: jsep });\n                //self.$$(\"#video-\" + self.state.sfutest.id).hide();\n              }\n            },\n            onlocalstream: function (stream) {\n              console.log(\" ::: Got a local stream :::\", stream);\n              console.log(self.state.sfutest.id);\n              var exisiting = self.state.feeds.filter(\n                (item) => item.id === self.state.sfutest.id\n              );\n              if (exisiting.length === 0) {\n                self.state.sfutest.rfid = self.state.myid;\n\n                self.setState({\n                  feeds: self.state.feeds.concat(self.state.sfutest),\n                });\n                if (self.state.isOwner) {\n                  self.requestAccepted(self.state.userUUID);\n                }\n              }\n\n              var videoTracks = stream.getVideoTracks();\n\n              if (!videoTracks || videoTracks.length === 0) {\n                self.$$(\"#video-\" + self.state.sfutest.id).hide();\n              } else {\n                console.log(self.state.participants);\n                self.$$(\"#video-\" + self.state.sfutest.id).show();\n                self.streamAttacher(self.state.sfutest);\n                //Janus.attachMediaStream(\n                //  document.getElementById(\"video-\" + self.state.sfutest.id),\n                //  stream\n                //);\n                //document.getElementById(\"video-\" + self.state.sfutest.id).muted = true;\n              }\n            },\n            onremotestream: function (stream) {\n              Janus.log(\" ::: Got a remote stream :::\", stream);\n              // The publisher stream is sendonly, we don't expect anything here\n            },\n            ondata: function (data) {\n              Janus.debug(\"We got data from the DataChannel!\", data);\n              //$('#datarecv').val(data);\n            },\n            oncleanup: function () {\n              Janus.log(\n                \" ::: Got a cleanup notification: we are unpublished now :::\"\n              );\n            },\n          });\n        },\n        error: function (error) {\n          Janus.error(error);\n          window.alert(error, function () {\n            window.location.reload();\n          });\n        },\n        destroyed: function () {\n          window.location.reload();\n        },\n      });\n    },\n  });\n}\n\nexport function registerUsername() {\n  var self = this;\n  var register = {\n    request: \"join\",\n    room: self.state.roomId,\n    ptype: \"publisher\",\n    display: self.state.fullname + \" §\" + self.state.userUUID,\n    pin: self.state.pin,\n  };\n  self.state.sfutest.send({ message: register });\n  setTimeout(\n    function () {\n      this.publishData();\n    }.bind(this),\n    8000\n  );\n}\n\nexport function findFeedByRfid(rfid) {\n  var feeds = this.state.feeds.filter((item) => item.rfid === rfid);\n  if (feeds && feeds[0]) {\n    return feeds[0];\n  }\n}\n\nexport function findFeedById(id) {\n  var feeds = this.state.feeds.filter((item) => item.id === id);\n  if (feeds && feeds[0]) {\n    return feeds[0];\n  }\n}\n\nexport function feedIdToRfid(id) {\n  var feeds = this.state.feeds.filter((item) => item.id === id);\n  if (feeds && feeds[0]) {\n    return feeds[0].rfid;\n  }\n}\n\nexport function addParticipant(id, p) {\n  var self = this;\n  var participant = p.split(\"§\");\n  if (this.exisitingParticipant(participant[1])) {\n    self.setState({\n      participants: self.state.participants.concat({\n        id: id,\n        display: participant[0],\n        uuid: participant[1],\n        role: \"listener\",\n      }),\n    });\n  }\n  console.log(\"participant added:\", participant[1]);\n}\n\nexport function exisitingParticipant(participantId) {\n  var self = this;\n  var exisiting = self.state.participants.filter(\n    (item) => item.uuid === participantId\n  );\n  if (exisiting.length === 0) {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function findParticpantById(id) {\n  var participants = this.state.participants.filter((item) => item.id === id);\n  if (participants && participants[0]) {\n    return participants[0];\n  }\n}\n\nexport function findParticpantByUuid(id) {\n  var participants = this.state.participants.filter((item) => item.uuid === id);\n  if (participants && participants[0]) {\n    return participants[0];\n  }\n}\n\nexport function removeParticipant(id) {\n  var self = this;\n  self.setState({\n    participants: self.state.participants.filter((item) => item.id !== id),\n  });\n}\n\nexport function newRemoteFeed(id, feeds, display, audio, video) {\n  var self = this;\n  // A new feed has been published, create a new plugin handle and attach to it as a subscriber\n  var remoteFeed = null;\n  self.state.janus.attach({\n    plugin: \"janus.plugin.videoroom\",\n    opaqueId: this.state.opaqueId,\n    success: function (pluginHandle) {\n      remoteFeed = pluginHandle;\n      remoteFeed.simulcastStarted = false;\n      Janus.log(\n        \"Plugin attached! (\" +\n          remoteFeed.getPlugin() +\n          \", id=\" +\n          remoteFeed.getId() +\n          \")\"\n      );\n      Janus.log(\"  -- This is a subscriber\");\n      // We wait for the plugin to send us an offer\n      var subscribe = {\n        request: \"join\",\n        room: self.state.roomId,\n        ptype: \"subscriber\",\n        pin: self.state.pin,\n        feed: id,\n        private_id: self.state.mypvtid,\n      };\n      // In case you don't want to receive audio, video or data, even if the\n      // publisher is sending them, set the 'offer_audio', 'offer_video' or\n      // 'offer_data' properties to false (they're true by default), e.g.:\n      // \t\tsubscribe[\"offer_video\"] = false;\n      // For example, if the publisher is VP8 and this is Safari, let's avoid video\n      if (\n        Janus.webRTCAdapter.browserDetails.browser === \"safari\" &&\n        (video === \"vp9\" || (video === \"vp8\" && !Janus.safariVp8))\n      ) {\n        if (video) video = video.toUpperCase();\n        console.log(\n          \"Publisher is using \" +\n            video +\n            \", but Safari doesn't support it: disabling video\"\n        );\n        subscribe[\"offer_video\"] = false;\n      }\n      remoteFeed.videoCodec = video;\n      remoteFeed.send({ message: subscribe });\n    },\n    error: function (error) {\n      Janus.error(\"  -- Error attaching plugin...\", error);\n      window.alert(\"Error attaching plugin... \" + error);\n    },\n    onmessage: function (msg, jsep) {\n      Janus.debug(\" ::: Got a message (subscriber) :::\", msg);\n      var event = msg[\"videoroom\"];\n      Janus.log(\"Event: \" + event);\n      if (msg[\"error\"]) {\n        window.alert(msg[\"error\"]);\n      } else if (event) {\n        if (event === \"attached\") {\n          remoteFeed.rfid = msg[\"id\"];\n          remoteFeed.rfdisplay = msg[\"display\"];\n          self.setState({ feeds: self.state.feeds.concat(remoteFeed) });\n          self.setState({ lowFeeds: self.state.lowFeeds.concat(remoteFeed) });\n          if (!video || !audio) {\n            self.$$(\"#video-\" + remoteFeed.id).hide();\n            //self.$$(\"#lowVideo-\" + remoteFeed.id).hide();\n          }\n          //  }\n\n          Janus.log(\n            \"Successfully attached to feed \" +\n              remoteFeed.rfid +\n              \" (\" +\n              remoteFeed.rfdisplay +\n              \") in room \" +\n              msg[\"room\"]\n          );\n        } else if (event === \"event\") {\n        } else {\n          // What has just happened?\n        }\n      }\n      if (jsep) {\n        Janus.log(\"Handling SDP as well...\", jsep);\n        remoteFeed.createAnswer({\n          jsep: jsep,\n          // Add data:true here if you want to subscribe to datachannels as well\n          // (obviously only works if the publisher offered them in the first place)\n          media: { audioSend: false, videoSend: false, data: true }, // We want recvonly audio/video\n          success: function (jsep) {\n            Janus.log(\"Got SDP!\", jsep);\n            var body = { request: \"start\", room: self.state.roomId };\n            remoteFeed.send({ message: body, jsep: jsep });\n          },\n          error: function (error) {\n            Janus.log(\"WebRTC error:\", error);\n            window.alert(\"WebRTC error... \" + error.message);\n          },\n        });\n      }\n    },\n    iceState: function (state) {\n      Janus.log(\n        \"ICE state of this WebRTC PeerConnection (feed #\" +\n          remoteFeed.rfindex +\n          \") changed to \" +\n          state\n      );\n    },\n    webrtcState: function (on) {\n      Janus.log(\n        \"Janus says this WebRTC PeerConnection (feed #\" +\n          remoteFeed.rfindex +\n          \") is \" +\n          (on ? \"up\" : \"down\") +\n          \" now\"\n      );\n      if (on === \"down\") {\n        self.removeParticipant(remoteFeed.rfid);\n      }\n    },\n    onlocalstream: function (stream) {\n      console.log(\">>>>>>>>>>>\", stream);\n    },\n    onremotestream: function (stream) {\n      //  console.log('§§§§§§§§§§§§§§§§§§', stream)\n      var videoTracks = stream.getVideoTracks();\n      var videoQuality = \"video\";\n      // if (self.feedToRole(remoteFeed.id) && self.feedToRole(remoteFeed.id) === 'listener'){\n      //  videoQuality = \"lowVideo\"\n      //}\n\n      console.log(\n        \">>>>>>>>>>>>>\",\n        self.feedToRole(remoteFeed.id),\n        remoteFeed.id\n      );\n      if (!videoTracks || videoTracks.length === 0) {\n        self.$$(\"#video-\" + remoteFeed.id).hide();\n        // self.$$(\"#lowVideo-\" + remoteFeed.id).hide();\n      } else {\n        //self.$$(videoQuality + remoteFeed.id).show()\n        self.$$(\"#\" + videoQuality + \"-\" + remoteFeed.id).show();\n        //self.attachMedia(videoQuality, remoteFeed.id, stream)\n        //console.log(remoteFeed.webrtcStuff.remoteStream)\n        //console.log(stream)\n        Janus.attachMediaStream(\n          document.getElementById(videoQuality + \"-\" + remoteFeed.id),\n          stream\n        );\n      }\n      var audioTracks = stream.getAudioTracks();\n      if (!audioTracks || audioTracks.length === 0) {\n        // self.$$(\"#video-\" + remoteFeed.id).hide();\n      } else {\n        //self.$$(\"#video-\" + remoteFeed.id).hide();\n        Janus.attachMediaStream(\n          document.getElementById(\"video-\" + remoteFeed.id),\n          stream\n        );\n      }\n    },\n    ondata: function (data) {\n      //Janus.debug(\"We got data from the DataChannel!\", data);\n      console.log(data);\n      var message = JSON.parse(data);\n      var exisiting = self.state.requests.filter(\n        (item) => item.uuid === message[\"uuid\"]\n      );\n\n      if (exisiting.length === 0 && message[\"request\"] === \"up\") {\n        self.setState({\n          requests: self.state.requests.concat({\n            display: message[\"display\"],\n            uuid: message[\"uuid\"],\n          }),\n        });\n      }\n\n      if (message[\"request\"] === \"removeRequest\") {\n        self.setState({\n          requests: self.state.requests.filter(\n            (item) => item.uuid != message[\"uuid\"]\n          ),\n        });\n      }\n\n      if (message[\"text\"] === \"newComment\") {\n          console.log(self.state)\n        self.setState({messageFlag: true});\n      }\n\n      if (message[\"request\"] === \"acceptRequest\") {\n        self.setState({\n          requests: self.state.requests.filter(\n            (item) => item.uuid != message[\"uuid\"]\n          ),\n        });\n        self.requestAccepted(message[\"uuid\"]);\n        if (message[\"uuid\"] === self.state.userUUID) {\n          console.log(\"§§§§§§§\", self.state.publisedCamera);\n          if (self.state.publisedCamera) {\n            self.unPublishCamera();\n            self.publishCamera(32);\n          } else {\n            self.publishMicrophone();\n          }\n        }\n      }\n    },\n    oncleanup: function () {\n      Janus.log(\" ::: Got a cleanup notification (remote feed \" + id + \") :::\");\n    },\n  });\n}\n\nexport function feedToRole(feedId) {\n  var feed = this.findFeedById(feedId);\n  if (feed && feed.rfid) var participant = this.findParticpantById(feed.rfid);\n  if (participant) {\n    return participant.role;\n  }\n}\n\nexport function attachMedia(videoQuality, feedId, stream) {\n  Janus.attachMediaStream(\n    document.getElementById(videoQuality + \"-\" + feedId),\n    stream\n  );\n}\n\nexport function requestAccepted(requesterId) {\n  let newState = Object.assign({}, this.state);\n  var participant = this.findParticpantByUuid(requesterId);\n  var index = this.participantIndex(requesterId);\n  newState.participants[index] = {\n    id: participant.id,\n    display: participant.display,\n    uuid: participant.uuid,\n    role: \"speaker\",\n  };\n  this.setState(newState, () => {\n    var feed = this.findFeedByRfid(participant.id);\n    if (feed) {\n      this.streamAttacher(feed);\n    }\n  });\n}\n\nexport function participantIndex(id) {\n  var index = this.state.participants.findIndex((item) => item.uuid === id);\n  console.log(index);\n  if (Number.isInteger(index)) {\n    return index;\n  }\n}\n\nexport function participantIsSpeaker(requesterId) {\n  var participant = this.findParticpantByUuid(requesterId);\n  if (participant && participant.role === \"speaker\") {\n    return true;\n  } else {\n    return false;\n  }\n}\n\nexport function streamAttacher(feed) {\n  console.log(feed.id);\n  if (feed.id && feed.webrtcStuff && feed.webrtcStuff.remoteStream) {\n    setTimeout(\n      function () {\n        Janus.attachMediaStream(\n          document.getElementById(\"video-h-\" + feed.id),\n          feed.webrtcStuff.remoteStream\n        );\n      }.bind(this),\n      12000\n    );\n  }\n}\n\nexport function sendData() {\n  var message = {\n    textroom: \"message\",\n    transaction: Janus.randomString(12),\n    room: this.state.roomId,\n    text: \"newComment\",\n  };\n  this.state.sfutest.data({\n    text: JSON.stringify(message),\n    error: function (reason) {\n      console.log(reason);\n    },\n    success: function () {\n      console.log(\"sent\");\n    },\n  });\n}\n\nexport function speakRequest() {\n  var self = this;\n  var message = {\n    textroom: \"message\",\n    transaction: Janus.randomString(12),\n    room: this.state.roomId,\n    request: \"up\",\n    uuid: this.state.userUUID,\n    display: this.state.fullname,\n  };\n  this.state.sfutest.data({\n    text: JSON.stringify(message),\n    error: function (reason) {\n      console.log(reason);\n    },\n    success: function () {\n      console.log(\"request sent\");\n      var exisiting = self.state.requests.filter(\n        (item) => item.uuid === message[\"uuid\"]\n      );\n      if (exisiting.length === 0 && message[\"request\"] === \"up\") {\n        self.setState({\n          requests: self.state.requests.concat({\n            display: message[\"display\"],\n            uuid: message[\"uuid\"],\n          }),\n        });\n      }\n    },\n  });\n}\n\nexport function publishData() {\n  var self = this;\n  self.state.sfutest.createOffer({\n    media: {\n      audioRecv: false,\n      videoRecv: false,\n      data: true,\n      videoSend: false,\n      audioSend: false,\n    },\n\n    success: function (jsep) {\n      Janus.debug(\"********* Got publisher SDP!\", jsep);\n      if (jsep) {\n        var publish = {\n          request: \"publish\",\n          audio: true,\n          video: true,\n          data: true,\n        };\n        self.state.sfutest.send({ message: publish, jsep: jsep });\n      }\n    },\n    error: function (error) {\n      Janus.error(\"***** WebRTC error:\", error);\n    },\n  });\n}\n\nexport function unPublishData() {\n  var self = this;\n  self.state.sfutest.createOffer({\n    media: {\n      audioRecv: false,\n      videoRecv: false,\n      data: false,\n      videoSend: false,\n      //removeVideo: false,\n      audioSend: false,\n    },\n\n    success: function (jsep) {\n      Janus.debug(\"********* Got publisher SDP!\", jsep);\n      if (jsep) {\n        var unPublish = {\n          request: \"unpublish\",\n          audio: false,\n          video: false,\n          data: false,\n        };\n        self.state.sfutest.send({ message: unPublish, jsep: jsep });\n      }\n    },\n    error: function (error) {\n      Janus.error(\"***** WebRTC error:\", error);\n    },\n  });\n}\n\nexport function publishCamera(bitrate = 16) {\n  var self = this;\n  var request = \"\";\n  if (self.state.publishedMicrophone) {\n    request = \"configure\";\n  } else {\n    request = \"configure\";\n  }\n  self.state.sfutest.createOffer({\n    media: {\n      audioRecv: false,\n      videoRecv: false,\n      data: true,\n      videoSend: true,\n      // removeVideo: self.state.publisedCamera,\n      audioSend: self.state.publishedMicrophone,\n    },\n\n    success: function (jsep) {\n      Janus.debug(\"********* Got publisher SDP!\", jsep);\n      console.log(\"switching to \" + bitrate);\n      if (jsep) {\n        var publish = {\n          request: request,\n          audio: self.state.publishedMicrophone,\n          video: true,\n          data: true,\n          bitrate: bitrate * 1000,\n          bitrate_cap: true,\n          videocodec: \"vp8\",\n        };\n        self.state.sfutest.send({ message: publish, jsep: jsep });\n      }\n      self.setState({ publisedCamera: !self.state.publisedCamera });\n    },\n    error: function (error) {\n      Janus.error(\"***** WebRTC error:\", error);\n    },\n  });\n}\n\nexport function unPublishCamera() {\n  console.log(\"unPublishing ..\");\n  var self = this;\n  self.state.sfutest.createOffer({\n    media: {\n      audioRecv: false,\n      videoRecv: false,\n      data: true,\n      videoSend: false,\n      audioSend: self.state.publishedMicrophone,\n    },\n\n    success: function (jsep) {\n      Janus.debug(\"********* Got publisher SDP!\", jsep);\n      //console.log('switching to ' + bitrate)\n      if (jsep) {\n        var publish = {\n          request: \"configure\",\n          audio: self.state.publishedMicrophone,\n          video: false,\n          data: true,\n        };\n        self.state.sfutest.send({ message: publish, jsep: jsep });\n      }\n      self.setState({ publisedCamera: false });\n    },\n    error: function (error) {\n      Janus.error(\"***** WebRTC error:\", error);\n    },\n  });\n}\n\nexport function publishMicrophone() {\n  var self = this;\n  self.state.sfutest.createOffer({\n    media: {\n      audioRecv: false,\n      videoRecv: false,\n      data: true,\n      audioSend: !self.state.publishedMicrophone,\n      removeAudio: self.state.publishedMicrophone,\n      videoSend: self.state.publisedCamera,\n    },\n\n    success: function (jsep) {\n      Janus.debug(\"********* Got publisher SDP!\", jsep);\n      if (jsep) {\n        var publish = {\n          request: \"configure\",\n          data: true,\n          audio: !self.state.publishedMicrophone,\n          video: self.state.publisedCamera,\n        };\n        self.state.sfutest.send({ message: publish, jsep: jsep });\n        self.setState({\n          publishedMicrophone: !self.state.publishedMicrophone,\n        });\n      }\n    },\n    error: function (error) {\n      Janus.error(\"***** WebRTC error:\", error);\n    },\n  });\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon, Fab\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport PostShow from \"../../containers/posts/show\";\nimport crypto from 'crypto-js';\nimport { conf } from \"../../conf\";\nimport Janus from \"../../janus.js\";\nimport { loggedIn } from \"../../components/users/loggedIn.js\"\nimport { \n  sessionCreate, registerUsername, newRemoteFeed,\n  streamAttacher, sendData, publishData,\n  addParticipant, removeParticipant, unPublishData,\n  exisitingParticipant, findParticpantByUuid, participantIndex,\n  findParticpantById, findFeedByRfid, findFeedById, feedToRole\n } from \"../../components/rooms/session.js\"\n\nexport default class Layout extends Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.interaction = this.interaction.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.loggedIn = loggedIn.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.getList = this.getList.bind(this);\n    this.submit = this.submit.bind(this);\n    this.submitComment = this.submitComment.bind(this);\n    this.deleteComment = this.deleteComment.bind(this);\n    this.deleteCommentConfirm = this.deleteCommentConfirm.bind(this);\n    this.replyToComment = this.replyToComment.bind(this);  \n    this.removeReply = this.removeReply.bind(this);      \n    \n    this.loadMore = this.loadMore.bind(this);\n    this.rating = this.rating.bind(this);\n    this.deletePost = this.deletePost.bind(this);\n    this.deletePostConfirm = this.deletePostConfirm.bind(this);\n\n    this.sessionCreate = sessionCreate.bind(this);\n    this.pageAfterIn = this.pageAfterIn.bind(this);\n    this.registerUsername = registerUsername.bind(this);\n    this.newRemoteFeed = newRemoteFeed.bind(this);\n    this.streamAttacher = streamAttacher.bind(this);\n    this.sendData = sendData.bind(this);\n    this.publishData = publishData.bind(this);\n    this.addParticipant = addParticipant.bind(this);\n    this.removeParticipant = removeParticipant.bind(this);\n    this.unPublishData = unPublishData.bind(this);\n    this.exisitingParticipant = exisitingParticipant.bind(this);\n    this.findParticpantByUuid = findParticpantByUuid.bind(this);\n    this.participantIndex = participantIndex.bind(this);\n    this.findParticpantById = findParticpantById.bind(this);\n    this.findFeedByRfid = findFeedByRfid.bind(this);\n    this.findFeedById = findFeedById.bind(this);\n    this.feedToRole = feedToRole.bind(this);\n\n    \n    \n    this.state = {\n      post: null,\n      id: null,\n      page: 1,\n      channels: null,\n      selectedChannel: null,\n      channelId: null,\n      sheetOpened: false,\n      commentContent: '',\n      comments: null,\n      token: window.localStorage.getItem('token'),\n      rnd: crypto.lib.WordArray.random(32),\n      replyTo: null,\n      deletable: false,\n      messageFlag: false,\n\n      shortners: null,\n      server: conf.janusServer,\n      janus: null,\n      sfutest: null,\n      opaqueId: \"videoroomtest-\" + Janus.randomString(12),\n      roomId: 1234,\n      myusername: window.localStorage.getItem('token'),\n      myid: null,\n      mystream: null,\n      mypvtid: \"videoroomtest-\" + Janus.randomString(12),\n      pin: null,\n      feeds: [],\n      activeFeeds: [],\n      bitrateTimer: [],\n      userUUID: window.localStorage.getItem('token'),\n      fullname: null,\n      isOwner: false,\n      urls: [],\n      publisedCamera: false,\n      publishedMicrophone: false,\n      muted: true,\n      requests: [],\n      lowFeeds: [],\n      participants: [],\n      room: null\n\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_list\", this.getList);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    this.loggedIn();\n    MyActions.getInstance('posts', this.$f7route.params['postId'], this.state.token);\n    MyActions.getList('channels/my', this.state.page, {}, this.state.token);\n  }\n\n  componentDidUpdate(prevProps) { \n    if (this.state.messageFlag) {\n      MyActions.getList('posts/comments/'+this.$f7route.params['postId'], this.state.page, {}, this.state.token);\n    }\n  }\n\n  getInstance() {\n    var post = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (post && klass === 'Post') {\n      this.setState({\n        post: post,\n        id: post.id,\n        comments: post.comments,\n        deletable: post.deletable\n      }, () => this.pageAfterIn());\n    }\n    if(klass ==='PostDelete') {\n      this.$f7router.navigate('/posts/');\n    }\n  }\n\n  getList() {\n    var list = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (list && klass === 'Channel') {\n      this.setState({\n        channels: list,\n      });\n    }\n    if (list && klass === 'Comment') {\n      this.setState({\n        comments: list,\n      });\n    }\n    if (list &&  list[0] && klass === 'Channel') {\n      this.setState({\n        channelId: list[0].id\n      });\n    }\n  }\n\n  setInstance() {\n    var post = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (post && klass === 'Post') {\n      this.setState({\n        post: post,\n        comments: post.comments,\n        page: 1,\n      });\n    }\n    this.$$('#cm-form-'+this.state.rnd).val('');\n  }\n\n  loadMore() {\n    this.setState({ page: this.state.page + 1 }, () => {\n      MyActions.getInstance('posts', this.$f7route.params['postId'], this.state.token, this.state.page);\n    });\n  }\n\n  fab() {\n    if (this.state.post && this.state.post.editable){\n      return (\n        <Fab href={\"/posts/\" + this.state.post.id + \"/edit\"} target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"lime\">\n          <Icon ios=\"f7:edit\" aurora=\"f7:edit\" md=\"material:edit\"></Icon>\n          <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n        </Fab>\n      )\n    }\n  }\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n\n  interaction(interaction_type, interactionable_id, interactionable_type, source_type = null, source_id = null) {\n    var data = { interaction_type: interaction_type, interactionable_id: interactionable_id, interactionable_type: interactionable_type, source_type: source_type, source_id: source_id }\n    MyActions.setInstance('interactions', data, this.state.token);\n  }\n\n  rating(value) {\n    console.log('value: ' ,value)\n    var data = { post_id: this.state.id, value: value }\n    MyActions.setInstance('ratings', data, this.state.token);\n  }\n\n  submit() {\n    var data = { post_id: this.state.id, channel_id: this.state.selectedChannel }\n    MyActions.setInstance('shares', data, this.state.token);\n    const self = this;\n    self.$f7.sheet.close('.demo-sheet')\n  }\n\n\n  submitComment() {\n    var data = {post_id: this.state.id, content: this.state.commentContent, reply_id: this.state.replyTo  }\n    MyActions.setInstance('comments', data, this.state.token);\n    this.sendData();\n  }\n\n\n  deleteCommentConfirm(id){\n    const self = this;\n    const app = self.$f7;\n    app.dialog.confirm(dict.are_you_sure, dict.alert, () => self.deleteComment(id))\n  }\n\n  deleteComment(id) {\n    var data = { id: id }\n    MyActions.removeInstance('comments', data, this.state.token, this.state.page);\n  }\n\n  replyToComment(id) {\n    this.setState({ replyTo: id })\n    this.$$('#cm-form-'+this.state.rnd).focus()\n  }\n\n  removeReply() {\n    this.setState({ replyTo: null })\n  }\n\n  deletePost() {\n    var data = { id: this.state.id }\n    MyActions.removeInstance('posts', data, this.state.token, this.state.page);\n  }\n\n  deletePostConfirm(){\n    const self = this;\n    const app = self.$f7;\n    app.dialog.confirm(dict.are_you_sure, dict.alert, () => self.deletePost())\n  }\n\n  pageAfterIn() {\n    setTimeout(function () {\n      this.sessionCreate();\n      //this.unmute();\n    }.bind(this), 1200)\n  }\n\n\n  render() {\n    const { post, sheetOpened, channels, comments, rating, rnd, replyTo, deletable } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.posts} backLink={dict.back} />\n        <BlockTitle></BlockTitle>\n        {this.fab()}\n        <PostShow \n        post={post} comments={comments} rating={this.rating} rnd={rnd}\n        channels={channels} submitComment={this.submitComment} replyTo={replyTo}\n        deleteComment={this.deleteComment} submit={this.submit} \n        deleteCommentConfirm={this.deleteCommentConfirm} replyToComment={this.replyToComment}\n        removeReply={this.removeReply} deletable={deletable}\n        interaction={this.interaction} handleChange={this.handleChangeValue} \n        loadMore={this.loadMore} deletePost={this.deletePost}\n        deletePostConfirm={this.deletePostConfirm}\n        \n        />\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { Card, CardHeader, Link, CardContent, Row, Col, CardFooter} from 'framework7-react';\nimport crypto from 'crypto-js';\nimport InteractionMenu from \"../interactions/menu\"\nimport { dict } from \"../../Dict\";\n\nconst PostList = (props) => {\n  if (props.posts && props.posts.length > 0) {\n    return (\n      <React.Fragment>\n        <Row noGap>\n          {props.posts.map((post) =>\n            <Col width=\"100\" tabletWidth=\"33\" key={crypto.lib.WordArray.random(128/8)}> \n              <Card className=\"demo-facebook-card\">\n                <CardHeader className=\"no-border\">\n                <div className=\"demo-facebook-avatar\"><Link tooltip={post.profile.fullname} href={'/profiles/' + post.profile.id}><img src={post.profile.avatar} height=\"34\" /></Link></div>\n                  <div className=\"demo-facebook-name \">\n                    <div className=\"demo-facebook-profile \">\n                      <Link className=\"gray-color\" href={'/profiles/' + post.profile.id}>{post.profile.fullname.substring(0, 60)}</Link>\n                    </div>\n                    <Link tooltip={post.title} className=\"gray-color\" href={'/posts/' + post.id}>{post.title.substring(0, 20) + '..'}</Link></div>\n                </CardHeader>\n                <CardContent className='lightgray-color fs-12'>\n                  {post.content.substring(0, 150) + '...'}\n                </CardContent>\n                <CardFooter>\n                  <div className=\"fs-10\">\n                  <span className='pl-2'><i className=\"va fa fa-bookmark\"></i>({post.bookmarks})</span>\n                  <span className='pl-2'><i className=\"va fa fa-heart\"></i>({post.likes})</span>\n                  <span className='pl-2'><i className=\"va fa fa-link\"></i>({post.follows})</span>\n                  <span className='pl-2'><i className=\"va fa fa-star\"></i>({post.ratings_count})</span>\n                  <span className='pl-2'><i className=\"va fa fa-comment\"></i>({post.comments_count})</span>\n\n                  </div>\n                <Link className=\"gray-color fs-10\" href={'/posts/' + post.id}>\n                      {dict.view}\n                      <i className=\"va fa fa-arrow-left mr-2\"></i>\n                    </Link>\n                </CardFooter>\n              </Card>\n            </Col>\n          )}\n        </Row>\n      </React.Fragment>\n    )\n  } else {\n    return (<ul></ul>)\n  }\n}\nexport default PostList;\n","import React from \"react\";\nimport { Page, Navbar, Subnavbar, Searchbar, BlockTitle, Link, Fab, Icon, Toolbar, Tabs, Tab, Block } from 'framework7-react';\nimport PostList from \"./list\"\nimport { dict } from '../../Dict';\n\nconst PostIndex = (props) => {\n  function fab(a) {\n    var result = []\n    if (props.ability) {\n      props.ability.map((ab) => {\n        if (ab.title === a && ab.value) {\n          result.push(\n            <Fab href=\"/posts/new\" target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"deeporange\">\n            <Icon ios=\"f7:add\" aurora=\"f7:add\" md=\"material:add\"></Icon>\n            <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n          </Fab>\n          )\n        }\n      })\n    }\n    return result\n  }\n  return (\n    <Page      \n\n    infinite={true}\n    infiniteDistance={10}\n    infinitePreloader={props.showPreloader}\n    onInfinite={props.loadMore}>\n      <Navbar title={dict.posts} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n        <Subnavbar inner={false}>\n          <Searchbar\n            disableButtonText={dict.cancel}\n            placeholder={dict.search}\n            onChange={(e) => {\n              props.search({ query: e.target.value })\n            }}\n          ></Searchbar>\n        </Subnavbar>\n      </Navbar>\n\n      {fab('new_post')}\n      <div style={{marginTop: '100px;'}}>|</div>\n      <BlockTitle></BlockTitle>\n          <Block>\n            <PostList posts={props.posts} interaction={props.interaction} loadMore={props.loadMore} />\n          </Block>\n\n    </Page>\n  )\n}\nexport default PostIndex;\n","import React from \"react\"\nimport { Page, Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport PostIndex from \"../../containers/posts/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { loggedIn } from \"../../components/users/loggedIn.js\"\n\n\nexport default class Post extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.loggedIn = loggedIn.bind(this);\n    this.interaction = this.interaction.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.search = this.search.bind(this);\n    this.loadMore = this.loadMore.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      posts: [],\n      query: null,\n      page: 1,\n      ability: null,\n      profileId: null,\n      allowInfinite: true,\n      showPreloader: true,\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    this.loggedIn();\n    this.loadData();\n  }\n\n  loadData() {\n    MyActions.getList('posts', this.state.page, {}, this.state.token);\n    MyActions.getInstance('users', 'role', this.state.token);\n  }\n\n  search(obj) {\n    this.setState({ posts: [], page: 1 });\n    this.setState(obj, () => {\n      MyActions.getList('posts/search', this.state.page, { q: this.state.query }, this.state.token);\n    });\n\n  }\n\n  setInstance() {\n    var post = ModelStore.getIntance()\n    if (post) {\n      this.setState({ posts: this.state.posts.map(el => (el.id === post.id ? Object.assign({}, el, post) : el)) });\n    }\n  }\n\n\n  loadMore() {\n    //console.log('loadmore ...')\n    if (this.state.query && this.state.query.length > 0) {\n      this.setState({ page: this.state.page + 1 }, () => {\n        MyActions.getList('posts/search', this.state.page, {q: this.state.query }, this.state.token);\n      });\n    } else {\n      this.setState({ page: this.state.page + 1 }, () => {\n        MyActions.getList('posts', this.state.page, {}, this.state.token);\n      });\n      this.setState({ showPreloader: false });\n    }\n  }\n\n  getList() {\n    var posts = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (posts.length > 0 && klass === 'PostSearch') {\n      this.setState({\n        posts: posts,\n      });\n    }\n    if (posts.length > 0 && klass === 'Post') {\n      this.setState({\n        posts: this.state.posts.concat(posts),\n      });\n    }\n    this.setState({ showPreloader: true });\n  }\n\n\n  getInstance() {\n    var user = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (user && klass === 'UserRole') {\n      this.setState({\n        ability: user.the_ability,\n        profileId: user.profile_id\n      });\n    }\n  }\n\n  interaction(interaction_type, interactionable_id, interactionable_type, source_type = null, source_id = null) {\n    var data = { interaction_type: interaction_type, interactionable_id: interactionable_id, interactionable_type: interactionable_type, source_type: source_type, source_id: source_id }\n    MyActions.setInstance('interactions', data, this.state.token);\n  }\n\n  render() {\n    const { posts , ability, showPreloader} = this.state;\n    return (\n      <PostIndex \n        interaction={this.interaction} loadMore={this.loadMore} \n        posts={posts} search={this.search} ability={ability}\n        showPreloader={showPreloader}\n        />)\n  }\n}\n","import React from \"react\";\n\nconst ChannelOptions = (props) => {\n  var options = [<option value=''></option>]\n  if(props.content){\n\n    for (let i = 0; i < props.content.length; i++) {\n      options.push(\n        <option value={props.content[i].id}>\n          {props.content[i].title}\n        </option>\n      )\n    }\n\n  }\n  return options\n\n}\nexport default ChannelOptions;","import React from \"react\";\nimport { List, ListItem, ListInput, Link, CardFooter, Button, Card, CardHeader } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\nimport { Editor } from 'react-draft-wysiwyg';\nimport { EditorState, convertFromRaw } from \"draft-js\";\nimport ChannelOptions from \"../channels/options\";\n\n\nimport fa from '../../js/fa.js';\nconst PostForm = (props) => {\n  if (props.post) {\n    var channels = null;\n    if (props.channels) {\n      channels =\n        <ListItem\n          title={dict.channel}\n          smartSelect\n          smartSelectParams={{ pageBackLinkText: dict.back, searchbar: true, searchbarPlaceholder: dict.search }}\n        >\n          <select name=\"content\"\n            defaultValue={props.channelId}\n            onChange={(e) => {\n              props.handleChange({ channelId: e.target.value })\n            }}>\n            <ChannelOptions content={props.channels} />\n          </select>\n        </ListItem>\n    }\n    return (\n      <React.Fragment>\n        <Card>\n          <CardHeader>{dict.new_post}</CardHeader>\n          <List form>\n            {channels}\n            <ListInput\n              label={dict.title + '*'}\n              type=\"text\"\n              placeholder='...'\n              maxlength='65'\n              value={props.title}\n              onInput={(e) => {\n                props.handleChange({ title: e.target.value })\n              }}\n            />\n            <Editor\n              editorState={props.editorState}\n              placeholder={dict.content}\n              localization={{\n                locale: 'fa',\n                translations: fa\n              }}\n              toolbar={{\n                options: ['inline', 'list', 'link', 'image', 'embedded'],\n                inline: { options: ['bold', 'italic', 'underline'] },\n                image: {\n                  uploadCallback: props.uploadImageCallBack,\n                  previewImage: true,\n                },\n              }}\n              onEditorStateChange={props.onEditorStateChange}\n            />\n          </List>\n          <CardFooter>\n            <Link></Link>\n            <Button className=\"col\" fill onClick={props.submit}>{dict.submit}</Button>\n          </CardFooter>\n        </Card>\n\n      </React.Fragment>\n    )\n  } else {\n    return (null)\n  }\n}\nexport default PostForm;\n","export function uploadImageCallBack(file) {\n  return new Promise(\n    (resolve, reject) => {\n      const xhr = new XMLHttpRequest(); // eslint-disable-line no-undef\n      xhr.open('POST', 'http://localhost:3001/v1/uploads');\n      xhr.setRequestHeader('Authorization', 'Client-ID 8d26ccd12712fca');\n      const data = new FormData(); // eslint-disable-line no-undef\n      data.append('upload[image]', file);\n      xhr.send(data);\n      xhr.addEventListener('load', () => {\n        const response = JSON.parse(xhr.responseText);\n        resolve(response);\n      });\n      xhr.addEventListener('error', () => {\n        const error = JSON.parse(xhr.responseText);\n        reject(error);\n      });\n    },\n  );\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport PostForm from \"../../containers/posts/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\nimport { EditorState, convertFromRaw, convertToRaw } from 'draft-js';\nimport { Editor } from 'react-draft-wysiwyg';\nimport { uploadImageCallBack } from \"./uploader.js\"\n\nexport default class PostCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.onEditorStateChange = this.onEditorStateChange.bind(this)\n    this.getList = this.getList.bind(this)\n    this.uploadImageCallBack = uploadImageCallBack.bind(this);\n\n\n    this.state = {\n      post: {},\n      channels: null,\n      editorState: EditorState.createEmpty(),\n      token: window.localStorage.getItem('token'),\n      title: null,\n      channelId: null,\n      interaction: null,\n      page: 0\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n\n\n  submit() {\n    const blocks = convertToRaw(this.state.editorState.getCurrentContent()).blocks;\n    const value = blocks.map(block => (!block.text.trim() && '\\n') || block.text).join('\\n');\n    var data = { title: this.state.title, content: value, channel_id: this.state.channelId, draft: convertToRaw(this.state.editorState.getCurrentContent()) }\n    if (this.state.title) {\n      MyActions.setInstance('posts', data, this.state.token);\n    } else {\n      const self = this;\n      self.$f7.dialog.alert(dict.incomplete_data, dict.alert);\n    }\n  }\n\n  onEditorStateChange(editorState) {\n    this.setState({\n      editorState,\n    });\n  };\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  loadData() {\n    MyActions.getList('channels/my', this.state.page, {}, this.state.token);\n  }\n\n  componentDidUpdate(prev, prevstate) {\n  }\n\n  getList() {\n    var channels = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (channels && klass === 'Channel') {\n      this.setState({\n        channels: channels,\n      });\n    }\n  }\n\n  setInstance() {\n    const self = this;\n    this.$f7router.navigate('/posts/');\n  }\n\n\n\n\n\n  render() {\n    const { post, editorState, channels } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.post_form} />\n        <PostForm post={post} channels={channels} editorState={editorState} onEditorStateChange={this.onEditorStateChange} submit={this.submit} handleChange={this.handleChangeValue} uploadImageCallBack={this.uploadImageCallBack} />\n      </Page>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport PostForm from \"../../containers/posts/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\nimport { EditorState, convertFromRaw, convertToRaw } from 'draft-js';\nimport { Editor } from 'react-draft-wysiwyg';\nimport {uploadImageCallBack} from \"./uploader.js\"\n\nexport default class PostUpdate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.onEditorStateChange = this.onEditorStateChange.bind(this)\n    this.getList = this.getList.bind(this)\n    this.uploadImageCallBack = uploadImageCallBack.bind(this);\n\n\n    this.state = {\n      post: {title: '', draft: ''},\n      editorState: EditorState.createEmpty(),\n      token: window.localStorage.getItem('token'),\n      id: null,\n      title: null,\n      draft: null,\n      page: 0\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  //submit(){\n  //  var data = {id: this.state.id, title: this.state.title, draft:convertToRaw(this.state.editorState.getCurrentContent())}\n  //  MyActions.updateInstance('posts', data, this.state.token);\n  //}\n\n  submit() {\n    const blocks = convertToRaw(this.state.editorState.getCurrentContent()).blocks;\n    const value = blocks.map(block => (!block.text.trim() && '\\n') || block.text).join('\\n');\n    var data = {id: this.state.id, title: this.state.title, content: value, channel_id: this.state.channelId, draft: convertToRaw(this.state.editorState.getCurrentContent()) }\n    if (this.state.title) {\n      MyActions.updateInstance('posts', data, this.state.token);\n    } else {\n      const self = this;\n      self.$f7.dialog.alert(dict.incomplete_data, dict.alert);\n    }\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    if (this.$f7route.params['postId']) {\n      MyActions.getInstance('posts', this.$f7route.params['postId'], this.state.token);\n    }\n  }\n\n  getList() {\n\n  }\n\n  getInstance(){\n    var post = ModelStore.getIntance()\n\n    if (post){\n      const contentState = convertFromRaw(post.draft);\n      const editorState = EditorState.createWithContent(contentState);\n      this.setState({\n        post: post,\n        title: post.title,\n        id: post.id,\n        editorState: editorState\n      });\n    }\n    console.log(post);\n  }\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  onEditorStateChange(editorState){\n      this.setState({\n      editorState,\n    });\n  };\n\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/posts/');\n  }\n\n\n  render() {\n    const { post, title,editorState, channels } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.post_form} />\n        <PostForm post={post} title={title} channels={channels} editorState={editorState} onEditorStateChange={this.onEditorStateChange} submit={this.submit} handleChange={this.handleChangeValue} uploadImageCallBack={this.uploadImageCallBack} />\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, Link, Card, CardHeader, CardContent, CardFooter } from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\n\nconst NotificationList = (props) => {\n  if (props.notifications && props.notifications.length > 0) {\n    function profileLink(profile) {\n      return (<Link href='/profiles/'>{profile.fullname}</Link>)\n    }\n\n    function colorClass(notification) {\n      if (!notification.seen) {\n        return 'bg-blonde'\n      }\n    }\n    return (\n      <Card>\n        <CardHeader></CardHeader>\n        <CardContent>\n          <List mediaList>\n            {props.notifications.map((notification) =>\n              <ListItem\n                className={'fs-11 ' + colorClass(notification)}\n                key={crypto.lib.WordArray.random(32)}\n                link={'/' + notification.target_type + '/' + notification.target_id}\n                title={profileLink(notification.profile)}\n                text={notification.notification_text.title}\n              >\n                <img slot=\"media\" src={notification.profile.avatar} width=\"32\" height=\"32\" />\n              </ListItem>\n            )}\n          </List>\n        </CardContent>\n        <CardFooter></CardFooter>\n      </Card>\n    )\n  } else {\n    return (<ul></ul>)\n  }\n}\nexport default NotificationList;\n","import React from \"react\";\nimport { Page, Navbar, Subnavbar, Searchbar, BlockTitle, Link, Fab, Icon, Toolbar, Tabs, Tab, Block } from 'framework7-react';\nimport NotificationList from \"./list\"\nimport { dict } from '../../Dict';\n\nconst NotificationIndex = (props) => {\n  return (\n    <Page>\n      <Navbar title={dict.notifications} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n      </Navbar>\n\n      <NotificationList notifications={props.notifications} loadMore={props.loadMore} />\n\n    </Page>\n  )\n}\nexport default NotificationIndex;\n","import React from \"react\"\nimport { Page, Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport NotificationIndex from \"../../containers/notifications/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { loggedIn } from \"../../components/users/loggedIn.js\"\n\n\nexport default class Notification extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.loggedIn = loggedIn.bind(this);\n    this.interaction = this.interaction.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.search = this.search.bind(this);\n    this.loadMore = this.loadMore.bind(this);\n\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      notifications: [],\n      query: null,\n      page: 1\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  componentDidMount() {\n\n    this.loggedIn();\n    this.loadData();\n  }\n\n  loadData() {\n    MyActions.getList('notifications', this.state.page, {}, this.state.token);\n  }\n\n  search(obj) {\n    this.setState({ notifications: [], page: 1 });\n    this.setState(obj, () => {\n      MyActions.getList('notifications/search', this.state.page, { q: this.state.query });\n    });\n\n  }\n\n  loadMore() {\n    if (this.state.query && this.state.query.length > 0) {\n      this.setState({ page: this.state.page + 1 }, () => {\n        MyActions.getList('notifications/search', this.state.page, {q: this.state.query }, this.state.token);\n      });\n    } else {\n      this.setState({ page: this.state.page + 1 }, () => {\n        MyActions.getList('notifications', this.state.page, {}, this.state.token);\n      });\n    }\n  }\n\n\n\n  setInstance() {\n    var notification = ModelStore.getIntance()\n    if (notification) {\n      this.setState({ notifications: this.state.notifications.map(el => (el.id === notification.id ? Object.assign({}, el, notification) : el)) });\n    }\n  }\n\n  getList() {\n    var notifications = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (notifications.length > 0 && klass === 'Notification') {\n      this.setState({\n        notifications: this.state.notifications.concat(notifications),\n      });\n    }\n    var data = {}\n    MyActions.setInstance('notifications', data, this.state.token);\n  }\n\n  interaction(interaction_type, interactionable_id, interactionable_type, source_type = null, source_id = null) {\n    var data = { interaction_type: interaction_type, interactionable_id: interactionable_id, interactionable_type: interactionable_type, source_type: source_type, source_id: source_id }\n    MyActions.setInstance('interactions', data, this.state.token);\n  }\n\n  render() {\n    const { notifications } = this.state;\n    return (<NotificationIndex interaction={this.interaction} loadMore={this.loadMore} notifications={notifications} search={this.search} />)\n  }\n}\n","import React from \"react\";\nimport { Page, Navbar, List, BlockTitle, Link, Card, Block, Row, Col, Button, CardHeader, CardContent } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport InteractionMenu from \"../interactions/menu\"\nimport ShareMenu from \"../shares/menu\"\nimport PostList from \"../posts/list\"\n\nconst ChannelShow = (props) => {\n  if (props.channel) {\n    console.log(props.channel.posts)\n    return (\n      <React.Fragment>\n        <Block>\n          <Row noGap>\n            <Col width='80'></Col>\n\n            <Col width=\"20\">\n              <Button><InteractionMenu model={props.channel} klass='Channel' interaction={props.interaction} sourceType='Channel' sourceId={props.channel.id} /></Button>\n            </Col>\n          </Row>\n        </Block>\n        <Row noGap>\n          <Col width='100' tabletWidth='50'>\n            <Card>\n              <CardHeader className='fs-12'>{props.channel.title}</CardHeader>\n              <CardContent className='lightgray-color fs-12'>{props.channel.content}</CardContent>\n            </Card>\n          </Col>\n          <Col width='100' tabletWidth='50'>\n            <Card>\n              <CardHeader className='fs-12'>{dict.admins}</CardHeader>\n              <CardContent>\n                <Link tooltip={props.channel.profile.fullname} href={'/profiles/' + props.channel.profile.id}><div className=\"demo-facebook-avatar\"><img src={props.channel.profile.avatar} width=\"34\" height=\"34\" /></div></Link>\n              </CardContent>\n            </Card>\n          </Col>\n        </Row>\n\n        <BlockTitle>{dict.recent_posts}</BlockTitle>\n        <PostList posts={props.channel.posts} interaction={props.interaction} sourceType='Channel' sourceId={props.channel.id} />\n      </React.Fragment>\n    )\n  } else {\n    return (null)\n  }\n}\nexport default ChannelShow;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  Link,\n  Icon, Fab\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport ChannelShow from \"../../containers/channels/show\"\nimport { loggedIn } from \"../../components/users/loggedIn.js\"\n\nexport default class Layout extends Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.interaction = this.interaction.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.loggedIn = loggedIn.bind(this);\n\n    this.state = {\n      channel: null,\n      sheetOpened: false,\n      token: window.localStorage.getItem('token'),\n\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  componentDidMount(){\n    this.loggedIn();\n    MyActions.getInstance('channels', this.$f7route.params['channelId'], this.state.token);\n  }\n\n  getInstance(){\n    var channel = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (channel && klass === 'Channel'){\n      this.setState({\n        channel: channel,\n      });\n    }\n    console.log('channel', channel);\n  }\n\n  setInstance(){\n    var channel = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if(channel && klass === 'Channel'){\n      this.setState({\n        channel: channel,\n      });\n    }\n    console.log(channel);\n  }\n\n\n  fab(){\n    if (this.state.channel && this.state.channel.editable){\n      return(\n        <Fab href={\"/channels/\"+this.state.channel.id+\"/edit\"} target=\"#main-view\"  position=\"left-bottom\" slot=\"fixed\" color=\"lime\">\n          <Icon ios=\"f7:edit\" aurora=\"f7:edit\" md=\"material:edit\"></Icon>\n          <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n        </Fab>\n      )\n    }\n  }\n\n  interaction(interaction_type, interactionable_id, interactionable_type, source_type=null, source_id=null){\n    var data = {interaction_type: interaction_type, interactionable_id: interactionable_id, interactionable_type: interactionable_type, source_type: source_type, source_id: source_id}\n    MyActions.setInstance('interactions', data, this.state.token);\n  }\n\n  render() {\n    const {channel, sheetOpened} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.channels} backLink={dict.back} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n        </Navbar>\n\n        {this.fab()}\n        <ChannelShow channel={channel} sheetOpened={sheetOpened} interaction={this.interaction} />\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { Card, CardHeader, BlockTitle, Link, CardFooter, CardContent, Row, Col, Menu, MenuItem, MenuDropdown, Icon, MenuDropdownItem } from 'framework7-react';\nimport crypto from 'crypto-js';\nimport InteractionMenu from \"../interactions/menu\"\nimport { dict } from '../../Dict';\n\nconst ChannelList = (props) => {\n  if (props.channels && props.channels.length > 0) {\n    return (\n      <React.Fragment>\n      <Row noGap>\n        {props.channels.map((channel) =>\n          <Col width=\"100\" tabletWidth=\"33\" key={crypto.lib.WordArray.random(128/8)}>\n            <Card className=\"demo-facebook-card\">\n              <CardHeader className=\"no-border\">\n                <div className=\"demo-facebook-avatar\"><img src={channel.avatar} width=\"34\" height=\"34\" /></div>\n                <div className=\"demo-facebook-title \"><Link tooltip={channel.title} className=\"gray-color\" href={'/channels/' + channel.id}>{channel.title.substring(0, 30)}</Link></div>\n                <div className=\"demo-facebook-date\"><InteractionMenu model={channel} klass='Channel' interaction={props.interaction} sourceType='Channel' sourceId={channel.id} /></div>\n              </CardHeader>\n              <CardContent className='lightgray-color'>\n                  <span  className='fs-12'>{channel.content.substring(0, 120) + '...'}</span>\n                  <div className=\"demo-facebook-more\">\n                    <Link className=\"gray-color\" href={'/channels/' + channel.id}>\n                      {dict.view}\n                      <i className=\"va fa fa-arrow-left mr-2\"></i>\n                    </Link>\n                  </div>\n                </CardContent>\n            </Card>\n          </Col>\n        )}\n      </Row>\n      </React.Fragment>\n\n    )\n  } else {\n    return (<ul></ul>)\n  }\n}\nexport default ChannelList;\n","import React from \"react\";\nimport { Page, Navbar, Searchbar, Subnavbar, Link, BlockTitle, Fab, Icon, Tabs, Tab, Block, Toolbar} from 'framework7-react';\nimport ChannelList from \"./list\"\nimport { dict } from '../../Dict';\n\nconst ChannelIndex = (props) => {\n  function fab(a) {\n    var result = []\n    if (props.ability) {\n      props.ability.map((ab) => {\n        if (ab.title === a && ab.value) {\n          result.push(\n            <Fab href=\"/channels/new\" target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"deeporange\">\n            <Icon ios=\"f7:add\" aurora=\"f7:add\" md=\"material:add\"></Icon>\n            <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n          </Fab>\n          )\n        }\n      })\n    }\n    return result\n  }\n  return (\n    <Page      \n    //infinite\n    //infiniteDistance={50}\n    //infinitePreloader={props.showPreloader}\n    //onInfinite={props.loadMore}\n    >\n      <Navbar title={dict.channels} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n        <Subnavbar inner={false}>\n          <Searchbar\n            disableButtonText={dict.cancel}\n            placeholder={dict.search}\n            onChange={(e) => {\n              props.search({ query: e.target.value })\n            }}\n          ></Searchbar>\n        </Subnavbar>\n      </Navbar>\n      <div style={{marginTop: '100px;'}}>|</div>\n      <BlockTitle></BlockTitle>\n      {fab('new_channel')}\n      <ChannelList channels={props.channels} interaction={props.interaction} loadMore={props.loadMore} />\n\n    </Page>\n  )\n}\nexport default ChannelIndex;\n","import React from \"react\"\nimport { Page,Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport ChannelIndex from \"../../containers/channels/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict} from '../../Dict';\nimport Framework7 from 'framework7/framework7.esm.bundle';\nimport {loggedIn} from \"../../components/users/loggedIn.js\"\n\n\nexport default class Channel extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.loggedIn = loggedIn.bind(this);\n    this.interaction = this.interaction.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.search = this.search.bind(this);\n    this.loadMore = this.loadMore.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      channels: [],\n      query: null,\n      page: 1,\n      ability: null,\n      profileId: null,\n      allowInfinite: true,\n      showPreloader: true,\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount(){\n    this.loggedIn();\n    this.loadData();\n  }\n\n\n  getInstance() {\n    var user = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (user && klass === 'UserRole') {\n      this.setState({\n        ability: user.the_ability,\n        profileId: user.profile_id\n      });\n    }\n\n  }\n\n  loadData(){\n    MyActions.getList('channels', this.state.page, {} , this.state.token);\n    MyActions.getInstance('users', 'role', this.state.token);\n  }\n\n  search(obj) {\n    this.setState({ channels: [], page: 1 });\n    this.setState(obj, () => {\n      MyActions.getList('channels/search', this.state.page, { q: this.state.query }, this.state.token);\n    });\n  }\n\n\n  setInstance(){\n    var channel = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if(channel && klass === 'Channel') {\n      this.setState({channels: this.state.channels.map(el => (el.id === channel.id ? Object.assign({}, el, channel) : el))});\n    }\n  }\n\n\n\n  loadMore() {\n    if (this.state.query && this.state.query.length > 0) {\n      this.setState({ page: this.state.page + 1 }, () => {\n        MyActions.getList('channels/search', this.state.page, {q: this.state.query }, this.state.token);\n      });\n    } else {\n      this.setState({ page: this.state.page + 1 }, () => {\n        MyActions.getList('channels', this.state.page, {}, this.state.token);\n      });\n      this.setState({ showPreloader: false });\n    }\n\n  }\n\n  getList() {\n    var channels = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (channels.length > 0 && klass === 'ChannelSearch') {\n      this.setState({\n        channels: channels,\n      });\n    }\n    if (channels.length > 0 && klass === 'Channel') {\n      this.setState({\n        channels: this.state.channels.concat(channels),\n      });\n    }\n    this.setState({ showPreloader: true });\n  }\n\n  interaction(interaction_type, interactionable_id, interactionable_type, source_type=null, source_id=null){\n    var data = {interaction_type: interaction_type, interactionable_id: interactionable_id, interactionable_type: interactionable_type, source_type: source_type, source_id: source_id}\n    MyActions.setInstance('interactions', data, this.state.token);\n  }\n\n  render() {\n    const {channels, ability, profileId, showPreloader} = this.state;\n    return(\n      <ChannelIndex \n        interaction={this.interaction} search={this.search} \n        loadMore={this.loadMore} channels={channels}\n        ability={ability} showPreloader={showPreloader}\n        />)\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, ListInput, Block, Row, Button} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport crypto from 'crypto-js';\nimport fa from '../../js/fa.js';\nconst ChannelForm = (props) => {\n  if (props.channel) {\n    return (\n      <React.Fragment>\n        <List form>\n          <ListInput\n            label={dict.title}\n            type=\"text\"\n            placeholder='...'\n            value={props.title}\n            onInput={(e) => {\n              props.handleChange({ title: e.target.value})\n            }}\n            />\n          <ListInput\n            label={dict.details}\n            type=\"textarea\"\n            placeholder='...'\n            value={props.content}\n            resizable\n            onInput={(e) => {\n              props.handleChange({ content: e.target.value})\n            }}\n            />\n        </List>\n        <Block strong className='minus-z'>\n          <Row tag=\"p\">\n            <Button className=\"col\" fill onClick={props.submit}>{dict.submit}</Button>\n          </Row>\n        </Block>\n      </React.Fragment>\n    )} else {\n      return (null)\n    }\n  }\n  export default ChannelForm;\n","export function uploadImageCallBack(file) {\n  return new Promise(\n    (resolve, reject) => {\n      const xhr = new XMLHttpRequest(); // eslint-disable-line no-undef\n      xhr.open('POST', 'http://localhost:3001/v1/uploads');\n      xhr.setRequestHeader('Authorization', 'Client-ID 8d26ccd12712fca');\n      const data = new FormData(); // eslint-disable-line no-undef\n      data.append('upload[image]', file);\n      xhr.send(data);\n      xhr.addEventListener('load', () => {\n        const response = JSON.parse(xhr.responseText);\n        resolve(response);\n      });\n      xhr.addEventListener('error', () => {\n        const error = JSON.parse(xhr.responseText);\n        reject(error);\n      });\n    },\n  );\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport ChannelForm from \"../../containers/channels/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\nimport { EditorState, convertFromRaw, convertToRaw } from 'draft-js';\nimport { Editor } from 'react-draft-wysiwyg';\nimport {uploadImageCallBack} from \"./uploader.js\"\n\nexport default class ChannelCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.onEditorStateChange = this.onEditorStateChange.bind(this)\n    this.getList = this.getList.bind(this)\n    this.uploadImageCallBack = uploadImageCallBack.bind(this);\n\n\n    this.state = {\n      channel: {},\n      editorState: EditorState.createEmpty(),\n      token: window.localStorage.getItem('token'),\n      title: null,\n      content: null,\n      interaction: null,\n      page: 0\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n\n\n  submit(){\n    var data = {title: this.state.title, content: this.state.content}\n    MyActions.setInstance('channels', data, this.state.token);\n  }\n\n  onEditorStateChange(editorState){\n    this.setState({\n      editorState,\n    });\n  };\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n  }\n\n\n  getList() {\n  }\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/channels/');\n  }\n\n\n\n\n\n  render() {\n    const {channel, editorState} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.channel_form} backLink={dict.back} />\n        <BlockTitle>{dict.channel_form}</BlockTitle>\n        <ChannelForm channel={channel}  editorState={editorState} onEditorStateChange={this.onEditorStateChange} submit={this.submit}  handleChange={this.handleChangeValue} uploadImageCallBack={this.uploadImageCallBack}/>\n      </Page>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport ChannelForm from \"../../containers/channels/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class ChannelUpdate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.onEditorStateChange = this.onEditorStateChange.bind(this)\n    this.getList = this.getList.bind(this)\n\n    this.state = {\n      channel: {title: '', draft: ''},\n      token: window.localStorage.getItem('token'),\n      id: null,\n      title: null,\n      content: null,\n      page: 0\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  submit(){\n    var data = {id: this.state.id, title: this.state.title, content: this.state.content}\n    MyActions.updateInstance('channels', data, this.state.token);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    if (this.$f7route.params['channelId']) {\n      MyActions.getInstance('channels', this.$f7route.params['channelId'], this.state.token);\n    }\n  }\n\n  getList() {\n\n  }\n\n  getInstance(){\n    var channel = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (channel && klass === 'Channel'){\n      this.setState({\n        channel: channel,\n        title: channel.title,\n        id: channel.id,\n        content: channel.content\n      });\n    }\n  }\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  onEditorStateChange(editorState){\n      this.setState({\n      editorState,\n    });\n  };\n\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/channels/');\n  }\n\n\n  render() {\n    const { channel, title, content} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.form} backLink={dict.back} />\n        <BlockTitle>{dict.channel_form}</BlockTitle>\n        <ChannelForm channel={channel} title={title} content={content}  onEditorStateChange={this.onEditorStateChange} submit={this.submit}  handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, Button, Icon} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport crypto from 'crypto-js';\nconst UserOptions = (props) => {\n  var options = [<option value=''></option>]\n  if(props.users){\n    for (let i = 0; i < props.users.length; i++) {\n      options.push(\n        <option value={props.users[i].id}>\n          {props.users[i].email}\n        </option>\n      )\n    }\n\n  }\n  return options\n\n}\nexport default UserOptions;\n","import React from \"react\";\nimport { List, ListItem, BlockTitle, Block, Row, Button} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport UserOptions from \"../users/options\";\n\nconst AssignmentForm = (props) => {\n    return (\n      <React.Fragment>\n        <BlockTitle>{dict.assignment_form}</BlockTitle>\n        <List form inset>\n          <ListItem\n            title={dict.email}\n            smartSelect\n            >\n            <select name=\"content\"\n              onChange={(e) => {  props.handleChange({ user_id: e.target.value}) }}>\n              <UserOptions users={props.users}/>\n            </select>\n          </ListItem>\n        </List>\n      <Block strong inset>\n        <Row tag=\"p\">\n          <Button className=\"col\" fill onClick={props.submit}>{dict.submit}</Button>\n        </Row>\n      </Block>\n      </React.Fragment>\n    )\n  }\n  export default AssignmentForm;\n","  \nimport React from \"react\";\nimport { List, ListItem, Button, Icon} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport crypto from 'crypto-js';\nconst UserList = (props) => {\n    var body = []\n  if(props.users){\n\n    \n    for (let i = 0; i < props.users.length; i++) {\n        var td = []\n        body.push(<tr key={crypto.lib.WordArray.random(32)}>\n        <td key={crypto.lib.WordArray.random(32)}>{props.users[i].id}</td>\n        <td key={crypto.lib.WordArray.random(32)}>{props.users[i].email}</td>\n        <td className=\"checkbox-cell\" key={crypto.lib.WordArray.random(32)}>\n            <Button color='gray' onClick={() => props.removeRole(props.users[i].id)}>\n              <Icon ios=\"f7:trash\" aurora=\"f7:trash\" md=\"material:trash\"></Icon>\n            </Button>\n          </td>\n        </tr>)\n    }\n\n  return(\n    <div className=\"data-table card\">\n      <table>\n        <thead>\n          <tr>\n            <td>ID</td>\n            <td>Email</td>\n          </tr>\n        </thead>\n\n        <tbody>\n          {body}\n        </tbody>\n      </table>\n    </div>\n\n  )\n}\nelse {\n  return(null)\n}\n}\nexport default UserList;","import React from \"react\";\nimport { List, Icon, ListInput, Block, Row, Button, BlockTitle } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\nimport UserOptions from \"../users/options\";\n\nconst AccessControlForm = (props) => {\n    return (\n        <React.Fragment>\n            <BlockTitle>{dict.access_control_form}</BlockTitle>\n            <List form inset>\n                <ListInput\n                    label={dict.item}\n                    type=\"text\"\n                    placeholder='...'\n                    onInput={(e) => {\n                        props.handleChange({ abilityTitle: e.target.value })\n                    }}\n                />\n                <ListInput\n                    label={dict.value}\n                    type=\"select\"\n                    defaultValue={true}\n                    placeholder=\"Please choose...\"\n                    onChange={(e) => {\n                        props.handleChange({ abilityValue: e.target.value })\n                    }}\n                >\n                    <option value={true}>{dict.true}</option>\n                    <option value={false}>{dict.false}</option>\n                </ListInput>\n            </List>\n            <Block strong inset>\n                <Row tag=\"p\">\n                    <Button className=\"col\" fill onClick={props.addAbility}>{dict.submit}</Button>\n                </Row>\n            </Block>\n        </React.Fragment>\n    )\n}\nexport default AccessControlForm;\n","\nimport React from \"react\";\nimport { List, ListItem, Button, Icon, BlockTitle } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\nconst AbilityList = (props) => {\n    var body = []\n    if (props.ability) {\n\n\n        for (let i = 0; i < props.ability.length; i++) {\n            var td = []\n            body.push(<tr key={crypto.lib.WordArray.random(32)}>\n                <td key={crypto.lib.WordArray.random(32)}>{props.ability[i].title}</td>\n                <td key={crypto.lib.WordArray.random(32)}>{dict[props.ability[i].value]}</td>\n                <td className=\"checkbox-cell\" key={crypto.lib.WordArray.random(32)}>\n                    <Button color='gray' onClick={() => props.removeAbility(props.ability[i].title)}>\n                        <Icon ios=\"f7:trash\" aurora=\"f7:trash\" md=\"material:trash\"></Icon>\n                    </Button>\n                </td>\n            </tr>)\n        }\n\n        return (\n            <React.Fragment>\n            <BlockTitle>{dict.access_control_list}</BlockTitle>\n            <div className=\"data-table card\">\n                <table>\n                    <thead>\n                        <tr>\n                            <td>{dict.title}</td>\n                            <td>{dict.value}</td>\n                        </tr>\n                    </thead>\n\n                    <tbody>\n                        {body}\n                    </tbody>\n                </table>\n            </div>\n            </React.Fragment>\n\n        )\n    }\n    else {\n        return (null)\n    }\n}\nexport default AbilityList;","import React from \"react\";\nimport { Page, Navbar, List, BlockTitle, ListItem, Fab, Icon,Preloader, Block} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport AssignmentForm from \"../assignments/form\";\nimport AssignmentList from \"../assignments/list\";\n\nimport AccessControlForm from \"../access_controls/form\";\nimport AccessControlList from \"../access_controls/list\";\n\nconst RoleShow = (props) => {\n  if (props.role){\n    return(\n      <React.Fragment>\n        <BlockTitle>{dict.title}</BlockTitle>\n        <List simple-list>\n          <ListItem>{props.role.title}</ListItem>\n        </List>\n\n        <AccessControlList  ability={props.ability} removeAbility={props.removeAbility}/>\n        <AccessControlForm  addAbility={props.addAbility} handleChange={props.handleChange} />\n        \n\n        <AssignmentList users={props.assignedUsers} removeRole={props.removeRole} />\n        <AssignmentForm users={props.users}  submit={props.submit} handleChange={props.handleChange}/>\n\n        \n      </React.Fragment>\n    )\n  } else {\n    return(null)\n  }\n}\nexport default RoleShow;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon, Fab\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport RoleShow from \"../../containers/roles/show\"\n\nexport default class Layout extends Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.getList = this.getList.bind(this);\n    this.submit = this.submit.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.removeRole = this.removeRole.bind(this);\n    this.addAbility = this.addAbility.bind(this);\n    this.removeAbility = this.removeAbility.bind(this);\n\n    \n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      role: null,\n      id: null,\n      users: null,\n      assignedUsers: null,\n      user_id: null,\n      abilityTitle: '',\n      abilityValue: true,\n      ability: null,\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.getInstance);\n    ModelStore.on(\"got_list\", this.getList);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.getInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('roles', this.$f7route.params['roleId'], this.state.token);\n    MyActions.getList('users', this.state.page, {}, this.state.token);\n  }\n\n  getInstance() {\n    var role = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (role && klass === 'Role') {\n      this.setState({\n        role: role,\n        id: role.id,\n        assignedUsers: role.users,\n        ability: role.ability\n      });\n    }\n  }\n\n  getList() {\n    var users = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (users && klass === 'User') {\n      this.setState({\n        users: users,\n      });\n    }\n  }\n\n  submit() {\n    var data = { role_id: this.state.id, user_id: this.state.user_id }\n    MyActions.setInstance('users/assignments', data, this.state.token);\n  }\n\n  addAbility() {\n    var data = { id: this.state.id, ability_title: this.state.abilityTitle, ability_value: this.state.abilityValue}\n    MyActions.setInstance('roles/abilities', data, this.state.token);\n  }\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  fab() {\n    if (this.state.role) {\n      return (\n        <Fab href={\"/roles/\" + this.state.role.id + \"/edit\"} target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"lime\">\n          <Icon ios=\"f7:edit\" aurora=\"f7:edit\" md=\"material:edit\"></Icon>\n          <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n        </Fab>\n      )\n    }\n  }\n\n  removeRole(user_id) {\n    MyActions.removeInstance('users/assignments', { user_id: user_id, role_id: this.state.id }, this.state.token);\n  }\n\n  removeAbility(title){\n    MyActions.removeInstance('roles/abilities', { id: this.state.id, title: title }, this.state.token);\n  }\n\n  render() {\n    const { role, users, assignedUsers, ability } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.roles} backLink={dict.back} />\n        <BlockTitle></BlockTitle>\n        {this.fab()}\n        <RoleShow role={role} users={users} ability={ability} removeAbility={this.removeAbility} assignedUsers={assignedUsers} addAbility={this.addAbility} removeRole={this.removeRole} submit={this.submit} handleChange={this.handleChangeValue} />\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem} from 'framework7-react';\nimport crypto from 'crypto-js';\n\nconst RoleList = (props) => {\n\n  if (props.roles) {\n    return (\n      <List mediaList>\n        {props.roles.map((role) =>\n          <ListItem\n            key={crypto.lib.WordArray.random(32)}\n            link={\"/roles/\" + role.id}\n            ignoreCache={true}\n            title={role.title}\n            after=\"\"\n            subtitle=\"\"\n            text=\"\"\n            ></ListItem>\n        )}\n      </List>\n    )} else {\n      return (<ul></ul>)\n    }\n  }\n  export default RoleList;\n","import React from \"react\";\nimport { Page, Navbar, List, BlockTitle, ListItem, Fab, Icon,Preloader, Block} from 'framework7-react';\nimport RoleList from \"./list\"\nimport { dict} from '../../Dict';\n\nconst RoleIndex = (props) => {\n  return(\n    <Page>\n      <Navbar title={dict.roles} backLink={dict.back} >\n      </Navbar>\n      <BlockTitle>{dict.list}</BlockTitle>\n      <Fab href=\"/roles/new\" target=\"#main-view\"  position=\"left-bottom\" slot=\"fixed\" color=\"deeporange\">\n        <Icon ios=\"f7:add\" aurora=\"f7:add\" md=\"material:add\"></Icon>\n        <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n      </Fab>\n      <RoleList roles={props.roles}/>\n    </Page>\n  )\n}\nexport default RoleIndex;\n","import React from \"react\"\nimport { Page,Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport RoleIndex from \"../../containers/roles/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict} from '../../Dict';\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class Layout extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      roles: null,\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    MyActions.getList('roles', this.state.page, {}, this.state.token);\n  }\n\n  getList() {\n    var roles = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (roles && klass === 'Role'){\n      this.setState({\n        roles: roles,\n      });\n    }\n  }\n\n  render() {\n    const {roles} = this.state;\n    return(<RoleIndex roles={roles}/>)\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, ListInput, Block, Row, Button, BlockTitle } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\n\nconst RoleForm = (props) => {\n  if (props.defaultRole) {\n    var isDefaultRole = true;\n  } else {\n    var isDefaultRole = false\n  }\n  return (\n    <React.Fragment>\n      <BlockTitle>{dict.role}</BlockTitle>\n      <List form>\n        <ListInput\n          label={dict.title}\n          type=\"text\"\n          placeholder='...'\n          defaultValue={props.role.title}\n          onInput={(e) => {\n            props.handleChange({ title: e.target.value })\n          }}\n        />\n        <ListItem radio value={false} checked={!isDefaultRole} name=\"defaultRole\" title={dict.NonDefault}\n          onChange={(e) => {\n            console.log(e)\n            props.handleChange({ defaultRole: JSON.parse(e.target.value) })\n          }}>\n        </ListItem>\n        <ListItem radio value={true} checked={isDefaultRole} name=\"defaultRole\" title={dict.Default}\n          onChange={(e) => {\n            console.log(e)\n            props.handleChange({ defaultRole: JSON.parse(e.target.value) });\n          }}>\n        </ListItem>\n      </List>\n\n      <Block strong>\n        <Row tag=\"p\">\n          <Button className=\"col\" fill disabled={!props.editing} onClick={props.submit}>{dict.submit}</Button>\n        </Row>\n      </Block>\n    </React.Fragment>\n  )\n}\nexport default RoleForm;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport RoleForm from \"../../containers/roles/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class RoleCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      role: {},\n      defaultRole: true,\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  submit(){\n    var data = {title: this.state.title, default_role: this.state.defaultRole}\n    MyActions.setInstance('roles', data, this.state.token);\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/roles/');\n  }\n\n\n\n  render() {\n    const {role, defaultRole} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.role_form} backLink={dict.back} />\n        <BlockTitle>{dict.role_form}</BlockTitle>\n        <RoleForm \n          role={role} submit={this.submit} editing={true} \n          handleChange={this.handleChangeValue} defaultRole={defaultRole}\n          \n          />\n      </Page>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport RoleForm from \"../../containers/roles/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class DocumentUpdate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      role : {},\n      defaultRole: null,\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n\n  }\n\n\n  submit(){\n    var data = {id:this.state.id, title: this.state.title, default_role: this.state.defaultRole}\n    MyActions.updateInstance('roles', data,  this.state.token);\n  }\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    if (this.$f7route.params['roleId']) {\n      MyActions.getInstance('roles', this.$f7route.params['roleId'],  this.state.token);\n    }\n  }\n\n\n  getInstance(){\n    var role = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (role && klass === 'Role'){\n      this.setState({\n        title: role.title,\n        id: role.id,\n        role: role,\n        defaultRole: role.default_role\n      });\n    }\n  }\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/roles/');\n  }\n\n\n  render() {\n        const {role, defaultRole} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.role_form} backLink={dict.back} />\n        <BlockTitle>{dict.role_form}</BlockTitle>\n        <RoleForm role={role} defaultRole={defaultRole} submit={this.submit} editing={true} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { Page, Navbar, List, BlockTitle, ListItem, Fab, Icon,Preloader, Block} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport AssignmentForm from \"../assignments/form\";\nimport AssignmentList from \"../assignments/list\";\n\nimport AccessControlForm from \"../access_controls/form\";\nimport AccessControlList from \"../access_controls/list\";\n\nconst SettingShow = (props) => {\n  if (props.setting){\n    return(\n      <React.Fragment>\n        <BlockTitle>{dict.title}</BlockTitle>\n        <List simple-list>\n          <ListItem>{props.setting.title}</ListItem>\n        </List>\n\n        <BlockTitle>{dict.content}</BlockTitle>\n        <List simple-list>\n          <ListItem>{props.setting.content}</ListItem>\n        </List>\n\n        \n      </React.Fragment>\n    )\n  } else {\n    return(null)\n  }\n}\nexport default SettingShow;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon, Fab\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport SettingShow from \"../../containers/settings/show\"\n\nexport default class Layout extends Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.getList = this.getList.bind(this);\n    this.submit = this.submit.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.removeSetting = this.removeSetting.bind(this);\n    this.addAbility = this.addAbility.bind(this);\n    this.removeAbility = this.removeAbility.bind(this);\n\n    \n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      setting: null,\n      id: null,\n      users: null,\n      assignedUsers: null,\n      user_id: null,\n      abilityTitle: '',\n      abilityValue: true,\n      ability: null,\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.getInstance);\n    ModelStore.on(\"got_list\", this.getList);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.getInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('settings', this.$f7route.params['settingId'], this.state.token);\n    MyActions.getList('users', this.state.page, {}, this.state.token);\n  }\n\n  getInstance() {\n    var setting = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (setting && klass === 'Setting') {\n      this.setState({\n        setting: setting,\n        id: setting.id,\n        assignedUsers: setting.users,\n        ability: setting.ability\n      });\n    }\n  }\n\n  getList() {\n    var users = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (users && klass === 'User') {\n      this.setState({\n        users: users,\n      });\n    }\n  }\n\n  submit() {\n    var data = { setting_id: this.state.id, user_id: this.state.user_id }\n    MyActions.setInstance('users/assignments', data, this.state.token);\n  }\n\n  addAbility() {\n    var data = { id: this.state.id, ability_title: this.state.abilityTitle, ability_value: this.state.abilityValue}\n    MyActions.setInstance('settings/abilities', data, this.state.token);\n  }\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  fab() {\n    if (this.state.setting) {\n      return (\n        <Fab href={\"/settings/\" + this.state.setting.id + \"/edit\"} target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"lime\">\n          <Icon ios=\"f7:edit\" aurora=\"f7:edit\" md=\"material:edit\"></Icon>\n          <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n        </Fab>\n      )\n    }\n  }\n\n  removeSetting(user_id) {\n    MyActions.removeInstance('users/assignments', { user_id: user_id, setting_id: this.state.id }, this.state.token);\n  }\n\n  removeAbility(title){\n    MyActions.removeInstance('settings/abilities', { id: this.state.id, title: title }, this.state.token);\n  }\n\n  render() {\n    const { setting, users, assignedUsers, ability } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.settings} backLink={dict.back} />\n        <BlockTitle></BlockTitle>\n        {this.fab()}\n        <SettingShow setting={setting} users={users} ability={ability} removeAbility={this.removeAbility} assignedUsers={assignedUsers} addAbility={this.addAbility} removeSetting={this.removeSetting} submit={this.submit} handleChange={this.handleChangeValue} />\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem} from 'framework7-react';\nimport crypto from 'crypto-js';\n\nconst SettingList = (props) => {\n\n  if (props.settings) {\n    return (\n      <List mediaList>\n        {props.settings.map((setting) =>\n          <ListItem\n            key={crypto.lib.WordArray.random(32)}\n            link={\"/settings/\" + setting.id}\n            ignoreCache={true}\n            title={setting.title}\n            after=\"\"\n            subtitle=\"\"\n            text=\"\"\n            ></ListItem>\n        )}\n      </List>\n    )} else {\n      return (<ul></ul>)\n    }\n  }\n  export default SettingList;\n","import React from \"react\";\nimport { Page, Navbar, List, BlockTitle, ListItem, Fab, Icon,Preloader, Block} from 'framework7-react';\nimport SettingList from \"./list\"\nimport { dict} from '../../Dict';\n\nconst SettingIndex = (props) => {\n  return(\n    <Page>\n      <Navbar title={dict.settings} backLink={dict.back} >\n      </Navbar>\n      <BlockTitle>{dict.list}</BlockTitle>\n      <Fab href=\"/settings/new\" target=\"#main-view\"  position=\"left-bottom\" slot=\"fixed\" color=\"deeporange\">\n        <Icon ios=\"f7:add\" aurora=\"f7:add\" md=\"material:add\"></Icon>\n        <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n      </Fab>\n      <SettingList settings={props.settings}/>\n    </Page>\n  )\n}\nexport default SettingIndex;\n","import React from \"react\"\nimport { Page,Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport SettingIndex from \"../../containers/settings/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict} from '../../Dict';\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class Layout extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      settings: null,\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    MyActions.getList('settings', this.state.page, {}, this.state.token);\n  }\n\n  getList() {\n    var settings = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (settings && klass === 'Setting'){\n      this.setState({\n        settings: settings,\n      });\n    }\n  }\n\n  render() {\n    const {settings} = this.state;\n    return(<SettingIndex settings={settings}/>)\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, ListInput, Block, Row, Button, BlockTitle } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\n\nconst SettingForm = (props) => {\n  console.log(props)\n  return (\n    <React.Fragment>\n      <BlockTitle>{dict.setting}</BlockTitle>\n      <List form>\n        <ListInput\n          label='Title'\n          inputStyle={{direction: 'ltr'}}\n          type=\"text\"\n          placeholder='...'\n          defaultValue={props.title}\n          onInput={(e) => {\n            props.handleChange({ title: e.target.value })\n          }}\n        />\n        <ListInput\n          label=\"Schema\"\n          type=\"text\"\n          inputStyle={{direction: 'ltr'}}\n          value={props.content}\n          placeholder=\"JSON\"\n          onInput={(e) => {\n            props.handleChange({ content: e.target.value })\n          }}\n        ></ListInput>\n      </List>\n\n      <Block strong>\n        <Row tag=\"p\">\n          <Button className=\"col\" fill disabled={!props.editing} onClick={props.submit}>{dict.submit}</Button>\n        </Row>\n      </Block>\n    </React.Fragment>\n  )\n}\nexport default SettingForm;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport SettingForm from \"../../containers/settings/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class SettingCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: '',\n      content: '',\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  submit(){\n    var data = {title: this.state.title, content: this.state.content}\n    MyActions.setInstance('settings', data, this.state.token);\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/settings/');\n  }\n\n\n\n  render() {\n    const {title, content} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.setting_form} backLink={dict.back} />\n        <BlockTitle>{dict.setting_form}</BlockTitle>\n        <SettingForm title={title} content={content} submit={this.submit} editing={true} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport SettingForm from \"../../containers/settings/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class SettingCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n\n    \n    this.state = {\n      token: window.localStorage.getItem('token'),\n      title: '',\n      id: null,\n      content: '',\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('settings', this.$f7route.params['settingId'], this.state.token);\n  }\n\n\n  getInstance() {\n    var setting = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (setting && klass === 'Setting') {\n      this.setState({\n        title: setting.title,\n        id: setting.id,\n        content: setting.content\n      });\n    }\n  }\n\n  submit(){\n    var data = {id: this.state.id, title: this.state.title, content: this.state.content}\n    MyActions.updateInstance('settings', data, this.state.token);\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/settings/');\n  }\n\n\n\n  render() {\n    const {title, content} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.setting_form} backLink={dict.back} />\n        <BlockTitle>{dict.setting_form}</BlockTitle>\n        <SettingForm title={title} content={content} submit={this.submit} editing={true} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { Card, List, ListItem, CardContent, CardHeader} from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from '../../Dict';\n\nconst ChannelCompactList = (props) => {\n  if (props.channels && props.channels.length > 0) {\n    console.log(props.channels)\n    return (\n      <React.Fragment>\n        <Card>\n          <CardHeader>\n            {dict.channels}\n          </CardHeader>\n          <CardContent>\n          <List>\n            {props.channels.map((channel) =>\n              <ListItem\n                link={\"/channels/\"+channel.id}\n                title={channel.title.substring(0, 30)}\n              ></ListItem>\n            )}\n          </List>\n          </CardContent>\n        </Card>\n      </React.Fragment>\n\n    )\n  } else {\n    return (<ul></ul>)\n  }\n}\nexport default ChannelCompactList;\n","import React from \"react\";\nimport { Row, CardHeader, Card, CardContent, Col, Link, CardFooter, Chip, Icon } from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport 'moment/locale/fa';\n\nconst ExpertiesList = (props) => {\n\n    if (props.experties) {\n        if (props.editable) {\n            return (\n                <Row noGap>\n                    {props.experties.map((expert) =>\n                        <a onClick={() => props.removeExperties(expert)}>\n                            <Chip text={expert} mediaBgColor=\"orange\">\n                                <Icon slot=\"media\" aurora=\"fa:times\"></Icon>\n                            </Chip>\n                        </a>\n                    )}\n                </Row>\n            )\n        } else {\n            return (\n                <Row noGap>\n                    {props.experties.map((expert) =>\n                        <a href={'/experties/'+expert}><Chip text={expert} /></a>\n                    )}\n                </Row>\n            )\n        }\n\n    } else {\n        return (null)\n    }\n}\nexport default ExpertiesList;\n","import React from \"react\";\nimport { List, ListItem, Link} from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport 'moment/locale/fa';\n\nconst SimpleList = (props) => {\n  if(props.profiles){\n    return (\n      <List>\n        {props.profiles.map((profile) =>\n          <ListItem\n          title={profile.fullname}\n          subtitle=\"...\"\n          link={'/profiles/'+profile.id}>\n          <img slot=\"media\" src={profile.avatar} width=\"25\" />\n          </ListItem>\n        )}\n      </List>\n    )\n  } else {\n    return (<ul></ul>)\n  }\n}\nexport default SimpleList;\n","import React from \"react\";\nimport { Row, CardHeader, Card, CardContent, Col, Link, CardFooter, Chip, Icon } from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport 'moment/locale/fa';\nimport SimpleList from \"./simpleList\"\n\nconst Followers = (props) => {\n    console.log(props)\n    if (props.followers) {\n        return (\n            <Card>\n                <CardHeader>\n                    {dict.followers}\n                </CardHeader>\n                <CardContent>\n                    <SimpleList profiles={props.followers} />\n                </CardContent>\n            </Card>)\n    } else {\n        return (null)\n    }\n}\nexport default Followers;\n","import React from \"react\";\nimport { Row, CardHeader, Card, CardContent, Col, Link, CardFooter, Chip, Icon } from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport 'moment/locale/fa';\nimport SimpleList from \"./simpleList\"\n\nconst Followers = (props) => {\n    if (props.followees) {\n        return (\n            <Card>\n                <CardHeader>\n                    {dict.followees}\n                </CardHeader>\n                <CardContent>\n                    <SimpleList profiles={props.followees} />\n                </CardContent>\n            </Card>)\n    } else {\n        return (null)\n    }\n}\nexport default Followers;\n","import React from \"react\";\nimport { Card, Chip, CardContent, CardHeader, Col, Row, Tab, Tabs, Icon } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ActualForm from \"../actuals/form\";\nimport ActualList from \"../actuals/list\";\nimport { Chart } from 'react-charts'\nimport { color } from \"d3\";\nimport ChannelCompactList from \"../channels/compactlist\"\nimport ExpertiesList from \"./experties\";\nimport InteractionMenu from \"../interactions/menu\"\nimport Followers from \"./followers\"\nimport Followees from \"./followees\"\n\nconst ProfileShow = (props) => {\n  const data = React.useMemo(\n    () => [\n      {\n        label: 'Series 1',\n        data: [[0, 1], [1, 2], [2, 4], [3, 2], [4, 7]]\n      },\n      {\n        label: 'Series 2',\n        data: [[0, 3], [1, 1], [2, 5], [3, 6], [4, 4]]\n      }\n    ],\n    []\n  )\n\n  const axes = React.useMemo(\n    () => [\n      { primary: true, type: 'linear', position: 'bottom' },\n      { type: 'linear', position: 'left' }\n    ],\n    []\n  )\n\n  if (props.profile) {\n    return (\n\n      <Tabs>\n        <Tab id=\"tab-1\" className=\"page-content\" tabActive>\n          <Row>\n            <Col width=\"100\" tabletWidth=\"50\">\n\n              <Card>\n                <CardHeader>\n                  <img src={props.profile.avatar} width=\"80\"></img>\n                  <div className='profile-card'>{props.profile.fullname}</div>\n                  <div className=\"demo-facebook-date\"><InteractionMenu model={props.profile} klass='Profile' interaction={props.interaction} sourceType='Profile' sourceId={props.profile.id} /></div>\n                </CardHeader>\n                <CardContent>\n                  <ExpertiesList experties={props.profile.experties} />\n                </CardContent>\n              </Card>\n              <Followers followers={props.profile.followers} profile={props.profile}/>\n            </Col>\n\n            <Col width=\"100\" tabletWidth=\"50\">\n            <ChannelCompactList channels={props.channels} />\n            <Followees followees={props.profile.followees} profile={props.profile}/>\n            </Col>\n          </Row>\n\n        </Tab>\n        <Tab id=\"tab-2\" className=\"page-content\">\n          <Row noGap>\n            <Col width=\"100\" tabletWidth=\"50\">\n              {/*\n                  <div\n                    style={{\n                      display: 'inline-block',\n                      borderRadius: '5px',\n                      padding: '10px',\n                      marginRight: '10px',\n                      backgroundColor: 'white',\n                      width: '250px',\n                      height: '200px'\n                    }}\n                  > \n                    <Chart data={data} axes={axes} />\n                    </div>\n                    */}\n              {props.metas.map((m) =>\n                <React.Fragment>\n                  <ActualList meta={m.meta} editable={false} actuals={m.actuals} removeActual={props.removeActual} />\n                </React.Fragment>\n              )}\n            </Col>\n          </Row>\n        </Tab>\n\n        <Tab id=\"tab-3\" className=\"page-content\">\n          <div className=\"block-title\">Only Tablet Side By Side</div>\n          <Row>\n            <Col width=\"100\" tabletWidth=\"100\">\n              <div className=\"timeline timeline-sides\">\n                <div className=\"timeline-item\">\n                  <div className=\"timeline-item-date\">21 <small>DEC</small></div>\n                  <div className=\"timeline-item-divider\"></div>\n                  <div className=\"timeline-item-content\">\n                    <div className=\"timeline-item-inner\">\n                      <div className=\"timeline-item-time\">12:30</div>\n                      <div className=\"timeline-item-title\">Title</div>\n                      <div className=\"timeline-item-subtitle\">Subtitle</div>\n                      <div className=\"timeline-item-text\">Text</div>\n                    </div>\n                  </div>\n                </div>\n                <div className=\"timeline-item\">\n                  <div className=\"timeline-item-date\">21 <small>DEC</small></div>\n                  <div className=\"timeline-item-divider\"></div>\n                  <div className=\"timeline-item-content\">\n                    <div className=\"timeline-item-inner\">\n                      <div className=\"timeline-item-time\">12:30</div>\n                      <div className=\"timeline-item-title\">Title</div>\n                      <div className=\"timeline-item-subtitle\">Subtitle</div>\n                      <div className=\"timeline-item-text\">Text</div>\n                    </div>\n                  </div>\n                </div>\n              </div>\n            </Col>\n          </Row>\n        </Tab>\n      </Tabs >\n\n    )\n  } else {\n    return (null)\n  }\n}\nexport default ProfileShow;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Link,\n  Tabs,\n  Toolbar,\n  Tab,\n  Range,\n  Block,\n  Icon, Fab\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport ProfileShow from \"../../containers/profiles/show\"\n\nexport default class Layout extends Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.addTag = this.addTag.bind(this);\n    this.interaction = this.interaction.bind(this);\n    \n    this.state = {\n      token: window.localStorage.getItem('token'),\n      profile: null,\n      id: null,\n      actuals: null,\n      metas: null,\n      channels: null,\n      editable: false\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('profiles', this.$f7route.params['profileId'], this.state.token);\n  }\n\n  getInstance() {\n    var profile = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (profile && klass === 'Profile') {\n      this.setState({\n        profile: profile,\n        id: profile.id,\n        actuals: profile.actuals,\n        metas: profile.metas,\n        channels: profile.channels,\n        editable: profile.editable,\n      });\n    }\n  }\n\n  fab() {\n    if (this.state.profile && this.state.editable) {\n      return (\n        <Fab href={\"/profiles/\" + this.state.profile.id + \"/edit\"} target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"lime\">\n          <Icon ios=\"f7:edit\" aurora=\"f7:edit\" md=\"material:edit\"></Icon>\n          <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n        </Fab>\n      )\n    }\n  }\n\n  addTag(){\n    console.log('hey');\n  }\n\n  interaction(interaction_type, interactionable_id, interactionable_type, source_type = null, source_id = null) {\n    var data = { interaction_type: interaction_type, interactionable_id: interactionable_id, interactionable_type: interactionable_type, source_type: source_type, source_id: source_id }\n    MyActions.setInstance('interactions', data, this.state.token);\n  }\n\n  render() {\n    const { profile, actuals, metas, channels, editable } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.profiles} backLinkForce={true} backLink={dict.back} />\n        <Toolbar tabbar bottom>\n          <Link tabLink=\"#tab-1\" tabLinkActive><i className=\"va ml-5 fa fa-user-circle\"></i></Link>\n          <Link tabLink=\"#tab-2\"><i className=\"va ml-5 fa fa-bar-chart\"></i></Link>\n          <Link tabLink=\"#tab-3\"><i className=\"va ml-5 fa fa-list\"></i></Link>\n        </Toolbar>\n        {this.fab()}\n        <ProfileShow \n          profile={profile} actuals={actuals} channels={channels} \n          metas={metas} addTag={this.addTag} interaction={this.interaction}\n          editable={editable}\n          />\n\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List,ListItem } from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport 'moment/locale/fa';\nimport ExpertiesList from \"./experties\";\n\nconst ProfileList = (props) => {\n\n  if (props.profiles) {\n    return (\n      <List mediaList>\n        {props.profiles.map((profile) =>\n          <ListItem\n          key={crypto.lib.WordArray.random(32)}\n          link={\"/profiles/\" + profile.id}\n          title={profile.fullname}\n          after=\"\"\n          subtitle=\"\"\n          text=\"\"\n          >\n                <img slot=\"media\" src={profile.avatar} width=\"40\" height=\"40\" />\n          </ListItem>\n        )}\n      </List>\n    )\n  } else {\n    return (<ul></ul>)\n  }\n}\nexport default ProfileList;\n","import React from \"react\";\nimport { Page, Navbar, Searchbar, BlockTitle, Subnavbar, Fab, Icon, Link } from 'framework7-react';\nimport ProfileList from \"./list\"\nimport { dict } from '../../Dict';\n\nconst ProfileIndex = (props) => {\n  return (\n    <Page>\n      <Navbar title={dict.profiles} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n        <Subnavbar inner={false}>\n          <Searchbar\n            disableButtonText={dict.cancel}\n            placeholder={dict.search}\n            onChange={(e) => {\n              props.search({ query: e.target.value })\n            }}\n          ></Searchbar>\n        </Subnavbar>\n      </Navbar>\n      \n      <ProfileList profiles={props.profiles} interaction={props.interaction} />\n\n    </Page>\n  )\n}\nexport default ProfileIndex;\n","import React from \"react\"\nimport { Page,Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport ProfileIndex from \"../../containers/profiles/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict} from '../../Dict';\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class Layout extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.search = this.search.bind(this);\n    this.interaction = this.interaction.bind(this);\n    \n    \n    \n    this.state = {\n      token: window.localStorage.getItem('token'),\n      profiles: null,\n      query: null,\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    MyActions.getList('profiles', this.state.page);\n  }\n\n  search(obj){\n    this.setState(obj, () => {\n      MyActions.getList('profiles/search', this.state.page, {q: this.state.query});\n  });    \n  }\n\n  getList() {\n    var profiles = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (profiles && klass === 'Profile'){\n      this.setState({\n        profiles: profiles,\n      });\n    }\n  }\n\n  interaction(interaction_type, interactionable_id, interactionable_type, source_type=null, source_id=null){\n    var data = {interaction_type: interaction_type, interactionable_id: interactionable_id, interactionable_type: interactionable_type, source_type: source_type, source_id: source_id}\n    MyActions.setInstance('interactions', data, this.state.token);\n  }\n\n  render() {\n    const {profiles} = this.state;\n    return(<ProfileIndex profiles={profiles} interaction={this.interaction} search={this.search}/>)\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, ListInput, CardFooter, Button, Card, Link, CardHeader, CardContent, Row } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\nimport ActualForm from \"../actuals/form\";\nimport ActualList from \"../actuals/list\";\nimport ExpertiesList from \"./experties\";\nimport ImageUploader from 'react-images-upload';\nconst ProfileForm = (props) => {\n  if (props.name && props.metas && props.editable) {\n    return (\n      <React.Fragment>\n        <Card>\n          <CardHeader>{dict.profile_info}</CardHeader>\n          <CardContent>\n            <List form>\n              <ListInput\n                label={dict.firstname}\n                type=\"text\"\n                placeholder='...'\n                defaultValue={props.name}\n                onInput={(e) => {\n                  props.handleChange({ name: e.target.value })\n                }}\n              />\n\n              <ListInput\n                label={dict.surename}\n                type=\"text\"\n                placeholder='...'\n                defaultValue={props.surename}\n                onInput={(e) => {\n                  props.handleChange({ surename: e.target.value })\n                }}\n              />\n            </List>\n          </CardContent>\n          <CardFooter>\n            <Link></Link>\n            <Button className=\"col\" fill onClick={props.submit}>{dict.submit}</Button>\n          </CardFooter>\n        </Card>\n\n        <Card>\n          <CardHeader>{dict.experties}</CardHeader>\n          <CardContent>\n            <List>\n              <ListItem>\n                <ExpertiesList experties={props.experties} editable={true} removeExperties={props.removeExperties}/>\n              </ListItem>\n            </List>\n\n            <List form>\n              <ListInput\n                label={dict.new_experties}\n                type=\"text\"\n                placeholder='...'\n                defaultValue={props.expert}\n                onInput={(e) => {\n                  props.handleChange({ expert: e.target.value })\n                }}\n              />\n\n            </List>\n          </CardContent>\n          <CardFooter>\n            <Link></Link>\n            <Button className=\"col\" fill onClick={props.submitExperties}>{dict.submit}</Button>\n          </CardFooter>\n        </Card>\n\n\n        <Card>\n          <CardHeader>\n            <img src={props.avatar} width=\"80\"></img>\n          </CardHeader>\n          <ImageUploader\n            withIcon={true}\n            buttonText={dict.choose_image}\n            onChange={props.onDrop}\n            buttonClassName='upload-btn'\n            imgExtension={['.jpg', '.jpeg', '.png']}\n            maxFileSize={5242880}\n          />\n        </Card>\n        {props.metas.map((m) =>\n          <React.Fragment>\n            <ActualList meta={m.meta} editable={true} actuals={m.actuals} removeActual={props.removeActual} />\n            <ActualForm meta={m.meta} submit={props.submitFields} onChangeValue={props.handleChangeValueFields} />\n          </React.Fragment>\n        )}\n\n\n      </React.Fragment>\n    )\n  } else {\n    return (null)\n  }\n\n}\nexport default ProfileForm;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport ProfileForm from \"../../containers/profiles/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class ProfileCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.handleChangeValueFields = this.handleChangeValueFields.bind(this);\n    this.removeActual = this.removeActual.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.submitFields = this.submitFields.bind(this);\n    this.onDrop = this.onDrop.bind(this);    \n    this.getList = this.getList.bind(this);\n    \n    \n    this.getList = this.getList.bind(this);\n\n    this.state = {\n      profile: {},\n      metas: null,\n      token: window.localStorage.getItem('token'),\n      fields: [],\n      name: 'dd',\n      surename: '',\n      pictures: [],\n      avatar: null,\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.getInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  componentDidMount(){\n    this.loadData();\n\n  }\n\n  loadData(){\n    MyActions.getList('metas', this.state.page);\n  }\n\n  onDrop(picture) {\n    console.log(picture[0])\n    MyActions.fileUpload('profiles', this.state.id, picture[0], this.state.token);\n  }\n\n\n  submit(){\n    var data = {id: this.state.id, name: this.state.name, surename: this.state.surename}\n    MyActions.updateInstance('profiles', data, this.state.token);\n  }\n\n  submitFields(){\n    var data = {meta_id: this.state.metaId, content: this.state.fields}\n    MyActions.setInstance('actuals', data, this.state.token);\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  handleChangeValueFields(key, value, metaId) {\n    var fields = this.state.fields\n    if (fields.length > 0) {\n      for (let i = 0; i < fields.length; i++) {\n        if (fields[i].fid && fields[i].fid === key) {\n          let newState = Object.assign({}, this.state);\n          newState.fields[i] = { fid: key, value: value, metaId: metaId }\n          this.setState(newState);\n        } else {\n          this.setState({ fields: this.state.fields.concat({ fid: key, value: value , metaId:metaId}) });\n        }\n      }\n    } else {\n      this.setState({ fields: this.state.fields.concat({ fid: key, value: value, metaId:metaId }) });\n    }\n  }\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/profiles/');\n  }\n\n  getInstance() {\n    var profile = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (profile && klass === 'Profile') {\n      this.setState({\n        metas: profile.metas,\n        profile: profile\n      });\n    }\n  }\n\n\n  removeActual(uuid){\n    MyActions.removeInstance('actuals', {uuid: uuid});\n  }\n\n  getList() {\n    var metas = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (metas && klass === 'Meta'){\n      this.setState({\n        metas: metas,\n      });\n    }\n  }\n\n\n\n  render() {\n    const {profile, metas, name, avatar, surename} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.profile_form} backLink={dict.back} />\n        <BlockTitle>{dict.profile_form}</BlockTitle>\n        <ProfileForm name={name} avatar={avatar} surename={surename} metas={metas} onDrop={this.onDrop} removeActual={this.removeActual} submitFields={this.submitFields} submit={this.submit} editing={true} handleChangeValueFields={this.handleChangeValueFields} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  BlockTitle,\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport ProfileForm from \"../../containers/profiles/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class ProfileCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.handleChangeValueFields = this.handleChangeValueFields.bind(this);\n    this.removeActual = this.removeActual.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.submitFields = this.submitFields.bind(this);\n    this.onDrop = this.onDrop.bind(this);    \n    this.getList = this.getList.bind(this);\n    this.submitExperties = this.submitExperties.bind(this);\n    this.removeExperties = this.removeExperties.bind(this);\n    \n\n    \n\n    this.state = {\n      name: null,\n      surename: null,\n      metas: null,\n      metaId: null,\n      actuals: null,\n      experties: null,\n      expert: null,\n      token: window.localStorage.getItem('token'),\n      fields: [],\n      id: null, \n      pictures: [],\n      avatar: null,\n      editable: false,\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.getInstance);\n    ModelStore.on(\"deleted_instance\", this.getInstance);\n    ModelStore.on(\"file_posted\", this.getInstance);    \n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.getInstance);\n    ModelStore.removeListener(\"deleted_instance\", this.getInstance);\n    ModelStore.removeListener(\"file_posted\", this.getInstance);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    if (this.$f7route.params['profileId']) {\n      MyActions.getInstance('profiles', this.$f7route.params['profileId'], this.state.token);\n    }\n  }\n\n  onDrop(picture) {\n    console.log(picture[0])\n    MyActions.fileUpload('profiles', this.state.id, picture[0], this.state.token);\n  }\n\n\n  submit(){\n    var data = {id: this.state.id, name: this.state.name, surename: this.state.surename}\n    MyActions.updateInstance('profiles', data, this.state.token);\n  }\n\n  submitFields(){\n    var data = {meta_id: this.state.metaId, content: this.state.fields}\n    MyActions.setInstance('actuals', data, this.state.token);\n  }\n\n  submitExperties(){\n    var data = {id: this.state.id, experties: this.state.expert}\n    MyActions.setInstance('profiles/add_experties/'+this.$f7route.params['profileId'], data, this.state.token);\n  }\n\n  removeExperties(experties){\n    var data = {id: this.state.id, experties: experties}\n    MyActions.setInstance('profiles/remove_experties/'+this.$f7route.params['profileId'], data, this.state.token);\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  handleChangeValueFields(key, value, metaId) {\n    var fields = this.state.fields\n    if (fields.length > 0) {\n      for (let i = 0; i < fields.length; i++) {\n        if (fields[i].fid && fields[i].fid === key) {\n          let newState = Object.assign({}, this.state);\n          newState.fields[i] = { fid: key, value: value, metaId: metaId }\n          this.setState(newState);\n        } else {\n          this.setState({ fields: this.state.fields.concat({ fid: key, value: value , metaId:metaId}) });\n        }\n      }\n    } else {\n      this.setState({ fields: this.state.fields.concat({ fid: key, value: value, metaId:metaId }) });\n    }\n  }\n\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/profiles/');\n  }\n\n  getInstance() {\n    var profile = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (profile && klass === 'Profile') {\n      this.setState({\n        id: profile.id, \n        metas: profile.metas,\n        name: profile.name,\n        surename : profile.surename,\n        avatar: profile.avatar,\n        editable: profile.editable,\n        experties: profile.experties\n      });\n    }\n  }\n\n\n  removeActual(uuid){\n    MyActions.removeInstance('actuals', {uuid: uuid});\n  }\n\n  getList() {\n    var metas = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (metas && klass === 'Meta'){\n      this.setState({\n        metas: metas,\n      });\n    }\n  }\n\n\n\n  render() {\n    const {name, surename, avatar,metas, actuals, experties, editable} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.profile_form} backLink={dict.back} />\n        <BlockTitle>{dict.profile_form}</BlockTitle>\n        <ProfileForm \n          name={name} avatar={avatar} surename={surename} \n          metas={metas} experties={experties} onDrop={this.onDrop} \n          removeActual={this.removeActual} submitFields={this.submitFields} \n          submit={this.submit} editing={true} \n          handleChangeValueFields={this.handleChangeValueFields} \n          handleChange={this.handleChangeValue} submitExperties={this.submitExperties} \n          removeExperties={this.removeExperties} editable={editable}/>\n      </Page>\n    );\n  }\n}\n\n","import React from \"react\";\nimport { Page, Navbar, Searchbar, BlockTitle, NavRight, Fab, Icon, Link } from 'framework7-react'; import crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\nimport Moment from 'react-moment';\nimport 'moment-timezone';\nimport 'moment/locale/fa';\nimport SimpleList from \"../profiles/simpleList\"\n\nconst FriendshipIndex = (props) => {\n    if (props.friendship) {\n        return (\n            <Page >\n                <Navbar title={dict.profiles} backLink={dict.back}>\n                    <Link panelOpen=\"right\">\n                        <Icon f7=\"bars\"></Icon>\n                    </Link>\n\n                </Navbar>\n                <BlockTitle></BlockTitle>\n                <SimpleList profiles={props.friendship.followees} />\n            </Page>\n        )\n    } else {\n        return (null)\n    }\n}\nexport default FriendshipIndex;\n","import React from \"react\"\nimport { Page, Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport FriendshipIndex from \"../../containers/friendships/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { loggedIn } from \"../users/loggedIn.js\"\n\n\nexport default class Friendship extends React.Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.loggedIn = loggedIn.bind(this);\n\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      friendship: null,\n      query: null,\n      page: 1\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    this.loggedIn();\n    this.loadData();\n  }\n\n  loadData() {\n    MyActions.getInstance('friendships', this.$f7route.params['sourceId'], this.state.token);\n  }\n\n\n  getInstance() {\n    var friendship = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (friendship && klass === 'Friendship') {\n      this.setState({\n        friendship: friendship,\n        id: friendship.id,\n      });\n    }\n    console.log(friendship, klass)\n  }\n\n\n\n  render() {\n    const { friendship } = this.state;\n    return (<FriendshipIndex  friendship={friendship}  />)\n  }\n}\n","import React from \"react\";\nimport { Page, Navbar, List, Button, ListItem, ListInput, Icon, Link, Card, CardHeader, CardContent, CardFooter } from 'framework7-react'; import crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\n\n\n\nconst PrivacyIndex = (props) => {\n    if (props.profilePrivacy) {\n        function findSetting(settings, title){\n            for (let i = 0; i < settings.length; i++) {\n                if(settings[i].title == title){\n                    return settings[i].value\n                }\n            }\n        }\n        function options(op, title,settings) {\n            var result = [<option></option>]\n            var selected = false\n            for (let i = 0; i < op.length; i++) {\n                if(op[i].title == findSetting(settings, title)){\n                    selected = true\n                } else {\n                    selected = false\n                }\n                result.push(\n                    <option value={op[i].title} selected={selected}>\n                        {op[i].label}\n                    </option>\n                )\n            }\n            return result\n        }\n\n\n        return (\n            <Page >\n                <Navbar title={dict.privacy_settings} backLink={dict.back}>\n                    <Link panelOpen=\"right\">\n                        <Icon f7=\"bars\"></Icon>\n                    </Link>\n                </Navbar>\n                <Card>\n                    <CardHeader>{dict.settings}</CardHeader>\n                    <CardContent>\n                        <List >\n                            {props.profilePrivacy.setting_schemas.map((schema) =>\n                                <ListInput\n                                    label={schema.label}\n                                    type=\"select\"\n                                    onChange={(e) => {\n                                        props.handleChangeValue( schema.title, e.target.value)\n                                    }\n                                    }\n                                >\n                                    {options(schema.options, schema.title ,props.privacySettings)}\n                                </ListInput>)}\n                        </List>\n                    </CardContent>\n                    <CardFooter>\n                        <Link></Link>\n                         <Button className=\"col\" fill  onClick={props.submit}>{dict.submit}</Button>          \n                    </CardFooter>\n                </Card>\n            </Page>\n        )\n    } else {\n        return (null)\n    }\n}\nexport default PrivacyIndex;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport PrivacyIndex from \"../../containers/privacy/index\"\n\nexport default class Layout extends Component {\n  constructor() {\n    super();\n    this.getInstance = this.getInstance.bind(this);\n    this.submit = this.submit.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    \n    this.state = {\n      token: window.localStorage.getItem('token'),\n      profilePrivacy: null,\n      privacySettings: null,\n      fields: [],\n\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('privacy', 1, this.state.token);\n  }\n\n  getInstance() {\n    var profilePrivacy = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (profilePrivacy && klass === 'Privacy') {\n      this.setState({\n        profilePrivacy: profilePrivacy,\n        privacySettings: profilePrivacy.privacy_settings,\n        fields : profilePrivacy.privacy_settings\n      });\n    }\n  }\n\n  setInstance(){\n    const self = this;\n    self.$f7.dialog.alert(dict.completed_successfully, dict.message);\n  }\n\n\n  submit() {\n    var data = { id: 1, privacy: this.state.fields}\n    MyActions.setInstance('privacy', data, this.state.token);\n  }\n\n\n\n  handleChangeValue(key, value) {\n    var fields = this.state.fields\n    if (fields.length > 0) {\n      for (let i = 0; i < fields.length; i++) {\n        if (fields[i].title && fields[i].title == key) {\n          let newState = Object.assign({}, this.state);\n          newState.fields[i] = { title: key, value: value }\n          this.setState(newState);\n        } \n      }\n    } else {\n      this.setState({ fields: this.state.fields.concat({ title: key, value: value }) });\n    }\n  }\n\n  render() {\n    const { profilePrivacy, privacySettings } = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.privacy_settings} backLink={dict.back} />\n        <PrivacyIndex profilePrivacy={profilePrivacy} privacySettings={privacySettings} handleChangeValue={this.handleChangeValue} submit={this.submit}/>\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, Link, Card, CardHeader, CardContent, CardFooter } from 'framework7-react';\nimport crypto from 'crypto-js';\nimport { dict } from \"../../Dict\";\n\nconst BookmarkList = (props) => {\n  console.log(props.bookmarks)\n  if (props.bookmarks) {\n    return (\n      <List>\n        {props.bookmarks.map((bookmark) =>\n          <ListItem\n            className={'fs-11 '}\n            key={crypto.lib.WordArray.random(32)}\n            link={'/' + bookmark.model + '/' + bookmark.id}\n            title={bookmark.title}\n          >\n          </ListItem>\n        )}\n      </List>\n\n    )\n  } else {\n    return (<ul></ul>)\n  }\n}\nexport default BookmarkList;\n","import React from \"react\";\nimport { Page, Navbar, Subnavbar, Searchbar, BlockTitle, Link, Fab, Icon, Toolbar, Tabs, Tab, Block } from 'framework7-react';\nimport BookmarkList from \"./list\"\nimport { dict } from '../../Dict';\n\nconst BookmarkIndex = (props) => {\n  return (\n    <Page>\n      <Navbar title={dict.bookmarks} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n      </Navbar>\n\n      <BookmarkList bookmarks={props.bookmarks} loadMore={props.loadMore} />\n\n    </Page>\n  )\n}\nexport default BookmarkIndex;\n","import React from \"react\"\nimport { Page,Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport BookmarkIndex from \"../../containers/bookmarks/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict} from '../../Dict';\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class Layout extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      bookmarks: null,\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    MyActions.getList('bookmarks', this.state.page, {}, this.state.token);\n  }\n\n  getList() {\n    var bookmarks = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (bookmarks && klass === 'Bookmark'){\n      this.setState({\n        bookmarks: bookmarks,\n      });\n    }\n    console.log(bookmarks, klass)\n  }\n\n  render() {\n    const {bookmarks} = this.state;\n    return(<BookmarkIndex bookmarks={bookmarks}/>)\n  }\n}\n","import React from \"react\";\nimport { Link, List, CardHeader, ListInput, CardContent, CardFooter, Button, Page, Card, Navbar, Icon } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\nconst LoginForm = (props) => {\n  return (\n    <Page>\n      <Navbar title={dict.sign_up} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n      </Navbar>\n      <Card>\n        <CardHeader>{dict.login}</CardHeader>\n        <CardContent className='mh-auto'>\n          <List >\n            <ListInput\n              label={dict.email}\n              type=\"text\"\n              autofocus={true}\n              placeholder={dict.enter_your_email}\n              value={props.email}\n              onInput={(e) => {\n                props.handleChange({ email: e.target.value })\n              }}\n            />\n            {/*<ListInput\n              label={dict.password}\n              type=\"password\"\n              placeholder={dict.enter_your_password}\n              value={props.password}\n              onInput={(e) => {\n                props.handleChange({ password: e.target.value })\n              }}\n            />*/}\n          </List>\n        </CardContent>\n        <CardFooter>\n          <Link href=\"/sign_up/\" animate={false} ignoreCache={true}>{dict.you_can_sign_up} </Link>\n          <Button fill className='fs-11 external f-color-black bg-teal' href=\"https://auth.ut.ac.ir:8443/cas/login?service=https%3A%2F%2Fsn.ut.ac.ir%2Fusers%2Fservice\"  animate={false} ignoreCache={true}>{dict.cas} </Button>\n          <Link className=\"btn-notice\"></Link>\n          <Button className=\"col btn\" fill onClick={props.submit}>{dict.login}</Button>\n        </CardFooter>\n      </Card>\n    </Page>\n  )\n}\nexport default LoginForm;\n","import React from 'react';\nimport {\n  Page,\n  Navbar,\n  NavLeft,\n  NavTitle,\n  NavRight,\n  Link,\n  Toolbar,\n  Block,\n  BlockTitle,\n  List,\n  ListItem,\n  Row,\n  Col,\n  Button, Icon, Fab,Searchbar, Subnavbar, LoginScreenTitle, ListInput, ListButton, BlockFooter\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport LoginForm from \"../../containers/users/Login\"\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class extends React.Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      email: '',\n      password: '',\n    };\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n  componentDidMount(){\n    if(this.$f7route.params['token']) {\n      MyActions.setInstance('users/validate_token', {}, this.$f7route.params['token']);\n    }\n    if(this.state.token && this.state.token.length > 10){\n      MyActions.setInstance('users/validate_token', {}, this.state.token);\n    }\n  }\n\n  submit(){\n    var data = {email: this.state.email, password: this.state.password}\n    MyActions.setInstance('users/login', data);\n  }\n\n  setInstance(){\n    var klass = ModelStore.getKlass()\n    if (klass === 'Login') {\n      this.$f7router.navigate('/verification/'+this.state.email);\n    }\n    if (klass === 'Validate') {\n      this.$f7router.navigate('/');\n      window.location.reload()\n    }\n    console.log(klass)\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  render() {\n    const {username, password} = this.state;\n    return (\n      <LoginForm submit={this.submit} handleChange={this.handleChangeValue}/>\n    )\n  }\n\n}\n","import React from 'react';\nimport {\n  Page,\n  Navbar,\n  NavLeft,\n  NavTitle,\n  NavRight,\n  Link,\n  Toolbar,\n  Block,\n  BlockTitle,\n  List,\n  ListItem,\n  Row,\n  Col,\n  Button, Icon, Fab,Searchbar, Subnavbar, LoginScreenTitle, ListInput, ListButton, BlockFooter\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport LoginForm from \"../../containers/users/Login\"\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class extends React.Component {\n  constructor() {\n    super();\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n\n    this.state = {\n      email: '',\n      password: '',\n    };\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n  componentDidMount(){\n    MyActions.setInstance('users/validate_token', {}, this.$f7route.params['token']);\n  }\n\n  setInstance() {\n    var user = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (klass === 'Validate') {\n      window.localStorage.setItem('token', user.token);\n      var last = window.localStorage.getItem('url')\n      if(last && last.length > 5){\n        //this.$f7router.navigate(last);\n        window.location.replace(last);\n        window.localStorage.setItem('url', '');\n        setTimeout(function(){\n          window.location.reload();\n        });\n      } else {\n        this.$f7router.navigate('/');\n        setTimeout(function(){\n          window.location.reload();\n        });\n      }\n    } else {\n      this.$f7router.navigate('/login_error/');\n      setTimeout(function(){\n        window.location.reload();\n      });\n    }\n  }\n\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  render() {\n    const {username, password} = this.state;\n    return (\n      <LoginForm submit={this.submit} handleChange={this.handleChangeValue}/>\n    )\n  }\n\n}\n","import React from \"react\";\nimport { Link, List, ListItem, ListInput, Navbar, Icon, Button, Page, LoginScreenTitle, ListButton, CardFooter, Card, CardHeader, CardContent } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\nconst SignUpForm = (props) => {\n  return (\n    <Page>\n      <Navbar title={dict.sign_up} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n      </Navbar>\n      <Card>\n        <CardHeader>{dict.sign_up}</CardHeader>\n        <CardContent>\n          <List >\n            <ListInput\n              label={dict.firstname + ' *'}\n              placeholder={dict.enter_your_name}\n              type=\"text\"\n              name={crypto.lib.WordArray.random(32)}\n              onInput={(e) => {\n                props.handleChange({ name: e.target.value })\n              }}\n            />\n\n            <ListInput\n              label={dict.surename + ' *'}\n              placeholder={dict.enter_your_surename}\n              type=\"text\"\n              name={crypto.lib.WordArray.random(32)}\n              onInput={(e) => {\n                props.handleChange({ surename: e.target.value })\n              }}\n            />\n\n\n            <ListInput\n              label={' * ' + dict.email}\n              type=\"email\"\n              validate\n              placeholder={dict.enter_your_email}\n              className='ltr'\n              value={props.email}\n              onInput={(e) => {\n                props.handleChange({ email: e.target.value })\n              }}\n            />\n          {/*\n            <ListInput\n              label={dict.password + ' *'}\n              type=\"password\"\n              placeholder={dict.enter_your_password}\n              autocomplete='new-password'\n              name={crypto.lib.WordArray.random(32)}\n              value={props.password}\n              onInput={(e) => {\n                props.handleChange({ password: e.target.value })\n              }}\n            />\n            <ListInput\n              label={dict.password_confirmation + ' *'}\n              type=\"password\"\n              autocomplete='off'\n              placeholder={dict.enter_your_password_confirmation}\n              value={props.password}\n              onInput={(e) => {\n                props.handleChange({ password_confirmation: e.target.value })\n              }}\n            />*/}\n          </List>\n        </CardContent>\n        <CardFooter>\n          <Link href=\"/login/\">{dict.if_registered}{'\\u00A0'}{dict.you_can_login} </Link>\n          <Link className=\"btn-notice\"></Link>\n          <Button className=\"col btn\" fill onClick={props.submit}>{dict.sign_up}</Button>\n        </CardFooter>\n      </Card>\n    </Page>\n  )\n}\nexport default SignUpForm;\n","import React from 'react';\nimport {\n  Page,\n  Navbar,\n  NavLeft,\n  NavTitle,\n  NavRight,\n  Link,\n  Toolbar,\n  Block,\n  BlockTitle,\n  List,\n  ListItem,\n  Row,\n  Col,\n  Button, Icon, Fab, Searchbar, Subnavbar, LoginScreenTitle, ListInput, ListButton, BlockFooter\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport SignUpForm from \"../../containers/users/SignUp\"\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class extends React.Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n\n    this.state = {\n      email: '',\n      name: '',\n      surename: '',\n    };\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  submit() {\n    this.$$('.btn').hide();\n    this.$$('.btn-notice').text(dict.submitting);\n    var data = { \n      email: this.state.email,\n       name: this.state.name, \n       surename: this.state.surename }\n    if (\n      (this.state.email && this.state.email.length > 0) &&\n      (this.state.name && this.state.name.length > 0) &&\n      (this.state.surename && this.state.surename.length > 0) \n      ) {\n      MyActions.setInstance('users/sign_up', data);\n    } else {\n      const self = this;\n      self.$f7.dialog.alert(dict.incomplete_data, dict.alert);\n    }\n  }\n\n  setInstance() {\n    var klass = ModelStore.getKlass()\n    if (klass === 'SignUp') {\n      this.$$('.btn').show();\n      this.$f7router.navigate('/verification/'+this.state.email);\n    }\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n    console.log(obj)\n  }\n\n  render() {\n    const { username, password } = this.state;\n    return (\n      <SignUpForm submit={this.submit} handleChange={this.handleChangeValue} />\n    )\n  }\n\n}\n","import React from \"react\";\nimport { Link, List, CardHeader, ListInput, CardContent, CardFooter, Button, Page, Card, Navbar, Icon } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\nconst LoginForm = (props) => {\n  return (\n    <Page>\n      <Navbar title={dict.verification} >\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n      </Navbar>\n      <Card>\n        <CardHeader>{dict.login}</CardHeader>\n        <CardContent >\n          <List >\n          <ListInput\n              label={dict.email}\n              type=\"text\"\n              autofocus={true}\n              placeholder={dict.enter_your_email}\n              value={props.email}\n              onInput={(e) => {\n                props.handleChange({ email: e.target.value })\n              }}\n            />\n            <ListInput\n              label={dict.verification_code}\n              type=\"text\"\n              placeholder={dict.enter_verification_code}\n              onInput={(e) => {\n                props.handleChange({ verificationCode: e.target.value })\n              }}\n            />\n          </List>\n        </CardContent>\n        <CardFooter>\n          <Link href=\"/sign_up/\" animate={false} ignoreCache={true}>{dict.you_can_sign_up} </Link>\n          <Link className=\"btn-notice\"></Link>\n          <Button className=\"col btn\" fill onClick={props.submit}>{dict.login}</Button>\n        </CardFooter>\n      </Card>\n    </Page>\n  )\n}\nexport default LoginForm;\n","import React from 'react';\nimport {\n  Page,\n  Navbar,\n  NavLeft,\n  NavTitle,\n  NavRight,\n  Link,\n  Toolbar,\n  Block,\n  BlockTitle,\n  List,\n  ListItem,\n  Row,\n  Col,\n  Button, Icon, Fab,Searchbar, Subnavbar, LoginScreenTitle, ListInput, ListButton, BlockFooter\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport VerificationForm from \"../../containers/users/Verification\"\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class extends React.Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n\n    this.state = {\n      verificationCode: '',\n      email: '',\n    };\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  componentDidMount(){\n    this.setState({email: this.$f7route.params['email']})\n  }\n\n  submit(){\n    var data = {verification_code: this.state.verificationCode}\n    MyActions.setInstance('users/verify', data);\n  }\n\n  setInstance(){\n    var user = ModelStore.getIntance();\n    var klass = ModelStore.getKlass()\n    if (user && klass == 'Verify'){\n      window.localStorage.setItem('token', user.token);\n      var last = window.localStorage.getItem('url')\n      if(last.length > 5){\n        //this.$f7router.navigate(last);\n        window.location.replace(last);\n        window.localStorage.setItem('url', '');\n        window.location.reload()\n      } else {\n        this.$f7router.navigate('/');\n        window.location.reload()\n      }\n      \n    }\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  render() {\n    const {username, email} = this.state;\n    return (\n      <VerificationForm submit={this.submit} email={email} handleChange={this.handleChangeValue}/>\n    )\n  }\n\n}\n","import React from \"react\";\nimport {\n  Page,\n  Card,\n  Row,\n  Col,\n  Fab,\n  Icon,\n  Navbar,\n  Link,\n  Button,\n  CardContent,\n  CardFooter,\n  CardHeader,\n  FabButtons,\n  Chip,\n  Block,\n  Subnavbar,\n} from \"framework7-react\";\n\nimport { dict } from \"../../Dict\";\n\n\nconst RoomIndex = (props) => {\n  function videos(spec, id) {\n    var width = '140'\n    var height = '120'\n    if (spec === 'high') {\n      width = '240'\n      height = ''\n    }\n    return (\n      <div class=\"col-100 tablet-33\" key={\"container-\" + id}>\n        <video\n          controls={true}\n          key={id}\n          id={\"video-\" + id}\n          src=\"\"\n          width={width}\n          height={height}\n          autoPlay\n          playsInline\n          muted={props.muted}\n        />\n      </div>\n    )\n  }\n\n  function highVidoes() {\n    var result = [];\n    if (props.feeds) {\n      {\n        props.feeds.map((feed) => {\n          //var participant = \n\n          if (props.feedToRole(feed.id) === 'speaker') {\n            console.log(feed.id, 'is a speaker')\n            result.push(videos('high', 'h-' + feed.id));\n            //props.streamAttacher(feed)\n          }\n\n          // if (participant && props.participantIsSpeaker(participant.uuid)) {\n          //  \n          //  \n          // }\n\n        });\n      }\n    }\n    return result;\n  }\n\n  function lowVideos() {\n    var result = [];\n    if (props.feeds) {\n      {\n        props.feeds.map((feed) => {\n\n          if (props.feedToRole(feed.id) === 'listener') {\n            console.log(feed.id, 'is a listener')\n            result.push(videos('low', feed.id));\n            //props.streamAttacher(feed)\n          }\n          // var participant = () =>props.findParticpantById(feed.rfid)\n          //console.log(props.findParticpantById(feed.rfid))\n          // if (participant && !props.participantIsSpeaker(participant.uuid)) {\n          //  result.push(videos('low', feed.id));\n          //  props.streamAttacher(feed)\n          // }\n\n        });\n      }\n    }\n    return result;\n  }\n\n  function requests() {\n    var result = [];\n    if (props.requests) {\n      props.requests.map((request) => {\n        result.push(\n          <div className=\"chip color-lightblue br-0\">\n            <a onClick={() => props.removeRequest(request.uuid)}>\n              <div className=\"chip-media br-0 color-lightgray \">\n                <i class=\"fa fa-times\" aria-hidden=\"true\"></i>\n              </div>\n            </a>\n            <a onClick={() => props.acceptRequest(request.uuid)}>\n              <div className=\"chip-media br-0 color-teal mr-0\">\n                <i class=\"fa fa-level-up\" aria-hidden=\"true\"></i>\n              </div>\n            </a>\n            <div className=\"chip-media br-0 color-lightred mr-0\">\n              <i class=\"fa fa-level-down\" aria-hidden=\"true\"></i>\n            </div>\n            <div className=\"chip-media br-0 color-lightyellow mr-0\">\n              <i class=\"fa fa-microphone-slash\" aria-hidden=\"true\"></i>\n            </div>\n\n            <div className=\"chip-media br-0 color-darkgray mr-0\">\n              <i class=\"fa fa-ban\" aria-hidden=\"true\"></i>\n            </div>\n\n            <div className=\"chip-media br-0 color-lightorange mr-0\">\n              <i class=\"fa fa-gavel\" aria-hidden=\"true\"></i>\n            </div>\n\n            <div className=\"chip-label  mr-2\">{request.display}</div>\n\n          </div>\n\n        )\n      });\n    }\n    return result;\n  }\n\n  function participants() {\n    var result = [];\n    if (props.participants) {\n      props.participants.map((participant) => {\n        result.push(\n          <div className=\"chip br-0\">\n\n            <div className=\"chip-label  mr-2\">{participant.display}</div>\n          </div>\n\n        )\n      });\n    }\n    return result;\n  }\n\n  function title() {\n    if (props.room) {\n      return (props.room.title)\n    }\n  }\n\n  return (\n    <Page onPageBeforeRemove={() => props.beforeRemove}>\n      <Navbar title={title()} backLink={dict.back}>\n        <Link panelOpen=\"right\">\n          <Icon f7=\"bars\"></Icon>\n        </Link>\n      </Navbar>\n      <Subnavbar className=\"bg-black subnavbar-black\">\n        <div></div>\n        <div className=''>\n          <a onClick={() => props.publishCamera()}><i class=\"fa fa-video-camera ml-4\" aria-hidden=\"true\"></i></a>\n          <a onClick={() => props.publishMicrophone()}><i class=\"fa fa-microphone ml-4\" aria-hidden=\"true\"></i></a>\n          <a onClick={() => props.sendData()}><i class=\"fa fa-comment ml-4\" aria-hidden=\"true\"></i></a>\n          <a onClick={() => props.speakRequest()}><i class=\"fa fa-hand-paper-o ml-4\" aria-hidden=\"true\"></i></a>\n        </div>\n\n      </Subnavbar>\n      <div style={{ marginTop: '150px;', paddingTop: '150px;' }}>|</div>\n      <Block >\n        <Row className=\"center\" id=\"hosts\">\n          {highVidoes()}\n        </Row>\n      </Block>\n\n      <Block strong>\n        {requests()}\n        < hr></hr>\n        {participants()}\n      </Block >\n\n      <Block >\n        {lowVideos()}\n      </Block>\n\n    </Page>\n  );\n};\nexport default RoomIndex;\n","import React from \"react\";\nimport { Page, Col, Icon } from \"framework7-react\";\nimport ModelStore from \"../../stores/ModelStore\";\nimport RoomIndex from \"../../containers/rooms/show\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict } from \"../../Dict\";\nimport { conf } from \"../../conf\";\nimport Janus from \"../../janus.js\";\nimport Framework7 from \"framework7/framework7.esm.bundle\";\n//import {newRemoteFeed} from \"./newRemoteFeed.js\"\n\nexport default class Layout extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.sessionCreate = this.sessionCreate.bind(this);\n    this.registerUsername = this.registerUsername.bind(this);\n    this.newRemoteFeed = this.newRemoteFeed.bind(this);\n    this.publishCamera = this.publishCamera.bind(this);\n    this.publishMicrophone = this.publishMicrophone.bind(this);\n    this.off = this.off.bind(this);\n    this.on = this.on.bind(this);\n    this.pageAfterIn = this.pageAfterIn.bind(this);\n    this.streamAttacher = this.streamAttacher.bind(this);\n    this.unmute = this.unmute.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.sendData = this.sendData.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.speakRequest = this.speakRequest.bind(this);\n    this.publishData = this.publishData.bind(this);\n    this.removeRequest = this.removeRequest.bind(this);\n    this.acceptRequest = this.acceptRequest.bind(this);\n    this.addParticipant = this.addParticipant.bind(this);\n    this.removeParticipant = this.removeParticipant.bind(this);\n    this.unPublishData = this.unPublishData.bind(this);\n    this.exisitingParticipant = this.exisitingParticipant.bind(this);\n    this.requestAccepted = this.requestAccepted.bind(this);\n    this.findParticpantByUuid = this.findParticpantByUuid.bind(this);\n    this.participantIndex = this.participantIndex.bind(this);\n    this.findParticpantById = this.findParticpantById.bind(this);\n    this.findFeedByRfid = this.findFeedByRfid.bind(this);\n    this.findFeedById = this.findFeedById.bind(this);\n    this.feedToRole = this.feedToRole.bind(this);\n    this.attachMedia = this.attachMedia.bind(this);\n    this.unPublishCamera = this.unPublishCamera.bind(this);\n    this.beforeRemove = this.beforeRemove.bind(this);\n\n    \n    this.state = {\n      token: window.localStorage.getItem(\"token\"),\n      shortners: null,\n      server: conf.janusServer,\n      janus: null,\n      sfutest: null,\n      opaqueId: \"videoroomtest-\" + Janus.randomString(12),\n      roomId: null,\n      myusername: null,\n      myid: null,\n      mystream: null,\n      mypvtid: \"videoroomtest-\" + Janus.randomString(12),\n      pin: null,\n      feeds: [],\n      activeFeeds: [],\n      bitrateTimer: [],\n      userUUID: null,\n      fullname: null,\n      isOwner: false,\n      urls: [],\n      publisedCamera: false,\n      publishedMicrophone: false,\n      muted: true,\n      requests: [],\n      lowFeeds: [],\n      participants: [],\n      room: null\n    };\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n    window.removeEventListener(\"beforeunload\", this.unPublishData);\n  }\n\n  setInstance() {\n\n  }\n\n  updateSubscribers() {\n    var data = { room_id: this.state.roomId }\n    MyActions.setInstance('subscribers', data, this.state.token);\n  }\n\n  renewSubscribers() {\n    MyActions.getInstance('subscribers', this.state.roomId, this.state.token);\n  }\n\n  sessionCreate() {\n    var self = this;\n    Janus.init({\n      debug: \"none\",\n      callback: function () {\n        var janus = new Janus({\n          server: self.state.server,\n          success: function () {\n            janus.attach({\n              plugin: \"janus.plugin.videoroom\",\n              opaqueId: self.state.opaqueId,\n              success: function (pluginHandle) {\n                self.setState({ janus: janus });\n                self.setState({ sfutest: pluginHandle });\n                Janus.log(\n                  \"Plugin attached! (\" +\n                  self.state.sfutest.getPlugin() +\n                  \", id=\" +\n                  self.state.sfutest.getId() +\n                  \")\"\n                );\n                Janus.log(\"  -- This is a publisher/manager\");\n                self.registerUsername();\n                //self.publishData();\n              },\n              error: function (error) {\n                Janus.error(\"  -- Error attaching plugin...\", error);\n                window.alert(\"Error attaching plugin... \" + error);\n              },\n              consentDialog: function (on) {\n                Janus.debug(\n                  \"Consent dialog should be \" + (on ? \"on\" : \"off\") + \" now\"\n                );\n              },\n              iceState: function (state) {\n                Janus.log(\"ICE state changed to \" + state);\n              },\n              mediaState: function (medium, on) {\n                Janus.log(\n                  \"Janus \" +\n                  (on ? \"started\" : \"stopped\") +\n                  \" receiving our \" +\n                  medium\n                );\n              },\n              webrtcState: function (on) {\n                Janus.log(\n                  \"Janus says our WebRTC PeerConnection is \" +\n                  (on ? \"up\" : \"down\") +\n                  \" now\"\n                );\n              },\n              onmessage: function (msg, jsep) {\n                Janus.log(\" ::: Got a message (publisher) :::\", msg);\n                var event = msg[\"videoroom\"];\n                Janus.debug(\"Event: \" + event);\n                if (event) {\n                  if (event === \"joined\") {\n                    console.log(\"joined\");\n                    self.setState({\n                      myid: msg[\"id\"],\n                      mypvtid: msg[\"private_id\"],\n                    });\n                    //self.publishData();\n                    // console.log('message ??????', msg)\n                    self.addParticipant(msg[\"id\"], self.state.fullname + '§' + self.state.userUUID);\n\n                    if (msg[\"publishers\"]) {\n                      var list = msg[\"publishers\"];\n                      console.log(\n                        \"Got a list of available publishers/feeds:\",\n                        list\n                      );\n                      for (var f in list) {\n                        var id = list[f][\"id\"];\n                        var display = list[f][\"display\"];\n                        var audio = list[f][\"audio_codec\"];\n                        var video = list[f][\"video_codec\"];\n                        Janus.debug(\n                          \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (audio: \" +\n                          audio +\n                          \", video: \" +\n                          video +\n                          \")\"\n                        );\n                        self.addParticipant(list[f][\"id\"], list[f][\"display\"]);\n                        self.newRemoteFeed(id, display, audio, video);\n\n                      }\n                    }\n                  } else if (event === \"destroyed\") {\n                    // The room has been destroyed\n                    Janus.warn(\"The room has been destroyed!\");\n                  } else if (event === \"event\") {\n                    // Any new feed to attach to?\n                    if (msg[\"publishers\"]) {\n                      var list = msg[\"publishers\"];\n                      Janus.log(\n                        \"Got a list of available publishers/feeds:\",\n                        list\n                      );\n                      for (var f in list) {\n                        var id = list[f][\"id\"];\n                        var display = list[f][\"display\"];\n                        var audio = list[f][\"audio_codec\"];\n                        var video = list[f][\"video_codec\"];\n                        Janus.log(\n                          \"  >> [\" +\n                          id +\n                          \"] \" +\n                          display +\n                          \" (audio: \" +\n                          audio +\n                          \", video: \" +\n                          video +\n                          \")\"\n                        );\n                        // if(audio || video) {\n                        self.addParticipant(list[f][\"id\"], list[f][\"display\"]);\n                        self.newRemoteFeed(id, display, audio, video);\n                        // }\n\n                      }\n                    } else if (msg[\"leaving\"]) {\n                      var leaving = msg[\"leaving\"];\n                      console.log(\"Publisher leaving: \" + leaving);\n                      self.setState(\n                        {\n                          feeds: self.state.feeds.filter(\n                            (item) => item.rfid != leaving\n                          ),\n                        },\n                        () => console.log(\"feeds: >>>>\", self.state.feeds)\n                      );\n                      var unPublishedFeed = self.state.feeds.filter(\n                        (item) => item.rfid === leaving\n                      );\n                      var remoteFeed = unPublishedFeed.shift();\n                      if (remoteFeed != null) {\n                        remoteFeed.detach();\n                      }\n                      self.removeParticipant(leaving)\n                    } else if (msg[\"unpublished\"]) {\n                      var unpublished = msg[\"unpublished\"];\n                      console.log(\"Publisher left: \" + unpublished);\n                      if (unpublished === \"ok\") {\n                        self.state.sfutest.hangup();\n                        return;\n                      }\n                      self.setState(\n                        {\n                          feeds: self.state.feeds.filter(\n                            (item) => item.rfid != unpublished\n                          ),\n                        }\n                      );\n                      var unPublishedFeed = self.state.feeds.filter(\n                        (item) => item.rfid === unpublished\n                      );\n\n                      self.setState(\n                        {\n                          lowFeeds: self.state.lowFeeds.filter(\n                            (item) => item.rfid != unpublished\n                          ),\n                        }\n                      );\n\n                      var remoteFeed = unPublishedFeed.shift();\n                      if (remoteFeed != null) {\n                        remoteFeed.detach();\n                      }\n                      self.removeParticipant(unpublished)\n                    } else if (msg[\"error\"]) {\n                    }\n                    else if (msg[\"configured\"]) {\n                    }\n                    else if (msg[\"joining\"]) {\n                      self.addParticipant(msg[\"joining\"].id, msg[\"joining\"].display);\n                    }\n                  }\n                }\n                if (jsep) {\n                  Janus.log(\"Handling SDP as well...\", jsep);\n                  self.state.sfutest.handleRemoteJsep({ jsep: jsep });\n                  //self.$$(\"#video-\" + self.state.sfutest.id).hide();\n                }\n              },\n              onlocalstream: function (stream) {\n                console.log(\" ::: Got a local stream :::\", stream);\n                console.log(self.state.sfutest.id);\n                var exisiting = self.state.feeds.filter(\n                  (item) => item.id === self.state.sfutest.id\n                );\n                if (exisiting.length === 0) {\n                  self.state.sfutest.rfid = self.state.myid\n\n                  self.setState({\n                    feeds: self.state.feeds.concat(self.state.sfutest),\n                  });\n                  if(self.state.isOwner){\n                    self.requestAccepted(self.state.userUUID)\n                  }\n\n                }\n\n                \n                var videoTracks = stream.getVideoTracks();\n\n                if (!videoTracks || videoTracks.length === 0) {\n                  self.$$(\"#video-\" + self.state.sfutest.id).hide();\n                } else {\n\n                  console.log(self.state.participants)\n                  self.$$(\"#video-\" + self.state.sfutest.id).show();\n                  self.streamAttacher(self.state.sfutest)\n                  //Janus.attachMediaStream(\n                  //  document.getElementById(\"video-\" + self.state.sfutest.id),\n                  //  stream\n                  //);\n                  //document.getElementById(\"video-\" + self.state.sfutest.id).muted = true;\n                }\n              },\n              onremotestream: function (stream) {\n                Janus.log(\" ::: Got a remote stream :::\", stream);\n                // The publisher stream is sendonly, we don't expect anything here\n              },\n              ondata: function (data) {\n                Janus.debug(\"We got data from the DataChannel!\", data);\n                //$('#datarecv').val(data);\n              },\n              oncleanup: function () {\n\n                Janus.log(\n                  \" ::: Got a cleanup notification: we are unpublished now :::\"\n                );\n              },\n            });\n          },\n          error: function (error) {\n            Janus.error(error);\n            window.alert(error, function () {\n              window.location.reload();\n            });\n          },\n          destroyed: function () {\n            window.location.reload();\n          },\n        });\n      },\n    });\n  }\n  registerUsername() {\n    var self = this;\n    var register = {\n      request: \"join\",\n      room: self.state.roomId,\n      ptype: \"publisher\",\n      display: self.state.fullname + \" §\" + self.state.userUUID,\n      pin: self.state.pin\n    };\n    self.state.sfutest.send({ message: register });\n    setTimeout(function () {\n      this.publishData();\n    }.bind(this), 8000)\n  }\n\n  findFeedByRfid(rfid) {\n    var feeds = this.state.feeds.filter(\n      (item) => item.rfid === rfid\n    );\n    if (feeds && feeds[0]) {\n      return feeds[0]\n    }\n  }\n\n  findFeedById(id) {\n    var feeds = this.state.feeds.filter(\n      (item) => item.id === id\n    );\n    if (feeds && feeds[0]) {\n      return feeds[0]\n    }\n  }\n\n  feedIdToRfid(id) {\n    var feeds = this.state.feeds.filter(\n      (item) => item.id === id\n    );\n    if (feeds && feeds[0]) {\n      return feeds[0].rfid\n    }\n  }\n\n  addParticipant(id, p) {\n    var self = this;\n    var participant = p.split('§')\n    if (this.exisitingParticipant(participant[1])) {\n      self.setState({ participants: self.state.participants.concat({ id: id, display: participant[0], uuid: participant[1], role: 'listener' }) });\n    }\n    console.log('participant added:', participant[1])\n  }\n\n  exisitingParticipant(participantId) {\n    var self = this;\n    var exisiting = self.state.participants.filter(\n      (item) => item.uuid === participantId\n    );\n    if (exisiting.length === 0) {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  findParticpantById(id) {\n    var participants = this.state.participants.filter(item => item.id === id);\n    if (participants && participants[0]) {\n      return participants[0]\n    }\n  }\n\n  findParticpantByUuid(id) {\n    var participants = this.state.participants.filter(item => item.uuid === id);\n    if (participants && participants[0]) {\n      return participants[0]\n    }\n  }\n\n  removeParticipant(id) {\n    var self = this;\n    self.setState({\n      participants: self.state.participants.filter(\n        (item) => item.id !== id\n      )\n    })\n\n  }\n\n  newRemoteFeed(id, feeds, display, audio, video) {\n    var self = this;\n    // A new feed has been published, create a new plugin handle and attach to it as a subscriber\n    var remoteFeed = null;\n    self.state.janus.attach({\n      plugin: \"janus.plugin.videoroom\",\n      opaqueId: this.state.opaqueId,\n      success: function (pluginHandle) {\n        remoteFeed = pluginHandle;\n        remoteFeed.simulcastStarted = false;\n        Janus.log(\n          \"Plugin attached! (\" +\n          remoteFeed.getPlugin() +\n          \", id=\" +\n          remoteFeed.getId() +\n          \")\"\n        );\n        Janus.log(\"  -- This is a subscriber\");\n        // We wait for the plugin to send us an offer\n        var subscribe = {\n          request: \"join\",\n          room: self.state.roomId,\n          ptype: \"subscriber\",\n          pin: self.state.pin,\n          feed: id,\n          private_id: self.state.mypvtid,\n        };\n        // In case you don't want to receive audio, video or data, even if the\n        // publisher is sending them, set the 'offer_audio', 'offer_video' or\n        // 'offer_data' properties to false (they're true by default), e.g.:\n        // \t\tsubscribe[\"offer_video\"] = false;\n        // For example, if the publisher is VP8 and this is Safari, let's avoid video\n        if (\n          Janus.webRTCAdapter.browserDetails.browser === \"safari\" &&\n          (video === \"vp9\" || (video === \"vp8\" && !Janus.safariVp8))\n        ) {\n          if (video) video = video.toUpperCase();\n          console.log(\n            \"Publisher is using \" +\n            video +\n            \", but Safari doesn't support it: disabling video\"\n          );\n          subscribe[\"offer_video\"] = false;\n        }\n        remoteFeed.videoCodec = video;\n        remoteFeed.send({ message: subscribe });\n      },\n      error: function (error) {\n        Janus.error(\"  -- Error attaching plugin...\", error);\n        window.alert(\"Error attaching plugin... \" + error);\n      },\n      onmessage: function (msg, jsep) {\n        Janus.debug(\" ::: Got a message (subscriber) :::\", msg);\n        var event = msg[\"videoroom\"];\n        Janus.log(\"Event: \" + event);\n        if (msg[\"error\"]) {\n          window.alert(msg[\"error\"]);\n        } else if (event) {\n          if (event === \"attached\") {\n            remoteFeed.rfid = msg[\"id\"];\n            remoteFeed.rfdisplay = msg[\"display\"];\n            self.setState({ feeds: self.state.feeds.concat(remoteFeed) });\n            self.setState({ lowFeeds: self.state.lowFeeds.concat(remoteFeed) });\n            if (!video || !audio) {\n              self.$$(\"#video-\" + remoteFeed.id).hide();\n              //self.$$(\"#lowVideo-\" + remoteFeed.id).hide();\n            }\n            //  }\n\n\n            Janus.log(\n              \"Successfully attached to feed \" +\n              remoteFeed.rfid +\n              \" (\" +\n              remoteFeed.rfdisplay +\n              \") in room \" +\n              msg[\"room\"]\n            );\n          } else if (event === \"event\") {\n          } else {\n            // What has just happened?\n          }\n        }\n        if (jsep) {\n          Janus.log(\"Handling SDP as well...\", jsep);\n          remoteFeed.createAnswer({\n            jsep: jsep,\n            // Add data:true here if you want to subscribe to datachannels as well\n            // (obviously only works if the publisher offered them in the first place)\n            media: { audioSend: false, videoSend: false, data: true }, // We want recvonly audio/video\n            success: function (jsep) {\n              Janus.log(\"Got SDP!\", jsep);\n              var body = { request: \"start\", room: self.state.roomId };\n              remoteFeed.send({ message: body, jsep: jsep });\n            },\n            error: function (error) {\n              Janus.log(\"WebRTC error:\", error);\n              window.alert(\"WebRTC error... \" + error.message);\n            },\n          });\n        }\n      },\n      iceState: function (state) {\n        Janus.log(\n          \"ICE state of this WebRTC PeerConnection (feed #\" +\n          remoteFeed.rfindex +\n          \") changed to \" +\n          state\n        );\n\n      },\n      webrtcState: function (on) {\n        Janus.log(\n          \"Janus says this WebRTC PeerConnection (feed #\" +\n          remoteFeed.rfindex +\n          \") is \" +\n          (on ? \"up\" : \"down\") +\n          \" now\"\n        );\n        if (on === \"down\") {\n          self.removeParticipant(remoteFeed.rfid)\n        }\n      },\n      onlocalstream: function (stream) {\n        console.log('>>>>>>>>>>>', stream)\n      },\n      onremotestream: function (stream) {\n      //  console.log('§§§§§§§§§§§§§§§§§§', stream)\n       var videoTracks = stream.getVideoTracks();\n       var videoQuality = \"video\"\n       // if (self.feedToRole(remoteFeed.id) && self.feedToRole(remoteFeed.id) === 'listener'){\n        //  videoQuality = \"lowVideo\"\n        //}\n\n        console.log('>>>>>>>>>>>>>', self.feedToRole(remoteFeed.id), remoteFeed.id)\n        if (!videoTracks || videoTracks.length === 0) {\n          self.$$(\"#video-\" + remoteFeed.id).hide();\n         // self.$$(\"#lowVideo-\" + remoteFeed.id).hide();\n        } else {\n          //self.$$(videoQuality + remoteFeed.id).show()\n          self.$$('#' + videoQuality + '-' + remoteFeed.id).show()\n          //self.attachMedia(videoQuality, remoteFeed.id, stream)\n          //console.log(remoteFeed.webrtcStuff.remoteStream)\n          //console.log(stream)\n         Janus.attachMediaStream(\n            document.getElementById(videoQuality + '-' + remoteFeed.id),\n            stream\n          );\n        }\n        var audioTracks = stream.getAudioTracks();\n        if (!audioTracks || audioTracks.length === 0) {\n          // self.$$(\"#video-\" + remoteFeed.id).hide();\n        } else {\n          //self.$$(\"#video-\" + remoteFeed.id).hide();\n          Janus.attachMediaStream(\n            document.getElementById(\"video-\" + remoteFeed.id),\n            stream\n          );\n        }\n\n      },\n      ondata: function (data) {\n        //Janus.debug(\"We got data from the DataChannel!\", data);\n        console.log(data)\n        var message = JSON.parse(data)\n        var exisiting = self.state.requests.filter(\n          (item) => item.uuid === message['uuid']\n        );\n\n\n        if (exisiting.length === 0 && message['request'] === 'up') {\n          self.setState({ requests: self.state.requests.concat({ display: message['display'], uuid: message['uuid'] }) });\n        }\n\n        if (message['request'] === 'removeRequest') {\n          self.setState({\n            requests: self.state.requests.filter(item => item.uuid != message['uuid'])\n          });\n        }\n\n        if (message['request'] === 'acceptRequest') {\n          self.setState({\n            requests: self.state.requests.filter(item => item.uuid != message['uuid'])\n          });\n          self.requestAccepted(message['uuid'])\n          if (message['uuid'] === self.state.userUUID) {\n            console.log('§§§§§§§', self.state.publisedCamera)\n            if (self.state.publisedCamera) {\n              self.unPublishCamera();\n              self.publishCamera(32);\n            } else {\n              self.publishMicrophone()\n            }\n\n          }\n        }\n\n      },\n      oncleanup: function () {\n        Janus.log(\n          \" ::: Got a cleanup notification (remote feed \" + id + \") :::\"\n        );\n      },\n    });\n  }\n\n  feedToRole(feedId) {\n    var feed = this.findFeedById(feedId)\n    if (feed && feed.rfid)\n      var participant = this.findParticpantById(feed.rfid)\n    if (participant) {\n      return participant.role\n    }\n  }\n\n  attachMedia(videoQuality, feedId ,stream){\n    Janus.attachMediaStream(\n      document.getElementById(videoQuality + '-' + feedId),\n      stream\n    );\n  }\n\n\n  requestAccepted(requesterId) {\n    let newState = Object.assign({}, this.state);\n    var participant = this.findParticpantByUuid(requesterId)\n    var index = this.participantIndex(requesterId)\n    newState.participants[index] = { id: participant.id, display: participant.display, uuid: participant.uuid, role: 'speaker' }\n    this.setState(newState, () => {\n      var feed = this.findFeedByRfid(participant.id)\n      if (feed)\n      {\n        this.streamAttacher(feed)\n      }\n    });\n  }\n\n\n\n  participantIndex(id) {\n    var index = this.state.participants.findIndex(item => item.uuid === id);\n    console.log(index)\n    if (Number.isInteger(index)) {\n      return index\n    }\n  }\n\n  participantIsSpeaker(requesterId) {\n    var participant = this.findParticpantByUuid(requesterId)\n    if (participant && participant.role === 'speaker') {\n      return true\n    } else {\n      return false\n    }\n  }\n\n  streamAttacher(feed) {\n    console.log(feed.id)\n    if (feed.id && feed.webrtcStuff && feed.webrtcStuff.remoteStream) {\n      setTimeout(function () {\n        Janus.attachMediaStream(\n          document.getElementById(\"video-h-\" + feed.id),\n          feed.webrtcStuff.remoteStream\n        );\n      }.bind(this), 12000)\n\n    }\n  }\n\n  sendData() {\n    var message = {\n      textroom: \"message\",\n      transaction: Janus.randomString(12),\n      room: this.state.roomId,\n      text: 'UUUUU',\n    };\n    this.state.sfutest.data({\n      text: JSON.stringify(message),\n      error: function (reason) { console.log(reason); },\n      success: function () { console.log('sent'); },\n    });\n  }\n\n  speakRequest() {\n    var self = this;\n    var message = {\n      textroom: \"message\",\n      transaction: Janus.randomString(12),\n      room: this.state.roomId,\n      request: 'up',\n      uuid: this.state.userUUID,\n      display: this.state.fullname\n    };\n    this.state.sfutest.data({\n      text: JSON.stringify(message),\n      error: function (reason) { console.log(reason); },\n      success: function () {\n        console.log('request sent')\n        var exisiting = self.state.requests.filter(\n          (item) => item.uuid === message['uuid']\n        );\n        if (exisiting.length === 0 && message['request'] === 'up') {\n          self.setState({ requests: self.state.requests.concat({ display: message['display'], uuid: message['uuid'] }) });\n        }\n      },\n    });\n  }\n\n  publishData() {\n    var self = this;\n    self.state.sfutest.createOffer({\n      media: {\n        audioRecv: false,\n        videoRecv: false,\n        data: true,\n        videoSend: false,\n        audioSend: false,\n      },\n\n      success: function (jsep) {\n        Janus.debug(\"********* Got publisher SDP!\", jsep);\n        if (jsep) {\n          var publish = {\n            request: \"publish\",\n            audio: true,\n            video: true,\n            data: true,\n          };\n          self.state.sfutest.send({ message: publish, jsep: jsep });\n        }\n\n      },\n      error: function (error) {\n        Janus.error(\"***** WebRTC error:\", error);\n      },\n    });\n  }\n\n  unPublishData() {\n    var self = this;\n    self.state.sfutest.createOffer({\n      media: {\n        audioRecv: false,\n        videoRecv: false,\n        data: false,\n        videoSend: false,\n        //removeVideo: false,\n        audioSend: false,\n      },\n\n      success: function (jsep) {\n        Janus.debug(\"********* Got publisher SDP!\", jsep);\n        if (jsep) {\n          var unPublish = {\n            request: \"unpublish\",\n            audio: false,\n            video: false,\n            data: false,\n          };\n          self.state.sfutest.send({ message: unPublish, jsep: jsep });\n        }\n      },\n      error: function (error) {\n        Janus.error(\"***** WebRTC error:\", error);\n      },\n    });\n  }\n\n  publishCamera(bitrate = 16) {\n    var self = this;\n    var request = ''\n    if (self.state.publishedMicrophone){\n      request = 'configure'\n    } else {\n      request = 'configure'\n    }\n    self.state.sfutest.createOffer({\n      media: {\n        audioRecv: false,\n        videoRecv: false,\n        data: true,\n        videoSend: true,\n       // removeVideo: self.state.publisedCamera,\n        audioSend: self.state.publishedMicrophone,\n      },\n\n      success: function (jsep) {\n        Janus.debug(\"********* Got publisher SDP!\", jsep);\n      console.log('switching to ' + bitrate)\n        if (jsep) {\n          var publish = {\n            request: request,\n            audio: self.state.publishedMicrophone,\n            video: true,\n            data: true,\n            bitrate: bitrate * 1000,\n            bitrate_cap: true,\n            videocodec: 'vp8',\n          };\n          self.state.sfutest.send({ message: publish, jsep: jsep });\n        }\n        self.setState({ publisedCamera: !self.state.publisedCamera });\n      },\n      error: function (error) {\n        Janus.error(\"***** WebRTC error:\", error);\n      },\n    });\n  }\n\n  unPublishCamera() {\n    console.log('unPublishing ..')\n    var self = this;\n    self.state.sfutest.createOffer({\n      media: {\n        audioRecv: false,\n        videoRecv: false,\n        data: true,\n        videoSend: false,\n        audioSend: self.state.publishedMicrophone,\n      },\n\n      success: function (jsep) {\n        Janus.debug(\"********* Got publisher SDP!\", jsep);\n      //console.log('switching to ' + bitrate)\n        if (jsep) {\n          var publish = {\n            request: \"configure\",\n            audio: self.state.publishedMicrophone,\n            video: false,\n            data: true,\n          };\n          self.state.sfutest.send({ message: publish, jsep: jsep });\n        }\n        self.setState({ publisedCamera: false });\n      },\n      error: function (error) {\n        Janus.error(\"***** WebRTC error:\", error);\n      },\n    });\n  }\n\n  publishMicrophone() {\n    var self = this;\n    self.state.sfutest.createOffer({\n      media: {\n        audioRecv: false,\n        videoRecv: false,\n        data: true,\n        audioSend: !self.state.publishedMicrophone,\n        removeAudio: self.state.publishedMicrophone,\n        videoSend: self.state.publisedCamera,\n      },\n\n      success: function (jsep) {\n        Janus.debug(\"********* Got publisher SDP!\", jsep);\n        if (jsep) {\n          var publish = { request: \"configure\", data: true, audio: !self.state.publishedMicrophone, video: self.state.publisedCamera };\n          self.state.sfutest.send({ message: publish, jsep: jsep });\n          self.setState({\n            publishedMicrophone: !self.state.publishedMicrophone,\n          });\n        }\n      },\n      error: function (error) {\n        Janus.error(\"***** WebRTC error:\", error);\n      },\n    });\n  }\n\n  off() {\n    console.log(this.state.feeds);\n    var body = {\n      request: \"switch\",\n      feed: this.state.feeds[1].rfid,\n      video: false,\n    };\n    this.state.feeds[1].send({ message: body });\n  }\n\n  on() {\n    console.log(this.state.feeds);\n    var body = {\n      request: \"switch\",\n      feed: this.state.feeds[1].rfid,\n      video: true,\n    };\n    this.state.feeds[1].send({ message: body });\n  }\n\n  componentDidMount() {\n    MyActions.getInstance('rooms', this.$f7route.params['roomId'], this.state.token);\n    window.addEventListener(\"beforeunload\", this.unPublishData);\n  }\n\n  getInstance() {\n    var room = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (room && klass === 'Room') {\n      this.setState({\n        room: room,\n        id: room.id,\n        roomId: room.room_id,\n        pin: room.pin,\n        userUUID: room.user_uuid,\n        fullname: room.user_fullname,\n        title: room.title,\n        isOwner: room.is_owner\n      }, () => this.pageAfterIn());\n    }\n    this.$$('.btn').show();\n  }\n\n  pageAfterIn() {\n    setTimeout(function () {\n      this.sessionCreate();\n      this.unmute();\n    }.bind(this), 12000)\n  }\n\n  loadData() {\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({\n      text: dict.receiving,\n      closeTimeout: 2000,\n      position: \"top\",\n    });\n    MyActions.getList(\"shortners\", this.state.page, {}, this.state.token);\n  }\n\n  localQualityChange(){\n\n  }\n\n  getList() {\n    var shortners = ModelStore.getList();\n    var klass = ModelStore.getKlass();\n    if (shortners && klass === \"Shortner\") {\n      this.setState({\n        shortners: shortners,\n      });\n    }\n  }\n\n  unmute() {\n    this.setState({ muted: false });\n  }\n\n  acceptRequest(uuid) {\n    var self = this;\n    var message = {\n      textroom: \"message\",\n      transaction: Janus.randomString(12),\n      room: this.state.roomId,\n      request: 'acceptRequest',\n      uuid: uuid,\n    };\n    this.state.sfutest.data({\n      text: JSON.stringify(message),\n      error: function (reason) { console.log(reason); },\n      success: function () {\n        self.setState({\n          requests: self.state.requests.filter(item => item.uuid != uuid)\n        });\n        self.requestAccepted(uuid);\n      },\n    });\n  }\n\n  removeRequest(uuid) {\n    var self = this;\n    var message = {\n      textroom: \"message\",\n      transaction: Janus.randomString(12),\n      room: this.state.roomId,\n      request: 'removeRequest',\n      uuid: uuid\n    };\n    this.state.sfutest.data({\n      text: JSON.stringify(message),\n      error: function (reason) { console.log(reason); },\n      success: function () {\n        self.setState({\n          requests: self.state.requests.filter(item => item.uuid != uuid)\n        });\n      },\n    });\n  }\n\n  beforeRemove(){\n    console.log('removing ...')\n    this.unPublishCamera();\n  }\n\n  render() {\n    const {\n      shortners,\n      urls,\n      publishedMicrophone,\n      publisedCamera,\n      feeds,\n      muted,\n      lowFeeds,\n      requests,\n      participants,\n      room\n    } = this.state;\n    return (\n      <RoomIndex\n        beforeRemove={this.beforeRemove}\n        pageAfterIn={this.pageAfterIn}\n        shortners={shortners}\n        streamAttacher={this.streamAttacher}\n        findParticpantById={this.findParticpantById}\n        participantIsSpeaker={this.participantIsSpeaker}\n        feedToRole={this.feedToRole}\n        urls={urls}\n        off={this.off}\n        on={this.on}\n        feeds={feeds}\n        muted={muted}\n        lowFeeds={lowFeeds}\n        requests={requests}\n        room={room}\n        participants={participants}\n        unmute={this.unmute}\n        publisedCamera={publisedCamera}\n        publishedMicrophone={publishedMicrophone}\n        publishCamera={this.publishCamera}\n        publishMicrophone={this.publishMicrophone}\n        sendData={this.sendData}\n        speakRequest={this.speakRequest}\n        accept={this.accept}\n        removeRequest={this.removeRequest}\n        acceptRequest={this.acceptRequest}\n      />\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem} from 'framework7-react';\nimport crypto from 'crypto-js';\n\nconst RoomList = (props) => {\n\n  if (props.rooms) {\n    return (\n      <List mediaList>\n        {props.rooms.map((room) =>\n          <ListItem\n            key={crypto.lib.WordArray.random(32)}\n            link={\"/rooms/\" + room.id}\n            ignoreCache={true}\n            title={room.title}\n            after=\"\"\n            subtitle=\"\"\n            text=\"\"\n            ></ListItem>\n        )}\n      </List>\n    )} else {\n      return (<ul></ul>)\n    }\n  }\n  export default RoomList;\n","import React from \"react\";\nimport { Page, Navbar, List, BlockTitle, ListItem, Fab, Icon,Preloader, Block} from 'framework7-react';\nimport RoomList from \"./list\"\nimport { dict} from '../../Dict';\n\nconst RoomIndex = (props) => {\n  function fab(a) {\n    console.log(props.ability)\n    var result = []\n    if (props.ability) {\n      props.ability.map((ab) => {\n        if (ab.title === a && ab.value) {\n          result.push(\n            <Fab href=\"/rooms/new\" target=\"#main-view\" position=\"left-bottom\" slot=\"fixed\" color=\"deeporange\">\n            <Icon ios=\"f7:add\" aurora=\"f7:add\" md=\"material:add\"></Icon>\n            <Icon ios=\"f7:close\" aurora=\"f7:close\" md=\"material:close\"></Icon>\n          </Fab>\n          )\n        }\n      })\n    }\n    return result\n  }\n  return(\n    <Page>\n      <Navbar title={dict.rooms} backLink={dict.back} >\n      </Navbar>\n      <BlockTitle>{dict.list}</BlockTitle>\n      {fab('new_room')}\n      <RoomList rooms={props.rooms}/>\n    </Page>\n  )\n}\nexport default RoomIndex;\n","import React from \"react\"\nimport { Page,Fab, Icon } from 'framework7-react';\nimport ModelStore from \"../../stores/ModelStore\";\nimport RoomIndex from \"../../containers/rooms/index\"\nimport * as MyActions from \"../../actions/MyActions\";\nimport { dict} from '../../Dict';\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class Layout extends React.Component {\n  constructor() {\n    super();\n    this.getList = this.getList.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      rooms: null,\n      ability: null,\n      profileId: null\n    }\n  }\n  componentWillMount() {\n    ModelStore.on(\"got_list\", this.getList);\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_list\", this.getList);\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    MyActions.getList('rooms', this.state.page, {}, this.state.token);\n  }\n\n  getList() {\n    var rooms = ModelStore.getList()\n    var klass = ModelStore.getKlass()\n    if (rooms && klass === 'Room'){\n      this.setState({\n        rooms: rooms,\n      });\n    }\n  }\n\n\n  getInstance() {\n    var user = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (user && klass === 'UserRole') {\n      this.setState({\n        ability: user.the_ability,\n        profileId: user.profile_id\n      });\n    }\n  }\n\n  render() {\n    const {rooms, ability} = this.state;\n    return(<RoomIndex rooms={rooms} ability={ability}/>)\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, ListInput, Block, Row, Button, BlockTitle, Link } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\n\nconst RoomForm = (props) => {\n  if (props.defaultRoom) {\n    var isPrivateRoom = true;\n  } else {\n    var isPrivateRoom = false\n  }\n\n  return (\n    <React.Fragment>\n      <BlockTitle>{dict.room}</BlockTitle>\n      <List >\n        <ListInput\n          label={dict.title}\n          key='room-title'\n          type=\"text\"\n          placeholder='...'\n          defaultValue={props.room.title}\n          onInput={(e) => {\n            props.handleChange({ title: e.target.value })\n          }}\n        />\n        <ListInput\n          label={dict.details}\n          type=\"textarea\"\n          placeholder={dict.write_appropriate_description}\n          value={props.details}\n          onInput={(e) => {\n            props.handleChange({ details: e.target.value })\n          }}\n        />\n\n        <ListItem radio value={false} checked={!isPrivateRoom} name=\"privateRoom\" title={dict.NonPrivate}\n          onChange={(e) => {\n            console.log(e)\n            props.handleChange({ privateRoom: JSON.parse(e.target.value) })\n          }}>\n        </ListItem>\n        <ListItem radio value={true} checked={isPrivateRoom} name=\"privateRoom\" title={dict.Private}\n          onChange={(e) => {\n            console.log(e)\n            props.handleChange({ privateRoom: JSON.parse(e.target.value) });\n          }}>\n        </ListItem>\n      </List>\n\n      <Block strong>\n        <Row tag=\"p\">\n          <Link className=\"btn-notice\"></Link>\n          <Button className=\"col btn\" fill disabled={!props.editing} onClick={props.submit}>{dict.submit}</Button>\n        </Row>\n      </Block>\n    </React.Fragment>\n  )\n}\nexport default RoomForm;\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport RoomForm from \"../../containers/rooms/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\nexport default class RoomCreate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      room: {},\n      defaultRoom: true,\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n  }\n\n  submit(){\n    var data = {title: this.state.title, default_room: this.state.defaultRoom}\n    MyActions.setInstance('rooms', data, this.state.token);\n  }\n\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/rooms/');\n  }\n\n\n\n  render() {\n    const {room, defaultRoom} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.room_form} backLink={dict.back} />\n        <BlockTitle>{dict.room_form}</BlockTitle>\n        <RoomForm room={room} defaultRoom={defaultRoom} submit={this.submit} editing={true} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  List,\n  ListItem,\n  ListInput,\n  Toggle,\n  BlockTitle,\n  Row,\n  Button,\n  Range,\n  Block,\n  Icon\n} from 'framework7-react';\nimport { dict} from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport RoomForm from \"../../containers/rooms/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n\nexport default class DocumentUpdate extends Component {\n  constructor() {\n    super();\n    this.submit = this.submit.bind(this);\n    this.setInstance = this.setInstance.bind(this);\n    this.getInstance = this.getInstance.bind(this);\n    this.handleChangeValue = this.handleChangeValue.bind(this);\n\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      room : {},\n      defaultRoom: null,\n    }\n  }\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n    ModelStore.on(\"set_instance\", this.setInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n    ModelStore.removeListener(\"set_instance\", this.setInstance);\n\n  }\n\n\n  submit(){\n    var data = {id:this.state.id, title: this.state.title, default_room: this.state.defaultRoom}\n    MyActions.updateInstance('rooms', data,  this.state.token);\n  }\n  componentDidMount(){\n    this.loadData();\n  }\n\n  loadData(){\n    const f7: Framework7 = Framework7.instance;\n    f7.toast.show({ text: dict.receiving, closeTimeout: 2000, position: 'top'});\n    if (this.$f7route.params['roomId']) {\n      MyActions.getInstance('rooms', this.$f7route.params['roomId'],  this.state.token);\n    }\n  }\n\n\n  getInstance(){\n    var room = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (room && klass === 'Room'){\n      this.setState({\n        title: room.title,\n        id: room.id,\n        room: room,\n        defaultRoom: room.default_room\n      });\n    }\n  }\n\n  handleChangeValue(obj) {\n    this.setState(obj);\n  }\n\n\n  setInstance(){\n    const self = this;\n    this.$f7router.navigate('/rooms/');\n  }\n\n\n  render() {\n        const {room, defaultRoom} = this.state;\n    return (\n      <Page>\n        <Navbar title={dict.room_form} backLink={dict.back} />\n        <BlockTitle>{dict.room_form}</BlockTitle>\n        <RoomForm room={room} defaultRoom={defaultRoom} submit={this.submit} editing={true} handleChange={this.handleChangeValue}/>\n      </Page>\n    );\n  }\n}\n","import React from \"react\";\nimport { List, ListItem, Toggle, Block, Row, Button, Chip, Col } from 'framework7-react';\nimport { dict } from '../../Dict';\nimport crypto from 'crypto-js';\n\n\nconst SettingForm = (props) => {\n  if (true) {\n    function setting(item) {\n      //console.log(props.notification_setting, item)\n      if (props.notification_setting && props.notification_setting[item]) {\n        return (true)\n      } else {\n        if (props.notification_setting && props.notification_setting[item] == false) {\n          return (false)\n        } else {\n          return (false)\n        }\n      }\n    }\n\n    function blockList() {\n      var chips = [\n        <div>\n          <a className='fs-11 ' href=\"#\" id='user-blocklist'>\n            <div className=\"item-title fs-11\">\n              <i className=\"va-minus-2 ml-5 fa fa-user-plus\"></i>\n              {dict.profiles}:\n          </div>\n          </a>\n        </div>\n      ]\n      if (props.blockList) {\n        props.blockList.map((profile) => {\n          chips.push(<Chip text={profile.fullname} deleteable onClick={() => props.removeBlocked(profile.id)} />)\n        }\n        )\n      }\n      return chips\n    }\n\n    function able_to_post() {\n      var result = []\n      if (props.ability) {\n        props.ability.map((ab) => {\n          if (ab.title === 'new_post') {\n            result.push(\n              <React.Fragment>\n                <tr>\n                  <td className='fs-11'>{dict.add_comment_to_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_comment_to_posts_email')} onChange={(e) => props.changeSetting(e, 'add_comment_to_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_comment_to_posts_push')} onChange={(e) => props.changeSetting(e, 'add_comment_to_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_comment_to_posts_sms')} onChange={(e) => props.changeSetting(e, 'add_comment_to_posts_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_comments_from_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_comment_from_posts_email')} onChange={(e) => props.changeSetting(e, 'remove_comment_from_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_comment_from_posts_push')} onChange={(e) => props.changeSetting(e, 'remove_comment_from_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_comment_from_posts_sms')} onChange={(e) => props.changeSetting(e, 'remove_comment_from_posts_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.add_likes_to_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_likes_to_posts_email')} onChange={(e) => props.changeSetting(e, 'add_likes_to_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_likes_to_posts_push')} onChange={(e) => props.changeSetting(e, 'add_likes_to_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_likes_to_posts_sms')} onChange={(e) => props.changeSetting(e, 'add_likes_to_posts_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_likes_from_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_likes_from_posts_email')} onChange={(e) => props.changeSetting(e, 'remove_likes_from_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_likes_from_posts_push')} onChange={(e) => props.changeSetting(e, 'remove_likes_from_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_likes_from_posts_sms')} onChange={(e) => props.changeSetting(e, 'remove_likes_from_posts_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.add_bookmarks_to_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_bookmarks_to_posts_email')} onChange={(e) => props.changeSetting(e, 'add_bookmarks_to_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_bookmarks_to_posts_push')} onChange={(e) => props.changeSetting(e, 'add_bookmarks_to_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_bookmarks_to_posts_sms')} onChange={(e) => props.changeSetting(e, 'add_bookmarks_to_posts_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_bookmarks_from_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_bookmarks_from_posts_email')} onChange={(e) => props.changeSetting(e, 'remove_bookmarks_from_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_bookmarks_from_posts_push')} onChange={(e) => props.changeSetting(e, 'remove_bookmarks_from_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_bookmarks_from_posts_sms')} onChange={(e) => props.changeSetting(e, 'remove_bookmarks_from_posts_sms')} /></td>\n                </tr>\n\n                <tr>\n                  <td className='fs-11'>{dict.add_follows_to_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_follows_to_posts_email')} onChange={(e) => props.changeSetting(e, 'add_follows_to_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_follows_to_posts_push')} onChange={(e) => props.changeSetting(e, 'add_follows_to_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_follows_to_posts_sms')} onChange={(e) => props.changeSetting(e, 'add_follows_to_posts_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_follows_from_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_follows_from_posts_email')} onChange={(e) => props.changeSetting(e, 'remove_follows_from_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_follows_from_posts_push')} onChange={(e) => props.changeSetting(e, 'remove_follows_from_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_follows_from_posts_sms')} onChange={(e) => props.changeSetting(e, 'remove_follows_from_posts_sms')} /></td>\n                </tr>\n\n\n                <tr>\n                  <td className='fs-11'>{dict.add_shares_to_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_shares_to_posts_email')} onChange={(e) => props.changeSetting(e, 'add_shares_to_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_shares_to_posts_push')} onChange={(e) => props.changeSetting(e, 'add_shares_to_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_shares_to_posts_sms')} onChange={(e) => props.changeSetting(e, 'add_shares_to_posts_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_shares_from_posts}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_shares_from_posts_email')} onChange={(e) => props.changeSetting(e, 'remove_shares_from_posts_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_shares_from_posts_push')} onChange={(e) => props.changeSetting(e, 'remove_shares_from_posts_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_shares_from_posts_sms')} onChange={(e) => props.changeSetting(e, 'remove_shares_from_posts_sms')} /></td>\n                </tr>\n              </React.Fragment>\n            )\n          }\n        })\n      }\n      return result\n    }\n\n    function able_to_channel() {\n      var result = []\n      if (props.ability) {\n        props.ability.map((ab) => {\n          if (ab.title === 'new_channel') {\n            result.push(\n              <React.Fragment>\n                <tr>\n                  <td className='fs-11'>{dict.add_likes_to_channels}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_likes_to_channels_email')} onChange={(e) => props.changeSetting(e, 'add_likes_to_channels_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_likes_to_channels_push')} onChange={(e) => props.changeSetting(e, 'add_likes_to_channels_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_likes_to_channels_sms')} onChange={(e) => props.changeSetting(e, 'add_likes_to_channels_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_likes_from_channels}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_likes_from_channels_email')} onChange={(e) => props.changeSetting(e, 'remove_likes_from_channels_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_likes_from_channels_push')} onChange={(e) => props.changeSetting(e, 'remove_likes_from_channels_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_likes_from_channels_sms')} onChange={(e) => props.changeSetting(e, 'remove_likes_from_channels_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.add_bookmarks_to_channels}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_bookmarks_to_channels_email')} onChange={(e) => props.changeSetting(e, 'add_bookmarks_to_channels_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_bookmarks_to_channels_push')} onChange={(e) => props.changeSetting(e, 'add_bookmarks_to_channels_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_bookmarks_to_channels_sms')} onChange={(e) => props.changeSetting(e, 'add_bookmarks_to_channels_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_bookmarks_from_channels}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_bookmarks_from_channels_email')} onChange={(e) => props.changeSetting(e, 'remove_bookmarks_from_channels_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_bookmarks_from_channels_push')} onChange={(e) => props.changeSetting(e, 'remove_bookmarks_from_channels_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_bookmarks_from_channels_sms')} onChange={(e) => props.changeSetting(e, 'remove_bookmarks_from_channels_sms')} /></td>\n                </tr>\n\n                <tr>\n                  <td className='fs-11'>{dict.add_follows_to_channels}</td>\n                  <td><Toggle className='pd-5' checked={setting('add_follows_to_channels_email')} onChange={(e) => props.changeSetting(e, 'add_follows_to_channels_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_follows_to_channels_push')} onChange={(e) => props.changeSetting(e, 'add_follows_to_channels_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('add_follows_to_channels_sms')} onChange={(e) => props.changeSetting(e, 'add_follows_to_channels_sms')} /></td>\n                </tr>\n                <tr>\n                  <td className='fs-11'>{dict.remove_follows_from_channels}</td>\n                  <td><Toggle className='pd-5' checked={setting('remove_follows_from_channels_email')} onChange={(e) => props.changeSetting(e, 'remove_follows_from_channels_email')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_follows_from_channels_push')} onChange={(e) => props.changeSetting(e, 'remove_follows_from_channels_push')} /></td>\n                  <td><Toggle className='pd-5' checked={setting('remove_follows_from_channels_sms')} onChange={(e) => props.changeSetting(e, 'remove_follows_from_channels_sms')} /></td>\n                </tr>\n              </React.Fragment>\n\n            )\n          }\n        })\n      }\n      return result\n    }\n\n    return (\n      <React.Fragment>\n\n        <div className=\"data-table card\">\n          <table className='fs-11'>\n            <thead>\n              <tr>\n                <td>{dict.notification_type}</td>\n                <td>{dict.mail_notification}</td>\n                <td>{dict.push_notification}</td>\n                <td>{dict.sms}</td>\n              </tr>\n            </thead>\n            <tbody>\n              <tr>\n                <td className='fs-11'>{dict.add_comment_to_followed_posts}</td>\n                <td><Toggle className='pd-5' checked={setting('add_comment_to_followed_posts_email')} onChange={(e) => props.changeSetting(e, 'add_comment_to_followed_posts_email')} /></td>\n                <td><Toggle className='pd-5' checked={setting('add_comment_to_followed_posts_push')} onChange={(e) => props.changeSetting(e, 'add_comment_to_followed_posts_push')} /></td>\n                <td><Toggle className='pd-5' checked={setting('add_comment_to_followed_posts_sms')} onChange={(e) => props.changeSetting(e, 'add_comment_to_followed_posts_sms')} /></td>\n              </tr>\n              {able_to_post()}\n              <tr>\n                <td></td>\n                <td></td>\n                <td></td>\n                <td></td>\n              </tr>\n              {able_to_channel()}\n              <tr>\n                <td className='fs-11'>{dict.add_post_to_channels}</td>\n                <td><Toggle className='pd-5' checked={setting('add_post_to_channels_email')} onChange={(e) => props.changeSetting(e, 'add_post_to_channels_email')} /></td>\n                <td><Toggle className='pd-5' checked={setting('add_post_to_channels_push')} onChange={(e) => props.changeSetting(e, 'add_post_to_channels_push')} /></td>\n                <td><Toggle className='pd-5' checked={setting('add_post_to_channels_sms')} onChange={(e) => props.changeSetting(e, 'add_post_to_channels_sms')} /></td>\n              </tr>\n\n\n\n            </tbody>\n          </table>\n        </div>\n\n\n\n      </React.Fragment>\n    )\n  } else {\n    return (null)\n  }\n\n}\nexport default SettingForm;\n","import HomePage from './containers/layouts/HomePage.jsx';\nimport NotFoundPage from './containers/layouts/NotFoundPage';\nimport PanelRightPage from './containers/layouts/PanelRightPage';\n\n\nimport MetaShow from './components/metas/show';\nimport MetaIndex from './components/metas/index';\nimport MetaCreate from './components/metas/create';\nimport MetaUpdate from './components/metas/update';\n\n\nimport PostShow from './components/posts/show';\nimport PostIndex from './components/posts/index';\nimport PostCreate from './components/posts/create';\nimport PostUpdate from './components/posts/update';\n\nimport NotificationIndex from './components/notifications/index';\n\nimport ChannelShow from './components/channels/show';\nimport ChannelIndex from './components/channels/index';\nimport ChannelCreate from './components/channels/create';\nimport ChannelUpdate from './components/channels/update';\n\nimport RoleShow from './components/roles/show';\nimport RoleIndex from './components/roles/index';\nimport RoleCreate from './components/roles/create';\nimport RoleUpdate from './components/roles/update';\n\n\nimport SettingShow from './components/settings/show';\nimport SettingIndex from './components/settings/index';\nimport SettingCreate from './components/settings/create';\nimport SettingUpdate from './components/settings/update';\n\n\nimport ProfileShow from './components/profiles/show';\nimport ProfileIndex from './components/profiles/index';\nimport ProfileCreate from './components/profiles/create';\nimport ProfileUpdate from './components/profiles/update';\n\nimport FriendshipIndex from './components/friendships/index';\n\nimport PrivacyIndex from './components/privacy/index';\n\nimport BookmarkIndex from './components/bookmarks/index';\n\nimport Login from './components/users/Login';\nimport LoginJwt from './components/users/LoginJwt';\nimport SignUp from './components/users/SignUp';\nimport Verification from './components/users/Verification';\n\nimport RoomShow from './components/rooms/show';\nimport RoomIndex from './components/rooms/index';\nimport RoomCreate from './components/rooms/create';\nimport RoomUpdate from './components/rooms/update';\n\nimport NotificationSettingUpdate from './components/notification_settings/update';\n\n\nexport default [\n  {\n    path: '/',\n    component: PostIndex,\n  },\n  {\n    path: '/login/',\n    component: Login,\n  },\n  {\n    path: '/sign_up/',\n    component: SignUp,\n  },\n  {\n    path: '/verification/:email',\n    component: Verification,\n  },\n  {\n    path: '/login_jwt/:token',\n    component: LoginJwt,\n  },\n  {\n    path: '/panel-right/',\n    component: PanelRightPage,\n  },\n  {\n    path: '/bookmarks/',\n    component: BookmarkIndex,\n  },\n\n  {\n    path: '/rooms/',\n    component: RoomIndex,\n  },\n  {\n    path: '/rooms/:roomId/edit',\n    component: RoomUpdate,\n  },\n  {\n    path: '/rooms/new',\n    component: RoomCreate,\n  },\n  {\n    path: '/rooms/:roomId',\n    component: RoomShow,\n  },\n\n  {\n    path: '/metas/',\n    component: MetaIndex,\n  },\n  {\n    path: '/metas/:metaId/edit',\n    component: MetaUpdate,\n  },\n  {\n    path: '/metas/new',\n    component: MetaCreate,\n  },\n  {\n    path: '/metas/:metaId',\n    component: MetaShow,\n  },\n\n  {\n    path: '/notifications/',\n    component: NotificationIndex,\n  },\n\n  {\n    path: '/posts/',\n    component: PostIndex,\n  },\n  {\n    path: '/posts/:postId/edit',\n    component: PostUpdate,\n  },\n  {\n    path: '/posts/new',\n    component: PostCreate,\n  },\n  {\n    path: '/posts/:postId',\n    component: PostShow,\n  },\n\n  {\n    path: '/channels/',\n    component: ChannelIndex,\n  },\n  {\n    path: '/channels/:channelId/edit',\n    component: ChannelUpdate,\n  },\n  {\n    path: '/channels/new',\n    component: ChannelCreate,\n  },\n  {\n    path: '/channels/:channelId',\n    component: ChannelShow,\n  },\n\n  {\n    path: '/roles/',\n    component: RoleIndex,\n  },\n  {\n    path: '/roles/:roleId/edit',\n    component: RoleUpdate,\n  },\n  {\n    path: '/roles/new',\n    component: RoleCreate,\n  },\n  {\n    path: '/roles/:roleId',\n    component: RoleShow,\n  },\n\n  {\n    path: '/profiles/',\n    component: ProfileIndex,\n  },\n  {\n    path: '/profiles/:profileId/edit',\n    component: ProfileUpdate,\n  },\n  {\n    path: '/profiles/new',\n    component: ProfileCreate,\n  },\n  {\n    path: '/profiles/:profileId',\n    component: ProfileShow,\n  },\n  {\n    path: '/friendships/:sourceId',\n    component: FriendshipIndex,\n  },\n  {\n    path: '/privacy_settings/',\n    component: PrivacyIndex,\n  },\n\n  {\n    path: '/settings/',\n    component: SettingIndex,\n  },\n  {\n    path: '/settings/:settingId/edit',\n    component: SettingUpdate,\n  },\n  {\n    path: '/settings/new',\n    component: SettingCreate,\n  },\n  {\n    path: '/settings/:settingId',\n    component: SettingShow,\n  },\n\n  {\n    path: '/notification_settings/',\n    component: NotificationSettingUpdate,\n  },\n\n\n  {\n    path: '(.*)',\n    component: NotFoundPage,\n  },\n];\n","import React, { Component } from 'react';\nimport {\n  Page,\n  Navbar,\n  BlockTitle,\n} from 'framework7-react';\nimport { dict } from '../../Dict';\nimport ModelStore from \"../../stores/ModelStore\";\nimport * as MyActions from \"../../actions/MyActions\";\nimport NotificationSettingForm from \"../../containers/notification_settings/form\"\nimport Framework7 from 'framework7/framework7.esm.bundle';\nimport { conf } from '../../conf';\n\nexport default class SettingCreate extends Component {\n  constructor() {\n    super();\n\n    this.getInstance = this.getInstance.bind(this);\n    this.changeSetting = this.changeSetting.bind(this);\n    this.loadBlockList = this.loadBlockList.bind(this);\n    this.removeBlocked = this.removeBlocked.bind(this);\n    \n\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n      setting: {},\n      title: null,\n      id: null,\n      setting: null,\n      notification_setting: [],\n      blockList: [],\n      ability: null,\n      profileId: null,\n    }\n  }\n\n\n  componentWillMount() {\n    ModelStore.on(\"got_instance\", this.getInstance);\n  }\n\n  componentWillUnmount() {\n    ModelStore.removeListener(\"got_instance\", this.getInstance);\n  }\n\n  componentDidMount() {\n    this.loadData();\n  }\n\n  loadData() {\n    MyActions.getInstance('notification_settings', 1, this.state.token);\n    MyActions.getInstance('users', 'role', this.state.token);\n  }\n\n  pageAfterIn() {\n    this.loadBlockList();\n  }\n\n\n  loadBlockList() {\n    const self = this;\n    const app = self.$f7;\n    app.autocomplete.create({\n      openIn: 'popup', //open in page\n      openerEl: '#user-blocklist', //link that opens autocomplete\n      multiple: true, //allow multiple values\n      valueProperty: 'id', //object's \"value\" property name\n      textProperty: 'fullname', //object's \"text\" property name\n      searchbarDisableText: dict.cancel,\n      popupCloseLinkText: dict.close,\n      notFoundText: dict.not_found,\n      limit: 50,\n      searchbarPlaceholder: dict.search,\n      //preloader: true, //enable preloader\n      source: function (query, render) {\n        var autocomplete = this;\n        var results = [];\n        if (query.length === 0) {\n          render(results);\n          return;\n        }\n        // Show Preloader\n       // autocomplete.preloaderShow();\n        // Do Ajax request to Autocomplete data\n        app.request({\n          url: conf.server + '/profiles/search',\n          method: 'GET',\n          dataType: 'json',\n          //send \"query\" to server. Useful in case you generate response dynamically\n          data: {\n            q: query\n          },\n          success: function (item) {\n            // Find matched items\n            for (var i = 0; i < item.data.length; i++) {\n               results.push(item.data[i]);\n            }\n            // Hide Preoloader\n            //autocomplete.preloaderHide();\n            // Render items by passing array with result items\n            render(results);\n          }\n        });\n      },\n      on: {\n        change: function (value) {\n          if (value && value[value.length - 1]) {\n            self.setState({ blockList: self.state.blockList.concat({ fullname: value[value.length - 1].fullname, id: value[value.length - 1].id }) })\n            var data = {profile_id: value[value.length - 1].id }\n            MyActions.setInstance('notification_settings/add_block', data, self.state.token)\n          }\n        },\n      },\n    });\n  }\n\n\n\n\n\n  getInstance() {\n    var model = ModelStore.getIntance()\n    var klass = ModelStore.getKlass()\n    if (model && klass === 'NotificationSetting') {\n      this.setState({\n        title: model.title,\n        id: model.id,\n        notification_setting: model.notification_setting\n      });\n    }\n    if (model && klass === 'UserRole') {\n      this.setState({\n        ability: model.the_ability,\n        roles: model.the_roles,\n        profileId: model.profile_id\n      });\n    }\n    \n  }\n\n  changeSetting(e, item) {\n    var data = { item: item }\n    if (e.target.checked) {\n      this.setState(prevState => {\n        let notification_setting = Object.assign({}, prevState.notification_setting);\n        notification_setting[item] = true;\n        return { notification_setting };\n      })\n      MyActions.setInstance('notification_settings/add', data, this.state.token)\n    } else {\n      this.setState(prevState => {\n        let notification_setting = Object.assign({}, prevState.notification_setting);\n        notification_setting[item] = false;\n        return { notification_setting };\n      })\n      MyActions.setInstance('notification_settings/remove', data, this.state.token);\n    }\n  }\n\n  removeBlocked(id){\n    this.setState({\n      blockList: this.state.blockList.filter(function (profile) {\n        return profile.id !== id\n      })\n    });\n    var data = {profile_id: id }\n    MyActions.setInstance('notification_settings/remove_block', data, this.state.token)\n  }\n\n\n\n\n  render() {\n    const { notification_setting, title, blockList, ability } = this.state;\n    return (\n      <Page onPageAfterIn={this.pageAfterIn.bind(this)}>\n        <Navbar title={dict.work_form} backLink={dict.back} />\n        <BlockTitle>{dict.work_form}</BlockTitle>\n        <NotificationSettingForm\n          notification_setting={notification_setting} ability={ability}\n          title={title} changeSetting={this.changeSetting} blockList={blockList}\n          submit={this.submit} editing={true} handleChange={this.handleChangeValue} \n          removeBlocked={this.removeBlocked}\n          />\n      </Page>\n    );\n  }\n}\n","import React from 'react';\nimport { Page, Navbar, Block } from 'framework7-react';\n\nexport default () => (\n  <Page>\n    <Navbar title=\"Not found\" backLink=\"Back\" />\n    <Block strong>\n      <p>Sorry</p>\n      <p>Requested content not found.</p>\n    </Block>\n  </Page>\n);\n","import React, { Component } from 'react';\nimport {\n  App,\n  Panel,\n  View,\n  Statusbar,\n} from 'framework7-react';\n//import ModelStore from \"../stores/ModelStore\";\nimport * as MyActions from \"../actions/MyActions\";\nimport { messaging } from \"../init-fcm.js\";\n\n\nimport routes from '../routes';\n\nexport default class extends React.Component {\n  constructor() {\n    super();\n\n    this.state = {\n      token: window.localStorage.getItem('token'),\n    }\n  }\n  async componentDidMount() {\n    const self = this;      \n    const app = self.$f7;\n\n    if (messaging) {\n      messaging.requestPermission()\n        .then(async function () {\n          const token = await messaging.getToken();\n          var data = { token: token }\n          if (self.state.token && self.state.token.length > 10) {\n            MyActions.setInstance('devices', data, self.state.token);\n          }\n        })\n        .catch(function (err) {\n          console.log(\"Unable to get permission to notify.\", err);\n        });\n    }\n    navigator.serviceWorker.addEventListener(\"message\", (message) => {\n\n     app.notification.create({\n        icon: '',\n\n        title: message.data.firebaseMessaging.payload.notification.title,\n        titleRightText: '',\n        cssClass: 'notification',\n        subtitle: message.data.firebaseMessaging.payload.notification.body,\n        closeTimeout: 5000,\n      }).open();\n    });\n\n\n  }\n  // Framework7 parameters here\n\n  render() {\n    const f7params = {\n      id: 'io.framework7.testapp', // App bundle ID\n      name: 'Framework7', // App name\n      theme: 'aurora', // Automatic theme detection\n      panel: {\n        rightBreakpoint: 960,\n      },\n      view: {\n       // animate : false,\n        //ignoreCache: true,\n        //reloadCurrent: true\n        auroraPageLoadDelay: 90,\n        removeElements: true\n      },\n      // App routes\n      routes,\n    };\n\n    //const server = React.createContext('http://localhost:3001/v1/');\n    return (\n      <App params={f7params}>\n        {/* Statusbar */}\n        <Statusbar />\n\n        {/* Left Panel */}\n\n        {/* Right Panel */}\n        <Panel right reveal themeDark>\n          <View url=\"/panel-right/\" />\n        </Panel>\n\n        {/* Main View */}\n        <View id=\"main-view\" url=\"/\" pushState={true} main className=\"safe-areas\" />\n\n      </App>\n    );\n  }\n};\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from 'react';\nimport ReactDOM from 'react-dom';\n// Import Framework7\nimport Framework7 from 'framework7/framework7.esm.bundle';\n\n// Import Framework7-React plugin\nimport Framework7React from 'framework7-react';\n\n// Import main App component\nimport App from './components/App.jsx';\n\n// Framework7 styles\nimport 'framework7/css/framework7.bundle.rtl.min.css';\n\n// Icons\nimport './css/icons.css';\n\n// Custom app styles\nimport './css/app.css';\nimport './css/editor.css';\nimport './css/font-awesome.min.css';\nimport 'react-draft-wysiwyg/dist/react-draft-wysiwyg.css';\n\n\nimport * as serviceWorker from './serviceWorker';\n\n\n// Init Framework7-React plugin\nFramework7.use(Framework7React);\n\n// Mount React App\nReactDOM.render(React.createElement(App),\n  document.getElementById('root')\n);\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister();\n","module.exports = {\n\n  // Generic\n  'generic.add': 'افزودن',\n  'generic.cancel': 'لغو',\n\n  // BlockType\n  'components.controls.blocktype.h1': 'H1',\n  'components.controls.blocktype.h2': 'H2',\n  'components.controls.blocktype.h3': 'H3',\n  'components.controls.blocktype.h4': 'H4',\n  'components.controls.blocktype.h5': 'H5',\n  'components.controls.blocktype.h6': 'H6',\n  'components.controls.blocktype.blockquote': 'Blockquote',\n  'components.controls.blocktype.code': 'Code',\n  'components.controls.blocktype.blocktype': 'Block Type',\n  'components.controls.blocktype.normal': 'Normal',\n\n  // Color Picker\n  'components.controls.colorpicker.colorpicker': 'Color Picker',\n  'components.controls.colorpicker.text': 'Text',\n  'components.controls.colorpicker.background': 'Highlight',\n\n  // Embedded\n  'components.controls.embedded.embedded': 'Embedded',\n  'components.controls.embedded.embeddedlink': 'Embedded Link',\n  'components.controls.embedded.enterlink': 'Enter link',\n\n  // Emoji\n  'components.controls.emoji.emoji': 'Emoji',\n\n  // FontFamily\n  'components.controls.fontfamily.fontfamily': 'Font',\n\n  // FontSize\n  'components.controls.fontsize.fontsize': 'Font Size',\n\n  // History\n  'components.controls.history.history': 'History',\n  'components.controls.history.undo': 'Undo',\n  'components.controls.history.redo': 'Redo',\n\n  // Image\n  'components.controls.image.image': 'عکس',\n  'components.controls.image.fileUpload': 'بارگذاری',\n  'components.controls.image.byURL': 'پیوند',\n  'components.controls.image.dropFileText': 'اینجا را کلیک کنید ',\n\n  // Inline\n  'components.controls.inline.bold': 'Bold',\n  'components.controls.inline.italic': 'Italic',\n  'components.controls.inline.underline': 'Underline',\n  'components.controls.inline.strikethrough': 'Strikethrough',\n  'components.controls.inline.monospace': 'Monospace',\n  'components.controls.inline.superscript': 'Superscript',\n  'components.controls.inline.subscript': 'Subscript',\n\n  // Link\n  'components.controls.link.linkTitle': 'عنوان پیوند',\n  'components.controls.link.linkTarget': 'آدرس',\n  'components.controls.link.linkTargetOption': 'در پنجره جدید باز کن',\n  'components.controls.link.link': 'پیوند',\n  'components.controls.link.unlink': 'لغو پیوند',\n\n  // List\n  'components.controls.list.list': 'List',\n  'components.controls.list.unordered': 'Unordered',\n  'components.controls.list.ordered': 'Ordered',\n  'components.controls.list.indent': 'Indent',\n  'components.controls.list.outdent': 'Outdent',\n\n  // Remove\n  'components.controls.remove.remove': 'Remove',\n\n  // TextAlign\n  'components.controls.textalign.textalign': 'Text Align',\n  'components.controls.textalign.left': 'Left',\n  'components.controls.textalign.center': 'Center',\n  'components.controls.textalign.right': 'Right',\n  'components.controls.textalign.justify': 'Justify',\n};\n"],"sourceRoot":""}