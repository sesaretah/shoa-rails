(window["webpackJsonpd1-react"]=window["webpackJsonpd1-react"]||[]).push([[0],{124:function(e,t,n){e.exports=n(279)},274:function(e,t,n){},275:function(e,t,n){},276:function(e,t,n){},277:function(e,t,n){},279:function(e,t,n){"use strict";n.r(t);var a,i=n(0),r=n.n(i),o=n(31),s=n.n(o),l=n(13),c=n(1),u=n(8),d=(a={home:"\u062e\u0627\u0646\u0647",name:"\u0646\u0627\u0645 \u0648 \u0646\u0627\u0645 \u062e\u0627\u0646\u0648\u0627\u062f\u06af\u06cc ",login:"\u0648\u0631\u0648\u062f",username:"\u0646\u0627\u0645 \u06a9\u0627\u0631\u0628\u0631\u06cc ",password:"\u0631\u0645\u0632 \u0639\u0628\u0648\u0631 ",password_confirmation:"\u062a\u06a9\u0631\u0627\u0631 \u0631\u0645\u0632 \u0639\u0628\u0648\u0631",mobile:"\u0634\u0645\u0627\u0631\u0647 \u0645\u0648\u0628\u0627\u06cc\u0644 ",error:"\u062e\u0637\u0627",sign_in:"\u0648\u0631\u0648\u062f ",sign_up:"\u062b\u0628\u062a \u0646\u0627\u0645",back:"\u0628\u0627\u0632\u06af\u0634\u062a",signed_up_already:"\u062a\u0627 \u06a9\u0646\u0648\u0646 \u062b\u0628\u062a \u0646\u0627\u0645 \u0646\u06a9\u0631\u062f\u0647 \u0627\u06cc\u062f\u061f",new_advert:"\u062f\u0631\u062c \u0622\u06af\u0647\u06cc ",title:"\u0639\u0646\u0648\u0627\u0646",abstract:"\u0686\u06a9\u06cc\u062f\u0647",content:"\u0645\u062a\u0646",submit:"\u062b\u0628\u062a ",upload_from_gallery:"\u0627\u0646\u062a\u062e\u0627\u0628 \u0627\u0632 \u06af\u0627\u0644\u0631\u06cc",welcome:"\u062e\u0648\u0634 \u0622\u0645\u062f\u06cc\u062f",sign_out:"\u062e\u0631\u0648\u062c",phone_number:"\u0634\u0645\u0627\u0631\u0647 \u062a\u0644\u0641\u0646",telegram_channel:"\u06a9\u0627\u0646\u0627\u0644 \u062a\u0644\u06af\u0631\u0627\u0645",instagram_page:"\u0635\u0641\u062d\u0647 \u0627\u06cc\u0646\u0633\u062a\u0627\u06af\u0631\u0627\u0645",address:"\u0622\u062f\u0631\u0633 ",email:"\u0627\u06cc\u0645\u06cc\u0644 ",contact_information:"\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u062a\u0645\u0627\u0633 ",search:"\u062c\u0633\u062a\u062c\u0648 ",cancel:"\u0628\u06cc\u062e\u06cc\u0627\u0644",view:"\u0646\u0645\u0627\u06cc\u0634",edit:"\u0648\u06cc\u0631\u0627\u06cc\u0634",delete:"\u062d\u0630\u0641",adverts_nes:"\u0639\u0646\u0648\u0627\u0646\u060c \u0645\u062a\u0646 \u0648 \u0634\u0645\u0627\u0631\u0647 \u062a\u0644\u0641\u0646 \u0627\u062c\u0628\u0627\u0631\u06cc \u0627\u0633\u062a",my_pins:" \u0646\u0634\u0627\u0646 \u0634\u062f\u0647\u200c\u0647\u0627 ",pin:"\u0646\u0634\u0627\u0646 \u06a9\u0646",pinned:"\u0646\u0634\u0627\u0646 \u0634\u062f\u0647",message_to_seller:"\u0627\u0631\u0633\u0627\u0644 \u067e\u06cc\u0627\u0645",messages:"\u067e\u06cc\u0627\u0645 \u0647\u0627 ",send_message:"\u067e\u06cc\u0627\u0645 \u062e\u0648\u062f \u0631\u0627 \u0628\u0646\u0648\u06cc\u0633\u06cc\u062f",province:"\u0627\u0633\u062a\u0627\u0646",city:"\u0634\u0647\u0631",website:"\u0648\u0628\u0633\u0627\u06cc\u062a",call:"\u062a\u0645\u0627\u0633 \u0628\u06af\u06cc\u0631\u06cc\u062f",ago:" \u0642\u0628\u0644",all_above:"\u0647\u0645\u0647 \u06cc \u0645\u0648\u0627\u0631\u062f \u0641\u0648\u0642",no_result:"\u0645\u0648\u0631\u062f\u06cc \u06cc\u0627\u0641\u062a \u0646\u0634\u062f ",category:"\u062f\u0633\u062a\u0647 \u0628\u0646\u062f\u06cc ",leg:"\u0645\u0633\u06cc\u0631",date:"\u062a\u0627\u0631\u06cc\u062e",time:"\u0632\u0645\u0627\u0646",numberOfPassngers:"\u062a\u0639\u062f\u0627\u062f \u0645\u0633\u0627\u0641\u0631\u0627\u0646 ",surename:"\u0646\u0627\u0645 \u062e\u0627\u0646\u0648\u0627\u062f\u06af\u06cc",fathername:"\u0646\u0627\u0645 \u067e\u062f\u0631",ssn:"\u06a9\u062f\u0645\u0644\u06cc",birthplace:"\u0645\u062d\u0644 \u062a\u0648\u0644\u062f",pass_no:"\u0634\u0645\u0627\u0631\u0647 \u06af\u0630\u0631\u0646\u0627\u0645\u0647",birthdate:"\u062a\u0627\u0631\u06cc\u062e \u062a\u0648\u0644\u062f",place_of_birth:"\u0645\u062d\u0644 \u062a\u0648\u0644\u062f",required_fields:"\u0641\u06cc\u0644\u062f\u0647\u0627\u06cc \u0627\u062c\u0628\u0627\u0631\u06cc",en_father_name:"\u0646\u0627\u0645 \u067e\u062f\u0631 \u0644\u0627\u062a\u06cc\u0646",en_name:"\u0646\u0627\u0645 \u0644\u0627\u062a\u06cc\u0646",en_surename:"\u0646\u0627\u0645 \u062e\u0627\u0646\u0648\u0627\u062f\u06af\u06cc \u0644\u0627\u062a\u06cc\u0646 ",passport_no:"\u0634\u0645\u0627\u0631\u0647 \u06af\u0630\u0631\u0646\u0627\u0645\u0647",final_confirm:"\u062a\u0627\u06cc\u06cc\u062f \u0646\u0647\u0627\u06cc\u06cc ",document_form:"\u0641\u0631\u0645 \u0627\u0633\u0646\u0627\u062f ",save:"\u0630\u062e\u06cc\u0631\u0647",documents:"\u0627\u0633\u0646\u0627\u062f ",type:"\u0646\u0648\u0639",string:"\u0645\u062a\u0646 \u06a9\u0648\u062a\u0627\u0647",text:"\u0645\u062a\u0646 \u0628\u0644\u0646\u062f",select:"\u06af\u0632\u06cc\u0646\u0647",multiSelect:"\u0686\u0646\u062f \u06af\u0632\u06cc\u0646\u0647",table:"\u062c\u062f\u0648\u0644"},Object(u.a)(a,"date","\u062a\u0627\u0631\u06cc\u062e"),Object(u.a)(a,"refundable","\u0642\u0627\u0628\u0644 \u0627\u0639\u0627\u062f\u0647"),Object(u.a)(a,"yes","\u0628\u0644\u0647"),Object(u.a)(a,"no","\u062e\u06cc\u0631"),Object(u.a)(a,"commentable","\u0642\u0627\u0628\u0644 \u0646\u0638\u0631\u062f\u0647\u06cc"),Object(u.a)(a,"end_point","\u0646\u0642\u0637\u0647 \u067e\u0627\u06cc\u0627\u0646"),Object(u.a)(a,"start_point","\u0646\u0642\u0637\u0647 \u0634\u0631\u0648\u0639"),Object(u.a)(a,"votable","\u0631\u0627\u06cc \u06af\u06cc\u0631\u06cc"),Object(u.a)(a,"publishable","\u0642\u0627\u0628\u0644 \u0627\u0646\u062a\u0634\u0627\u0631"),Object(u.a)(a,"field_name","\u0646\u0627\u0645 \u0641\u06cc\u0644\u062f"),Object(u.a)(a,"add","\u0627\u0641\u0632\u0648\u062f\u0646 "),Object(u.a)(a,"remove","\u062d\u0630\u0641"),Object(u.a)(a,"auxiliary_tables","\u062c\u062f\u0627\u0648\u0644 \u06a9\u0645\u06a9\u06cc"),Object(u.a)(a,"create_by","\u0627\u06cc\u062c\u0627\u062f \u0634\u062f\u0647 \u062a\u0648\u0633\u0637"),Object(u.a)(a,"list","\u0644\u06cc\u0633\u062a"),Object(u.a)(a,"workflows","\u06af\u0631\u062f\u0634 \u06a9\u0627\u0631\u0647\u0627"),Object(u.a)(a,"auxiliary_records","\u0645\u0642\u0627\u062f\u06cc\u0631 \u06a9\u0645\u06a9\u06cc"),Object(u.a)(a,"basic_table","\u062c\u062f\u0648\u0644 \u067e\u0627\u06cc\u0647"),Object(u.a)(a,"relation_table","\u062c\u062f\u0648\u0644 \u0631\u0627\u0628\u0637\u0647"),Object(u.a)(a,"auxiliary_table_form","\u0641\u0631\u0645 \u062c\u062f\u0648\u0644 \u06a9\u0645\u06a9\u06cc "),Object(u.a)(a,"Basic","\u067e\u0627\u06cc\u0647"),Object(u.a)(a,"Relation","\u0631\u0627\u0628\u0637\u0647 "),Object(u.a)(a,"Divan","\u062f\u06cc\u0648\u0627\u0646"),Object(u.a)(a,"workflow_form","\u0641\u0631\u0645 \u06af\u0631\u062f\u0634 \u06a9\u0627\u0631"),Object(u.a)(a,"submitting","\u062f\u0631 \u062d\u0627\u0644 \u0627\u0631\u0633\u0627\u0644 ... "),Object(u.a)(a,"settings","\u062a\u0646\u0638\u06cc\u0645\u0627\u062a"),Object(u.a)(a,"receiving","\u062f\u0631 \u062d\u0627\u0644 \u062f\u0631\u06cc\u0627\u0641\u062a ..."),Object(u.a)(a,"workflow_tables","\u062c\u062f\u0627\u0648\u0644 \u06a9\u0645\u06a9\u06cc \u06af\u0631\u062f\u0634 \u06a9\u0627\u0631 "),Object(u.a)(a,"auxiliary_table","\u062c\u062f\u0648\u0644 \u06a9\u0645\u06a9\u06cc"),Object(u.a)(a,"workflow","\u06af\u0631\u062f\u0634 \u06a9\u0627\u0631"),Object(u.a)(a,"actions","\u0639\u0645\u0644\u06cc\u0627\u062a"),Object(u.a)(a,"roles","\u0646\u0642\u0634 \u0647\u0627"),Object(u.a)(a,"divan","\u062f\u06cc\u0648\u0627\u0646"),Object(u.a)(a,"enter_your_email","\u0627\u06cc\u0645\u06cc\u0644 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"),Object(u.a)(a,"enter_your_password","\u0631\u0645\u0632 \u0639\u0628\u0648\u0631 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f "),Object(u.a)(a,"enter_your_password_confirmation","\u0631\u0645\u0632 \u0639\u0628\u0648\u0631 \u0631\u0627 \u062a\u06a9\u0631\u0627\u0631 \u06a9\u0646\u06cc\u062f "),Object(u.a)(a,"profiles","\u0627\u0641\u0631\u0627\u062f "),Object(u.a)(a,"firstname","\u0646\u0627\u0645"),Object(u.a)(a,"if_registered","\u0627\u06af\u0631 \u0642\u0628\u0644\u0627 \u062b\u0628\u062a \u0646\u0627\u0645 \u06a9\u0631\u062f\u0647 \u0627\u06cc\u062f"),Object(u.a)(a,"you_can_login","\u0648\u0627\u0631\u062f \u0634\u0648\u06cc\u062f "),Object(u.a)(a,"if_not_registered","\u0627\u06af\u0631 \u062b\u0628\u062a \u0646\u0627\u0645 \u0646\u06a9\u0631\u062f\u0647 \u0627\u06cc\u062f"),Object(u.a)(a,"you_can_sign_up","\u062b\u0628\u062a \u0646\u0627\u0645 \u06a9\u0646\u06cc\u062f"),Object(u.a)(a,"new_assignment","\u0627\u0639\u0637\u0627\u06cc \u0646\u0642\u0634 \u062c\u062f\u06cc\u062f"),Object(u.a)(a,"posts","\u067e\u0633\u062a \u0647\u0627"),Object(u.a)(a,"bookmark","\u0646\u0634\u0627\u0646"),Object(u.a)(a,"like","\u0639\u0644\u0627\u0642\u0647"),Object(u.a)(a,"follow","\u062f\u0646\u0628\u0627\u0644"),Object(u.a)(a,"share","\u0627\u0634\u062a\u0631\u0627\u06a9"),Object(u.a)(a,"social_acts","\u0639\u0645\u0644\u06af\u0631\u0647\u0627\u06cc \u0627\u062c\u062a\u0645\u0627\u0639\u06cc "),Object(u.a)(a,"channels","\u06a9\u0627\u0646\u0627\u0644 \u0647\u0627"),Object(u.a)(a,"close","\u0628\u0633\u062a\u0646"),Object(u.a)(a,"channel","\u06a9\u0627\u0646\u0627\u0644 "),Object(u.a)(a,"details","\u0634\u0631\u062d"),Object(u.a)(a,"Shoa","\u0634\u0639\u0627\u0639 "),Object(u.a)(a,"role","\u0646\u0642\u0634"),Object(u.a)(a,"Default","\u067e\u06cc\u0634 \u0641\u0631\u0636"),Object(u.a)(a,"NonDefault","\u063a\u06cc\u0631 \u067e\u06cc\u0634 \u0641\u0631\u0636 "),Object(u.a)(a,"value"," \u0645\u0642\u062f\u0627\u0631"),Object(u.a)(a,"true","\u0645\u062b\u0628\u062a"),Object(u.a)(a,"false","\u0645\u0646\u0641\u06cc"),Object(u.a)(a,"access_control_list","\u0644\u06cc\u0633\u062a \u06a9\u0646\u062a\u0631\u0644 \u062f\u0633\u062a\u0631\u0633\u06cc"),Object(u.a)(a,"access_control_form","\u0641\u0631\u0645 \u06a9\u0646\u062a\u0631\u0644 \u062f\u0633\u062a\u0631\u0633\u06cc"),Object(u.a)(a,"assignment_form","\u0641\u0631\u0645 \u0627\u0639\u0637\u0627\u06cc \u0646\u0642\u0634"),Object(u.a)(a,"comment_form","\u0646\u0638\u0631 \u0628\u062f\u0647\u06cc\u062f"),Object(u.a)(a,"post_form","\u0641\u0631\u0645 \u067e\u0633\u062a"),Object(u.a)(a,"metas","\u067e\u06cc\u0634 \u062c\u062f\u0627\u0648\u0644"),Object(u.a)(a,"shoa","\u0634\u0639\u0627\u0639"),Object(u.a)(a,"form","\u0648\u0631\u0648\u062f \u0627\u0637\u0644\u0627\u0639\u0627\u062a"),Object(u.a)(a,"choose_image","\u0627\u0646\u062a\u062e\u0627\u0628 \u0639\u06a9\u0633"),Object(u.a)(a,"logout","\u062e\u0631\u0648\u062c"),Object(u.a)(a,"more","\u0628\u06cc\u0634\u062a\u0631 ..."),Object(u.a)(a,"social","\u0627\u062c\u062a\u0645\u0627\u0639\u06cc"),Object(u.a)(a,"others","\u062f\u06cc\u06af\u0631\u0627\u0646"),Object(u.a)(a,"related","\u0645\u0631\u062a\u0628\u0637"),Object(u.a)(a,"mine","\u0645\u0646"),Object(u.a)(a,"info","\u0627\u0637\u0644\u0627\u0639\u0627\u062a"),Object(u.a)(a,"admins","\u0645\u062f\u06cc\u0631\u0627\u0646"),Object(u.a)(a,"recent_posts","\u067e\u0633\u062a \u0647\u0627\u06cc \u0627\u062e\u06cc\u0631"),Object(u.a)(a,"profile_info","\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0641\u0631\u062f\u06cc "),Object(u.a)(a,"experties","\u062a\u062e\u0635\u0635 \u0647\u0627 \u0648 \u0645\u0647\u0627\u0631\u062a \u0647\u0627"),Object(u.a)(a,"new_experties","\u0627\u0641\u0632\u0648\u062f\u0646 \u062a\u062e\u0635\u0635"),Object(u.a)(a,"notifications","\u0622\u06af\u0627\u0647\u0633\u0627\u0632\u06cc \u0647\u0627"),Object(u.a)(a,"enter_your_name","\u0646\u0627\u0645 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"),Object(u.a)(a,"enter_your_surename","\u0646\u0627\u0645 \u062e\u0627\u0646\u0648\u0627\u062f\u06af\u06cc \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"),Object(u.a)(a,"incomplete_data","\u0627\u0637\u0644\u0627\u0639\u0627\u062a \u0646\u0627\u0642\u0635"),Object(u.a)(a,"alert","\u0647\u0634\u062f\u0627\u0631"),Object(u.a)(a,"followers","\u062f\u0646\u0628\u0627\u0644 \u06a9\u0646\u0646\u062f\u06af\u0627\u0646"),Object(u.a)(a,"followees","\u062f\u0646\u0628\u0627\u0644 \u0634\u0648\u0646\u062f\u06af\u0627\u0646"),Object(u.a)(a,"verification","\u0627\u062d\u0631\u0627\u0632 \u0647\u0648\u06cc\u062a"),Object(u.a)(a,"verification_code","\u06a9\u062f \u0627\u062d\u0631\u0627\u0632"),Object(u.a)(a,"enter_verification_code","\u06a9\u062f \u0627\u062d\u0631\u0627\u0632 \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"),Object(u.a)(a,"faculty","\u062f\u0627\u0646\u0634\u06a9\u062f\u0647"),Object(u.a)(a,"enter_your_faculty","\u0646\u0627\u0645 \u062f\u0627\u0646\u0634\u06a9\u062f\u0647 \u062e\u0648\u062f \u0631\u0627 \u0648\u0627\u0631\u062f \u06a9\u0646\u06cc\u062f"),Object(u.a)(a,"new_post","\u067e\u0633\u062a \u062c\u062f\u06cc\u062f"),Object(u.a)(a,"full_list","\u0644\u06cc\u0633\u062a \u06a9\u0627\u0645\u0644"),Object(u.a)(a,"privacy_settings","\u062d\u0631\u06cc\u0645 \u062e\u0635\u0648\u0635\u06cc"),Object(u.a)(a,"global_settings","\u062a\u0646\u0638\u06cc\u0645\u0627\u062a \u0639\u0645\u0648\u0645\u06cc"),Object(u.a)(a,"message","\u067e\u06cc\u0627\u0645"),Object(u.a)(a,"completed_successfully","\u0628\u0627 \u0645\u0648\u0641\u0642\u06cc\u062a \u0627\u0646\u062c\u0627\u0645 \u0634\u062f"),Object(u.a)(a,"cas","\u0627\u062d\u0631\u0627\u0632 \u0647\u0648\u06cc\u062a \u0645\u0631\u06a9\u0632\u06cc"),a),m=n(4),f=n(7),h=n(2),g=n(5),v=n(3),p=n(6),b=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).logout=e.logout.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token")},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"logout",value:function(){this.setState({token:null}),window.localStorage.removeItem("token"),window.location.reload()}},{key:"logged_in",value:function(e){return e?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.user_settings),r.a.createElement(c.t,null,r.a.createElement(c.v,{view:"#main-view",panelClose:!0,onClick:this.logout},r.a.createElement("i",{className:"va ml-5 fa fa-power-off"}),r.a.createElement("span",null,d.logout))),r.a.createElement(c.g,null," ",r.a.createElement("i",{className:"va ml-5 fa fa-users"}),d.social),r.a.createElement(c.t,null,r.a.createElement(c.v,{link:"/posts/",ignoreCache:!1,reloadCurrent:!1,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-pencil"}),r.a.createElement("span",null,d.posts)),r.a.createElement(c.v,{link:"/channels/",ignoreCache:!1,reloadCurrent:!1,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-bullhorn"}),r.a.createElement("span",null,d.channels)),r.a.createElement(c.v,{link:"/profiles/",ignoreCache:!1,reloadCurrent:!1,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-user-circle-o"}),r.a.createElement("span",null,d.profiles)),r.a.createElement(c.v,{link:"/notifications/",ignoreCache:!1,reloadCurrent:!1,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-circle-o-notch"}),r.a.createElement("span",null,d.notifications)),r.a.createElement(c.v,{link:"/rooms/",ignoreCache:!1,reloadCurrent:!1,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-address-card-o"}),r.a.createElement("span",null,d.rooms))),r.a.createElement(c.g,null," ",r.a.createElement("i",{className:"va ml-5 fa fa-cogs"}),d.settings),r.a.createElement(c.t,null,r.a.createElement(c.v,{link:"/settings/",ignoreCache:!0,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-cog"}),r.a.createElement("span",null,d.global_settings)),r.a.createElement(c.v,{link:"/roles/",ignoreCache:!0,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-shield"}),r.a.createElement("span",null,d.roles)),r.a.createElement(c.v,{link:"/metas/",ignoreCache:!0,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-th"}),r.a.createElement("span",null,d.metas)),r.a.createElement(c.v,{link:"/privacy_settings/",ignoreCache:!0,view:"#main-view",panelClose:!0},r.a.createElement("i",{className:"va ml-5 fa fa-vcard"}),r.a.createElement("span",null,d.privacy_settings)))):r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.user_settings),r.a.createElement(c.t,null,r.a.createElement(c.v,{link:"/login/",title:d.login,view:"#main-view",panelClose:!0})))}},{key:"render",value:function(){var e=this.state.token;return r.a.createElement(c.y,null,r.a.createElement(c.x,null,r.a.createElement("span",{className:"jc-center white"},r.a.createElement("i",{className:"va ml-5 fa fa-umbrella"}),d.Shoa)),this.logged_in(e))}}]),t}(i.Component),y=n(118),k=new(n(119).Dispatcher),E=new(function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).list=[],e.instance=null,e.klass=null,e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"listModel",value:function(e){this.list=[],this.klass=e.klass;for(var t=0,n=e.data.length;t<n;++t)this.list.push(e.data[t]),t===n-1&&this.emit("got_list");0==e.data.length&&this.emit("got_list")}},{key:"showIntance",value:function(e){this.klass=e.klass,this.instance=e.data,this.emit("got_instance")}},{key:"setIntance",value:function(e){this.klass=e.klass,this.instance=e.data,this.emit("set_instance")}},{key:"deleteIntance",value:function(e){this.klass=e.klass,this.instance=e.data,this.emit("deleted_instance")}},{key:"postFile",value:function(e){console.log(e),this.klass=e.klass,this.instance=e.data,this.emit("file_posted")}},{key:"getIntance",value:function(){return this.instance}},{key:"getList",value:function(){return this.list}},{key:"getListnKlass",value:function(){return[this.list,this.klass]}},{key:"getKlass",value:function(){return this.klass}},{key:"handleActions",value:function(e){switch(e.type){case"LIST_MODEL_SUCCESS":this.listModel(e.list);break;case"GET_INSTANCE_SUCCESS":this.showIntance(e.instance);break;case"DELETE_INSTANCE_SUCCESS":this.deleteIntance(e.instance);break;case"SET_INSTANCE_SUCCESS":this.setIntance(e.instance);break;case"POST_FILE_SUCCESS":this.postFile(e.instance)}}}]),t}(y.EventEmitter));k.register(E.handleActions.bind(E));var w=E,S=n(40),C=n.n(S),O={server:"/v1",janusServer:"https://kaarafarinan.ir:8089/janus"},j=O.server;function I(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},a=arguments.length>3?arguments[3]:void 0,i=Object.keys(n).map((function(e){return e+"="+n[e]})).join("&");C.a.get(j+"/"+e+"?page="+t+"&"+i,{headers:{"Content-Type":"application/json",Authorization:"bearer "+a}}).then((function(e){k.dispatch({type:"LIST_MODEL_SUCCESS",list:e.data})})).catch((function(e){console.log(e)}))}function _(e,t,n,a){var i=j+"/"+e+"/"+t,r=new FormData;r.append("profile[avatar]",n),r.append("profile[id]",t);var o={headers:{"content-type":"multipart/form-data",Authorization:"bearer "+a}};Object(S.put)(i,r,o).then((function(e){k.dispatch({type:"POST_FILE_SUCCESS",instance:e.data})})).catch((function(e){console.log(e)}))}function T(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:1;C.a.get(j+"/"+e+"/"+t+"?page="+a,{headers:{"Content-Type":"application/json",Authorization:"bearer "+n}}).then((function(e){k.dispatch({type:"GET_INSTANCE_SUCCESS",instance:e.data})})).catch((function(e){console.log(e)}))}function A(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=arguments.length>2?arguments[2]:void 0,a=Object.keys(t).map((function(e){return e+"="+t[e]})).join("&");C.a.get(j+"/"+e+"/delete?"+a,{headers:{"Content-Type":"application/json",Authorization:"bearer "+n}}).then((function(e){k.dispatch({type:"DELETE_INSTANCE_SUCCESS",instance:e.data})})).catch((function(e){console.log(e)}))}function D(e,t,n){C.a.post(j+"/"+e+"/",t,{headers:{"Content-Type":"application/json",Authorization:"bearer "+n}}).then((function(e){k.dispatch({type:"SET_INSTANCE_SUCCESS",instance:e.data})})).catch((function(e){console.log(e)}))}function L(e,t,n){C.a.put(j+"/"+e+"/"+t.id,t,{headers:{"Content-Type":"application/json",Authorization:"bearer "+n}}).then((function(e){k.dispatch({type:"SET_INSTANCE_SUCCESS",instance:e.data})})).catch((function(e){console.log(e)}))}var x=function(e){var t=[r.a.createElement("option",{value:""})];if(e.content)for(var n=0;n<e.content.length;n++)t.push(r.a.createElement("option",{value:e.content[n].content[0].fid},e.content[n].content[0].value));return t},V=function(e){if(e.meta&&e.meta.meta_schema){for(var t=e.meta.meta_schema,n=[],a=function(a){switch(t[a].type){case"String":n.push(r.a.createElement(c.u,{label:t[a].label,type:"text",placeholder:"...",onInput:function(n){return e.onChangeValue(t[a].fid,n.target.value,e.meta.id)}}));break;case"Text":n.push(r.a.createElement(c.u,{label:t[a].name,type:"textarea",placeholder:"...",onInput:function(n){return e.onChangeValue(t[a].fid,n.target.value,e.meta.id)}}));break;case"Table":t[a].content&&n.push(r.a.createElement(c.v,{title:t[a].content.title,smartSelect:!0,smartSelectParams:{pageBackLinkText:d.back}},r.a.createElement("select",{name:"content",onChange:function(n){return e.onChangeValue(t[a].fid,n.target.value,e.meta.id)}},r.a.createElement(x,{content:t[a].content}))))}},i=0;i<t.length;i++)a(i);var o=null;return e.submit&&(o=r.a.createElement(c.k,null,r.a.createElement(c.s,null),r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit))),r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.form," ",e.meta.label),r.a.createElement(c.t,{form:!0},n,o))}return r.a.createElement("div",null)},N=n(10),M=n.n(N),R=function(e){var t=e.meta.meta_schema;if(e.meta&&e.actuals){for(var n=[r.a.createElement(c.g,null,e.meta.label)],a=[],i=e.actuals,o=function(o){l=i[o].content,a=[];for(var s=0;s<l.length;s++)a.push(r.a.createElement(c.u,{key:M.a.lib.WordArray.random(32),label:l[s].label,type:"text",defaultValue:l[s].value})),e.editable&&l[s]&&s==t.length-1&&e.meta.id==l[s].metaId&&a.push(r.a.createElement(c.h,{color:"gray",onClick:function(){return e.removeActual(i[o].uuid)}},r.a.createElement(c.r,{ios:"f7:trash",aurora:"f7:trash",md:"material:trash"})));n.push(r.a.createElement(c.i,null,r.a.createElement(c.t,{key:M.a.lib.WordArray.random(32)},a)))},s=0;s<i.length;s++){var l;o(s)}return r.a.createElement(r.a.Fragment,null,n)}return r.a.createElement("div",null)},P=n(120),W=n.n(P),F=function(e){return e.meta?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.title,": ",e.meta.title),r.a.createElement(c.t,{"simple-list":!0},r.a.createElement(c.v,{className:""},r.a.createElement(W.a,{id:"json-pretty",data:JSON.stringify(e.meta.meta_schema)})))),r.a.createElement(R,{meta:e.meta,editable:!0,actuals:e.meta.actuals,removeActual:e.removeActual}),r.a.createElement(V,{meta:e.meta,submit:e.submit,onChangeValue:e.handleChangeValue})):null},U=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.submit=e.submit.bind(Object(v.a)(e)),e.removeActual=e.removeActual.bind(Object(v.a)(e)),e.state={meta:null,metaId:null,token:window.localStorage.getItem("token"),fields:[]},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.getInstance),w.on("deleted_instance",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.getInstance),w.removeListener("deleted_instance",this.getInstance)}},{key:"componentDidMount",value:function(){T("metas",this.$f7route.params.metaId)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Meta"===t&&this.setState({meta:e,metaId:e.id})}},{key:"handleChangeValue",value:function(e,t){var n=this.state.fields;if(n.length>0)for(var a=0;a<n.length;a++)if(n[a].fid&&n[a].fid===e){var i=Object.assign({},this.state);i.fields[a]={fid:e,value:t},this.setState(i)}else this.setState({fields:this.state.fields.concat({fid:e,value:t})});else this.setState({fields:this.state.fields.concat({fid:e,value:t})})}},{key:"removeActual",value:function(e){A("actuals",{uuid:e})}},{key:"submit",value:function(){D("actuals",{meta_id:this.state.metaId,content:this.state.fields},this.state.token)}},{key:"fab",value:function(){if(this.state.meta)return r.a.createElement(c.o,{href:"/metas/"+this.state.meta.id+"/edit",target:"#main-view",position:"left-bottom",slot:"fixed",color:"lime"},r.a.createElement(c.r,{ios:"f7:edit",aurora:"f7:edit",md:"material:edit"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"}))}},{key:"render",value:function(){var e=this.state.meta;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.metas,backLink:d.back}),r.a.createElement(c.g,null),this.fab(),r.a.createElement(F,{meta:e,removeActual:this.removeActual,handleChangeValue:this.handleChangeValue,submit:this.submit}))}}]),t}(i.Component),B=function(e){return e.metas?r.a.createElement(c.t,{mediaList:!0},e.metas.map((function(e){return r.a.createElement(c.v,{key:M.a.lib.WordArray.random(32),link:"/metas/"+e.id,ignoreCache:!0,title:e.title,after:"",subtitle:"",text:""})}))):r.a.createElement("ul",null)},q=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.metas,backLink:d.back}),r.a.createElement(c.g,null,d.list),r.a.createElement(c.o,{href:"/metas/new",target:"#main-view",position:"left-bottom",slot:"fixed",color:"deeporange"},r.a.createElement(c.r,{ios:"f7:add",aurora:"f7:add",md:"material:add"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"})),r.a.createElement(B,{metas:e.metas}))},$=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.state={metas:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),I("metas",this.state.page)}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Meta"===t&&this.setState({metas:e})}},{key:"render",value:function(){var e=this.state.metas;return r.a.createElement(q,{metas:e})}}]),t}(r.a.Component),G=function(e){return r.a.createElement(c.i,null,r.a.createElement(c.t,{form:!0},r.a.createElement(c.u,{label:d.title,type:"text",placeholder:"...",defaultValue:e.meta.title,onInput:function(t){e.handleChange({title:t.target.value})}}),r.a.createElement(c.u,{label:d.label,type:"text",placeholder:"...",defaultValue:e.meta.label,onInput:function(t){e.handleChange({label:t.target.value})}}),r.a.createElement(c.u,{label:"Schema",type:"text",inputStyle:{direction:"ltr"},defaultValue:JSON.stringify(e.meta.meta_schema),placeholder:"JSON",onInput:function(t){e.handleChange({metaSchema:t.target.value})}})),r.a.createElement(c.k,null,r.a.createElement(c.s,null),r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit)))},J=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),meta:{},metaSchema:null,title:null,label:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance)}},{key:"submit",value:function(){D("metas",{title:this.state.title,label:this.state.label,meta_schema:this.state.metaSchema},this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"setInstance",value:function(){this.$f7router.navigate("/metas/")}},{key:"render",value:function(){var e=this.state.meta;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.meta_form,backLink:d.back}),r.a.createElement(c.g,null,d.meta_form),r.a.createElement(G,{meta:e,submit:this.submit,editing:!0,handleChange:this.handleChangeValue}))}}]),t}(i.Component),K=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.getInstance=e.getInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.state={meta:{},title:null,metaSchema:null,id:null,label:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.setInstance)}},{key:"submit",value:function(){L("metas",{id:this.state.id,title:this.state.title,label:this.state.label,meta_schema:this.state.metaSchema})}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),this.$f7route.params.metaId&&T("metas",this.$f7route.params.metaId)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();console.log(e),e&&"Meta"===t&&this.setState({title:e.title,id:e.id,meta:e,metaSchema:e.metaSchema,label:e.label})}},{key:"handleChangeValue",value:function(e){console.log(e),this.setState(e)}},{key:"setInstance",value:function(){this.$f7router.navigate("/metas/")}},{key:"render",value:function(){var e=this.state.meta;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.meta_form,backLink:d.back}),r.a.createElement(c.g,null,d.meta_form),r.a.createElement(G,{meta:e,submit:this.submit,editing:!0,handleChange:this.handleChangeValue}))}}]),t}(i.Component),z=(n(280),n(16)),H=n(39),X=function(e){return e.model?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.a,{id:"actions-two-groups-"+e.model.id},r.a.createElement(c.c,null,r.a.createElement(c.d,null,d.social_acts),r.a.createElement(c.b,{onClick:function(){return e.interaction("Bookmark",e.model.id,e.klass,e.sourceType,e.sourceId)}},r.a.createElement("i",{className:"va ml-5 fa fa-bookmark"}),d.bookmark," (",e.model.bookmarks,")"),r.a.createElement(c.b,{onClick:function(){return e.interaction("Like",e.model.id,e.klass,e.sourceType,e.sourceId)}},r.a.createElement("i",{className:"va ml-5 fa fa-heart"}),d.like," (",e.model.likes,")"),r.a.createElement(c.b,{onClick:e.model.followed?"":function(){return e.interaction("Follow",e.model.id,e.klass,e.sourceType,e.sourceId)}},r.a.createElement("i",{className:"va ml-5 fa fa-link"}),d.follow," (",e.model.follows,")")),r.a.createElement(c.c,null,r.a.createElement(c.b,{color:"red"},d.cancel))),r.a.createElement(c.h,{className:"col",href:!1,actionsOpen:"#actions-two-groups-"+e.model.id},r.a.createElement("i",{className:"va fa fa-users"}))):null},Y=function(e){if(e.model){if(e.channels)for(var t=[],n=0;n<e.channels.length;n++)t.push(r.a.createElement("option",{value:e.channels[n].id},e.channels[n].title));return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.D,{className:"demo-sheet",opened:e.sheetOpened,onSheetClosed:function(){e.handleChange({sheetOpened:!1})}},r.a.createElement(c.I,null,r.a.createElement("div",{className:"left"}),r.a.createElement("div",{className:"right"},r.a.createElement(c.s,{sheetClose:!0},d.close))),r.a.createElement(c.z,null,r.a.createElement(c.t,null,r.a.createElement(c.u,{label:d.channel,type:"select",onChange:function(t){e.handleChange({selectedChannel:t.target.value})}},t)),r.a.createElement(c.f,{strong:!0},r.a.createElement(c.B,{tag:"p"},r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit))))),r.a.createElement(c.h,{className:"col",href:!1,sheetOpen:".demo-sheet"},r.a.createElement("i",{class:"va fa fa-retweet"})))}return null},Q=function(e){return r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.comment_form),r.a.createElement(c.t,{form:!0},r.a.createElement(c.u,{label:d.comment,type:"textarea",placeholder:"...",maxlength:"300",resizable:!0,clearButton:!0,onInput:function(t){e.handleChange({commentContent:t.target.value})}})),r.a.createElement(c.k,null,r.a.createElement(c.s,null),r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit)))},Z=n(30),ee=n.n(Z),te=(n(37),n(38),function(e){var t=[];if(e.comments){for(var n=function(n){i=r.a.createElement(r.a.Fragment,null,r.a.createElement(c.s,{onClick:function(){return e.removeComment(e.comments[n].id)}},r.a.createElement("i",{className:"va ml-5 fa fa-trash"})),r.a.createElement(ee.a,{locale:"fa",fromNow:!0,ago:!0},e.comments[n].created_at),d.ago),t.push(r.a.createElement(c.v,{className:"some-link",text:i,subtitle:e.comments[n].content},r.a.createElement("img",{slot:"media",src:e.comments[n].profile.avatar,width:"44"})))},a=0;a<e.comments.length;a++){var i;n(a)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.comments),r.a.createElement(c.t,{mediaList:!0,inset:!0},t),r.a.createElement(c.B,{noGap:!0},r.a.createElement(c.n,null),r.a.createElement(c.n,{className:"center"},r.a.createElement("a",{className:"gray-color",onClick:function(){return e.loadMore()}},d.more)),r.a.createElement(c.n,null)))}return null}),ne=function(e){if(e.post&&e.post.draft){var t,n=Object(z.convertFromRaw)(e.post.draft),a=z.EditorState.createWithContent(n);return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.f,null,r.a.createElement(c.B,null,r.a.createElement(c.n,{width:"50",tabletWidth:"70"}),r.a.createElement(c.n,{width:"25",tabletWidth:"15",className:"ml-5"},r.a.createElement(c.h,{fill:!0},r.a.createElement(Y,(t={model:e.post,submit:e.submit,channels:e.channels,klass:"Post",sheetOpened:e.sheetOpened,handleChange:e.handleChange},Object(u.a)(t,"klass","Channel"),Object(u.a)(t,"interaction",e.interaction),t)))),r.a.createElement(c.n,{width:"25",tabletWidth:"15"},r.a.createElement(c.h,{fill:!0},r.a.createElement(X,{model:e.post,klass:"Post",interaction:e.interaction}))))),r.a.createElement(c.g,null,d.title),r.a.createElement(c.t,{"simple-list":!0},r.a.createElement(c.v,null,e.post.title)),r.a.createElement(c.g,null,d.content),r.a.createElement(H.Editor,{editorState:a,toolbar:{options:[]},readOnly:!0}),r.a.createElement(Q,{post:e.post,submit:e.submitComment,handleChange:e.handleChange}),r.a.createElement(te,{comments:e.comments,removeComment:e.removeComment,loadMore:e.loadMore}))}return null},ae=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.interaction=e.interaction.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.submit=e.submit.bind(Object(v.a)(e)),e.submitComment=e.submitComment.bind(Object(v.a)(e)),e.removeComment=e.removeComment.bind(Object(v.a)(e)),e.loadMore=e.loadMore.bind(Object(v.a)(e)),e.state={post:null,id:null,page:1,channels:null,selectedChannel:null,channelId:null,sheetOpened:!1,commentContent:"",comments:null,token:window.localStorage.getItem("token")},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.setInstance),w.on("got_list",this.getList),w.on("deleted_instance",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.setInstance),w.removeListener("got_list",this.getList),w.removeListener("deleted_instance",this.getInstance)}},{key:"componentDidMount",value:function(){this.$$(".some-link").on("taphold",(function(e){e.dialog.alert("Tap hold fired!")})),T("posts",this.$f7route.params.postId,this.state.token),I("channels/my",this.state.page,{},this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Post"===t&&this.setState({post:e,id:e.id,comments:e.comments})}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Channel"===t&&this.setState({channels:e,channelId:e[0].id}),console.log(e)}},{key:"setInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Post"===t&&this.setState({post:e,comments:e.comments,page:1})}},{key:"loadMore",value:function(){var e=this;this.setState({page:this.state.page+1},(function(){T("posts",e.$f7route.params.postId,e.state.token,e.state.page)}))}},{key:"fab",value:function(){if(this.state.post)return r.a.createElement(c.o,{href:"/posts/"+this.state.post.id+"/edit",target:"#main-view",position:"left-bottom",slot:"fixed",color:"lime"},r.a.createElement(c.r,{ios:"f7:edit",aurora:"f7:edit",md:"material:edit"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"}))}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"interaction",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r={interaction_type:e,interactionable_id:t,interactionable_type:n,source_type:a,source_id:i};D("interactions",r,this.state.token)}},{key:"submit",value:function(){D("shares",{post_id:this.state.id,channel_id:this.state.selectedChannel},this.state.token);this.$f7.sheet.close(".demo-sheet")}},{key:"submitComment",value:function(){D("comments",{post_id:this.state.id,content:this.state.commentContent},this.state.token)}},{key:"removeComment",value:function(e){A("comments",{id:e},this.state.token,this.state.page)}},{key:"render",value:function(){var e=this.state,t=e.post,n=(e.sheetOpened,e.channels),a=e.comments;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.posts,backLink:d.back}),r.a.createElement(c.g,null),this.fab(),r.a.createElement(ne,{post:t,comments:a,channels:n,submitComment:this.submitComment,removeComment:this.removeComment,submit:this.submit,interaction:this.interaction,handleChange:this.handleChangeValue,loadMore:this.loadMore}))}}]),t}(i.Component),ie=function(e){return e.posts&&e.posts.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.B,{noGap:!0},e.posts.map((function(t){return r.a.createElement(c.n,{width:"100",tabletWidth:"33",key:M.a.lib.WordArray.random(16)},r.a.createElement(c.i,{className:"demo-facebook-card"},r.a.createElement(c.l,{className:"no-border"},r.a.createElement("div",{className:"demo-facebook-avatar"},r.a.createElement(c.s,{tooltip:t.profile.fullname,href:"/profiles/"+t.profile.id},r.a.createElement("img",{src:t.profile.avatar,height:"34"}))),r.a.createElement("div",{className:"demo-facebook-name "},r.a.createElement("div",{className:"demo-facebook-profile "},r.a.createElement(c.s,{className:"gray-color",href:"/profiles/"+t.profile.id},t.profile.fullname.substring(0,40))),r.a.createElement(c.s,{tooltip:d.view,className:"gray-color",href:"/posts/"+t.id},t.title.substring(0,15)+"..")),r.a.createElement("div",{className:"demo-facebook-date"},r.a.createElement(X,{model:t,klass:"Post",interaction:e.interaction,sourceType:e.sourceType,sourceId:e.sourceId}))),r.a.createElement(c.j,{className:"lightgray-color fs-12"},t.content.substring(0,150)+"...",r.a.createElement("div",{className:"demo-facebook-more"},r.a.createElement(c.s,{className:"gray-color",href:"/posts/"+t.id},d.view,r.a.createElement("i",{className:"va fa fa-arrow-left mr-2"}))))))}))),r.a.createElement(c.B,{noGap:!0},r.a.createElement(c.n,null),r.a.createElement(c.n,{className:"center mb-20"},r.a.createElement("a",{className:"gray-color",onClick:function(){return e.loadMore()}},d.more)),r.a.createElement(c.n,null))):r.a.createElement("ul",null)},re=function(e){return r.a.createElement(c.y,{pageContent:!1},r.a.createElement(c.x,{title:d.posts},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"})),r.a.createElement(c.F,{inner:!1},r.a.createElement(c.C,{disableButtonText:d.cancel,placeholder:d.search,onChange:function(t){e.search({query:t.target.value})}}))),r.a.createElement(c.I,{tabbar:!0,bottom:!0},r.a.createElement(c.s,{tabLink:"#tab-1",tabLinkActive:!0},r.a.createElement("i",{className:"va ml-5 fa fa-link"})),r.a.createElement(c.s,{tabLink:"#tab-2"},r.a.createElement("i",{className:"va ml-5 fa fa-plug"})),r.a.createElement(c.s,{tabLink:"#tab-3"},r.a.createElement("i",{className:"va ml-5 fa fa-user-o"}))),r.a.createElement(c.g,null),r.a.createElement(c.o,{href:"/posts/new",target:"#main-view",position:"left-bottom",slot:"fixed",color:"deeporange"},r.a.createElement(c.r,{ios:"f7:add",aurora:"f7:add",md:"material:add"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"})),r.a.createElement(c.H,{swipeable:!0},r.a.createElement(c.G,{id:"tab-1",className:"page-content",tabActive:!0},r.a.createElement(c.f,null,r.a.createElement(ie,{posts:e.posts,interaction:e.interaction,loadMore:e.loadMore}))),r.a.createElement(c.G,{id:"tab-2",className:"page-content"},r.a.createElement(c.f,null,r.a.createElement(ie,{posts:e.posts,interaction:e.interaction,loadMore:e.loadMore}))),r.a.createElement(c.G,{id:"tab-3",className:"page-content"},r.a.createElement(c.f,null,r.a.createElement(ie,{posts:e.posts,interaction:e.interaction,loadMore:e.loadMore})))))};function oe(){if(console.log(">>>>>>>>>>>>>>>>>>>>>"),window.localStorage.getItem("token"))return!0;this.$f7router.navigate("/login/")}var se=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.loggedIn=oe.bind(Object(v.a)(e)),e.interaction=e.interaction.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.search=e.search.bind(Object(v.a)(e)),e.loadMore=e.loadMore.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),posts:[],query:null,page:1},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList),w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList),w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){this.loggedIn(),this.loadData()}},{key:"loadData",value:function(){I("posts",this.state.page,{},this.state.token)}},{key:"search",value:function(e){var t=this;this.setState({posts:[],page:1}),this.setState(e,(function(){I("posts/search",t.state.page,{q:t.state.query})}))}},{key:"setInstance",value:function(){var e=w.getIntance();e&&this.setState({posts:this.state.posts.map((function(t){return t.id===e.id?Object.assign({},t,e):t}))})}},{key:"loadMore",value:function(){var e=this;this.state.query&&this.state.query.length>0?this.setState({page:this.state.page+1},(function(){I("posts/search",e.state.page,{q:e.state.query},e.state.token)})):this.setState({page:this.state.page+1},(function(){I("posts",e.state.page,{},e.state.token)}))}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e.length>0&&"Post"===t&&this.setState({posts:this.state.posts.concat(e)})}},{key:"interaction",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r={interaction_type:e,interactionable_id:t,interactionable_type:n,source_type:a,source_id:i};D("interactions",r,this.state.token)}},{key:"render",value:function(){var e=this.state.posts;return r.a.createElement(re,{interaction:this.interaction,loadMore:this.loadMore,posts:e,search:this.search})}}]),t}(r.a.Component),le=function(e){var t=[r.a.createElement("option",{value:""})];if(e.content)for(var n=0;n<e.content.length;n++)t.push(r.a.createElement("option",{value:e.content[n].id},e.content[n].title));return t},ce=n(72),ue=n.n(ce),de=function(e){if(e.post){var t=null;return e.channels&&(t=r.a.createElement(c.v,{title:d.channel,smartSelect:!0,smartSelectParams:{pageBackLinkText:d.back,searchbar:!0,searchbarPlaceholder:d.search}},r.a.createElement("select",{name:"content",defaultValue:e.channelId,onChange:function(t){e.handleChange({channelId:t.target.value})}},r.a.createElement(le,{content:e.channels})))),r.a.createElement(r.a.Fragment,null,r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.new_post),r.a.createElement(c.t,{form:!0},t,r.a.createElement(c.u,{label:d.title+"*",type:"text",placeholder:"...",maxlength:"65",value:e.post.title,onInput:function(t){e.handleChange({title:t.target.value})}}),r.a.createElement(H.Editor,{editorState:e.editorState,placeholder:d.content,localization:{locale:"fa",translations:ue.a},toolbar:{options:["inline","list","link","image"],inline:{options:["bold","italic","underline"]},image:{uploadCallback:e.uploadImageCallBack,previewImage:!0}},onEditorStateChange:e.onEditorStateChange})),r.a.createElement(c.k,null,r.a.createElement(c.s,null),r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit))))}return null};function me(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("POST","http://localhost:3001/v1/uploads"),a.setRequestHeader("Authorization","Client-ID 8d26ccd12712fca");var i=new FormData;i.append("upload[image]",e),a.send(i),a.addEventListener("load",(function(){var e=JSON.parse(a.responseText);t(e)})),a.addEventListener("error",(function(){var e=JSON.parse(a.responseText);n(e)}))}))}var fe=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.onEditorStateChange=e.onEditorStateChange.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.uploadImageCallBack=me.bind(Object(v.a)(e)),e.state={post:{},channels:null,editorState:z.EditorState.createEmpty(),token:window.localStorage.getItem("token"),title:null,channelId:null,interaction:null,page:0},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance),w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance),w.removeListener("got_list",this.getList)}},{key:"submit",value:function(){var e=Object(z.convertToRaw)(this.state.editorState.getCurrentContent()).blocks.map((function(e){return e.text.trim()?e.text:"\n"})).join("\n"),t={title:this.state.title,content:e,channel_id:this.state.channelId,draft:Object(z.convertToRaw)(this.state.editorState.getCurrentContent())};if(this.state.title)D("posts",t,this.state.token);else{this.$f7.dialog.alert(d.incomplete_data,d.alert)}}},{key:"onEditorStateChange",value:function(e){this.setState({editorState:e})}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){I("channels/my",this.state.page,{},this.state.token)}},{key:"componentDidUpdate",value:function(e,t){}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Channel"===t&&this.setState({channels:e})}},{key:"setInstance",value:function(){this.$f7router.navigate("/posts/")}},{key:"render",value:function(){var e=this.state,t=e.post,n=e.editorState,a=e.channels;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.post_form}),r.a.createElement(de,{post:t,channels:a,editorState:n,onEditorStateChange:this.onEditorStateChange,submit:this.submit,handleChange:this.handleChangeValue,uploadImageCallBack:this.uploadImageCallBack}))}}]),t}(i.Component),he=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.getInstance=e.getInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.onEditorStateChange=e.onEditorStateChange.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.uploadImageCallBack=me.bind(Object(v.a)(e)),e.state={post:{title:"",draft:""},editorState:z.EditorState.createEmpty(),token:window.localStorage.getItem("token"),id:null,title:null,draft:null,page:0},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.setInstance),w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.setInstance),w.removeListener("got_list",this.getList)}},{key:"submit",value:function(){L("posts",{id:this.state.id,title:this.state.title,draft:Object(z.convertToRaw)(this.state.editorState.getCurrentContent())},this.state.token)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),this.$f7route.params.postId&&T("posts",this.$f7route.params.postId,this.state.token)}},{key:"getList",value:function(){}},{key:"getInstance",value:function(){var e=w.getIntance();if(e){var t=Object(z.convertFromRaw)(e.draft),n=z.EditorState.createWithContent(t);this.setState({post:e,title:e.title,id:e.id,editorState:n})}console.log(e)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"onEditorStateChange",value:function(e){this.setState({editorState:e})}},{key:"setInstance",value:function(){this.$f7router.navigate("/posts/")}},{key:"render",value:function(){var e=this.state,t=e.post,n=e.editorState;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:"Form",backLink:d.back}),r.a.createElement(c.g,null,d.workflow_form),r.a.createElement(de,{post:t,editorState:n,onEditorStateChange:this.onEditorStateChange,submit:this.submit,handleChange:this.handleChangeValue,uploadImageCallBack:this.uploadImageCallBack}))}}]),t}(i.Component),ge=function(e){if(e.notifications&&e.notifications.length>0){var t=function(e){if(!e.seen)return"bg-blonde"};return r.a.createElement(c.t,{mediaList:!0},e.notifications.map((function(e){return r.a.createElement(c.v,{className:t(e),key:M.a.lib.WordArray.random(32),link:"/"+e.target_type+"/"+e.target_id,title:e.content,subtitle:(n=e.profile,r.a.createElement(c.s,{href:"/profiles/"},n.fullname))},r.a.createElement("img",{slot:"media",src:e.profile.avatar,width:"44"}));var n})))}return r.a.createElement("ul",null)},ve=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.notifications},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),r.a.createElement(ge,{notifications:e.notifications,loadMore:e.loadMore}))},pe=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.loggedIn=oe.bind(Object(v.a)(e)),e.interaction=e.interaction.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.search=e.search.bind(Object(v.a)(e)),e.loadMore=e.loadMore.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),notifications:[],query:null,page:1},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList),w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList),w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){this.loggedIn(),this.loadData()}},{key:"loadData",value:function(){I("notifications",this.state.page,{},this.state.token)}},{key:"search",value:function(e){var t=this;this.setState({notifications:[],page:1}),this.setState(e,(function(){I("notifications/search",t.state.page,{q:t.state.query})}))}},{key:"loadMore",value:function(){var e=this;this.state.query&&this.state.query.length>0?this.setState({page:this.state.page+1},(function(){I("notifications/search",e.state.page,{q:e.state.query},e.state.token)})):this.setState({page:this.state.page+1},(function(){I("notifications",e.state.page,{},e.state.token)}))}},{key:"setInstance",value:function(){var e=w.getIntance();e&&this.setState({notifications:this.state.notifications.map((function(t){return t.id===e.id?Object.assign({},t,e):t}))})}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e.length>0&&"Notification"===t&&this.setState({notifications:this.state.notifications.concat(e)});D("notifications",{},this.state.token)}},{key:"interaction",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r={interaction_type:e,interactionable_id:t,interactionable_type:n,source_type:a,source_id:i};D("interactions",r,this.state.token)}},{key:"render",value:function(){var e=this.state.notifications;return r.a.createElement(ve,{interaction:this.interaction,loadMore:this.loadMore,notifications:e,search:this.search})}}]),t}(r.a.Component),be=function(e){return e.channel?(console.log(e.channel.posts),r.a.createElement(r.a.Fragment,null,r.a.createElement(c.f,null,r.a.createElement(c.B,{noGap:!0},r.a.createElement(c.n,{width:"80"}),r.a.createElement(c.n,{width:"20"},r.a.createElement(c.h,null,r.a.createElement(X,{model:e.channel,klass:"Channel",interaction:e.interaction,sourceType:"Channel",sourceId:e.channel.id}))))),r.a.createElement(c.B,{noGap:!0},r.a.createElement(c.n,{width:"100",tabletWidth:"50"},r.a.createElement(c.i,null,r.a.createElement(c.l,{className:"fs-12"},e.channel.title),r.a.createElement(c.j,{className:"lightgray-color fs-12"},e.channel.content))),r.a.createElement(c.n,{width:"100",tabletWidth:"50"},r.a.createElement(c.i,null,r.a.createElement(c.l,{className:"fs-12"},d.admins),r.a.createElement(c.j,null,r.a.createElement(c.s,{tooltip:e.channel.profile.fullname,href:"/profiles/"+e.channel.profile.id},r.a.createElement("div",{className:"demo-facebook-avatar"},r.a.createElement("img",{src:e.channel.profile.avatar,width:"34",height:"34"}))))))),r.a.createElement(c.g,null,d.recent_posts),r.a.createElement(ie,{posts:e.channel.posts,interaction:e.interaction,sourceType:"Channel",sourceId:e.channel.id}))):null},ye=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.interaction=e.interaction.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.state={channel:null,sheetOpened:!1,token:window.localStorage.getItem("token")},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){T("channels",this.$f7route.params.channelId,this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Channel"===t&&this.setState({channel:e}),console.log("channel",e)}},{key:"setInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Channel"===t&&this.setState({channel:e}),console.log(e)}},{key:"fab",value:function(){if(this.state.channel)return r.a.createElement(c.o,{href:"/channels/"+this.state.channel.id+"/edit",target:"#main-view",position:"left-bottom",slot:"fixed",color:"lime"},r.a.createElement(c.r,{ios:"f7:edit",aurora:"f7:edit",md:"material:edit"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"}))}},{key:"interaction",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r={interaction_type:e,interactionable_id:t,interactionable_type:n,source_type:a,source_id:i};D("interactions",r,this.state.token)}},{key:"render",value:function(){var e=this.state,t=e.channel,n=e.sheetOpened;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.channels,backLink:d.back},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),this.fab(),r.a.createElement(be,{channel:t,sheetOpened:n,interaction:this.interaction}))}}]),t}(i.Component),ke=function(e){return e.channels&&e.channels.length>0?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.B,{noGap:!0},e.channels.map((function(t){return r.a.createElement(c.n,{width:"100",tabletWidth:"33",key:M.a.lib.WordArray.random(16)},r.a.createElement(c.i,{className:"demo-facebook-card"},r.a.createElement(c.l,{className:"no-border"},r.a.createElement("div",{className:"demo-facebook-avatar"},r.a.createElement("img",{src:t.avatar,width:"34",height:"34"})),r.a.createElement("div",{className:"demo-facebook-title "},r.a.createElement(c.s,{className:"gray-color",href:"/channels/"+t.id},t.title.substring(0,30))),r.a.createElement("div",{className:"demo-facebook-date"},r.a.createElement(X,{model:t,klass:"Channel",interaction:e.interaction,sourceType:"Channel",sourceId:t.id}))),r.a.createElement(c.j,{className:"lightgray-color"},r.a.createElement("span",{className:"fs-12"},t.content.substring(0,120)+"..."),r.a.createElement("div",{className:"demo-facebook-more"},r.a.createElement(c.s,{className:"gray-color",href:"/channels/"+t.id},d.view,r.a.createElement("i",{className:"va fa fa-arrow-left mr-2"}))))))}))),r.a.createElement(c.B,{noGap:!0},r.a.createElement(c.n,null),r.a.createElement(c.n,{className:"center mb-20"},r.a.createElement("a",{className:"gray-color",onClick:function(){return e.loadMore()}},d.more)),r.a.createElement(c.n,null))):r.a.createElement("ul",null)},Ee=function(e){return r.a.createElement(c.y,{pageContent:!1},r.a.createElement(c.x,{title:d.channels},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"})),r.a.createElement(c.F,{inner:!1},r.a.createElement(c.C,{disableButtonText:d.cancel,placeholder:d.search,onChange:function(t){e.search({query:t.target.value})}}))),r.a.createElement(c.I,{tabbar:!0,bottom:!0},r.a.createElement(c.s,{tabLink:"#tab-1",tabLinkActive:!0},r.a.createElement("i",{className:"va ml-5 fa fa-link"})),r.a.createElement(c.s,{tabLink:"#tab-2"},r.a.createElement("i",{className:"va ml-5 fa fa-plug"})),r.a.createElement(c.s,{tabLink:"#tab-3"},r.a.createElement("i",{className:"va ml-5 fa fa-user-o"}))),r.a.createElement(c.g,null),r.a.createElement(c.o,{href:"/channels/new",target:"#main-view",position:"left-bottom",slot:"fixed",color:"deeporange"},r.a.createElement(c.r,{ios:"f7:add",aurora:"f7:add",md:"material:add"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"})),r.a.createElement(c.H,{swipeable:!0},r.a.createElement(c.G,{id:"tab-1",className:"page-content",tabActive:!0},r.a.createElement(c.f,null,r.a.createElement(ke,{channels:e.channels,interaction:e.interaction,loadMore:e.loadMore}))),r.a.createElement(c.G,{id:"tab-2",className:"page-content"},r.a.createElement(c.f,null,r.a.createElement(ke,{channels:e.channels,interaction:e.interaction,loadMore:e.loadMore}))),r.a.createElement(c.G,{id:"tab-3",className:"page-content"},r.a.createElement(c.f,null,r.a.createElement(ke,{channels:e.channels,interaction:e.interaction,loadMore:e.loadMore})))))},we=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.loggedIn=oe.bind(Object(v.a)(e)),e.interaction=e.interaction.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.search=e.search.bind(Object(v.a)(e)),e.loadMore=e.loadMore.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),channels:[],query:null,page:1},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList),w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList),w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){this.loggedIn(),this.loadData()}},{key:"loadData",value:function(){I("channels",this.state.page,{},this.state.token)}},{key:"search",value:function(e){var t=this;this.setState({channels:[],page:1}),this.setState(e,(function(){I("channels/search",t.state.page,{q:t.state.query})}))}},{key:"setInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Channel"===t&&this.setState({channels:this.state.channels.map((function(t){return t.id===e.id?Object.assign({},t,e):t}))})}},{key:"loadMore",value:function(){var e=this;this.state.query&&this.state.query.length>0?this.setState({page:this.state.page+1},(function(){I("channels/search",e.state.page,{q:e.state.query},e.state.token)})):this.setState({page:this.state.page+1},(function(){I("channels",e.state.page,{},e.state.token)}))}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e.length>0&&"Channel"===t&&this.setState({channels:this.state.channels.concat(e)})}},{key:"interaction",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r={interaction_type:e,interactionable_id:t,interactionable_type:n,source_type:a,source_id:i};D("interactions",r,this.state.token)}},{key:"render",value:function(){var e=this.state.channels;return r.a.createElement(Ee,{interaction:this.interaction,search:this.search,loadMore:this.loadMore,channels:e})}}]),t}(r.a.Component),Se=function(e){return e.channel?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.t,{form:!0},r.a.createElement(c.u,{label:d.title,type:"text",placeholder:"...",value:e.title,onInput:function(t){e.handleChange({title:t.target.value})}}),r.a.createElement(c.u,{label:d.abstract,type:"textarea",placeholder:"...",value:e.content,resizable:!0,onInput:function(t){e.handleChange({content:t.target.value})}})),r.a.createElement(c.f,{strong:!0,className:"minus-z"},r.a.createElement(c.B,{tag:"p"},r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit)))):null};function Ce(e){return new Promise((function(t,n){var a=new XMLHttpRequest;a.open("POST","http://localhost:3001/v1/uploads"),a.setRequestHeader("Authorization","Client-ID 8d26ccd12712fca");var i=new FormData;i.append("upload[image]",e),a.send(i),a.addEventListener("load",(function(){var e=JSON.parse(a.responseText);t(e)})),a.addEventListener("error",(function(){var e=JSON.parse(a.responseText);n(e)}))}))}var Oe=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.onEditorStateChange=e.onEditorStateChange.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.uploadImageCallBack=Ce.bind(Object(v.a)(e)),e.state={channel:{},editorState:z.EditorState.createEmpty(),token:window.localStorage.getItem("token"),title:null,content:null,interaction:null,page:0},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance),w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance),w.removeListener("got_list",this.getList)}},{key:"submit",value:function(){D("channels",{title:this.state.title,content:this.state.content},this.state.token)}},{key:"onEditorStateChange",value:function(e){this.setState({editorState:e})}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){}},{key:"getList",value:function(){}},{key:"setInstance",value:function(){this.$f7router.navigate("/channels/")}},{key:"render",value:function(){var e=this.state,t=e.channel,n=e.editorState;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.channel_form,backLink:d.back}),r.a.createElement(c.g,null,d.channel_form),r.a.createElement(Se,{channel:t,editorState:n,onEditorStateChange:this.onEditorStateChange,submit:this.submit,handleChange:this.handleChangeValue,uploadImageCallBack:this.uploadImageCallBack}))}}]),t}(i.Component),je=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.getInstance=e.getInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.onEditorStateChange=e.onEditorStateChange.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.state={channel:{title:"",draft:""},token:window.localStorage.getItem("token"),id:null,title:null,content:null,page:0},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.setInstance),w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.setInstance),w.removeListener("got_list",this.getList)}},{key:"submit",value:function(){L("channels",{id:this.state.id,title:this.state.title,content:this.state.content},this.state.token)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),this.$f7route.params.channelId&&T("channels",this.$f7route.params.channelId,this.state.token)}},{key:"getList",value:function(){}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Channel"===t&&this.setState({channel:e,title:e.title,id:e.id,content:e.content})}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"onEditorStateChange",value:function(e){this.setState({editorState:e})}},{key:"setInstance",value:function(){this.$f7router.navigate("/channels/")}},{key:"render",value:function(){var e=this.state,t=e.channel,n=e.title,a=e.content;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.form,backLink:d.back}),r.a.createElement(c.g,null,d.channel_form),r.a.createElement(Se,{channel:t,title:n,content:a,onEditorStateChange:this.onEditorStateChange,submit:this.submit,handleChange:this.handleChangeValue}))}}]),t}(i.Component),Ie=function(e){var t=[r.a.createElement("option",{value:""})];if(e.users)for(var n=0;n<e.users.length;n++)t.push(r.a.createElement("option",{value:e.users[n].id},e.users[n].email));return t},_e=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.assignment_form),r.a.createElement(c.t,{form:!0,inset:!0},r.a.createElement(c.v,{title:d.email,smartSelect:!0},r.a.createElement("select",{name:"content",onChange:function(t){e.handleChange({user_id:t.target.value})}},r.a.createElement(Ie,{users:e.users})))),r.a.createElement(c.f,{strong:!0,inset:!0},r.a.createElement(c.B,{tag:"p"},r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit))))},Te=function(e){var t=[];if(e.users){for(var n=function(n){[],t.push(r.a.createElement("tr",{key:M.a.lib.WordArray.random(32)},r.a.createElement("td",{key:M.a.lib.WordArray.random(32)},e.users[n].id),r.a.createElement("td",{key:M.a.lib.WordArray.random(32)},e.users[n].email),r.a.createElement("td",{className:"checkbox-cell",key:M.a.lib.WordArray.random(32)},r.a.createElement(c.h,{color:"gray",onClick:function(){return e.removeRole(e.users[n].id)}},r.a.createElement(c.r,{ios:"f7:trash",aurora:"f7:trash",md:"material:trash"})))))},a=0;a<e.users.length;a++){n(a)}return r.a.createElement("div",{className:"data-table card"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,"ID"),r.a.createElement("td",null,"Email"))),r.a.createElement("tbody",null,t)))}return null},Ae=function(e){return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.access_control_form),r.a.createElement(c.t,{form:!0,inset:!0},r.a.createElement(c.u,{label:d.item,type:"text",placeholder:"...",onInput:function(t){e.handleChange({abilityTitle:t.target.value})}}),r.a.createElement(c.u,{label:d.value,type:"select",defaultValue:!0,placeholder:"Please choose...",onChange:function(t){e.handleChange({abilityValue:t.target.value})}},r.a.createElement("option",{value:!0},d.true),r.a.createElement("option",{value:!1},d.false))),r.a.createElement(c.f,{strong:!0,inset:!0},r.a.createElement(c.B,{tag:"p"},r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.addAbility},d.submit))))},De=function(e){var t=[];if(e.ability){for(var n=function(n){[],t.push(r.a.createElement("tr",{key:M.a.lib.WordArray.random(32)},r.a.createElement("td",{key:M.a.lib.WordArray.random(32)},e.ability[n].title),r.a.createElement("td",{key:M.a.lib.WordArray.random(32)},d[e.ability[n].value]),r.a.createElement("td",{className:"checkbox-cell",key:M.a.lib.WordArray.random(32)},r.a.createElement(c.h,{color:"gray",onClick:function(){return e.removeAbility(e.ability[n].title)}},r.a.createElement(c.r,{ios:"f7:trash",aurora:"f7:trash",md:"material:trash"})))))},a=0;a<e.ability.length;a++){n(a)}return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.access_control_list),r.a.createElement("div",{className:"data-table card"},r.a.createElement("table",null,r.a.createElement("thead",null,r.a.createElement("tr",null,r.a.createElement("td",null,d.title),r.a.createElement("td",null,d.value))),r.a.createElement("tbody",null,t))))}return null},Le=function(e){return e.role?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.title),r.a.createElement(c.t,{"simple-list":!0},r.a.createElement(c.v,null,e.role.title)),r.a.createElement(De,{ability:e.ability,removeAbility:e.removeAbility}),r.a.createElement(Ae,{addAbility:e.addAbility,handleChange:e.handleChange}),r.a.createElement(Te,{users:e.assignedUsers,removeRole:e.removeRole}),r.a.createElement(_e,{users:e.users,submit:e.submit,handleChange:e.handleChange})):null},xe=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.submit=e.submit.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.removeRole=e.removeRole.bind(Object(v.a)(e)),e.addAbility=e.addAbility.bind(Object(v.a)(e)),e.removeAbility=e.removeAbility.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),role:null,id:null,users:null,assignedUsers:null,user_id:null,abilityTitle:"",abilityValue:!0,ability:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.getInstance),w.on("got_list",this.getList),w.on("deleted_instance",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.getInstance),w.removeListener("got_list",this.getList),w.removeListener("deleted_instance",this.getInstance)}},{key:"componentDidMount",value:function(){T("roles",this.$f7route.params.roleId,this.state.token),I("users",this.state.page,{},this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Role"===t&&this.setState({role:e,id:e.id,assignedUsers:e.users,ability:e.ability})}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"User"===t&&this.setState({users:e})}},{key:"submit",value:function(){D("users/assignments",{role_id:this.state.id,user_id:this.state.user_id},this.state.token)}},{key:"addAbility",value:function(){D("roles/abilities",{id:this.state.id,ability_title:this.state.abilityTitle,ability_value:this.state.abilityValue},this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"fab",value:function(){if(this.state.role)return r.a.createElement(c.o,{href:"/roles/"+this.state.role.id+"/edit",target:"#main-view",position:"left-bottom",slot:"fixed",color:"lime"},r.a.createElement(c.r,{ios:"f7:edit",aurora:"f7:edit",md:"material:edit"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"}))}},{key:"removeRole",value:function(e){A("users/assignments",{user_id:e,role_id:this.state.id},this.state.token)}},{key:"removeAbility",value:function(e){A("roles/abilities",{id:this.state.id,title:e},this.state.token)}},{key:"render",value:function(){var e=this.state,t=e.role,n=e.users,a=e.assignedUsers,i=e.ability;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.roles,backLink:d.back}),r.a.createElement(c.g,null),this.fab(),r.a.createElement(Le,{role:t,users:n,ability:i,removeAbility:this.removeAbility,assignedUsers:a,addAbility:this.addAbility,removeRole:this.removeRole,submit:this.submit,handleChange:this.handleChangeValue}))}}]),t}(i.Component),Ve=function(e){return e.roles?r.a.createElement(c.t,{mediaList:!0},e.roles.map((function(e){return r.a.createElement(c.v,{key:M.a.lib.WordArray.random(32),link:"/roles/"+e.id,ignoreCache:!0,title:e.title,after:"",subtitle:"",text:""})}))):r.a.createElement("ul",null)},Ne=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.roles,backLink:d.back}),r.a.createElement(c.g,null,d.list),r.a.createElement(c.o,{href:"/roles/new",target:"#main-view",position:"left-bottom",slot:"fixed",color:"deeporange"},r.a.createElement(c.r,{ios:"f7:add",aurora:"f7:add",md:"material:add"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"})),r.a.createElement(Ve,{roles:e.roles}))},Me=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),roles:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),I("roles",this.state.page,{},this.state.token)}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Role"===t&&this.setState({roles:e})}},{key:"render",value:function(){var e=this.state.roles;return r.a.createElement(Ne,{roles:e})}}]),t}(r.a.Component),Re=function(e){if(e.defaultRole)var t=!0;else t=!1;return r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.role),r.a.createElement(c.t,{form:!0},r.a.createElement(c.u,{label:d.title,type:"text",placeholder:"...",defaultValue:e.role.title,onInput:function(t){e.handleChange({title:t.target.value})}}),r.a.createElement(c.v,{radio:!0,value:!1,checked:!t,name:"defaultRole",title:d.NonDefault,onChange:function(t){console.log(t),e.handleChange({defaultRole:JSON.parse(t.target.value)})}}),r.a.createElement(c.v,{radio:!0,value:!0,checked:t,name:"defaultRole",title:d.Default,onChange:function(t){console.log(t),e.handleChange({defaultRole:JSON.parse(t.target.value)})}})),r.a.createElement(c.f,{strong:!0},r.a.createElement(c.B,{tag:"p"},r.a.createElement(c.h,{className:"col",fill:!0,disabled:!e.editing,onClick:e.submit},d.submit))))},Pe=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),role:{},default_role:!0},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance)}},{key:"submit",value:function(){D("roles",{title:this.state.title,default_role:this.state.defaultRole},this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"setInstance",value:function(){this.$f7router.navigate("/roles/")}},{key:"render",value:function(){var e=this.state.role;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.role_form,backLink:d.back}),r.a.createElement(c.g,null,d.role_form),r.a.createElement(Re,{role:e,submit:this.submit,editing:!0,handleChange:this.handleChangeValue}))}}]),t}(i.Component),We=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.getInstance=e.getInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),role:{},defaultRole:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.setInstance)}},{key:"submit",value:function(){L("roles",{id:this.state.id,title:this.state.title,default_role:this.state.defaultRole},this.state.token)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),this.$f7route.params.roleId&&T("roles",this.$f7route.params.roleId,this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Role"===t&&this.setState({title:e.title,id:e.id,role:e,defaultRole:e.default_role})}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"setInstance",value:function(){this.$f7router.navigate("/roles/")}},{key:"render",value:function(){var e=this.state,t=e.role,n=e.defaultRole;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.role_form,backLink:d.back}),r.a.createElement(c.g,null,d.role_form),r.a.createElement(Re,{role:t,defaultRole:n,submit:this.submit,editing:!0,handleChange:this.handleChangeValue}))}}]),t}(i.Component),Fe=function(e){return e.setting?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.title),r.a.createElement(c.t,{"simple-list":!0},r.a.createElement(c.v,null,e.setting.title)),r.a.createElement(c.g,null,d.content),r.a.createElement(c.t,{"simple-list":!0},r.a.createElement(c.v,null,e.setting.content))):null},Ue=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.submit=e.submit.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.removeSetting=e.removeSetting.bind(Object(v.a)(e)),e.addAbility=e.addAbility.bind(Object(v.a)(e)),e.removeAbility=e.removeAbility.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),setting:null,id:null,users:null,assignedUsers:null,user_id:null,abilityTitle:"",abilityValue:!0,ability:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.getInstance),w.on("got_list",this.getList),w.on("deleted_instance",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.getInstance),w.removeListener("got_list",this.getList),w.removeListener("deleted_instance",this.getInstance)}},{key:"componentDidMount",value:function(){T("settings",this.$f7route.params.settingId,this.state.token),I("users",this.state.page,{},this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Setting"===t&&this.setState({setting:e,id:e.id,assignedUsers:e.users,ability:e.ability})}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"User"===t&&this.setState({users:e})}},{key:"submit",value:function(){D("users/assignments",{setting_id:this.state.id,user_id:this.state.user_id},this.state.token)}},{key:"addAbility",value:function(){D("settings/abilities",{id:this.state.id,ability_title:this.state.abilityTitle,ability_value:this.state.abilityValue},this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"fab",value:function(){if(this.state.setting)return r.a.createElement(c.o,{href:"/settings/"+this.state.setting.id+"/edit",target:"#main-view",position:"left-bottom",slot:"fixed",color:"lime"},r.a.createElement(c.r,{ios:"f7:edit",aurora:"f7:edit",md:"material:edit"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"}))}},{key:"removeSetting",value:function(e){A("users/assignments",{user_id:e,setting_id:this.state.id},this.state.token)}},{key:"removeAbility",value:function(e){A("settings/abilities",{id:this.state.id,title:e},this.state.token)}},{key:"render",value:function(){var e=this.state,t=e.setting,n=e.users,a=e.assignedUsers,i=e.ability;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.settings,backLink:d.back}),r.a.createElement(c.g,null),this.fab(),r.a.createElement(Fe,{setting:t,users:n,ability:i,removeAbility:this.removeAbility,assignedUsers:a,addAbility:this.addAbility,removeSetting:this.removeSetting,submit:this.submit,handleChange:this.handleChangeValue}))}}]),t}(i.Component),Be=function(e){return e.settings?r.a.createElement(c.t,{mediaList:!0},e.settings.map((function(e){return r.a.createElement(c.v,{key:M.a.lib.WordArray.random(32),link:"/settings/"+e.id,ignoreCache:!0,title:e.title,after:"",subtitle:"",text:""})}))):r.a.createElement("ul",null)},qe=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.settings,backLink:d.back}),r.a.createElement(c.g,null,d.list),r.a.createElement(c.o,{href:"/settings/new",target:"#main-view",position:"left-bottom",slot:"fixed",color:"deeporange"},r.a.createElement(c.r,{ios:"f7:add",aurora:"f7:add",md:"material:add"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"})),r.a.createElement(Be,{settings:e.settings}))},$e=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),settings:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),I("settings",this.state.page,{},this.state.token)}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Setting"===t&&this.setState({settings:e})}},{key:"render",value:function(){var e=this.state.settings;return r.a.createElement(qe,{settings:e})}}]),t}(r.a.Component),Ge=function(e){return console.log(e),r.a.createElement(r.a.Fragment,null,r.a.createElement(c.g,null,d.setting),r.a.createElement(c.t,{form:!0},r.a.createElement(c.u,{label:"Title",inputStyle:{direction:"ltr"},type:"text",placeholder:"...",defaultValue:e.title,onInput:function(t){e.handleChange({title:t.target.value})}}),r.a.createElement(c.u,{label:"Schema",type:"text",inputStyle:{direction:"ltr"},value:e.content,placeholder:"JSON",onInput:function(t){e.handleChange({content:t.target.value})}})),r.a.createElement(c.f,{strong:!0},r.a.createElement(c.B,{tag:"p"},r.a.createElement(c.h,{className:"col",fill:!0,disabled:!e.editing,onClick:e.submit},d.submit))))},Je=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),title:"",content:""},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance)}},{key:"submit",value:function(){D("settings",{title:this.state.title,content:this.state.content},this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"setInstance",value:function(){this.$f7router.navigate("/settings/")}},{key:"render",value:function(){var e=this.state,t=e.title,n=e.content;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.setting_form,backLink:d.back}),r.a.createElement(c.g,null,d.setting_form),r.a.createElement(Ge,{title:t,content:n,submit:this.submit,editing:!0,handleChange:this.handleChangeValue}))}}]),t}(i.Component),Ke=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.getInstance=e.getInstance.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),title:"",id:null,content:""},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance),w.on("got_instance",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance),w.removeListener("got_instance",this.getInstance)}},{key:"componentDidMount",value:function(){T("settings",this.$f7route.params.settingId,this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Setting"===t&&this.setState({title:e.title,id:e.id,content:e.content})}},{key:"submit",value:function(){L("settings",{id:this.state.id,title:this.state.title,content:this.state.content},this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"setInstance",value:function(){this.$f7router.navigate("/settings/")}},{key:"render",value:function(){var e=this.state,t=e.title,n=e.content;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.setting_form,backLink:d.back}),r.a.createElement(c.g,null,d.setting_form),r.a.createElement(Ge,{title:t,content:n,submit:this.submit,editing:!0,handleChange:this.handleChangeValue}))}}]),t}(i.Component),ze=(n(264),n(269),function(e){return e.channels&&e.channels.length>0?(console.log(e.channels),r.a.createElement(r.a.Fragment,null,r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.channels),r.a.createElement(c.j,null,r.a.createElement(c.t,null,e.channels.map((function(e){return r.a.createElement(c.v,{link:"/channels/"+e.id,title:e.title.substring(0,30)})}))))))):r.a.createElement("ul",null)}),He=function(e){return e.experties?e.editable?r.a.createElement(c.B,{noGap:!0},e.experties.map((function(t){return r.a.createElement("a",{onClick:function(){return e.removeExperties(t)}},r.a.createElement(c.m,{text:t,mediaBgColor:"orange"},r.a.createElement(c.r,{slot:"media",aurora:"fa:times"})))}))):r.a.createElement(c.B,{noGap:!0},e.experties.map((function(e){return r.a.createElement("a",{href:"/experties/"+e},r.a.createElement(c.m,{text:e}))}))):null},Xe=function(e){return e.profiles?r.a.createElement(c.t,null,e.profiles.map((function(e){return r.a.createElement(c.v,{title:e.fullname,subtitle:"...",link:"/profiles/"+e.id},r.a.createElement("img",{slot:"media",src:e.avatar,width:"25"}))}))):r.a.createElement("ul",null)},Ye=function(e){return console.log(e),e.followers?r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.followers),r.a.createElement(c.j,null,r.a.createElement(Xe,{profiles:e.followers}))):null},Qe=function(e){return e.followees?r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.followees),r.a.createElement(c.j,null,r.a.createElement(Xe,{profiles:e.followees}))):null},Ze=function(e){r.a.useMemo((function(){return[{label:"Series 1",data:[[0,1],[1,2],[2,4],[3,2],[4,7]]},{label:"Series 2",data:[[0,3],[1,1],[2,5],[3,6],[4,4]]}]}),[]),r.a.useMemo((function(){return[{primary:!0,type:"linear",position:"bottom"},{type:"linear",position:"left"}]}),[]);return e.profile?r.a.createElement(c.H,null,r.a.createElement(c.G,{id:"tab-1",className:"page-content",tabActive:!0},r.a.createElement(c.B,null,r.a.createElement(c.n,{width:"100",tabletWidth:"50"},r.a.createElement(c.i,null,r.a.createElement(c.l,null,r.a.createElement("img",{src:e.profile.avatar,width:"80"}),r.a.createElement("div",{className:"profile-card"},e.profile.fullname),r.a.createElement("div",{className:"demo-facebook-date"},r.a.createElement(X,{model:e.profile,klass:"Profile",interaction:e.interaction,sourceType:"Profile",sourceId:e.profile.id}))),r.a.createElement(c.j,null,r.a.createElement(He,{experties:e.profile.experties}))),r.a.createElement(Ye,{followers:e.profile.followers,profile:e.profile})),r.a.createElement(c.n,{width:"100",tabletWidth:"50"},r.a.createElement(ze,{channels:e.channels}),r.a.createElement(Qe,{followees:e.profile.followees,profile:e.profile})))),r.a.createElement(c.G,{id:"tab-2",className:"page-content"},r.a.createElement(c.B,{noGap:!0},r.a.createElement(c.n,{width:"100",tabletWidth:"50"},e.metas.map((function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{meta:t.meta,editable:!1,actuals:t.actuals,removeActual:e.removeActual}))}))))),r.a.createElement(c.G,{id:"tab-3",className:"page-content"},r.a.createElement("div",{className:"block-title"},"Only Tablet Side By Side"),r.a.createElement(c.B,null,r.a.createElement(c.n,{width:"100",tabletWidth:"100"},r.a.createElement("div",{className:"timeline timeline-sides"},r.a.createElement("div",{className:"timeline-item"},r.a.createElement("div",{className:"timeline-item-date"},"21 ",r.a.createElement("small",null,"DEC")),r.a.createElement("div",{className:"timeline-item-divider"}),r.a.createElement("div",{className:"timeline-item-content"},r.a.createElement("div",{className:"timeline-item-inner"},r.a.createElement("div",{className:"timeline-item-time"},"12:30"),r.a.createElement("div",{className:"timeline-item-title"},"Title"),r.a.createElement("div",{className:"timeline-item-subtitle"},"Subtitle"),r.a.createElement("div",{className:"timeline-item-text"},"Text")))),r.a.createElement("div",{className:"timeline-item"},r.a.createElement("div",{className:"timeline-item-date"},"21 ",r.a.createElement("small",null,"DEC")),r.a.createElement("div",{className:"timeline-item-divider"}),r.a.createElement("div",{className:"timeline-item-content"},r.a.createElement("div",{className:"timeline-item-inner"},r.a.createElement("div",{className:"timeline-item-time"},"12:30"),r.a.createElement("div",{className:"timeline-item-title"},"Title"),r.a.createElement("div",{className:"timeline-item-subtitle"},"Subtitle"),r.a.createElement("div",{className:"timeline-item-text"},"Text"))))))))):null},et=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.addTag=e.addTag.bind(Object(v.a)(e)),e.interaction=e.interaction.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),profile:null,id:null,actuals:null,metas:null,channels:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance)}},{key:"componentDidMount",value:function(){T("profiles",this.$f7route.params.profileId,this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Profile"===t&&this.setState({profile:e,id:e.id,actuals:e.actuals,metas:e.metas,channels:e.channels})}},{key:"fab",value:function(){if(this.state.profile)return r.a.createElement(c.o,{href:"/profiles/"+this.state.profile.id+"/edit",target:"#main-view",position:"left-bottom",slot:"fixed",color:"lime"},r.a.createElement(c.r,{ios:"f7:edit",aurora:"f7:edit",md:"material:edit"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"}))}},{key:"addTag",value:function(){console.log("hey")}},{key:"interaction",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r={interaction_type:e,interactionable_id:t,interactionable_type:n,source_type:a,source_id:i};D("interactions",r,this.state.token)}},{key:"render",value:function(){var e=this.state,t=e.profile,n=e.actuals,a=e.metas,i=e.channels;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.profiles,backLinkForce:!0,backLink:d.back}),r.a.createElement(c.I,{tabbar:!0,bottom:!0},r.a.createElement(c.s,{tabLink:"#tab-1",tabLinkActive:!0},r.a.createElement("i",{className:"va ml-5 fa fa-user-circle"})),r.a.createElement(c.s,{tabLink:"#tab-2"},r.a.createElement("i",{className:"va ml-5 fa fa-bar-chart"})),r.a.createElement(c.s,{tabLink:"#tab-3"},r.a.createElement("i",{className:"va ml-5 fa fa-list"}))),this.fab(),r.a.createElement(Ze,{profile:t,actuals:n,channels:i,metas:a,addTag:this.addTag,interaction:this.interaction}))}}]),t}(i.Component),tt=function(e){return e.profiles?(console.log(e.profiles),r.a.createElement(c.B,{noGap:!0},e.profiles.map((function(t){return r.a.createElement(c.n,{width:"100",tabletWidth:"33"},r.a.createElement(c.i,{className:"demo-facebook-card"},r.a.createElement(c.l,{className:"no-border"},r.a.createElement("div",{className:"demo-facebook-avatar"},r.a.createElement("img",{src:t.avatar,width:"34",height:"34"})),r.a.createElement("div",{className:"demo-facebook-name "},r.a.createElement(c.s,{className:"gray-color",href:"/profiles/"+t.id},t.fullname.substring(0,30))),r.a.createElement("div",{className:"demo-facebook-date"},r.a.createElement(X,{model:t,klass:"Profile",interaction:e.interaction,sourceType:"Profile",sourceId:t.id})),r.a.createElement("div",{className:"demo-facebook-sub"},r.a.createElement(ee.a,{locale:"fa",fromNow:!0,ago:!0},t.last_login)," ",d.ago)),r.a.createElement(c.k,{className:"profile-footer"},r.a.createElement(He,{experties:t.experties}))))})))):r.a.createElement("ul",null)},nt=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.profiles},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"})),r.a.createElement(c.F,{inner:!1},r.a.createElement(c.C,{disableButtonText:d.cancel,placeholder:d.search,onChange:function(t){e.search({query:t.target.value})}}))),r.a.createElement(c.g,null),r.a.createElement(c.o,{href:"/profiles/new",target:"#main-view",position:"left-bottom",slot:"fixed",color:"deeporange"},r.a.createElement(c.r,{ios:"f7:add",aurora:"f7:add",md:"material:add"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"})),r.a.createElement(tt,{profiles:e.profiles,interaction:e.interaction}))},at=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.search=e.search.bind(Object(v.a)(e)),e.interaction=e.interaction.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),profiles:null,query:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),I("profiles",this.state.page)}},{key:"search",value:function(e){var t=this;this.setState(e,(function(){I("profiles/search",t.state.page,{q:t.state.query})}))}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Profile"===t&&this.setState({profiles:e})}},{key:"interaction",value:function(e,t,n){var a=arguments.length>3&&void 0!==arguments[3]?arguments[3]:null,i=arguments.length>4&&void 0!==arguments[4]?arguments[4]:null,r={interaction_type:e,interactionable_id:t,interactionable_type:n,source_type:a,source_id:i};D("interactions",r,this.state.token)}},{key:"render",value:function(){var e=this.state.profiles;return r.a.createElement(nt,{profiles:e,interaction:this.interaction,search:this.search})}}]),t}(r.a.Component),it=n(121),rt=n.n(it),ot=function(e){return e.name&&e.metas?r.a.createElement(r.a.Fragment,null,r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.profile_info),r.a.createElement(c.j,null,r.a.createElement(c.t,{form:!0},r.a.createElement(c.u,{label:d.firstname,type:"text",placeholder:"...",defaultValue:e.name,onInput:function(t){e.handleChange({name:t.target.value})}}),r.a.createElement(c.u,{label:d.surename,type:"text",placeholder:"...",defaultValue:e.surename,onInput:function(t){e.handleChange({surename:t.target.value})}}))),r.a.createElement(c.k,null,r.a.createElement(c.s,null),r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit))),r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.experties),r.a.createElement(c.j,null,r.a.createElement(c.t,null,r.a.createElement(c.v,null,r.a.createElement(He,{experties:e.experties,editable:!0,removeExperties:e.removeExperties}))),r.a.createElement(c.t,{form:!0},r.a.createElement(c.u,{label:d.new_experties,type:"text",placeholder:"...",defaultValue:e.expert,onInput:function(t){e.handleChange({expert:t.target.value})}}))),r.a.createElement(c.k,null,r.a.createElement(c.s,null),r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submitExperties},d.submit))),r.a.createElement(c.i,null,r.a.createElement(c.l,null,r.a.createElement("img",{src:e.avatar,width:"80"})),r.a.createElement(rt.a,{withIcon:!0,buttonText:d.choose_image,onChange:e.onDrop,buttonClassName:"upload-btn",imgExtension:[".jpg",".jpeg",".png"],maxFileSize:5242880})),e.metas.map((function(t){return r.a.createElement(r.a.Fragment,null,r.a.createElement(R,{meta:t.meta,editable:!0,actuals:t.actuals,removeActual:e.removeActual}),r.a.createElement(V,{meta:t.meta,submit:e.submitFields,onChangeValue:e.handleChangeValueFields}))}))):null},st=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.handleChangeValueFields=e.handleChangeValueFields.bind(Object(v.a)(e)),e.removeActual=e.removeActual.bind(Object(v.a)(e)),e.getInstance=e.getInstance.bind(Object(v.a)(e)),e.submitFields=e.submitFields.bind(Object(v.a)(e)),e.onDrop=e.onDrop.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.state={profile:{},metas:null,token:window.localStorage.getItem("token"),fields:[],name:"dd",surename:"",pictures:[],avatar:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.getInstance),w.on("deleted_instance",this.getInstance),w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.getInstance),w.removeListener("deleted_instance",this.getInstance),w.removeListener("got_list",this.getList)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){I("metas",this.state.page)}},{key:"onDrop",value:function(e){console.log(e[0]),_("profiles",this.state.id,e[0],this.state.token)}},{key:"submit",value:function(){L("profiles",{id:this.state.id,name:this.state.name,surename:this.state.surename},this.state.token)}},{key:"submitFields",value:function(){D("actuals",{meta_id:this.state.metaId,content:this.state.fields},this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"handleChangeValueFields",value:function(e,t,n){var a=this.state.fields;if(a.length>0)for(var i=0;i<a.length;i++)if(a[i].fid&&a[i].fid===e){var r=Object.assign({},this.state);r.fields[i]={fid:e,value:t,metaId:n},this.setState(r)}else this.setState({fields:this.state.fields.concat({fid:e,value:t,metaId:n})});else this.setState({fields:this.state.fields.concat({fid:e,value:t,metaId:n})})}},{key:"setInstance",value:function(){this.$f7router.navigate("/profiles/")}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Profile"===t&&this.setState({metas:e.metas,profile:e})}},{key:"removeActual",value:function(e){A("actuals",{uuid:e})}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Meta"===t&&this.setState({metas:e})}},{key:"render",value:function(){var e=this.state,t=(e.profile,e.metas),n=e.name,a=e.avatar,i=e.surename;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.profile_form,backLink:d.back}),r.a.createElement(c.g,null,d.profile_form),r.a.createElement(ot,{name:n,avatar:a,surename:i,metas:t,onDrop:this.onDrop,removeActual:this.removeActual,submitFields:this.submitFields,submit:this.submit,editing:!0,handleChangeValueFields:this.handleChangeValueFields,handleChange:this.handleChangeValue}))}}]),t}(i.Component),lt=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.handleChangeValueFields=e.handleChangeValueFields.bind(Object(v.a)(e)),e.removeActual=e.removeActual.bind(Object(v.a)(e)),e.getInstance=e.getInstance.bind(Object(v.a)(e)),e.submitFields=e.submitFields.bind(Object(v.a)(e)),e.onDrop=e.onDrop.bind(Object(v.a)(e)),e.getList=e.getList.bind(Object(v.a)(e)),e.submitExperties=e.submitExperties.bind(Object(v.a)(e)),e.removeExperties=e.removeExperties.bind(Object(v.a)(e)),e.state={name:null,surename:null,metas:null,metaId:null,actuals:null,experties:null,expert:null,token:window.localStorage.getItem("token"),fields:[],id:null,pictures:[],avatar:null},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.getInstance),w.on("deleted_instance",this.getInstance),w.on("file_posted",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.getInstance),w.removeListener("deleted_instance",this.getInstance),w.removeListener("file_posted",this.getInstance)}},{key:"componentDidMount",value:function(){this.loadData()}},{key:"loadData",value:function(){this.$f7route.params.profileId&&T("profiles",this.$f7route.params.profileId)}},{key:"onDrop",value:function(e){console.log(e[0]),_("profiles",this.state.id,e[0],this.state.token)}},{key:"submit",value:function(){L("profiles",{id:this.state.id,name:this.state.name,surename:this.state.surename},this.state.token)}},{key:"submitFields",value:function(){D("actuals",{meta_id:this.state.metaId,content:this.state.fields},this.state.token)}},{key:"submitExperties",value:function(){var e={id:this.state.id,experties:this.state.expert};D("profiles/add_experties/"+this.$f7route.params.profileId,e,this.state.token)}},{key:"removeExperties",value:function(e){var t={id:this.state.id,experties:e};D("profiles/remove_experties/"+this.$f7route.params.profileId,t,this.state.token)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"handleChangeValueFields",value:function(e,t,n){var a=this.state.fields;if(a.length>0)for(var i=0;i<a.length;i++)if(a[i].fid&&a[i].fid===e){var r=Object.assign({},this.state);r.fields[i]={fid:e,value:t,metaId:n},this.setState(r)}else this.setState({fields:this.state.fields.concat({fid:e,value:t,metaId:n})});else this.setState({fields:this.state.fields.concat({fid:e,value:t,metaId:n})})}},{key:"setInstance",value:function(){this.$f7router.navigate("/profiles/")}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Profile"===t&&this.setState({id:e.id,metas:e.metas,name:e.name,surename:e.surename,avatar:e.avatar,experties:e.experties})}},{key:"removeActual",value:function(e){A("actuals",{uuid:e})}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Meta"===t&&this.setState({metas:e})}},{key:"render",value:function(){var e=this.state,t=e.name,n=e.surename,a=e.avatar,i=e.metas,o=(e.actuals,e.experties);return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.profile_form,backLink:d.back}),r.a.createElement(c.g,null,d.profile_form),r.a.createElement(ot,{name:t,avatar:a,surename:n,metas:i,experties:o,onDrop:this.onDrop,removeActual:this.removeActual,submitFields:this.submitFields,submit:this.submit,editing:!0,handleChangeValueFields:this.handleChangeValueFields,handleChange:this.handleChangeValue,submitExperties:this.submitExperties,removeExperties:this.removeExperties}))}}]),t}(i.Component),ct=function(e){return e.friendship?r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.profiles,backLink:d.back},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),r.a.createElement(c.g,null),r.a.createElement(Xe,{profiles:e.friendship.followees})):null},ut=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.loggedIn=oe.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),friendship:null,query:null,page:1},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance)}},{key:"componentDidMount",value:function(){this.loggedIn(),this.loadData()}},{key:"loadData",value:function(){T("friendships",this.$f7route.params.sourceId,this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Friendship"===t&&this.setState({friendship:e,id:e.id}),console.log(e,t)}},{key:"render",value:function(){var e=this.state.friendship;return r.a.createElement(ct,{friendship:e})}}]),t}(r.a.Component),dt=function(e){if(e.profilePrivacy){var t=function(e,t){for(var n=0;n<e.length;n++)if(e[n].title==t)return e[n].value};return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.privacy_settings,backLink:d.back},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.settings),r.a.createElement(c.j,null,r.a.createElement(c.t,null,e.profilePrivacy.setting_schemas.map((function(n){return r.a.createElement(c.u,{label:n.label,type:"select",onChange:function(t){e.handleChangeValue(n.title,t.target.value)}},function(e,n,a){for(var i=[r.a.createElement("option",null)],o=!1,s=0;s<e.length;s++)o=e[s].title==t(a,n),i.push(r.a.createElement("option",{value:e[s].title,selected:o},e[s].label));return i}(n.options,n.title,e.privacySettings))})))),r.a.createElement(c.k,null,r.a.createElement(c.s,null),r.a.createElement(c.h,{className:"col",fill:!0,onClick:e.submit},d.submit))))}return null},mt=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getInstance=e.getInstance.bind(Object(v.a)(e)),e.submit=e.submit.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),profilePrivacy:null,privacySettings:null,fields:[]},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_instance",this.getInstance),w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_instance",this.getInstance),w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){T("privacy",1,this.state.token)}},{key:"getInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Privacy"===t&&this.setState({profilePrivacy:e,privacySettings:e.privacy_settings,fields:e.privacy_settings})}},{key:"setInstance",value:function(){this.$f7.dialog.alert(d.completed_successfully,d.message)}},{key:"submit",value:function(){D("privacy",{id:1,privacy:this.state.fields},this.state.token)}},{key:"handleChangeValue",value:function(e,t){var n=this.state.fields;if(n.length>0){for(var a=0;a<n.length;a++)if(n[a].title&&n[a].title==e){var i=Object.assign({},this.state);i.fields[a]={title:e,value:t},this.setState(i)}}else this.setState({fields:this.state.fields.concat({title:e,value:t})})}},{key:"render",value:function(){var e=this.state,t=e.profilePrivacy,n=e.privacySettings;return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.privacy_settings,backLink:d.back}),r.a.createElement(dt,{profilePrivacy:t,privacySettings:n,handleChangeValue:this.handleChangeValue,submit:this.submit}))}}]),t}(i.Component),ft=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.sign_up},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.login),r.a.createElement(c.j,{className:"mh-auto"},r.a.createElement(c.t,null,r.a.createElement(c.u,{label:d.email,type:"text",autofocus:!0,placeholder:d.enter_your_email,value:e.email,onInput:function(t){e.handleChange({email:t.target.value})}}))),r.a.createElement(c.k,null,r.a.createElement(c.s,{href:"/sign_up/",animate:!1,ignoreCache:!0},d.you_can_sign_up," "),r.a.createElement(c.h,{fill:!0,className:"fs-11 external f-color-black bg-teal",href:"https://auth.ut.ac.ir:8443/cas/login?service=https%3A%2F%2Fsn.ut.ac.ir%2Fusers%2Fservice",animate:!1,ignoreCache:!0},d.cas," "),r.a.createElement(c.s,{className:"btn-notice"}),r.a.createElement(c.h,{className:"col btn",fill:!0,onClick:e.submit},d.login))))},ht=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),email:"",password:""},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){this.$f7route.params.token&&D("users/validate_token",{},this.$f7route.params.token),this.state.token&&this.state.token.length>10&&D("users/validate_token",{},this.state.token)}},{key:"submit",value:function(){D("users/login",{email:this.state.email,password:this.state.password})}},{key:"setInstance",value:function(){var e=w.getKlass();"Login"===e&&this.$f7router.navigate("/verification/"+this.state.email),"Validate"===e&&(this.$f7router.navigate("/"),window.location.reload()),console.log(e)}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this.state;e.username,e.password;return r.a.createElement(ft,{submit:this.submit,handleChange:this.handleChangeValue})}}]),t}(r.a.Component),gt=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.state={email:"",password:""},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){D("users/validate_token",{},this.$f7route.params.token)}},{key:"setInstance",value:function(){var e=w.getIntance();"Validate"===w.getKlass()?(window.localStorage.setItem("token",e.token),this.$f7router.navigate("/"),window.location.reload()):(this.$f7router.navigate("/login_error/"),window.location.reload())}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this.state;e.username,e.password;return r.a.createElement(ft,{submit:this.submit,handleChange:this.handleChangeValue})}}]),t}(r.a.Component),vt=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.sign_up},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.sign_up),r.a.createElement(c.j,null,r.a.createElement(c.t,null,r.a.createElement(c.u,{label:d.firstname+" *",placeholder:d.enter_your_name,type:"text",name:M.a.lib.WordArray.random(32),onInput:function(t){e.handleChange({name:t.target.value})}}),r.a.createElement(c.u,{label:d.surename+" *",placeholder:d.enter_your_surename,type:"text",name:M.a.lib.WordArray.random(32),onInput:function(t){e.handleChange({surename:t.target.value})}}),r.a.createElement(c.u,{label:" * "+d.email,type:"email",validate:!0,placeholder:d.enter_your_email,className:"ltr",value:e.email,onInput:function(t){e.handleChange({email:t.target.value})}}))),r.a.createElement(c.k,null,r.a.createElement(c.s,{href:"/login/"},d.if_registered,"\xa0",d.you_can_login," "),r.a.createElement(c.s,{className:"btn-notice"}),r.a.createElement(c.h,{className:"col btn",fill:!0,onClick:e.submit},d.sign_up))))},pt=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.state={email:"",name:"",surename:""},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance)}},{key:"submit",value:function(){this.$$(".btn").hide(),this.$$(".btn-notice").text(d.submitting);var e={email:this.state.email,name:this.state.name,surename:this.state.surename};if(this.state.email&&this.state.email.length>0&&this.state.name&&this.state.name.length>0&&this.state.surename&&this.state.surename.length>0)D("users/sign_up",e);else{this.$f7.dialog.alert(d.incomplete_data,d.alert)}}},{key:"setInstance",value:function(){"SignUp"===w.getKlass()&&(this.$$(".btn").show(),this.$f7router.navigate("/verification/"+this.state.email))}},{key:"handleChangeValue",value:function(e){this.setState(e),console.log(e)}},{key:"render",value:function(){var e=this.state;e.username,e.password;return r.a.createElement(vt,{submit:this.submit,handleChange:this.handleChangeValue})}}]),t}(r.a.Component),bt=function(e){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:d.verification},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),r.a.createElement(c.i,null,r.a.createElement(c.l,null,d.login),r.a.createElement(c.j,null,r.a.createElement(c.t,null,r.a.createElement(c.u,{label:d.email,type:"text",autofocus:!0,placeholder:d.enter_your_email,value:e.email,onInput:function(t){e.handleChange({email:t.target.value})}}),r.a.createElement(c.u,{label:d.verification_code,type:"text",placeholder:d.enter_verification_code,onInput:function(t){e.handleChange({verificationCode:t.target.value})}}))),r.a.createElement(c.k,null,r.a.createElement(c.s,{href:"/sign_up/",animate:!1,ignoreCache:!0},d.you_can_sign_up," "),r.a.createElement(c.s,{className:"btn-notice"}),r.a.createElement(c.h,{className:"col btn",fill:!0,onClick:e.submit},d.login))))},yt=function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).submit=e.submit.bind(Object(v.a)(e)),e.handleChangeValue=e.handleChangeValue.bind(Object(v.a)(e)),e.setInstance=e.setInstance.bind(Object(v.a)(e)),e.state={verificationCode:"",email:""},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("set_instance",this.setInstance)}},{key:"componentWillUnmount",value:function(){w.removeListener("set_instance",this.setInstance)}},{key:"componentDidMount",value:function(){this.setState({email:this.$f7route.params.email})}},{key:"submit",value:function(){D("users/verify",{verification_code:this.state.verificationCode})}},{key:"setInstance",value:function(){var e=w.getIntance(),t=w.getKlass();e&&"Verify"==t&&(window.localStorage.setItem("token",e.token),this.$f7router.navigate("/"),window.location.reload())}},{key:"handleChangeValue",value:function(e){this.setState(e)}},{key:"render",value:function(){var e=this.state,t=(e.username,e.email);return r.a.createElement(bt,{submit:this.submit,email:t,handleChange:this.handleChangeValue})}}]),t}(r.a.Component),kt=function(e){return r.a.createElement(c.y,{onPageAfterIn:e.pageAfterIn.bind(void 0)},r.a.createElement(c.x,{title:d.profiles,backLink:d.back},r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"}))),r.a.createElement(c.f,null,r.a.createElement(c.B,{className:"center",id:"hosts"},function(){var t=[];return e.feeds&&e.feeds.map((function(n){t.push(r.a.createElement("div",{class:"col-100 tablet-33",key:"container-"+n.id},r.a.createElement("video",{controls:!0,key:n.id,id:"video-"+n.id,src:"",width:"320",height:"240",autoPlay:!0,playsInline:!0,muted:e.muted}))),e.streamAttacher(n)})),t}())),r.a.createElement(c.o,{position:"center-bottom",slot:"fixed",color:"orange",className:"f-color-black"},r.a.createElement("i",{class:"fa fa-cogs","aria-hidden":"true"}),r.a.createElement("i",{class:"fa fa-cog","aria-hidden":"true"}),r.a.createElement(c.q,{position:"center"},r.a.createElement(c.p,{className:"f-color-black",outline:!0,active:!0,onClick:function(){return e.publishMicrophone()}},r.a.createElement("i",{class:"fa fa-microphone","aria-hidden":"true"})),r.a.createElement(c.p,{className:"f-color-black",onClick:function(){return e.publishCamera()}},r.a.createElement("i",{class:"fa fa-video-camera","aria-hidden":"true"})),r.a.createElement(c.p,null),r.a.createElement(c.p,{className:"f-color-black"},r.a.createElement("i",{class:"fa fa-desktop","aria-hidden":"true"})))))},Et=n(122),wt=n.n(Et),St=n(74),Ct=window.RTCRtpTransceiver;jt.sessions={},jt.isExtensionEnabled=function(){if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return!0;if(window.navigator.userAgent.match("Chrome")){var e=parseInt(window.navigator.userAgent.match(/Chrome\/(.*) /)[1],10),t=33;return window.navigator.userAgent.match("Linux")&&(t=35),e>=26&&e<=t||jt.extension.isInstalled()}return!0};var Ot={extensionId:"hapfgfdkleiggjjpfpenajgdnfckjpaj",isInstalled:function(){return null!==document.querySelector("#janus-extension-installed")},getScreen:function(e){var t=window.setTimeout((function(){var t=new Error("NavigatorUserMediaError");return t.name='The required Chrome extension is not installed: click <a href="#">here</a> to install it. (NOTE: this will need you to refresh the page)',e(t)}),1e3);this.cache[t]=e,window.postMessage({type:"janusGetScreen",id:t},"*")},init:function(){var e={};this.cache=e,window.addEventListener("message",(function(t){if(t.origin==window.location.origin)if("janusGotScreen"==t.data.type&&e[t.data.id]){var n=e[t.data.id];if(delete e[t.data.id],""===t.data.sourceId){var a=new Error("NavigatorUserMediaError");a.name="You cancelled the request for permission, giving up...",n(a)}else n(null,t.data.sourceId)}else"janusGetScreenPending"==t.data.type&&(console.log("clearing ",t.data.id),window.clearTimeout(t.data.id))}))}};function jt(e){if((e=e||{}).success="function"==typeof e.success?e.success:jt.noop,e.error="function"==typeof e.error?e.error:jt.noop,e.destroyed="function"==typeof e.destroyed?e.destroyed:jt.noop,!jt.initDone)return e.error("Library not initialized"),{};if(!jt.isWebrtcSupported())return e.error("WebRTC not supported by this browser"),{};if(jt.log("Library initialized: "+jt.initDone),!e.server)return e.error("Invalid server url"),{};var t=!1,n=null,a={},i=null,r=null,o=0,s=e.server;jt.isArray(s)?(jt.log("Multiple servers provided ("+s.length+"), will use the first that works"),s=null,r=e.server,jt.debug(r)):0===s.indexOf("ws")?(t=!0,jt.log("Using WebSockets to contact Janus: "+s)):(t=!1,jt.log("Using REST API to contact Janus: "+s));var l=e.iceServers||[{urls:"stun:stun.l.google.com:19302"}],c=e.iceTransportPolicy,u=e.bundlePolicy,d=!0===e.ipv6,m=!1;void 0!==e.withCredentials&&null!==e.withCredentials&&(m=!0===e.withCredentials);var f=10;void 0!==e.max_poll_events&&null!==e.max_poll_events&&(f=e.max_poll_events),f<1&&(f=1);var h=null;void 0!==e.token&&null!==e.token&&(h=e.token);var g=null;void 0!==e.apisecret&&null!==e.apisecret&&(g=e.apisecret),this.destroyOnUnload=!0,void 0!==e.destroyOnUnload&&null!==e.destroyOnUnload&&(this.destroyOnUnload=!0===e.destroyOnUnload);var v=25e3;void 0!==e.keepAlivePeriod&&null!==e.keepAlivePeriod&&(v=e.keepAlivePeriod),isNaN(v)&&(v=25e3);var p=6e4;function b(e){var t={high:9e5,medium:3e5,low:1e5};return void 0!==e&&null!==e&&(e.high&&(t.high=e.high),e.medium&&(t.medium=e.medium),e.low&&(t.low=e.low)),t}void 0!==e.longPollTimeout&&null!==e.longPollTimeout&&(p=e.longPollTimeout),isNaN(p)&&(p=6e4);var y=!1,k=null,E={},w=this,S=0,C={};function O(){if(null!=k)if(jt.debug("Long poll..."),y){var t=s+"/"+k+"?rid="+(new Date).getTime();f&&(t=t+"&maxev="+f),h&&(t=t+"&token="+encodeURIComponent(h)),g&&(t=t+"&apisecret="+encodeURIComponent(g)),jt.httpAPICall(t,{verb:"GET",withCredentials:m,success:j,timeout:p,error:function(t,n){if(jt.error(t+":",n),++S>3)return y=!1,void e.error("Lost connection to the server (is it down?)");O()}})}else jt.warn("Is the server down? (connected=false)")}function j(e,a){if(S=0,t||void 0===k||null===k||!0===a||O(),t||!jt.isArray(e))if("keepalive"!==e.janus)if("ack"!==e.janus)if("success"!==e.janus)if("trickle"===e.janus){if(!(l=e.sender))return void jt.warn("Missing sender...");if(!(u=E[l]))return void jt.debug("This handle is not attached to this session");var i=e.candidate;jt.debug("Got a trickled candidate on session "+k),jt.debug(i);var r=u.webrtcStuff;r.pc&&r.remoteSdp?(jt.debug("Adding remote candidate:",i),i&&!0!==i.completed?r.pc.addIceCandidate(i):r.pc.addIceCandidate(jt.endOfCandidates)):(jt.debug("We didn't do setRemoteDescription (trickle got here before the offer?), caching candidate"),r.candidates||(r.candidates=[]),r.candidates.push(i),jt.debug(r.candidates))}else{if("webrtcup"===e.janus)return jt.debug("Got a webrtcup event on session "+k),jt.debug(e),(l=e.sender)?(u=E[l])?void u.webrtcState(!0):void jt.debug("This handle is not attached to this session"):void jt.warn("Missing sender...");if("hangup"===e.janus){if(jt.debug("Got a hangup event on session "+k),jt.debug(e),!(l=e.sender))return void jt.warn("Missing sender...");if(!(u=E[l]))return void jt.debug("This handle is not attached to this session");u.webrtcState(!1,e.reason),u.hangup()}else if("detached"===e.janus){if(jt.debug("Got a detached event on session "+k),jt.debug(e),!(l=e.sender))return void jt.warn("Missing sender...");if(!(u=E[l]))return;u.detached=!0,u.ondetached(),u.detach()}else if("media"===e.janus){if(jt.debug("Got a media event on session "+k),jt.debug(e),!(l=e.sender))return void jt.warn("Missing sender...");if(!(u=E[l]))return void jt.debug("This handle is not attached to this session");u.mediaState(e.type,e.receiving)}else if("slowlink"===e.janus){if(jt.debug("Got a slowlink event on session "+k),jt.debug(e),!(l=e.sender))return void jt.warn("Missing sender...");if(!(u=E[l]))return void jt.debug("This handle is not attached to this session");u.slowLink(e.uplink,e.lost)}else{if("error"===e.janus){var o,s;if(jt.error("Ooops: "+e.error.code+" "+e.error.reason),jt.debug(e),o=e.transaction)(s=C[o])&&s(e),delete C[o];return}if("event"===e.janus){var l;if(jt.debug("Got a plugin event on session "+k),jt.debug(e),!(l=e.sender))return void jt.warn("Missing sender...");var c=e.plugindata;if(!c)return void jt.warn("Missing plugindata...");jt.debug("  -- Event is coming from "+l+" ("+c.plugin+")");var u,d=c.data;if(jt.debug(d),!(u=E[l]))return void jt.warn("This handle is not attached to this session");var m=e.jsep;m&&(jt.debug("Handling SDP as well..."),jt.debug(m));var f=u.onmessage;f?(jt.debug("Notifying application..."),f(d,m)):jt.debug("No provided notification callback")}else{if("timeout"===e.janus)return jt.error("Timeout on session "+k),jt.debug(e),void(t&&n.close(3504,"Gateway timeout"));jt.warn("Unknown message/event  '"+e.janus+"' on session "+k),jt.debug(e)}}}else jt.debug("Got a success on session "+k),jt.debug(e),(o=e.transaction)&&((s=C[o])&&s(e),delete C[o]);else jt.debug("Got an ack on session "+k),jt.debug(e),(o=e.transaction)&&((s=C[o])&&s(e),delete C[o]);else jt.vdebug("Got a keepalive on session "+k);else for(var h=0;h<e.length;h++)j(e[h],!0)}function I(){if(s&&t&&y){i=setTimeout(I,v);var e={janus:"keepalive",session_id:k,transaction:jt.randomString(12)};h&&(e.token=h),g&&(e.apisecret=g),n.send(JSON.stringify(e))}}function _(l){var c=jt.randomString(12),u={janus:"create",transaction:c};if(l.reconnect&&(y=!1,u.janus="claim",u.session_id=k,n&&(n.onopen=null,n.onerror=null,n.onclose=null,i&&(clearTimeout(i),i=null))),h&&(u.token=h),g&&(u.apisecret=g),!s&&jt.isArray(r)&&(0===(s=r[o]).indexOf("ws")?(t=!0,jt.log("Server #"+(o+1)+": trying WebSockets to contact Janus ("+s+")")):(t=!1,jt.log("Server #"+(o+1)+": trying REST API to contact Janus ("+s+")"))),t)for(var d in n=jt.newWebSocket(s,"janus-protocol"),a={error:function(){if(jt.error("Error connecting to the Janus WebSockets server... "+s),jt.isArray(r)&&!l.reconnect)return++o===r.length?void l.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){_(l)}),200));l.error("Error connecting to the Janus WebSockets server: Is the server down?")},open:function(){C[c]=function(e){if(jt.debug(e),"success"!==e.janus)return jt.error("Ooops: "+e.error.code+" "+e.error.reason),void l.error(e.error.reason);i=setTimeout(I,v),y=!0,k=e.session_id?e.session_id:e.data.id,l.reconnect?jt.log("Claimed session: "+k):jt.log("Created session: "+k),jt.sessions[k]=w,l.success()},n.send(JSON.stringify(u))},message:function(e){j(JSON.parse(e.data))},close:function(){s&&y&&(y=!1,e.error("Lost connection to the server (is it down?)"))}})n.addEventListener(d,a[d]);else jt.httpAPICall(s,{verb:"POST",withCredentials:m,body:u,success:function(e){if(jt.debug(e),"success"!==e.janus)return jt.error("Ooops: "+e.error.code+" "+e.error.reason),void l.error(e.error.reason);y=!0,k=e.session_id?e.session_id:e.data.id,l.reconnect?jt.log("Claimed session: "+k):jt.log("Created session: "+k),jt.sessions[k]=w,O(),l.success()},error:function(e,t){if(jt.error(e+":",t),jt.isArray(r)&&!l.reconnect)return++o===r.length?void l.error("Error connecting to any of the provided Janus servers: Is the server down?"):(s=null,void setTimeout((function(){_(l)}),200));""===t?l.error(e+": Is the server down?"):l.error(e+": "+t)}})}function T(e,a){if((a=a||{}).success="function"==typeof a.success?a.success:jt.noop,a.error="function"==typeof a.error?a.error:jt.noop,!y)return jt.warn("Is the server down? (connected=false)"),void a.error("Is the server down? (connected=false)");var i=E[e];if(!i||!i.webrtcStuff)return jt.warn("Invalid handle"),void a.error("Invalid handle");var r=a.message,o=a.jsep,l=jt.randomString(12),c={janus:"message",body:r,transaction:l};if(i.token&&(c.token=i.token),g&&(c.apisecret=g),o&&(c.jsep={type:o.type,sdp:o.sdp},o.e2ee&&(c.jsep.e2ee=!0)),jt.debug("Sending message to plugin (handle="+e+"):"),jt.debug(c),t)return c.session_id=k,c.handle_id=e,C[l]=function(e){if(jt.debug("Message sent!"),jt.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return jt.warn("Request succeeded, but missing plugindata..."),void a.success();jt.log("Synchronous transaction successful ("+t.plugin+")");var n=t.data;return jt.debug(n),void a.success(n)}"ack"===e.janus?a.success():e.error?(jt.error("Ooops: "+e.error.code+" "+e.error.reason),a.error(e.error.code+" "+e.error.reason)):(jt.error("Unknown error"),a.error("Unknown error"))},void n.send(JSON.stringify(c));jt.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:c,success:function(e){if(jt.debug("Message sent!"),jt.debug(e),"success"===e.janus){var t=e.plugindata;if(!t)return jt.warn("Request succeeded, but missing plugindata..."),void a.success();jt.log("Synchronous transaction successful ("+t.plugin+")");var n=t.data;return jt.debug(n),void a.success(n)}"ack"===e.janus?a.success():e.error?(jt.error("Ooops: "+e.error.code+" "+e.error.reason),a.error(e.error.code+" "+e.error.reason)):(jt.error("Unknown error"),a.error("Unknown error"))},error:function(e,t){jt.error(e+":",t),a.error(e+": "+t)}})}function A(e,a){if(y){var i=E[e];if(i&&i.webrtcStuff){var r={janus:"trickle",candidate:a,transaction:jt.randomString(12)};if(i.token&&(r.token=i.token),g&&(r.apisecret=g),jt.vdebug("Sending trickle candidate (handle="+e+"):"),jt.vdebug(r),t)return r.session_id=k,r.handle_id=e,void n.send(JSON.stringify(r));jt.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:r,success:function(e){jt.vdebug("Candidate sent!"),jt.vdebug(e),"ack"===e.janus||jt.error("Ooops: "+e.error.code+" "+e.error.reason)},error:function(e,t){jt.error(e+":",t)}})}else jt.warn("Invalid handle")}else jt.warn("Is the server down? (connected=false)")}function D(e,t,n,a,i){var r=E[e];if(r&&r.webrtcStuff){var o=r.webrtcStuff,s=function(e){jt.log("Received state change on data channel:",e);var t=e.target.label,n=e.target.protocol,a=o.dataChannel[t]?o.dataChannel[t].readyState:"null";if(jt.log("State change on <"+t+"> data channel: "+a),"open"===a){if(o.dataChannel[t].pending&&o.dataChannel[t].pending.length>0){jt.log("Sending pending messages on <"+t+">:",o.dataChannel[t].pending.length);var i=!0,s=!1,l=void 0;try{for(var c,u=o.dataChannel[t].pending[Symbol.iterator]();!(i=(c=u.next()).done);i=!0){var d=c.value;jt.log("Sending data on data channel <"+t+">"),jt.debug(d),o.dataChannel[t].send(d)}}catch(m){s=!0,l=m}finally{try{i||null==u.return||u.return()}finally{if(s)throw l}}o.dataChannel[t].pending=[]}r.ondataopen(t,n)}};if(a)o.dataChannel[t]=a;else{var l={ordered:!0};n&&(l.protocol=n),o.dataChannel[t]=o.pc.createDataChannel(t,l)}o.dataChannel[t].onmessage=function(e){jt.log("Received message on data channel:",e);var t=e.target.label;r.ondata(e.data,t)},o.dataChannel[t].onopen=s,o.dataChannel[t].onclose=s,o.dataChannel[t].onerror=function(e){jt.error("Got error on data channel:",e)},o.dataChannel[t].pending=[],i&&o.dataChannel[t].pending.push(i)}else jt.warn("Invalid handle")}function L(e,t){(t=t||{}).success="function"==typeof t.success?t.success:jt.noop,t.error="function"==typeof t.error?t.error:jt.noop;var n=E[e];if(!n||!n.webrtcStuff)return jt.warn("Invalid handle"),void t.error("Invalid handle");var a=n.webrtcStuff,i=t.text||t.data;if(!i)return jt.warn("Invalid data"),void t.error("Invalid data");var r=t.label?t.label:jt.dataChanDefaultLabel;return a.dataChannel[r]?"open"!==a.dataChannel[r].readyState?(a.dataChannel[r].pending.push(i),void t.success()):(jt.log("Sending data on data channel <"+r+">"),jt.debug(i),a.dataChannel[r].send(i),void t.success()):(D(e,r,t.protocol,!1,i,t.protocol),void t.success())}function x(e,t){(t=t||{}).success="function"==typeof t.success?t.success:jt.noop,t.error="function"==typeof t.error?t.error:jt.noop;var n=E[e];if(!n||!n.webrtcStuff)return jt.warn("Invalid handle"),void t.error("Invalid handle");var a=n.webrtcStuff;if(!a.dtmfSender){if(a.pc){var i=a.pc.getSenders().find((function(e){return e.track&&"audio"===e.track.kind}));if(!i)return jt.warn("Invalid DTMF configuration (no audio track)"),void t.error("Invalid DTMF configuration (no audio track)");a.dtmfSender=i.dtmf,a.dtmfSender&&(jt.log("Created DTMF Sender"),a.dtmfSender.ontonechange=function(e){jt.debug("Sent DTMF tone: "+e.tone)})}if(!a.dtmfSender)return jt.warn("Invalid DTMF configuration"),void t.error("Invalid DTMF configuration")}var r=t.dtmf;if(!r)return jt.warn("Invalid DTMF parameters"),void t.error("Invalid DTMF parameters");var o=r.tones;if(!o)return jt.warn("Invalid DTMF string"),void t.error("Invalid DTMF string");var s="number"===typeof r.duration?r.duration:500,l="number"===typeof r.gap?r.gap:50;jt.debug("Sending DTMF string "+o+" (duration "+s+"ms, gap "+l+"ms)"),a.dtmfSender.insertDTMF(o,s,l),t.success()}function V(e,a){(a=a||{}).success="function"==typeof a.success?a.success:jt.noop,a.error="function"==typeof a.error?a.error:jt.noop;var i=!0===a.noRequest;jt.log("Destroying handle "+e+" (only-locally="+i+")"),q(e);var r=E[e];if(!r||r.detached)return delete E[e],void a.success();if(i)return delete E[e],void a.success();if(!y)return jt.warn("Is the server down? (connected=false)"),void a.error("Is the server down? (connected=false)");var o={janus:"detach",transaction:jt.randomString(12)};if(r.token&&(o.token=r.token),g&&(o.apisecret=g),t)return o.session_id=k,o.handle_id=e,n.send(JSON.stringify(o)),delete E[e],void a.success();jt.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:o,success:function(t){jt.log("Destroyed handle:"),jt.debug(t),"success"!==t.janus&&jt.error("Ooops: "+t.error.code+" "+t.error.reason),delete E[e],a.success()},error:function(t,n){jt.error(t+":",n),delete E[e],a.success()}})}function N(e,t,n,a,i){var r=E[e];if(!r||!r.webrtcStuff)return jt.warn("Invalid handle"),void a.error("Invalid handle");var o=r.webrtcStuff;jt.debug("streamsDone:",i),i&&(jt.debug("  -- Audio tracks:",i.getAudioTracks()),jt.debug("  -- Video tracks:",i.getVideoTracks()));var s=!1;if(o.myStream&&n.update&&!o.streamExternal){if((!n.update&&$(n)||n.update&&(n.addAudio||n.replaceAudio))&&i.getAudioTracks()&&i.getAudioTracks().length)if(o.myStream.addTrack(i.getAudioTracks()[0]),jt.unifiedPlan){jt.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",i.getAudioTracks()[0]);var m=null;if((y=o.pc.getTransceivers())&&y.length>0){var f=!0,h=!1,g=void 0;try{for(var v,p=y[Symbol.iterator]();!(f=(v=p.next()).done);f=!0){if((I=v.value).sender&&I.sender.track&&"audio"===I.sender.track.kind||I.receiver&&I.receiver.track&&"audio"===I.receiver.track.kind){m=I;break}}}catch(V){h=!0,g=V}finally{try{f||null==p.return||p.return()}finally{if(h)throw g}}}m&&m.sender?m.sender.replaceTrack(i.getAudioTracks()[0]):o.pc.addTrack(i.getAudioTracks()[0],i)}else jt.log((n.replaceAudio?"Replacing":"Adding")+" audio track:",i.getAudioTracks()[0]),o.pc.addTrack(i.getAudioTracks()[0],i);if((!n.update&&J(n)||n.update&&(n.addVideo||n.replaceVideo))&&i.getVideoTracks()&&i.getVideoTracks().length)if(o.myStream.addTrack(i.getVideoTracks()[0]),jt.unifiedPlan){jt.log((n.replaceVideo?"Replacing":"Adding")+" video track:",i.getVideoTracks()[0]);var y,k=null;if((y=o.pc.getTransceivers())&&y.length>0){var w=!0,S=!1,C=void 0;try{for(var O,j=y[Symbol.iterator]();!(w=(O=j.next()).done);w=!0){var I;if((I=O.value).sender&&I.sender.track&&"video"===I.sender.track.kind||I.receiver&&I.receiver.track&&"video"===I.receiver.track.kind){k=I;break}}}catch(V){S=!0,C=V}finally{try{w||null==j.return||j.return()}finally{if(S)throw C}}}k&&k.sender?k.sender.replaceTrack(i.getVideoTracks()[0]):o.pc.addTrack(i.getVideoTracks()[0],i)}else jt.log((n.replaceVideo?"Replacing":"Adding")+" video track:",i.getVideoTracks()[0]),o.pc.addTrack(i.getVideoTracks()[0],i)}else o.myStream=i,s=!0;if(!o.pc){var _={iceServers:l,iceTransportPolicy:c,bundlePolicy:u};"chrome"===jt.webRTCAdapter.browserDetails.browser&&(_.sdpSemantics=jt.webRTCAdapter.browserDetails.version<72?"plan-b":"unified-plan");var T={optional:[{DtlsSrtpKeyAgreement:!0}]};if(d&&T.optional.push({googIPv6:!0}),a.rtcConstraints&&"object"===typeof a.rtcConstraints)for(var L in jt.debug("Adding custom PeerConnection constraints:",a.rtcConstraints),a.rtcConstraints)T.optional.push(a.rtcConstraints[L]);"edge"===jt.webRTCAdapter.browserDetails.browser&&(_.bundlePolicy="max-bundle"),RTCRtpSender.prototype.createEncodedAudioStreams&&RTCRtpSender.prototype.createEncodedVideoStreams&&(a.senderTransforms||a.receiverTransforms)&&(o.senderTransforms=a.senderTransforms,o.receiverTransforms=a.receiverTransforms,_.forceEncodedAudioInsertableStreams=!0,_.forceEncodedVideoInsertableStreams=!0,_.encodedInsertableStreams=!0),jt.log("Creating PeerConnection"),jt.debug(T),o.pc=new RTCPeerConnection(_,T),jt.debug(o.pc),o.pc.getStats&&(o.volume={},o.bitrate.value="0 kbits/sec"),jt.log("Preparing local SDP and gathering candidates (trickle="+o.trickle+")"),o.pc.oniceconnectionstatechange=function(e){o.pc&&r.iceState(o.pc.iceConnectionState)},o.pc.onicecandidate=function(t){if(!t.candidate||"edge"===jt.webRTCAdapter.browserDetails.browser&&t.candidate.candidate.indexOf("endOfCandidates")>0)jt.log("End of candidates."),o.iceDone=!0,!0===o.trickle?A(e,{completed:!0}):function(e,t){(t=t||{}).success="function"==typeof t.success?t.success:jt.noop,t.error="function"==typeof t.error?t.error:jt.noop;var n=E[e];if(!n||!n.webrtcStuff)return void jt.warn("Invalid handle, not sending anything");var a=n.webrtcStuff;if(jt.log("Sending offer/answer SDP..."),!a.mySdp)return void jt.warn("Local SDP instance is invalid, not sending anything...");a.mySdp={type:a.pc.localDescription.type,sdp:a.pc.localDescription.sdp},!1===a.trickle&&(a.mySdp.trickle=!1);jt.debug(t),a.sdpSent=!0,t.success(a.mySdp)}(e,a);else{var n={candidate:t.candidate.candidate,sdpMid:t.candidate.sdpMid,sdpMLineIndex:t.candidate.sdpMLineIndex};!0===o.trickle&&A(e,n)}},o.pc.ontrack=function(e){if(jt.log("Handling Remote Track"),jt.debug(e),e.streams&&(o.remoteStream=e.streams[0],r.onremotestream(o.remoteStream),!e.track.onended)){if(o.receiverTransforms){var t=null;"audio"===e.track.kind&&o.receiverTransforms.audio?t=e.receiver.createEncodedAudioStreams():"video"===e.track.kind&&o.receiverTransforms.video&&(t=e.receiver.createEncodedVideoStreams()),t&&t.readableStream.pipeThrough(o.receiverTransforms[e.track.kind]).pipeTo(t.writableStream)}var n=null;jt.log("Adding onended callback to track:",e.track),e.track.onended=function(e){jt.log("Remote track removed:",e),o.remoteStream&&(clearTimeout(n),o.remoteStream.removeTrack(e.target),r.onremotestream(o.remoteStream))},e.track.onmute=function(e){jt.log("Remote track muted:",e),o.remoteStream&&null==n&&(n=setTimeout((function(){jt.log("Removing remote track"),o.remoteStream.removeTrack(e.target),r.onremotestream(o.remoteStream),n=null}),2520))},e.track.onunmute=function(e){if(jt.log("Remote track flowing again:",e),null!=n)clearTimeout(n),n=null;else try{o.remoteStream.addTrack(e.target),r.onremotestream(o.remoteStream)}catch(t){jt.error(t)}}}}}if(s&&i){jt.log("Adding local stream");var x=!0===a.simulcast2;i.getTracks().forEach((function(e){if(jt.log("Adding local track:",e),x)if("audio"===e.kind)o.pc.addTrack(e,i);else{jt.log("Enabling rid-based simulcasting:",e);var t=b(a.simulcastMaxBitrates);o.pc.addTransceiver(e,{direction:"sendrecv",streams:[i],sendEncodings:[{rid:"h",active:!0,maxBitrate:t.high},{rid:"m",active:!0,maxBitrate:t.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:t.low,scaleResolutionDownBy:4}]})}else{var n=o.pc.addTrack(e,i);if(n&&o.senderTransforms){var r=null;"audio"===n.track.kind&&o.senderTransforms.audio?r=n.createEncodedAudioStreams():"video"===n.track.kind&&o.senderTransforms.video&&(r=n.createEncodedVideoStreams()),r&&r.readableStream.pipeThrough(o.senderTransforms[n.track.kind]).pipeTo(r.writableStream)}}}))}(function(e){if(jt.debug("isDataEnabled:",e),"edge"===jt.webRTCAdapter.browserDetails.browser)return jt.warn("Edge doesn't support data channels yet"),!1;return void 0!==e&&null!==e&&!0===e.data})(n)&&!o.dataChannel[jt.dataChanDefaultLabel]&&(jt.log("Creating default data channel"),D(e,jt.dataChanDefaultLabel,null,!1),o.pc.ondatachannel=function(t){jt.log("Data channel created by Janus:",t),D(e,t.channel.label,t.channel.protocol,t.channel)}),o.myStream&&r.onlocalstream(o.myStream),t?o.pc.setRemoteDescription(t).then((function(){if(jt.log("Remote description accepted!"),o.remoteSdp=t.sdp,o.candidates&&o.candidates.length>0){for(var i=0;i<o.candidates.length;i++){var r=o.candidates[i];jt.debug("Adding remote candidate:",r),r&&!0!==r.completed?o.pc.addIceCandidate(r):o.pc.addIceCandidate(jt.endOfCandidates)}o.candidates=[]}!function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:jt.noop,n.error="function"==typeof n.error?n.error:jt.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:jt.noop;var a=E[e];if(!a||!a.webrtcStuff)return jt.warn("Invalid handle"),void n.error("Invalid handle");var i=a.webrtcStuff,r=!0===n.simulcast;r?jt.log("Creating answer (iceDone="+i.iceDone+", simulcast="+r+")"):jt.log("Creating answer (iceDone="+i.iceDone+")");var o=null;if(jt.unifiedPlan){o={};var s=null,l=null,c=i.pc.getTransceivers();if(c&&c.length>0){var u=!0,d=!1,m=void 0;try{for(var f,h=c[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var g=f.value;g.sender&&g.sender.track&&"audio"===g.sender.track.kind||g.receiver&&g.receiver.track&&"audio"===g.receiver.track.kind?s||(s=g):(g.sender&&g.sender.track&&"video"===g.sender.track.kind||g.receiver&&g.receiver.track&&"video"===g.receiver.track.kind)&&(l||(l=g))}}catch(V){d=!0,m=V}finally{try{u||null==h.return||h.return()}finally{if(d)throw m}}}var v=$(t),p=G(t);if(v||p){if(v&&p){if(s)try{s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",jt.log("Setting audio transceiver to sendrecv:",s)}catch(j){jt.error(j)}}else if(v&&!p)try{s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",jt.log("Setting audio transceiver to sendonly:",s))}catch(j){jt.error(j)}else if(!v&&p)if(s)try{s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",jt.log("Setting audio transceiver to recvonly:",s)}catch(j){jt.error(j)}else s=i.pc.addTransceiver("audio",{direction:"recvonly"}),jt.log("Adding recvonly audio transceiver:",s)}else if(t.removeAudio&&s)try{s.setDirection?s.setDirection("inactive"):s.direction="inactive",jt.log("Setting audio transceiver to inactive:",s)}catch(j){jt.error(j)}var y=J(t),k=K(t);if(y||k){if(y&&k){if(l)try{l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",jt.log("Setting video transceiver to sendrecv:",l)}catch(j){jt.error(j)}}else if(y&&!k){if(l)try{l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",jt.log("Setting video transceiver to sendonly:",l)}catch(j){jt.error(j)}}else if(!y&&k)if(l)try{l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",jt.log("Setting video transceiver to recvonly:",l)}catch(j){jt.error(j)}else l=i.pc.addTransceiver("video",{direction:"recvonly"}),jt.log("Adding recvonly video transceiver:",l)}else if(t.removeVideo&&l)try{l.setDirection?l.setDirection("inactive"):l.direction="inactive",jt.log("Setting video transceiver to inactive:",l)}catch(j){jt.error(j)}}else o="firefox"===jt.webRTCAdapter.browserDetails.browser||"edge"===jt.webRTCAdapter.browserDetails.browser?{offerToReceiveAudio:G(t),offerToReceiveVideo:K(t)}:{mandatory:{OfferToReceiveAudio:G(t),OfferToReceiveVideo:K(t)}};jt.debug(o);var w=J(t);if(w&&r&&"firefox"===jt.webRTCAdapter.browserDetails.browser){jt.log("Enabling Simulcasting for Firefox (RID)");var S=i.pc.getSenders()[1];jt.log(S);var C=S.getParameters();jt.log(C);var O=b(n.simulcastMaxBitrates);S.setParameters({encodings:[{rid:"high",active:!0,priority:"high",maxBitrate:O.high},{rid:"medium",active:!0,priority:"medium",maxBitrate:O.medium},{rid:"low",active:!0,priority:"low",maxBitrate:O.low}]})}i.pc.createAnswer(o).then((function(e){jt.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,jt.log("Setting local description"),w&&r&&("chrome"===jt.webRTCAdapter.browserDetails.browser?jt.warn("simulcast=true, but this is an answer, and video breaks in Chrome if we enable it"):"firefox"!==jt.webRTCAdapter.browserDetails.browser&&jt.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),i.mySdp=e.sdp,i.pc.setLocalDescription(e).catch(n.error),i.mediaConstraints=o,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e.e2ee=!0),n.success(e)):jt.log("Waiting for all candidates...")}),n.error)}(e,n,a)}),a.error):function(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:jt.noop,n.error="function"==typeof n.error?n.error:jt.noop,n.customizeSdp="function"==typeof n.customizeSdp?n.customizeSdp:jt.noop;var a=E[e];if(!a||!a.webrtcStuff)return jt.warn("Invalid handle"),void n.error("Invalid handle");var i=a.webrtcStuff,r=!0===n.simulcast;r?jt.log("Creating offer (iceDone="+i.iceDone+", simulcast="+r+")"):jt.log("Creating offer (iceDone="+i.iceDone+")");var o={};if(jt.unifiedPlan){var s=null,l=null,c=i.pc.getTransceivers();if(c&&c.length>0){var u=!0,d=!1,m=void 0;try{for(var f,h=c[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var g=f.value;g.sender&&g.sender.track&&"audio"===g.sender.track.kind||g.receiver&&g.receiver.track&&"audio"===g.receiver.track.kind?s||(s=g):(g.sender&&g.sender.track&&"video"===g.sender.track.kind||g.receiver&&g.receiver.track&&"video"===g.receiver.track.kind)&&(l||(l=g))}}catch(V){d=!0,m=V}finally{try{u||null==h.return||h.return()}finally{if(d)throw m}}}var v=$(t),p=G(t);v||p?v&&p?s&&(s.setDirection?s.setDirection("sendrecv"):s.direction="sendrecv",jt.log("Setting audio transceiver to sendrecv:",s)):v&&!p?s&&(s.setDirection?s.setDirection("sendonly"):s.direction="sendonly",jt.log("Setting audio transceiver to sendonly:",s)):!v&&p&&(s?(s.setDirection?s.setDirection("recvonly"):s.direction="recvonly",jt.log("Setting audio transceiver to recvonly:",s)):(s=i.pc.addTransceiver("audio",{direction:"recvonly"}),jt.log("Adding recvonly audio transceiver:",s))):t.removeAudio&&s&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive",jt.log("Setting audio transceiver to inactive:",s));var y=J(t),k=K(t);y||k?y&&k?l&&(l.setDirection?l.setDirection("sendrecv"):l.direction="sendrecv",jt.log("Setting video transceiver to sendrecv:",l)):y&&!k?l&&(l.setDirection?l.setDirection("sendonly"):l.direction="sendonly",jt.log("Setting video transceiver to sendonly:",l)):!y&&k&&(l?(l.setDirection?l.setDirection("recvonly"):l.direction="recvonly",jt.log("Setting video transceiver to recvonly:",l)):(l=i.pc.addTransceiver("video",{direction:"recvonly"}),jt.log("Adding recvonly video transceiver:",l))):t.removeVideo&&l&&(l.setDirection?l.setDirection("inactive"):l.direction="inactive",jt.log("Setting video transceiver to inactive:",l))}else o.offerToReceiveAudio=G(t),o.offerToReceiveVideo=K(t);!0===n.iceRestart&&(o.iceRestart=!0);jt.debug(o);var w=J(t);if(w&&r&&"firefox"===jt.webRTCAdapter.browserDetails.browser){jt.log("Enabling Simulcasting for Firefox (RID)");var S=i.pc.getSenders().find((function(e){return"video"===e.track.kind}));if(S){var C=S.getParameters();C||(C={});var O=b(n.simulcastMaxBitrates);C.encodings=[{rid:"h",active:!0,maxBitrate:O.high},{rid:"m",active:!0,maxBitrate:O.medium,scaleResolutionDownBy:2},{rid:"l",active:!0,maxBitrate:O.low,scaleResolutionDownBy:4}],S.setParameters(C)}}i.pc.createOffer(o).then((function(e){jt.debug(e);var t={type:e.type,sdp:e.sdp};n.customizeSdp(t),e.sdp=t.sdp,jt.log("Setting local description"),w&&r&&("chrome"===jt.webRTCAdapter.browserDetails.browser||"safari"===jt.webRTCAdapter.browserDetails.browser?(jt.log("Enabling Simulcasting for Chrome (SDP munging)"),e.sdp=function(e){for(var t=e.split("\r\n"),n=!1,a=[-1],i=[-1],r=null,o=null,s=null,l=null,c=-1,u=0;u<t.length;u++){if(m=t[u].match(/m=(\w+) */)){if("video"===m[1]){if(!(a[0]<0)){c=u;break}n=!0}else if(a[0]>-1){c=u;break}}else if(n){var d=t[u].match(/a=ssrc-group:FID (\d+) (\d+)/);if(d)a[0]=d[1],i[0]=d[2],t.splice(u,1),u--;else{if(a[0]){if((h=t[u].match("a=ssrc:"+a[0]+" cname:(.+)"))&&(r=h[1]),(h=t[u].match("a=ssrc:"+a[0]+" msid:(.+)"))&&(o=h[1]),(h=t[u].match("a=ssrc:"+a[0]+" mslabel:(.+)"))&&(s=h[1]),(h=t[u].match("a=ssrc:"+a[0]+" label:(.+)"))&&(l=h[1]),0===t[u].indexOf("a=ssrc:"+i[0])){t.splice(u,1),u--;continue}if(0===t[u].indexOf("a=ssrc:"+a[0])){t.splice(u,1),u--;continue}}0!=t[u].length||(t.splice(u,1),u--)}}}if(a[0]<0){c=-1,n=!1;for(u=0;u<t.length;u++){var m;if(m=t[u].match(/m=(\w+) */)){if("video"===m[1]){if(!(a[0]<0)){c=u;break}n=!0}else if(a[0]>-1){c=u;break}}else if(n){if(a[0]<0){var f=t[u].match(/a=ssrc:(\d+)/);if(f){a[0]=f[1],t.splice(u,1),u--;continue}}else{var h;if((h=t[u].match("a=ssrc:"+a[0]+" cname:(.+)"))&&(r=h[1]),(h=t[u].match("a=ssrc:"+a[0]+" msid:(.+)"))&&(o=h[1]),(h=t[u].match("a=ssrc:"+a[0]+" mslabel:(.+)"))&&(s=h[1]),(h=t[u].match("a=ssrc:"+a[0]+" label:(.+)"))&&(l=h[1]),0===t[u].indexOf("a=ssrc:"+i[0])){t.splice(u,1),u--;continue}if(0===t[u].indexOf("a=ssrc:"+a[0])){t.splice(u,1),u--;continue}}0!==t[u].length||(t.splice(u,1),u--)}}}if(a[0]<0)return jt.warn("Couldn't find the video SSRC, simulcasting NOT enabled"),e;c<0&&(c=t.length);a[1]=Math.floor(4294967295*Math.random()),a[2]=Math.floor(4294967295*Math.random()),i[1]=Math.floor(4294967295*Math.random()),i[2]=Math.floor(4294967295*Math.random());for(u=0;u<a.length;u++)r&&(t.splice(c,0,"a=ssrc:"+a[u]+" cname:"+r),c++),o&&(t.splice(c,0,"a=ssrc:"+a[u]+" msid:"+o),c++),s&&(t.splice(c,0,"a=ssrc:"+a[u]+" mslabel:"+s),c++),l&&(t.splice(c,0,"a=ssrc:"+a[u]+" label:"+l),c++),r&&(t.splice(c,0,"a=ssrc:"+i[u]+" cname:"+r),c++),o&&(t.splice(c,0,"a=ssrc:"+i[u]+" msid:"+o),c++),s&&(t.splice(c,0,"a=ssrc:"+i[u]+" mslabel:"+s),c++),l&&(t.splice(c,0,"a=ssrc:"+i[u]+" label:"+l),c++);t.splice(c,0,"a=ssrc-group:FID "+a[2]+" "+i[2]),t.splice(c,0,"a=ssrc-group:FID "+a[1]+" "+i[1]),t.splice(c,0,"a=ssrc-group:FID "+a[0]+" "+i[0]),t.splice(c,0,"a=ssrc-group:SIM "+a[0]+" "+a[1]+" "+a[2]),(e=t.join("\r\n")).endsWith("\r\n")||(e+="\r\n");return e}(e.sdp)):"firefox"!==jt.webRTCAdapter.browserDetails.browser&&jt.warn("simulcast=true, but this is not Chrome nor Firefox, ignoring")),i.mySdp=e.sdp,i.pc.setLocalDescription(e).catch(n.error),i.mediaConstraints=o,i.iceDone||i.trickle?((i.senderTransforms||i.receiverTransforms)&&(e.e2ee=!0),n.success(e)):jt.log("Waiting for all candidates...")}),n.error)}(e,n,a)}function M(e,t,n){(n=n||{}).success="function"==typeof n.success?n.success:jt.noop,n.error="function"==typeof n.error?n.error:B;var a=n.jsep;if(t&&a)return jt.error("Provided a JSEP to a createOffer"),void n.error("Provided a JSEP to a createOffer");if(!t&&(!a||!a.type||!a.sdp))return jt.error("A valid JSEP is required for createAnswer"),void n.error("A valid JSEP is required for createAnswer");n.media="object"===typeof n.media&&n.media?n.media:{audio:!0,video:!0};var i=n.media,r=E[e];if(!r||!r.webrtcStuff)return jt.warn("Invalid handle"),void n.error("Invalid handle");var o,s=r.webrtcStuff;if(s.trickle=(o=n.trickle,jt.debug("isTrickleEnabled:",o),!1!==o),s.pc){if(jt.log("Updating existing media session"),i.update=!0,n.stream)n.stream!==s.myStream&&jt.log("Renegotiation involves a new external stream");else{if(i.addAudio){if(i.keepAudio=!1,i.replaceAudio=!1,i.removeAudio=!1,i.audioSend=!0,s.myStream&&s.myStream.getAudioTracks()&&s.myStream.getAudioTracks().length)return jt.error("Can't add audio stream, there already is one"),void n.error("Can't add audio stream, there already is one")}else i.removeAudio?(i.keepAudio=!1,i.replaceAudio=!1,i.addAudio=!1,i.audioSend=!1):i.replaceAudio&&(i.keepAudio=!1,i.addAudio=!1,i.removeAudio=!1,i.audioSend=!0);if(s.myStream&&s.myStream.getAudioTracks()&&0!==s.myStream.getAudioTracks().length?!$(i)||i.removeAudio||i.replaceAudio||(i.keepAudio=!0):(i.replaceAudio&&(i.keepAudio=!1,i.replaceAudio=!1,i.addAudio=!0,i.audioSend=!0),$(i)&&(i.keepAudio=!1,i.addAudio=!0)),i.addVideo){if(i.keepVideo=!1,i.replaceVideo=!1,i.removeVideo=!1,i.videoSend=!0,s.myStream&&s.myStream.getVideoTracks()&&s.myStream.getVideoTracks().length)return jt.error("Can't add video stream, there already is one"),void n.error("Can't add video stream, there already is one")}else i.removeVideo?(i.keepVideo=!1,i.replaceVideo=!1,i.addVideo=!1,i.videoSend=!1):i.replaceVideo&&(i.keepVideo=!1,i.addVideo=!1,i.removeVideo=!1,i.videoSend=!0);s.myStream&&s.myStream.getVideoTracks()&&0!==s.myStream.getVideoTracks().length?!J(i)||i.removeVideo||i.replaceVideo||(i.keepVideo=!0):(i.replaceVideo&&(i.keepVideo=!1,i.replaceVideo=!1,i.addVideo=!0,i.videoSend=!0),J(i)&&(i.keepVideo=!1,i.addVideo=!0)),i.addData&&(i.data=!0)}if($(i)&&i.keepAudio&&J(i)&&i.keepVideo)return r.consentDialog(!1),void N(e,a,i,n,s.myStream)}else i.update=!1,i.keepAudio=!1,i.keepVideo=!1;if(i.update&&!s.streamExternal){if(i.removeAudio||i.replaceAudio){if(s.myStream&&s.myStream.getAudioTracks()&&s.myStream.getAudioTracks().length){var l=s.myStream.getAudioTracks()[0];jt.log("Removing audio track:",l),s.myStream.removeTrack(l);try{l.stop()}catch(H){}}if(s.pc.getSenders()&&s.pc.getSenders().length){var c=!0;if(i.replaceAudio&&jt.unifiedPlan&&(c=!1),c){var u=!0,d=!1,m=void 0;try{for(var f,h=s.pc.getSenders()[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var g=f.value;g&&g.track&&"audio"===g.track.kind&&(jt.log("Removing audio sender:",g),s.pc.removeTrack(g))}}catch(X){d=!0,m=X}finally{try{u||null==h.return||h.return()}finally{if(d)throw m}}}}}if(i.removeVideo||i.replaceVideo){if(s.myStream&&s.myStream.getVideoTracks()&&s.myStream.getVideoTracks().length){var v=s.myStream.getVideoTracks()[0];jt.log("Removing video track:",v),s.myStream.removeTrack(v);try{v.stop()}catch(H){}}if(s.pc.getSenders()&&s.pc.getSenders().length){var p=!0;if(i.replaceVideo&&jt.unifiedPlan&&(p=!1),p){var b=!0,y=!1,k=void 0;try{for(var w,S=s.pc.getSenders()[Symbol.iterator]();!(b=(w=S.next()).done);b=!0){var C=w.value;C&&C.track&&"video"===C.track.kind&&(jt.log("Removing video sender:",C),s.pc.removeTrack(C))}}catch(X){y=!0,k=X}finally{try{b||null==S.return||S.return()}finally{if(y)throw k}}}}}}if(n.stream){var O=n.stream;if(jt.log("MediaStream provided by the application"),jt.debug(O),i.update&&s.myStream&&s.myStream!==n.stream&&!s.streamExternal){try{var j=s.myStream.getTracks(),I=!0,_=!1,T=void 0;try{for(var A,D=j[Symbol.iterator]();!(I=(A=D.next()).done);I=!0){var L=A.value;jt.log(L),L&&L.stop()}}catch(X){_=!0,T=X}finally{try{I||null==D.return||D.return()}finally{if(_)throw T}}}catch(H){}s.myStream=null}return s.streamExternal=!0,r.consentDialog(!1),void N(e,a,i,n,O)}if($(i)||J(i)){if(!jt.isGetUserMediaAvailable())return void n.error("getUserMedia not available");var x={mandatory:{},optional:[]};r.consentDialog(!0);var V=$(i);V&&i&&"object"===typeof i.audio&&(V=i.audio);var M=J(i);if(M&&i){var R=!0===n.simulcast,P=!0===n.simulcast2;if(!R&&!P||a||i.video||(i.video="hires"),i.video&&"screen"!=i.video&&"window"!=i.video)if("object"===typeof i.video)M=i.video;else{var W=0,F=0;"lowres"===i.video?(F=240,240,W=320):"lowres-16:9"===i.video?(F=180,180,W=320):"hires"===i.video||"hires-16:9"===i.video||"hdres"===i.video?(F=720,720,W=1280):"fhdres"===i.video?(F=1080,1080,W=1920):"4kres"===i.video?(F=2160,2160,W=3840):"stdres"===i.video?(F=480,480,W=640):"stdres-16:9"===i.video?(F=360,360,W=640):(jt.log("Default video setting is stdres 4:3"),F=480,480,W=640),jt.log("Adding media constraint:",i.video),M={height:{ideal:F},width:{ideal:W}},jt.log("Adding video constraint:",M)}else if("screen"===i.video||"window"===i.video){var U=function(t,o){r.consentDialog(!1),t?n.error(t):N(e,a,i,n,o)},q=function(e,t,n){jt.log("Adding media constraint (screen capture)"),jt.debug(e),navigator.mediaDevices.getUserMedia(e).then((function(e){n?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(n){e.addTrack(n.getAudioTracks()[0]),t(null,e)})):t(null,e)})).catch((function(e){r.consentDialog(!1),t(e)}))};if(navigator.mediaDevices&&navigator.mediaDevices.getDisplayMedia)return x.video={},i.screenshareFrameRate&&(x.video.frameRate=i.screenshareFrameRate),i.screenshareHeight&&(x.video.height=i.screenshareHeight),i.screenshareWidth&&(x.video.width=i.screenshareWidth),x.audio=i.captureDesktopAudio,void navigator.mediaDevices.getDisplayMedia(x).then((function(t){r.consentDialog(!1),$(i)&&!i.keepAudio?navigator.mediaDevices.getUserMedia({audio:!0,video:!1}).then((function(r){t.addTrack(r.getAudioTracks()[0]),N(e,a,i,n,t)})):N(e,a,i,n,t)}),(function(e){r.consentDialog(!1),n.error(e)}));if("chrome"===jt.webRTCAdapter.browserDetails.browser){var G=jt.webRTCAdapter.browserDetails.version,K=33;window.navigator.userAgent.match("Linux")&&(K=35),G>=26&&G<=K?(x={video:{mandatory:{googLeakyBucket:!0,maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:i.screenshareFrameRate,maxFrameRate:i.screenshareFrameRate,chromeMediaSource:"screen"}},audio:$(i)&&!i.keepAudio},q(x,U)):jt.extension.getScreen((function(e,t){if(e)return r.consentDialog(!1),n.error(e);(x={audio:!1,video:{mandatory:{chromeMediaSource:"desktop",maxWidth:window.screen.width,maxHeight:window.screen.height,minFrameRate:i.screenshareFrameRate,maxFrameRate:i.screenshareFrameRate},optional:[{googLeakyBucket:!0},{googTemporalLayeredScreencast:!0}]}}).video.mandatory.chromeMediaSourceId=t,q(x,U,$(i)&&!i.keepAudio)}))}else if("firefox"===jt.webRTCAdapter.browserDetails.browser){if(!(jt.webRTCAdapter.browserDetails.version>=33)){var z=new Error("NavigatorUserMediaError");return z.name="Your version of Firefox does not support screen sharing, please install Firefox 33 (or more recent versions)",r.consentDialog(!1),void n.error(z)}x={video:{mozMediaSource:i.video,mediaSource:i.video},audio:$(i)&&!i.keepAudio},q(x,(function(e,t){if(U(e,t),!e)var n=t.currentTime,a=window.setInterval((function(){t||window.clearInterval(a),t.currentTime==n&&(window.clearInterval(a),t.onended&&t.onended()),n=t.currentTime}),500)}))}return}}i&&"screen"===i.video||navigator.mediaDevices.enumerateDevices().then((function(t){var o=t.some((function(e){return"audioinput"===e.kind})),s=function(e){if(jt.debug("isScreenSendEnabled:",e),!e)return!1;if("object"!==typeof e.video||"object"!==typeof e.video.mandatory)return!1;var t=e.video.mandatory;if(t.chromeMediaSource)return"desktop"===t.chromeMediaSource||"screen"===t.chromeMediaSource;if(t.mozMediaSource)return"window"===t.mozMediaSource||"screen"===t.mozMediaSource;if(t.mediaSource)return"window"===t.mediaSource||"screen"===t.mediaSource;return!1}(i)||t.some((function(e){return"videoinput"===e.kind})),l=$(i),c=J(i),u=function(e){return jt.debug("isAudioSendRequired:",e),!!e&&(!1!==e.audio&&!1!==e.audioSend&&(void 0!==e.failIfNoAudio&&null!==e.failIfNoAudio&&!0===e.failIfNoAudio))}(i),d=function(e){return jt.debug("isVideoSendRequired:",e),!!e&&(!1!==e.video&&!1!==e.videoSend&&(void 0!==e.failIfNoVideo&&null!==e.failIfNoVideo&&!0===e.failIfNoVideo))}(i);if(l||c||u||d){var m=!!l&&o,f=!!c&&s;if(!m&&!f)return r.consentDialog(!1),n.error("No capture device found"),!1;if(!m&&u)return r.consentDialog(!1),n.error("Audio capture is required, but no capture device found"),!1;if(!f&&d)return r.consentDialog(!1),n.error("Video capture is required, but no capture device found"),!1}var h={audio:!(!o||i.keepAudio)&&V,video:!(!s||i.keepVideo)&&M};jt.debug("getUserMedia constraints",h),h.audio||h.video?navigator.mediaDevices.getUserMedia(h).then((function(t){r.consentDialog(!1),N(e,a,i,n,t)})).catch((function(e){r.consentDialog(!1),n.error({code:e.code,name:e.name,message:e.message})})):(r.consentDialog(!1),N(e,a,i,n,O))})).catch((function(e){r.consentDialog(!1),n.error("enumerateDevices error",e)}))}else N(e,a,i,n)}function R(e,t){(t=t||{}).success="function"==typeof t.success?t.success:jt.noop,t.error="function"==typeof t.error?t.error:B;var n=t.jsep,a=E[e];if(!a||!a.webrtcStuff)return jt.warn("Invalid handle"),void t.error("Invalid handle");var i=a.webrtcStuff;if(n){if(!i.pc)return jt.warn("Wait, no PeerConnection?? if this is an answer, use createAnswer and not handleRemoteJsep"),void t.error("No PeerConnection: if this is an answer, use createAnswer and not handleRemoteJsep");i.pc.setRemoteDescription(n).then((function(){if(jt.log("Remote description accepted!"),i.remoteSdp=n.sdp,i.candidates&&i.candidates.length>0){for(var e=0;e<i.candidates.length;e++){var a=i.candidates[e];jt.debug("Adding remote candidate:",a),a&&!0!==a.completed?i.pc.addIceCandidate(a):i.pc.addIceCandidate(jt.endOfCandidates)}i.candidates=[]}t.success()}),t.error)}else t.error("Invalid JSEP")}function P(e,t){var n=E[e];if(!n||!n.webrtcStuff)return jt.warn("Invalid handle"),0;var a=t?"remote":"local",i=n.webrtcStuff;return i.volume[a]||(i.volume[a]={value:0}),!i.pc.getStats||"chrome"!==jt.webRTCAdapter.browserDetails.browser&&"safari"!==jt.webRTCAdapter.browserDetails.browser?(jt.warn("Getting the "+a+" volume unsupported by browser"),0):t&&!i.remoteStream?(jt.warn("Remote stream unavailable"),0):t||i.myStream?i.volume[a].timer?i.volume[a].value:(jt.log("Starting "+a+" volume monitor"),i.volume[a].timer=setInterval((function(){i.pc.getStats().then((function(e){e.forEach((function(e){e&&"audio"===e.kind&&(t&&!e.remoteSource||!t&&"media-source"!==e.type||(i.volume[a].value=e.audioLevel?e.audioLevel:0))}))}))}),200),0):(jt.warn("Local stream unavailable"),0)}function W(e,t){var n=E[e];if(!n||!n.webrtcStuff)return jt.warn("Invalid handle"),!0;var a=n.webrtcStuff;return a.pc?a.myStream?t?a.myStream.getVideoTracks()&&0!==a.myStream.getVideoTracks().length?!a.myStream.getVideoTracks()[0].enabled:(jt.warn("No video track"),!0):a.myStream.getAudioTracks()&&0!==a.myStream.getAudioTracks().length?!a.myStream.getAudioTracks()[0].enabled:(jt.warn("No audio track"),!0):(jt.warn("Invalid local MediaStream"),!0):(jt.warn("Invalid PeerConnection"),!0)}function F(e,t,n){var a=E[e];if(!a||!a.webrtcStuff)return jt.warn("Invalid handle"),!1;var i=a.webrtcStuff;return i.pc?i.myStream?t?i.myStream.getVideoTracks()&&0!==i.myStream.getVideoTracks().length?(i.myStream.getVideoTracks()[0].enabled=!n,!0):(jt.warn("No video track"),!1):i.myStream.getAudioTracks()&&0!==i.myStream.getAudioTracks().length?(i.myStream.getAudioTracks()[0].enabled=!n,!0):(jt.warn("No audio track"),!1):(jt.warn("Invalid local MediaStream"),!1):(jt.warn("Invalid PeerConnection"),!1)}function U(e){var t=E[e];if(!t||!t.webrtcStuff)return jt.warn("Invalid handle"),"Invalid handle";var n=t.webrtcStuff;return n.pc?n.pc.getStats?n.bitrate.timer?n.bitrate.value:(jt.log("Starting bitrate timer (via getStats)"),n.bitrate.timer=setInterval((function(){n.pc.getStats().then((function(e){e.forEach((function(e){if(e){var t=!1;if(("video"===e.mediaType||e.id.toLowerCase().indexOf("video")>-1)&&"inbound-rtp"===e.type&&e.id.indexOf("rtcp")<0?t=!0:"ssrc"!=e.type||!e.bytesReceived||"VP8"!==e.googCodecName&&""!==e.googCodecName||(t=!0),t)if(n.bitrate.bsnow=e.bytesReceived,n.bitrate.tsnow=e.timestamp,null===n.bitrate.bsbefore||null===n.bitrate.tsbefore)n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow;else{var a=n.bitrate.tsnow-n.bitrate.tsbefore;"safari"===jt.webRTCAdapter.browserDetails.browser&&(a/=1e3);var i=Math.round(8*(n.bitrate.bsnow-n.bitrate.bsbefore)/a);"safari"===jt.webRTCAdapter.browserDetails.browser&&(i=parseInt(i/1e3)),n.bitrate.value=i+" kbits/sec",n.bitrate.bsbefore=n.bitrate.bsnow,n.bitrate.tsbefore=n.bitrate.tsnow}}}))}))}),1e3),"0 kbits/sec"):(jt.warn("Getting the video bitrate unsupported by browser"),"Feature unsupported by browser"):"Invalid PeerConnection"}function B(e){jt.error("WebRTC error:",e)}function q(e,a){jt.log("Cleaning WebRTC stuff");var i=E[e];if(i){var r=i.webrtcStuff;if(r){if(!0===a){var o={janus:"hangup",transaction:jt.randomString(12)};i.token&&(o.token=i.token),g&&(o.apisecret=g),jt.debug("Sending hangup request (handle="+e+"):"),jt.debug(o),t?(o.session_id=k,o.handle_id=e,n.send(JSON.stringify(o))):jt.httpAPICall(s+"/"+k+"/"+e,{verb:"POST",withCredentials:m,body:o})}r.remoteStream=null,r.volume&&(r.volume.local&&r.volume.local.timer&&clearInterval(r.volume.local.timer),r.volume.remote&&r.volume.remote.timer&&clearInterval(r.volume.remote.timer)),r.volume={},r.bitrate.timer&&clearInterval(r.bitrate.timer),r.bitrate.timer=null,r.bitrate.bsnow=null,r.bitrate.bsbefore=null,r.bitrate.tsnow=null,r.bitrate.tsbefore=null,r.bitrate.value=null;try{if(!r.streamExternal&&r.myStream){jt.log("Stopping local stream tracks");var l=r.myStream.getTracks(),c=!0,u=!1,d=void 0;try{for(var f,h=l[Symbol.iterator]();!(c=(f=h.next()).done);c=!0){var v=f.value;jt.log(v),v&&v.stop()}}catch(p){u=!0,d=p}finally{try{c||null==h.return||h.return()}finally{if(u)throw d}}}}catch(b){}r.streamExternal=!1,r.myStream=null;try{r.pc.close()}catch(b){}r.pc=null,r.candidates=null,r.mySdp=null,r.remoteSdp=null,r.iceDone=!1,r.dataChannel={},r.dtmfSender=null,r.senderTransforms=null,r.receiverTransforms=null}i.oncleanup()}}function $(e){return jt.debug("isAudioSendEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioSend||null===e.audioSend||!0===e.audioSend)}function G(e){return jt.debug("isAudioRecvEnabled:",e),!e||!1!==e.audio&&(void 0===e.audioRecv||null===e.audioRecv||!0===e.audioRecv)}function J(e){return jt.debug("isVideoSendEnabled:",e),!e||!1!==e.video&&(void 0===e.videoSend||null===e.videoSend||!0===e.videoSend)}function K(e){return jt.debug("isVideoRecvEnabled:",e),!e||!1!==e.video&&(void 0===e.videoRecv||null===e.videoRecv||!0===e.videoRecv)}_(e),this.getServer=function(){return s},this.isConnected=function(){return y},this.reconnect=function(e){(e=e||{}).success="function"==typeof e.success?e.success:jt.noop,e.error="function"==typeof e.error?e.error:jt.noop,e.reconnect=!0,_(e)},this.getSessionId=function(){return k},this.destroy=function(r){!function(r){(r=r||{}).success="function"==typeof r.success?r.success:jt.noop,r.error="function"==typeof r.error?r.error:jt.noop;var o=!0===r.unload,l=!0;void 0!==r.notifyDestroyed&&null!==r.notifyDestroyed&&(l=!0===r.notifyDestroyed);var c=!0===r.cleanupHandles;if(jt.log("Destroying session "+k+" (unload="+o+")"),!k)return jt.warn("No session to destroy"),r.success(),void(l&&e.destroyed());if(c)for(var u in E)V(u,{noRequest:!0});if(!y)return jt.warn("Is the server down? (connected=false)"),k=null,void r.success();var d={janus:"destroy",transaction:jt.randomString(12)};h&&(d.token=h);g&&(d.apisecret=g);if(o)return t?(n.onclose=null,n.close(),n=null):navigator.sendBeacon(s+"/"+k,JSON.stringify(d)),jt.log("Destroyed session:"),k=null,y=!1,r.success(),void(l&&e.destroyed());if(t){d.session_id=k;var f=function(){for(var e in a)n.removeEventListener(e,a[e]);n.removeEventListener("message",v),n.removeEventListener("error",p),i&&clearTimeout(i),n.close()},v=function(t){var n=JSON.parse(t.data);n.session_id==d.session_id&&n.transaction==d.transaction&&(f(),r.success(),l&&e.destroyed())},p=function(t){f(),r.error("Failed to destroy the server: Is the server down?"),l&&e.destroyed()};return n.addEventListener("message",v),n.addEventListener("error",p),void n.send(JSON.stringify(d))}jt.httpAPICall(s+"/"+k,{verb:"POST",withCredentials:m,body:d,success:function(t){jt.log("Destroyed session:"),jt.debug(t),k=null,y=!1,"success"!==t.janus&&jt.error("Ooops: "+t.error.code+" "+t.error.reason),r.success(),l&&e.destroyed()},error:function(t,n){jt.error(t+":",n),k=null,y=!1,r.success(),l&&e.destroyed()}})}(r)},this.attach=function(e){!function(e){if((e=e||{}).success="function"==typeof e.success?e.success:jt.noop,e.error="function"==typeof e.error?e.error:jt.noop,e.consentDialog="function"==typeof e.consentDialog?e.consentDialog:jt.noop,e.iceState="function"==typeof e.iceState?e.iceState:jt.noop,e.mediaState="function"==typeof e.mediaState?e.mediaState:jt.noop,e.webrtcState="function"==typeof e.webrtcState?e.webrtcState:jt.noop,e.slowLink="function"==typeof e.slowLink?e.slowLink:jt.noop,e.onmessage="function"==typeof e.onmessage?e.onmessage:jt.noop,e.onlocalstream="function"==typeof e.onlocalstream?e.onlocalstream:jt.noop,e.onremotestream="function"==typeof e.onremotestream?e.onremotestream:jt.noop,e.ondata="function"==typeof e.ondata?e.ondata:jt.noop,e.ondataopen="function"==typeof e.ondataopen?e.ondataopen:jt.noop,e.oncleanup="function"==typeof e.oncleanup?e.oncleanup:jt.noop,e.ondetached="function"==typeof e.ondetached?e.ondetached:jt.noop,!y)return jt.warn("Is the server down? (connected=false)"),void e.error("Is the server down? (connected=false)");var a=e.plugin;if(!a)return jt.error("Invalid plugin"),void e.error("Invalid plugin");var i=e.opaqueId,r=e.token?e.token:h,o=jt.randomString(12),l={janus:"attach",plugin:a,opaque_id:i,transaction:o};r&&(l.token=r);g&&(l.apisecret=g);if(t)return C[o]=function(t){if(jt.debug(t),"success"!==t.janus)return jt.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var n=t.data.id;jt.log("Created handle: "+n);var i={session:w,plugin:a,id:n,token:r,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return a},getVolume:function(){return P(n,!0)},getRemoteVolume:function(){return P(n,!0)},getLocalVolume:function(){return P(n,!1)},isAudioMuted:function(){return W(n,!1)},muteAudio:function(){return F(n,!1,!0)},unmuteAudio:function(){return F(n,!1,!1)},isVideoMuted:function(){return W(n,!0)},muteVideo:function(){return F(n,!0,!0)},unmuteVideo:function(){return F(n,!0,!1)},getBitrate:function(){return U(n)},send:function(e){T(n,e)},data:function(e){L(n,e)},dtmf:function(e){x(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){M(n,!0,e)},createAnswer:function(e){M(n,!1,e)},handleRemoteJsep:function(e){R(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){q(n,!0===e)},detach:function(e){V(n,e)}};E[n]=i,e.success(i)},l.session_id=k,void n.send(JSON.stringify(l));jt.httpAPICall(s+"/"+k,{verb:"POST",withCredentials:m,body:l,success:function(t){if(jt.debug(t),"success"!==t.janus)return jt.error("Ooops: "+t.error.code+" "+t.error.reason),void e.error("Ooops: "+t.error.code+" "+t.error.reason);var n=t.data.id;jt.log("Created handle: "+n);var i={session:w,plugin:a,id:n,token:r,detached:!1,webrtcStuff:{started:!1,myStream:null,streamExternal:!1,remoteStream:null,mySdp:null,mediaConstraints:null,pc:null,dataChannel:{},dtmfSender:null,trickle:!0,iceDone:!1,volume:{value:null,timer:null},bitrate:{value:null,bsnow:null,bsbefore:null,tsnow:null,tsbefore:null,timer:null}},getId:function(){return n},getPlugin:function(){return a},getVolume:function(){return P(n,!0)},getRemoteVolume:function(){return P(n,!0)},getLocalVolume:function(){return P(n,!1)},isAudioMuted:function(){return W(n,!1)},muteAudio:function(){return F(n,!1,!0)},unmuteAudio:function(){return F(n,!1,!1)},isVideoMuted:function(){return W(n,!0)},muteVideo:function(){return F(n,!0,!0)},unmuteVideo:function(){return F(n,!0,!1)},getBitrate:function(){return U(n)},send:function(e){T(n,e)},data:function(e){L(n,e)},dtmf:function(e){x(n,e)},consentDialog:e.consentDialog,iceState:e.iceState,mediaState:e.mediaState,webrtcState:e.webrtcState,slowLink:e.slowLink,onmessage:e.onmessage,createOffer:function(e){M(n,!0,e)},createAnswer:function(e){M(n,!1,e)},handleRemoteJsep:function(e){R(n,e)},onlocalstream:e.onlocalstream,onremotestream:e.onremotestream,ondata:e.ondata,ondataopen:e.ondataopen,oncleanup:e.oncleanup,ondetached:e.ondetached,hangup:function(e){q(n,!0===e)},detach:function(e){V(n,e)}};E[n]=i,e.success(i)},error:function(t,n){jt.error(t+":",n),""===n?e.error(t+": Is the server down?"):e.error(t+": "+n)}})}(e)}}jt.useDefaultDependencies=function(e){var t=e&&e.fetch||fetch,n=e&&e.Promise||Promise,a=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new a(e,t)},extension:e&&e.extension||Ot,isArray:function(e){return Array.isArray(e)},webRTCAdapter:e&&e.adapter||St.a,httpAPICall:function(e,a){var i={method:a.verb,headers:{Accept:"application/json, text/plain, */*"},cache:"no-cache"};"POST"===a.verb&&(i.headers["Content-Type"]="application/json"),void 0!==a.withCredentials&&(i.credentials=!0===a.withCredentials?"include":a.withCredentials?a.withCredentials:"omit"),a.body&&(i.body=JSON.stringify(a.body));var r=t(e,i).catch((function(e){return n.reject({message:"Probably a network error, is the server down?",error:e})}));if(a.timeout){var o=new n((function(e,t){var n=setTimeout((function(){return clearTimeout(n),t({message:"Request timed out",timeout:a.timeout})}),a.timeout)}));r=n.race([r,o])}return r.then((function(e){return e.ok?typeof a.success===typeof jt.noop?e.json().then((function(e){a.success(e)})).catch((function(t){return n.reject({message:"Failed to parse response body",error:t,response:e})})):void 0:n.reject({message:"API call failed",response:e})})).catch((function(e){typeof a.error===typeof jt.noop&&a.error(e.message||"<< internal error >>",e)})),r}}},jt.useOldDependencies=function(e){var t=e&&e.jQuery||wt.a,n=e&&e.WebSocket||WebSocket;return{newWebSocket:function(e,t){return new n(e,t)},isArray:function(e){return t.isArray(e)},extension:e&&e.extension||Ot,webRTCAdapter:e&&e.adapter||St.a,httpAPICall:function(e,n){var a=void 0!==n.body?{contentType:"application/json",data:JSON.stringify(n.body)}:{},i=void 0!==n.withCredentials?{xhrFields:{withCredentials:n.withCredentials}}:{};return t.ajax(t.extend(a,i,{url:e,type:n.verb,cache:!1,dataType:"json",async:n.async,timeout:n.timeout,success:function(e){typeof n.success===typeof jt.noop&&n.success(e)},error:function(e,t,a){typeof n.error===typeof jt.noop&&n.error(t,a)}}))}}},jt.noop=function(){},jt.dataChanDefaultLabel="JanusDataChannel",jt.endOfCandidates=null,jt.init=function(e){if((e=e||{}).callback="function"==typeof e.callback?e.callback:jt.noop,jt.initDone)e.callback();else{if("undefined"!=typeof console&&"undefined"!=typeof console.log||(console={log:function(){}}),jt.trace=jt.noop,jt.debug=jt.noop,jt.vdebug=jt.noop,jt.log=jt.noop,jt.warn=jt.noop,jt.error=jt.noop,!0===e.debug||"all"===e.debug)jt.trace=console.trace.bind(console),jt.debug=console.debug.bind(console),jt.vdebug=console.debug.bind(console),jt.log=console.log.bind(console),jt.warn=console.warn.bind(console),jt.error=console.error.bind(console);else if(Array.isArray(e.debug)){var t=!0,n=!1,a=void 0;try{for(var i,r=e.debug[Symbol.iterator]();!(t=(i=r.next()).done);t=!0){var o=i.value;switch(o){case"trace":jt.trace=console.trace.bind(console);break;case"debug":jt.debug=console.debug.bind(console);break;case"vdebug":jt.vdebug=console.debug.bind(console);break;case"log":jt.log=console.log.bind(console);break;case"warn":jt.warn=console.warn.bind(console);break;case"error":jt.error=console.error.bind(console);break;default:console.error("Unknown debugging option '"+o+"' (supported: 'trace', 'debug', 'vdebug', 'log', warn', 'error')")}}}catch(b){n=!0,a=b}finally{try{t||null==r.return||r.return()}finally{if(n)throw a}}}jt.log("Initializing library");var s=e.dependencies||jt.useDefaultDependencies();jt.isArray=s.isArray,jt.webRTCAdapter=s.webRTCAdapter,jt.httpAPICall=s.httpAPICall,jt.newWebSocket=s.newWebSocket,jt.extension=s.extension,jt.extension.init(),jt.listDevices=function(e,t){e="function"==typeof e?e:jt.noop,null==t&&(t={audio:!0,video:!0}),jt.isGetUserMediaAvailable()?navigator.mediaDevices.getUserMedia(t).then((function(t){navigator.mediaDevices.enumerateDevices().then((function(n){jt.debug(n),e(n);try{var a=t.getTracks(),i=!0,r=!1,o=void 0;try{for(var s,l=a[Symbol.iterator]();!(i=(s=l.next()).done);i=!0){var c=s.value;c&&c.stop()}}catch(b){r=!0,o=b}finally{try{i||null==l.return||l.return()}finally{if(r)throw o}}}catch(u){}}))})).catch((function(t){jt.error(t),e([])})):(jt.warn("navigator.mediaDevices unavailable"),e([]))},jt.attachMediaStream=function(e,t){try{e.srcObject=t}catch(n){try{e.src=URL.createObjectURL(t)}catch(n){jt.error("Error attaching stream to element"),console.log("Error attaching stream to element")}}},jt.reattachMediaStream=function(e,t){try{e.srcObject=t.srcObject}catch(n){try{e.src=t.src}catch(n){jt.error("Error reattaching stream to element")}}};var l=["iPad","iPhone","iPod"].indexOf(navigator.platform)>=0?"pagehide":"beforeunload",c=window["on"+l];if(window.addEventListener(l,(function(e){for(var t in jt.log("Closing window"),jt.sessions)jt.sessions[t]&&jt.sessions[t].destroyOnUnload&&(jt.log("Destroying session "+t),jt.sessions[t].destroy({unload:!0,notifyDestroyed:!1}));c&&"function"==typeof c&&c()})),jt.safariVp8=!1,"safari"===jt.webRTCAdapter.browserDetails.browser&&jt.webRTCAdapter.browserDetails.version>=605)if(RTCRtpSender&&RTCRtpSender.getCapabilities&&RTCRtpSender.getCapabilities("video")&&RTCRtpSender.getCapabilities("video").codecs&&RTCRtpSender.getCapabilities("video").codecs.length){var u=!0,d=!1,m=void 0;try{for(var f,h=RTCRtpSender.getCapabilities("video").codecs[Symbol.iterator]();!(u=(f=h.next()).done);u=!0){var g=f.value;if(g&&g.mimeType&&"video/vp8"===g.mimeType.toLowerCase()){jt.safariVp8=!0;break}}}catch(b){d=!0,m=b}finally{try{u||null==h.return||h.return()}finally{if(d)throw m}}jt.safariVp8?jt.log("This version of Safari supports VP8"):jt.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu")}else{var v=new RTCPeerConnection({});v.createOffer({offerToReceiveVideo:!0}).then((function(e){jt.safariVp8=-1!==e.sdp.indexOf("VP8"),jt.safariVp8?jt.log("This version of Safari supports VP8"):jt.warn("This version of Safari does NOT support VP8: if you're using a Technology Preview, try enabling the 'WebRTC VP8 codec' setting in the 'Experimental Features' Develop menu"),v.close(),v=null}))}if(jt.unifiedPlan=!1,"firefox"===jt.webRTCAdapter.browserDetails.browser&&jt.webRTCAdapter.browserDetails.version>=59)jt.unifiedPlan=!0;else if("chrome"===jt.webRTCAdapter.browserDetails.browser&&jt.webRTCAdapter.browserDetails.version<72)jt.unifiedPlan=!1;else if(window.RTCRtpTransceiver&&"currentDirection"in Ct.prototype){var p=new RTCPeerConnection;try{p.addTransceiver("audio"),jt.unifiedPlan=!0}catch(y){}p.close()}else jt.unifiedPlan=!1;jt.initDone=!0,e.callback()}},jt.isWebrtcSupported=function(){return!!window.RTCPeerConnection},jt.isGetUserMediaAvailable=function(){return navigator.mediaDevices&&navigator.mediaDevices.getUserMedia},jt.randomString=function(e){for(var t="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n="",a=0;a<e;a++){var i=Math.floor(Math.random()*t.length);n+=t.substring(i,i+1)}return n};var It=jt,_t=[{path:"/",component:function(){return r.a.createElement(c.y,{className:"no-swipe-panel"},r.a.createElement(c.x,null,r.a.createElement(c.w,null,r.a.createElement(c.s,{panelOpen:"right"},r.a.createElement(c.r,{f7:"bars"})))),r.a.createElement(c.I,{bottom:!0},r.a.createElement(c.s,null,"Left Link"),r.a.createElement(c.s,null,"Right Link")),r.a.createElement(c.f,{strong:!0},r.a.createElement("p",null)),r.a.createElement(c.g,null),r.a.createElement(c.t,null),r.a.createElement(c.g,null),r.a.createElement(c.f,{strong:!0}),r.a.createElement(c.g,null),r.a.createElement(c.f,{strong:!0}),r.a.createElement(c.t,null),r.a.createElement(c.o,{href:"/document_form/",target:"#main-view",position:"left-bottom",slot:"fixed",color:"orange"},r.a.createElement(c.r,{ios:"f7:add",aurora:"f7:add",md:"material:add"}),r.a.createElement(c.r,{ios:"f7:close",aurora:"f7:close",md:"material:close"})))}},{path:"/login/",component:ht},{path:"/sign_up/",component:pt},{path:"/verification/:email",component:yt},{path:"/login_jwt/:token",component:gt},{path:"/panel-right/",component:b},{path:"/rooms/",component:function(e){function t(){var e;return Object(m.a)(this,t),(e=Object(h.a)(this,Object(g.a)(t).call(this))).getList=e.getList.bind(Object(v.a)(e)),e.sessionCreate=e.sessionCreate.bind(Object(v.a)(e)),e.registerUsername=e.registerUsername.bind(Object(v.a)(e)),e.newRemoteFeed=e.newRemoteFeed.bind(Object(v.a)(e)),e.publishCamera=e.publishCamera.bind(Object(v.a)(e)),e.publishMicrophone=e.publishMicrophone.bind(Object(v.a)(e)),e.off=e.off.bind(Object(v.a)(e)),e.on=e.on.bind(Object(v.a)(e)),e.pageAfterIn=e.pageAfterIn.bind(Object(v.a)(e)),e.streamAttacher=e.streamAttacher.bind(Object(v.a)(e)),e.unmute=e.unmute.bind(Object(v.a)(e)),e.state={token:window.localStorage.getItem("token"),shortners:null,server:O.janusServer,janus:null,sfutest:null,opaqueId:"videoroomtest-"+It.randomString(12),myroom:1234,myusername:null,myid:null,mystream:null,mypvtid:null,feeds:[],bitrateTimer:[],urls:[],publisedCamera:!1,publishedMicrophone:!1,muted:!0},e}return Object(p.a)(t,e),Object(f.a)(t,[{key:"componentWillMount",value:function(){w.on("got_list",this.getList)}},{key:"componentWillUnmount",value:function(){w.removeListener("got_list",this.getList)}},{key:"sessionCreate",value:function(){var e=this;It.init({debug:"none",callback:function(){var t=new It({server:e.state.server,success:function(){t.attach({plugin:"janus.plugin.videoroom",opaqueId:e.state.opaqueId,success:function(n){e.setState({janus:t}),e.setState({sfutest:n}),It.log("Plugin attached! ("+e.state.sfutest.getPlugin()+", id="+e.state.sfutest.getId()+")"),It.log("  -- This is a publisher/manager"),e.registerUsername()},error:function(e){It.error("  -- Error attaching plugin...",e),window.alert("Error attaching plugin... "+e)},consentDialog:function(e){It.debug("Consent dialog should be "+(e?"on":"off")+" now")},iceState:function(e){It.log("ICE state changed to "+e)},mediaState:function(e,t){It.log("Janus "+(t?"started":"stopped")+" receiving our "+e)},webrtcState:function(e){It.log("Janus says our WebRTC PeerConnection is "+(e?"up":"down")+" now")},onmessage:function(t,n){It.log(" ::: Got a message (publisher) :::",t);var a=t.videoroom;if(It.debug("Event: "+a),a)if("joined"===a){if(console.log("joined"),e.setState({myid:t.id,mypvtid:t.private_id}),t.publishers){var i=t.publishers;for(var r in console.log("Got a list of available publishers/feeds:",i),i){var o=i[r].id,s=i[r].display,l=i[r].audio_codec,c=i[r].video_codec;It.debug("  >> ["+o+"] "+s+" (audio: "+l+", video: "+c+")"),e.newRemoteFeed(o,s,l,c)}}}else if("destroyed"===a)It.warn("The room has been destroyed!");else if("event"===a)if(t.publishers){i=t.publishers;for(var r in It.log("Got a list of available publishers/feeds:",i),i){o=i[r].id,s=i[r].display,l=i[r].audio_codec,c=i[r].video_codec;It.log("  >> ["+o+"] "+s+" (audio: "+l+", video: "+c+")"),e.newRemoteFeed(o,s,l,c)}}else if(t.leaving){var u=t.leaving;console.log("Publisher leaving: "+u),e.setState({feeds:e.state.feeds.filter((function(e){return e.rfid!=u}))},(function(){return console.log("feeds: >>>>",e.state.feeds)})),null!=(d=e.state.feeds.filter((function(e){return e.rfid===u})).shift())&&d.detach()}else if(t.unpublished){var d,m=t.unpublished;if(console.log("Publisher left: "+m),"ok"===m)return void e.state.sfutest.hangup();e.setState({feeds:e.state.feeds.filter((function(e){return e.rfid!=m}))}),null!=(d=e.state.feeds.filter((function(e){return e.rfid===m})).shift())&&d.detach()}else t.error;n&&(It.log("Handling SDP as well...",n),e.state.sfutest.handleRemoteJsep({jsep:n}))},onlocalstream:function(t){console.log(" ::: Got a local stream :::",t),console.log(e.state.sfutest),t.active?(e.setState({feeds:e.state.feeds.concat(e.state.sfutest)}),It.attachMediaStream(document.getElementById("video-"+e.state.sfutest.id),t)):e.setState({feeds:e.state.feeds.filter((function(t){return t.id!=e.state.sfutest.id}))})},onremotestream:function(e){It.log(" ::: Got a remote stream :::",e)},oncleanup:function(){It.log(" ::: Got a cleanup notification: we are unpublished now :::")}})},error:function(e){It.error(e),window.alert(e,(function(){window.location.reload()}))},destroyed:function(){window.location.reload()}})}})}},{key:"registerUsername",value:function(){var e={request:"join",room:this.state.myroom,ptype:"publisher",display:"test1"};this.state.sfutest.send({message:e})}},{key:"newRemoteFeed",value:function(e,t,n,a,i){var r=this,o=null;r.state.janus.attach({plugin:"janus.plugin.videoroom",opaqueId:this.state.opaqueId,success:function(t){(o=t).simulcastStarted=!1,It.log("Plugin attached! ("+o.getPlugin()+", id="+o.getId()+")"),It.log("  -- This is a subscriber");var n={request:"join",room:r.state.myroom,ptype:"subscriber",feed:e,private_id:r.state.mypvtid};"safari"!==It.webRTCAdapter.browserDetails.browser||"vp9"!==i&&("vp8"!==i||It.safariVp8)||(i&&(i=i.toUpperCase()),console.log("Publisher is using "+i+", but Safari doesn't support it: disabling video"),n.offer_video=!1),o.videoCodec=i,o.send({message:n})},error:function(e){It.error("  -- Error attaching plugin...",e),window.alert("Error attaching plugin... "+e)},onmessage:function(e,t){It.debug(" ::: Got a message (subscriber) :::",e);var n=e.videoroom;It.log("Event: "+n),e.error?window.alert(e.error):n&&"attached"===n&&(r.setState({feeds:r.state.feeds.concat(o)}),o.rfid=e.id,o.rfdisplay=e.display,It.log("Successfully attached to feed "+o.rfid+" ("+o.rfdisplay+") in room "+e.room)),t&&(It.log("Handling SDP as well...",t),o.createAnswer({jsep:t,media:{audioSend:!1,videoSend:!1},success:function(e){It.log("Got SDP!",e);var t={request:"start",room:r.state.myroom};o.send({message:t,jsep:e})},error:function(e){It.log("WebRTC error:",e),window.alert("WebRTC error... "+e.message)}}))},iceState:function(e){It.log("ICE state of this WebRTC PeerConnection (feed #"+o.rfindex+") changed to "+e)},webrtcState:function(e){It.log("Janus says this WebRTC PeerConnection (feed #"+o.rfindex+") is "+(e?"up":"down")+" now")},onlocalstream:function(e){},onremotestream:function(e){It.attachMediaStream(document.getElementById("video-"+o.id),e)},oncleanup:function(){It.log(" ::: Got a cleanup notification (remote feed "+e+") :::")}})}},{key:"streamAttacher",value:function(e){e.id&&e.webrtcStuff&&e.webrtcStuff.remoteStream&&It.attachMediaStream(document.getElementById("video-"+e.id),e.webrtcStuff.remoteStream)}},{key:"publishCamera",value:function(){var e=this;console.log("camera",!e.state.publisedCamera),e.state.sfutest.createOffer({media:{audioRecv:!1,videoRecv:!1,videoSend:!e.state.publisedCamera,removeVideo:e.state.publisedCamera,audioSend:e.state.publishedMicrophone,video:"lowres"},success:function(t){if(It.debug("********* Got publisher SDP!",t),t){e.state.sfutest.send({message:{request:"configure",audio:!0,video:!0,bitrate:256e3},jsep:t})}e.setState({publisedCamera:!e.state.publisedCamera})},error:function(e){It.error("***** WebRTC error:",e)}})}},{key:"publishMicrophone",value:function(){var e=this;console.log("Microphone",!e.state.publishedMicrophone),e.state.sfutest.createOffer({media:{audioRecv:!1,videoRecv:!1,audioSend:!e.state.publishedMicrophone,removeAudio:e.state.publishedMicrophone,videoSend:e.state.publisedCamera},success:function(t){if(It.debug("********* Got publisher SDP!",t),t){e.state.sfutest.send({message:{request:"configure",audio:!0,video:!0},jsep:t}),e.setState({publishedMicrophone:!e.state.publishedMicrophone})}},error:function(e){It.error("***** WebRTC error:",e)}})}},{key:"off",value:function(){console.log(this.state.feeds);var e={request:"switch",feed:this.state.feeds[1].rfid,video:!1};this.state.feeds[1].send({message:e})}},{key:"on",value:function(){console.log(this.state.feeds);var e={request:"switch",feed:this.state.feeds[1].rfid,video:!0};this.state.feeds[1].send({message:e})}},{key:"componentDidMount",value:function(){}},{key:"pageAfterIn",value:function(){this.sessionCreate()}},{key:"loadData",value:function(){l.a.instance.toast.show({text:d.receiving,closeTimeout:2e3,position:"top"}),I("shortners",this.state.page,{},this.state.token)}},{key:"getList",value:function(){var e=w.getList(),t=w.getKlass();e&&"Shortner"===t&&this.setState({shortners:e})}},{key:"unmute",value:function(){this.setState({muted:!1})}},{key:"render",value:function(){var e=this.state,t=e.shortners,n=e.urls,a=e.publishedMicrophone,i=e.publisedCamera,o=e.feeds,s=e.muted;return r.a.createElement(kt,{pageAfterIn:this.pageAfterIn,shortners:t,streamAttacher:this.streamAttacher,urls:n,off:this.off,on:this.on,feeds:o,muted:s,unmute:this.unmute,publisedCamera:i,publishedMicrophone:a,publishCamera:this.publishCamera,publishMicrophone:this.publishMicrophone})}}]),t}(r.a.Component)},{path:"/metas/",component:$},{path:"/metas/:metaId/edit",component:K},{path:"/metas/new",component:J},{path:"/metas/:metaId",component:U},{path:"/notifications/",component:pe},{path:"/posts/",component:se},{path:"/posts/:postId/edit",component:he},{path:"/posts/new",component:fe},{path:"/posts/:postId",component:ae},{path:"/channels/",component:we},{path:"/channels/:channelId/edit",component:je},{path:"/channels/new",component:Oe},{path:"/channels/:channelId",component:ye},{path:"/roles/",component:Me},{path:"/roles/:roleId/edit",component:We},{path:"/roles/new",component:Pe},{path:"/roles/:roleId",component:xe},{path:"/profiles/",component:at},{path:"/profiles/:profileId/edit",component:lt},{path:"/profiles/new",component:st},{path:"/profiles/:profileId",component:et},{path:"/friendships/:sourceId",component:ut},{path:"/privacy_settings/",component:mt},{path:"/settings/",component:$e},{path:"/settings/:settingId/edit",component:Ke},{path:"/settings/new",component:Je},{path:"/settings/:settingId",component:Ue},{path:"(.*)",component:function(){return r.a.createElement(c.y,null,r.a.createElement(c.x,{title:"Not found",backLink:"Back"}),r.a.createElement(c.f,{strong:!0},r.a.createElement("p",null,"Sorry"),r.a.createElement("p",null,"Requested content not found.")))}}];n(273),n(274),n(275),n(276),n(277),n(278),Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));l.a.use(c.K),s.a.render(r.a.createElement((function(e){var t={id:"io.framework7.testapp",name:"Framework7",theme:"aurora",panel:{rightBreakpoint:960},touch:{tapHold:!0},view:{},routes:_t};return r.a.createElement(c.e,{params:t},r.a.createElement(c.E,null),r.a.createElement(c.A,{left:!0,cover:!0,themeDark:!0},r.a.createElement(c.J,{url:"/panel-left/"})),r.a.createElement(c.A,{right:!0,reveal:!0,themeDark:!0},r.a.createElement(c.J,{url:"/panel-right/"})),r.a.createElement(c.J,{id:"main-view",url:"/",pushState:!0,main:!0,className:"safe-areas"}))})),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()}))},72:function(e,t){e.exports={"generic.add":"\u0627\u0641\u0632\u0648\u062f\u0646","generic.cancel":"\u0644\u063a\u0648","components.controls.blocktype.h1":"H1","components.controls.blocktype.h2":"H2","components.controls.blocktype.h3":"H3","components.controls.blocktype.h4":"H4","components.controls.blocktype.h5":"H5","components.controls.blocktype.h6":"H6","components.controls.blocktype.blockquote":"Blockquote","components.controls.blocktype.code":"Code","components.controls.blocktype.blocktype":"Block Type","components.controls.blocktype.normal":"Normal","components.controls.colorpicker.colorpicker":"Color Picker","components.controls.colorpicker.text":"Text","components.controls.colorpicker.background":"Highlight","components.controls.embedded.embedded":"Embedded","components.controls.embedded.embeddedlink":"Embedded Link","components.controls.embedded.enterlink":"Enter link","components.controls.emoji.emoji":"Emoji","components.controls.fontfamily.fontfamily":"Font","components.controls.fontsize.fontsize":"Font Size","components.controls.history.history":"History","components.controls.history.undo":"Undo","components.controls.history.redo":"Redo","components.controls.image.image":"\u0639\u06a9\u0633","components.controls.image.fileUpload":"\u0628\u0627\u0631\u06af\u0630\u0627\u0631\u06cc","components.controls.image.byURL":"\u067e\u06cc\u0648\u0646\u062f","components.controls.image.dropFileText":"\u0627\u06cc\u0646\u062c\u0627 \u0631\u0627 \u06a9\u0644\u06cc\u06a9 \u06a9\u0646\u06cc\u062f ","components.controls.inline.bold":"Bold","components.controls.inline.italic":"Italic","components.controls.inline.underline":"Underline","components.controls.inline.strikethrough":"Strikethrough","components.controls.inline.monospace":"Monospace","components.controls.inline.superscript":"Superscript","components.controls.inline.subscript":"Subscript","components.controls.link.linkTitle":"\u0639\u0646\u0648\u0627\u0646 \u067e\u06cc\u0648\u0646\u062f","components.controls.link.linkTarget":"\u0622\u062f\u0631\u0633","components.controls.link.linkTargetOption":"\u062f\u0631 \u067e\u0646\u062c\u0631\u0647 \u062c\u062f\u06cc\u062f \u0628\u0627\u0632 \u06a9\u0646","components.controls.link.link":"\u067e\u06cc\u0648\u0646\u062f","components.controls.link.unlink":"\u0644\u063a\u0648 \u067e\u06cc\u0648\u0646\u062f","components.controls.list.list":"List","components.controls.list.unordered":"Unordered","components.controls.list.ordered":"Ordered","components.controls.list.indent":"Indent","components.controls.list.outdent":"Outdent","components.controls.remove.remove":"Remove","components.controls.textalign.textalign":"Text Align","components.controls.textalign.left":"Left","components.controls.textalign.center":"Center","components.controls.textalign.right":"Right","components.controls.textalign.justify":"Justify"}}},[[124,1,2]]]);
//# sourceMappingURL=main.5a938547.chunk.js.map